var $T=Object.defineProperty;var cA=s=>{throw TypeError(s)};var zT=(s,e,t)=>e in s?$T(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ss=(s,e,t)=>zT(s,typeof e!="symbol"?e+"":e,t),cw=(s,e,t)=>e.has(s)||cA("Cannot "+t);var f=(s,e,t)=>(cw(s,e,"read from private field"),t?t.call(s):e.get(s)),Q=(s,e,t)=>e.has(s)?cA("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),F=(s,e,t,r)=>(cw(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t),te=(s,e,t)=>(cw(s,e,"access private method"),t);var Gn=(s,e,t,r)=>({set _(n){F(s,e,n,t)},get _(){return f(s,e,r)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var si=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Y3(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function K3(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(r){var n=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return s[r]}})}),t}var X3={exports:{}},W1={},J3={exports:{}},ks={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var db=Symbol.for("react.element"),UT=Symbol.for("react.portal"),qT=Symbol.for("react.fragment"),HT=Symbol.for("react.strict_mode"),WT=Symbol.for("react.profiler"),VT=Symbol.for("react.provider"),GT=Symbol.for("react.context"),YT=Symbol.for("react.forward_ref"),KT=Symbol.for("react.suspense"),XT=Symbol.for("react.memo"),JT=Symbol.for("react.lazy"),dA=Symbol.iterator;function QT(s){return s===null||typeof s!="object"?null:(s=dA&&s[dA]||s["@@iterator"],typeof s=="function"?s:null)}var Q3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Z3=Object.assign,ek={};function Np(s,e,t){this.props=s,this.context=e,this.refs=ek,this.updater=t||Q3}Np.prototype.isReactComponent={};Np.prototype.setState=function(s,e){if(typeof s!="object"&&typeof s!="function"&&s!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,s,e,"setState")};Np.prototype.forceUpdate=function(s){this.updater.enqueueForceUpdate(this,s,"forceUpdate")};function tk(){}tk.prototype=Np.prototype;function tS(s,e,t){this.props=s,this.context=e,this.refs=ek,this.updater=t||Q3}var sS=tS.prototype=new tk;sS.constructor=tS;Z3(sS,Np.prototype);sS.isPureReactComponent=!0;var uA=Array.isArray,sk=Object.prototype.hasOwnProperty,rS={current:null},rk={key:!0,ref:!0,__self:!0,__source:!0};function nk(s,e,t){var r,n={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)sk.call(e,r)&&!rk.hasOwnProperty(r)&&(n[r]=e[r]);var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];n.children=c}if(s&&s.defaultProps)for(r in l=s.defaultProps,l)n[r]===void 0&&(n[r]=l[r]);return{$$typeof:db,type:s,key:i,ref:o,props:n,_owner:rS.current}}function ZT(s,e){return{$$typeof:db,type:s.type,key:e,ref:s.ref,props:s.props,_owner:s._owner}}function nS(s){return typeof s=="object"&&s!==null&&s.$$typeof===db}function eI(s){var e={"=":"=0",":":"=2"};return"$"+s.replace(/[=:]/g,function(t){return e[t]})}var hA=/\/+/g;function dw(s,e){return typeof s=="object"&&s!==null&&s.key!=null?eI(""+s.key):e.toString(36)}function zy(s,e,t,r,n){var i=typeof s;(i==="undefined"||i==="boolean")&&(s=null);var o=!1;if(s===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(s.$$typeof){case db:case UT:o=!0}}if(o)return o=s,n=n(o),s=r===""?"."+dw(o,0):r,uA(n)?(t="",s!=null&&(t=s.replace(hA,"$&/")+"/"),zy(n,e,t,"",function(d){return d})):n!=null&&(nS(n)&&(n=ZT(n,t+(!n.key||o&&o.key===n.key?"":(""+n.key).replace(hA,"$&/")+"/")+s)),e.push(n)),1;if(o=0,r=r===""?".":r+":",uA(s))for(var l=0;l<s.length;l++){i=s[l];var c=r+dw(i,l);o+=zy(i,e,t,c,n)}else if(c=QT(s),typeof c=="function")for(s=c.call(s),l=0;!(i=s.next()).done;)i=i.value,c=r+dw(i,l++),o+=zy(i,e,t,c,n);else if(i==="object")throw e=String(s),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ay(s,e,t){if(s==null)return s;var r=[],n=0;return zy(s,r,"","",function(i){return e.call(t,i,n++)}),r}function tI(s){if(s._status===-1){var e=s._result;e=e(),e.then(function(t){(s._status===0||s._status===-1)&&(s._status=1,s._result=t)},function(t){(s._status===0||s._status===-1)&&(s._status=2,s._result=t)}),s._status===-1&&(s._status=0,s._result=e)}if(s._status===1)return s._result.default;throw s._result}var oi={current:null},Uy={transition:null},sI={ReactCurrentDispatcher:oi,ReactCurrentBatchConfig:Uy,ReactCurrentOwner:rS};function ik(){throw Error("act(...) is not supported in production builds of React.")}ks.Children={map:ay,forEach:function(s,e,t){ay(s,function(){e.apply(this,arguments)},t)},count:function(s){var e=0;return ay(s,function(){e++}),e},toArray:function(s){return ay(s,function(e){return e})||[]},only:function(s){if(!nS(s))throw Error("React.Children.only expected to receive a single React element child.");return s}};ks.Component=Np;ks.Fragment=qT;ks.Profiler=WT;ks.PureComponent=tS;ks.StrictMode=HT;ks.Suspense=KT;ks.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sI;ks.act=ik;ks.cloneElement=function(s,e,t){if(s==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+s+".");var r=Z3({},s.props),n=s.key,i=s.ref,o=s._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=rS.current),e.key!==void 0&&(n=""+e.key),s.type&&s.type.defaultProps)var l=s.type.defaultProps;for(c in e)sk.call(e,c)&&!rk.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=t;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:db,type:s.type,key:n,ref:i,props:r,_owner:o}};ks.createContext=function(s){return s={$$typeof:GT,_currentValue:s,_currentValue2:s,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},s.Provider={$$typeof:VT,_context:s},s.Consumer=s};ks.createElement=nk;ks.createFactory=function(s){var e=nk.bind(null,s);return e.type=s,e};ks.createRef=function(){return{current:null}};ks.forwardRef=function(s){return{$$typeof:YT,render:s}};ks.isValidElement=nS;ks.lazy=function(s){return{$$typeof:JT,_payload:{_status:-1,_result:s},_init:tI}};ks.memo=function(s,e){return{$$typeof:XT,type:s,compare:e===void 0?null:e}};ks.startTransition=function(s){var e=Uy.transition;Uy.transition={};try{s()}finally{Uy.transition=e}};ks.unstable_act=ik;ks.useCallback=function(s,e){return oi.current.useCallback(s,e)};ks.useContext=function(s){return oi.current.useContext(s)};ks.useDebugValue=function(){};ks.useDeferredValue=function(s){return oi.current.useDeferredValue(s)};ks.useEffect=function(s,e){return oi.current.useEffect(s,e)};ks.useId=function(){return oi.current.useId()};ks.useImperativeHandle=function(s,e,t){return oi.current.useImperativeHandle(s,e,t)};ks.useInsertionEffect=function(s,e){return oi.current.useInsertionEffect(s,e)};ks.useLayoutEffect=function(s,e){return oi.current.useLayoutEffect(s,e)};ks.useMemo=function(s,e){return oi.current.useMemo(s,e)};ks.useReducer=function(s,e,t){return oi.current.useReducer(s,e,t)};ks.useRef=function(s){return oi.current.useRef(s)};ks.useState=function(s){return oi.current.useState(s)};ks.useSyncExternalStore=function(s,e,t){return oi.current.useSyncExternalStore(s,e,t)};ks.useTransition=function(){return oi.current.useTransition()};ks.version="18.3.1";J3.exports=ks;var ne=J3.exports;const Yt=Y3(ne);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rI=ne,nI=Symbol.for("react.element"),iI=Symbol.for("react.fragment"),aI=Object.prototype.hasOwnProperty,oI=rI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lI={key:!0,ref:!0,__self:!0,__source:!0};function ak(s,e,t){var r,n={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)aI.call(e,r)&&!lI.hasOwnProperty(r)&&(n[r]=e[r]);if(s&&s.defaultProps)for(r in e=s.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:nI,type:s,key:i,ref:o,props:n,_owner:oI.current}}W1.Fragment=iI;W1.jsx=ak;W1.jsxs=ak;X3.exports=W1;var a=X3.exports,ok={exports:{}},sa={},lk={exports:{}},ck={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(s){function e(q,K){var de=q.length;q.push(K);e:for(;0<de;){var Ne=de-1>>>1,R=q[Ne];if(0<n(R,K))q[Ne]=K,q[de]=R,de=Ne;else break e}}function t(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var K=q[0],de=q.pop();if(de!==K){q[0]=de;e:for(var Ne=0,R=q.length,W=R>>>1;Ne<W;){var Z=2*(Ne+1)-1,ue=q[Z],ce=Z+1,ye=q[ce];if(0>n(ue,de))ce<R&&0>n(ye,ue)?(q[Ne]=ye,q[ce]=de,Ne=ce):(q[Ne]=ue,q[Z]=de,Ne=Z);else if(ce<R&&0>n(ye,de))q[Ne]=ye,q[ce]=de,Ne=ce;else break e}}return K}function n(q,K){var de=q.sortIndex-K.sortIndex;return de!==0?de:q.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;s.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();s.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,m=3,p=!1,x=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(q){for(var K=t(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=q)r(d),K.sortIndex=K.expirationTime,e(c,K);else break;K=t(d)}}function j(q){if(w=!1,N(q),!x)if(t(c)!==null)x=!0,M(E);else{var K=t(d);K!==null&&$(j,K.startTime-q)}}function E(q,K){x=!1,w&&(w=!1,b(C),C=-1),p=!0;var de=m;try{for(N(K),h=t(c);h!==null&&(!(h.expirationTime>K)||q&&!P());){var Ne=h.callback;if(typeof Ne=="function"){h.callback=null,m=h.priorityLevel;var R=Ne(h.expirationTime<=K);K=s.unstable_now(),typeof R=="function"?h.callback=R:h===t(c)&&r(c),N(K)}else r(c);h=t(c)}if(h!==null)var W=!0;else{var Z=t(d);Z!==null&&$(j,Z.startTime-K),W=!1}return W}finally{h=null,m=de,p=!1}}var A=!1,L=null,C=-1,B=5,U=-1;function P(){return!(s.unstable_now()-U<B)}function T(){if(L!==null){var q=s.unstable_now();U=q;var K=!0;try{K=L(!0,q)}finally{K?z():(A=!1,L=null)}}else A=!1}var z;if(typeof v=="function")z=function(){v(T)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,D=H.port2;H.port1.onmessage=T,z=function(){D.postMessage(null)}}else z=function(){S(T,0)};function M(q){L=q,A||(A=!0,z())}function $(q,K){C=S(function(){q(s.unstable_now())},K)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(q){q.callback=null},s.unstable_continueExecution=function(){x||p||(x=!0,M(E))},s.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<q?Math.floor(1e3/q):5},s.unstable_getCurrentPriorityLevel=function(){return m},s.unstable_getFirstCallbackNode=function(){return t(c)},s.unstable_next=function(q){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var de=m;m=K;try{return q()}finally{m=de}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(q,K){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var de=m;m=q;try{return K()}finally{m=de}},s.unstable_scheduleCallback=function(q,K,de){var Ne=s.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?Ne+de:Ne):de=Ne,q){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=de+R,q={id:u++,callback:K,priorityLevel:q,startTime:de,expirationTime:R,sortIndex:-1},de>Ne?(q.sortIndex=de,e(d,q),t(c)===null&&q===t(d)&&(w?(b(C),C=-1):w=!0,$(j,de-Ne))):(q.sortIndex=R,e(c,q),x||p||(x=!0,M(E))),q},s.unstable_shouldYield=P,s.unstable_wrapCallback=function(q){var K=m;return function(){var de=m;m=K;try{return q.apply(this,arguments)}finally{m=de}}}})(ck);lk.exports=ck;var cI=lk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dI=ne,ta=cI;function _t(s){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+s,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+s+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dk=new Set,cg={};function Uh(s,e){fp(s,e),fp(s+"Capture",e)}function fp(s,e){for(cg[s]=e,s=0;s<e.length;s++)dk.add(e[s])}var Zl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m5=Object.prototype.hasOwnProperty,uI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fA={},mA={};function hI(s){return m5.call(mA,s)?!0:m5.call(fA,s)?!1:uI.test(s)?mA[s]=!0:(fA[s]=!0,!1)}function fI(s,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function mI(s,e,t,r){if(e===null||typeof e>"u"||fI(s,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function li(s,e,t,r,n,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=s,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Nn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){Nn[s]=new li(s,0,!1,s,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var e=s[0];Nn[e]=new li(e,1,!1,s[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(s){Nn[s]=new li(s,2,!1,s.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){Nn[s]=new li(s,2,!1,s,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){Nn[s]=new li(s,3,!1,s.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(s){Nn[s]=new li(s,3,!0,s,null,!1,!1)});["capture","download"].forEach(function(s){Nn[s]=new li(s,4,!1,s,null,!1,!1)});["cols","rows","size","span"].forEach(function(s){Nn[s]=new li(s,6,!1,s,null,!1,!1)});["rowSpan","start"].forEach(function(s){Nn[s]=new li(s,5,!1,s.toLowerCase(),null,!1,!1)});var iS=/[\-:]([a-z])/g;function aS(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var e=s.replace(iS,aS);Nn[e]=new li(e,1,!1,s,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var e=s.replace(iS,aS);Nn[e]=new li(e,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(s){var e=s.replace(iS,aS);Nn[e]=new li(e,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(s){Nn[s]=new li(s,1,!1,s.toLowerCase(),null,!1,!1)});Nn.xlinkHref=new li("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(s){Nn[s]=new li(s,1,!1,s.toLowerCase(),null,!0,!0)});function oS(s,e,t,r){var n=Nn.hasOwnProperty(e)?Nn[e]:null;(n!==null?n.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(mI(e,t,n,r)&&(t=null),r||n===null?hI(e)&&(t===null?s.removeAttribute(e):s.setAttribute(e,""+t)):n.mustUseProperty?s[n.propertyName]=t===null?n.type===3?!1:"":t:(e=n.attributeName,r=n.attributeNamespace,t===null?s.removeAttribute(e):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,r?s.setAttributeNS(r,e,t):s.setAttribute(e,t))))}var oc=dI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,oy=Symbol.for("react.element"),Of=Symbol.for("react.portal"),Bf=Symbol.for("react.fragment"),lS=Symbol.for("react.strict_mode"),p5=Symbol.for("react.profiler"),uk=Symbol.for("react.provider"),hk=Symbol.for("react.context"),cS=Symbol.for("react.forward_ref"),g5=Symbol.for("react.suspense"),x5=Symbol.for("react.suspense_list"),dS=Symbol.for("react.memo"),Ec=Symbol.for("react.lazy"),fk=Symbol.for("react.offscreen"),pA=Symbol.iterator;function r0(s){return s===null||typeof s!="object"?null:(s=pA&&s[pA]||s["@@iterator"],typeof s=="function"?s:null)}var yr=Object.assign,uw;function w0(s){if(uw===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);uw=e&&e[1]||""}return`
`+uw+s}var hw=!1;function fw(s,e){if(!s||hw)return"";hw=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(s,[],e)}else{try{e.call()}catch(d){r=d}s.call(e.prototype)}else{try{throw Error()}catch(d){r=d}s()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var n=d.stack.split(`
`),i=r.stack.split(`
`),o=n.length-1,l=i.length-1;1<=o&&0<=l&&n[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(n[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||n[o]!==i[l]){var c=`
`+n[o].replace(" at new "," at ");return s.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",s.displayName)),c}while(1<=o&&0<=l);break}}}finally{hw=!1,Error.prepareStackTrace=t}return(s=s?s.displayName||s.name:"")?w0(s):""}function pI(s){switch(s.tag){case 5:return w0(s.type);case 16:return w0("Lazy");case 13:return w0("Suspense");case 19:return w0("SuspenseList");case 0:case 2:case 15:return s=fw(s.type,!1),s;case 11:return s=fw(s.type.render,!1),s;case 1:return s=fw(s.type,!0),s;default:return""}}function b5(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case Bf:return"Fragment";case Of:return"Portal";case p5:return"Profiler";case lS:return"StrictMode";case g5:return"Suspense";case x5:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case hk:return(s.displayName||"Context")+".Consumer";case uk:return(s._context.displayName||"Context")+".Provider";case cS:var e=s.render;return s=s.displayName,s||(s=e.displayName||e.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case dS:return e=s.displayName||null,e!==null?e:b5(s.type)||"Memo";case Ec:e=s._payload,s=s._init;try{return b5(s(e))}catch{}}return null}function gI(s){var e=s.type;switch(s.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=e.render,s=s.displayName||s.name||"",e.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return b5(e);case 8:return e===lS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ld(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function mk(s){var e=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xI(s){var e=mk(s)?"checked":"value",t=Object.getOwnPropertyDescriptor(s.constructor.prototype,e),r=""+s[e];if(!s.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,i=t.set;return Object.defineProperty(s,e,{configurable:!0,get:function(){return n.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(s,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){s._valueTracker=null,delete s[e]}}}}function ly(s){s._valueTracker||(s._valueTracker=xI(s))}function pk(s){if(!s)return!1;var e=s._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return s&&(r=mk(s)?s.checked?"true":"false":s.value),s=r,s!==t?(e.setValue(s),!0):!1}function Mv(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function y5(s,e){var t=e.checked;return yr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??s._wrapperState.initialChecked})}function gA(s,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Ld(e.value!=null?e.value:t),s._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function gk(s,e){e=e.checked,e!=null&&oS(s,"checked",e,!1)}function v5(s,e){gk(s,e);var t=Ld(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&s.value===""||s.value!=t)&&(s.value=""+t):s.value!==""+t&&(s.value=""+t);else if(r==="submit"||r==="reset"){s.removeAttribute("value");return}e.hasOwnProperty("value")?w5(s,e.type,t):e.hasOwnProperty("defaultValue")&&w5(s,e.type,Ld(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(s.defaultChecked=!!e.defaultChecked)}function xA(s,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+s._wrapperState.initialValue,t||e===s.value||(s.value=e),s.defaultValue=e}t=s.name,t!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,t!==""&&(s.name=t)}function w5(s,e,t){(e!=="number"||Mv(s.ownerDocument)!==s)&&(t==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+t&&(s.defaultValue=""+t))}var N0=Array.isArray;function Qf(s,e,t,r){if(s=s.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<s.length;t++)n=e.hasOwnProperty("$"+s[t].value),s[t].selected!==n&&(s[t].selected=n),n&&r&&(s[t].defaultSelected=!0)}else{for(t=""+Ld(t),e=null,n=0;n<s.length;n++){if(s[n].value===t){s[n].selected=!0,r&&(s[n].defaultSelected=!0);return}e!==null||s[n].disabled||(e=s[n])}e!==null&&(e.selected=!0)}}function N5(s,e){if(e.dangerouslySetInnerHTML!=null)throw Error(_t(91));return yr({},e,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function bA(s,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(_t(92));if(N0(t)){if(1<t.length)throw Error(_t(93));t=t[0]}e=t}e==null&&(e=""),t=e}s._wrapperState={initialValue:Ld(t)}}function xk(s,e){var t=Ld(e.value),r=Ld(e.defaultValue);t!=null&&(t=""+t,t!==s.value&&(s.value=t),e.defaultValue==null&&s.defaultValue!==t&&(s.defaultValue=t)),r!=null&&(s.defaultValue=""+r)}function yA(s){var e=s.textContent;e===s._wrapperState.initialValue&&e!==""&&e!==null&&(s.value=e)}function bk(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _5(s,e){return s==null||s==="http://www.w3.org/1999/xhtml"?bk(e):s==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var cy,yk=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return s(e,t,r,n)})}:s}(function(s,e){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=e;else{for(cy=cy||document.createElement("div"),cy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=cy.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;e.firstChild;)s.appendChild(e.firstChild)}});function dg(s,e){if(e){var t=s.firstChild;if(t&&t===s.lastChild&&t.nodeType===3){t.nodeValue=e;return}}s.textContent=e}var q0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bI=["Webkit","ms","Moz","O"];Object.keys(q0).forEach(function(s){bI.forEach(function(e){e=e+s.charAt(0).toUpperCase()+s.substring(1),q0[e]=q0[s]})});function vk(s,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||q0.hasOwnProperty(s)&&q0[s]?(""+e).trim():e+"px"}function wk(s,e){s=s.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,n=vk(t,e[t],r);t==="float"&&(t="cssFloat"),r?s.setProperty(t,n):s[t]=n}}var yI=yr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function S5(s,e){if(e){if(yI[s]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(_t(137,s));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(_t(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(_t(61))}if(e.style!=null&&typeof e.style!="object")throw Error(_t(62))}}function j5(s,e){if(s.indexOf("-")===-1)return typeof e.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var A5=null;function uS(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var k5=null,Zf=null,em=null;function vA(s){if(s=fb(s)){if(typeof k5!="function")throw Error(_t(280));var e=s.stateNode;e&&(e=X1(e),k5(s.stateNode,s.type,e))}}function Nk(s){Zf?em?em.push(s):em=[s]:Zf=s}function _k(){if(Zf){var s=Zf,e=em;if(em=Zf=null,vA(s),e)for(s=0;s<e.length;s++)vA(e[s])}}function Sk(s,e){return s(e)}function jk(){}var mw=!1;function Ak(s,e,t){if(mw)return s(e,t);mw=!0;try{return Sk(s,e,t)}finally{mw=!1,(Zf!==null||em!==null)&&(jk(),_k())}}function ug(s,e){var t=s.stateNode;if(t===null)return null;var r=X1(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(s=s.type,r=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!r;break e;default:s=!1}if(s)return null;if(t&&typeof t!="function")throw Error(_t(231,e,typeof t));return t}var C5=!1;if(Zl)try{var n0={};Object.defineProperty(n0,"passive",{get:function(){C5=!0}}),window.addEventListener("test",n0,n0),window.removeEventListener("test",n0,n0)}catch{C5=!1}function vI(s,e,t,r,n,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(u){this.onError(u)}}var H0=!1,Fv=null,Ov=!1,E5=null,wI={onError:function(s){H0=!0,Fv=s}};function NI(s,e,t,r,n,i,o,l,c){H0=!1,Fv=null,vI.apply(wI,arguments)}function _I(s,e,t,r,n,i,o,l,c){if(NI.apply(this,arguments),H0){if(H0){var d=Fv;H0=!1,Fv=null}else throw Error(_t(198));Ov||(Ov=!0,E5=d)}}function qh(s){var e=s,t=s;if(s.alternate)for(;e.return;)e=e.return;else{s=e;do e=s,e.flags&4098&&(t=e.return),s=e.return;while(s)}return e.tag===3?t:null}function kk(s){if(s.tag===13){var e=s.memoizedState;if(e===null&&(s=s.alternate,s!==null&&(e=s.memoizedState)),e!==null)return e.dehydrated}return null}function wA(s){if(qh(s)!==s)throw Error(_t(188))}function SI(s){var e=s.alternate;if(!e){if(e=qh(s),e===null)throw Error(_t(188));return e!==s?null:s}for(var t=s,r=e;;){var n=t.return;if(n===null)break;var i=n.alternate;if(i===null){if(r=n.return,r!==null){t=r;continue}break}if(n.child===i.child){for(i=n.child;i;){if(i===t)return wA(n),s;if(i===r)return wA(n),e;i=i.sibling}throw Error(_t(188))}if(t.return!==r.return)t=n,r=i;else{for(var o=!1,l=n.child;l;){if(l===t){o=!0,t=n,r=i;break}if(l===r){o=!0,r=n,t=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===t){o=!0,t=i,r=n;break}if(l===r){o=!0,r=i,t=n;break}l=l.sibling}if(!o)throw Error(_t(189))}}if(t.alternate!==r)throw Error(_t(190))}if(t.tag!==3)throw Error(_t(188));return t.stateNode.current===t?s:e}function Ck(s){return s=SI(s),s!==null?Ek(s):null}function Ek(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var e=Ek(s);if(e!==null)return e;s=s.sibling}return null}var Lk=ta.unstable_scheduleCallback,NA=ta.unstable_cancelCallback,jI=ta.unstable_shouldYield,AI=ta.unstable_requestPaint,Er=ta.unstable_now,kI=ta.unstable_getCurrentPriorityLevel,hS=ta.unstable_ImmediatePriority,Pk=ta.unstable_UserBlockingPriority,Bv=ta.unstable_NormalPriority,CI=ta.unstable_LowPriority,Tk=ta.unstable_IdlePriority,V1=null,Yo=null;function EI(s){if(Yo&&typeof Yo.onCommitFiberRoot=="function")try{Yo.onCommitFiberRoot(V1,s,void 0,(s.current.flags&128)===128)}catch{}}var oo=Math.clz32?Math.clz32:TI,LI=Math.log,PI=Math.LN2;function TI(s){return s>>>=0,s===0?32:31-(LI(s)/PI|0)|0}var dy=64,uy=4194304;function _0(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function $v(s,e){var t=s.pendingLanes;if(t===0)return 0;var r=0,n=s.suspendedLanes,i=s.pingedLanes,o=t&268435455;if(o!==0){var l=o&~n;l!==0?r=_0(l):(i&=o,i!==0&&(r=_0(i)))}else o=t&~n,o!==0?r=_0(o):i!==0&&(r=_0(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&n)&&(n=r&-r,i=e&-e,n>=i||n===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=s.entangledLanes,e!==0)for(s=s.entanglements,e&=r;0<e;)t=31-oo(e),n=1<<t,r|=s[t],e&=~n;return r}function II(s,e){switch(s){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RI(s,e){for(var t=s.suspendedLanes,r=s.pingedLanes,n=s.expirationTimes,i=s.pendingLanes;0<i;){var o=31-oo(i),l=1<<o,c=n[o];c===-1?(!(l&t)||l&r)&&(n[o]=II(l,e)):c<=e&&(s.expiredLanes|=l),i&=~l}}function L5(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Ik(){var s=dy;return dy<<=1,!(dy&4194240)&&(dy=64),s}function pw(s){for(var e=[],t=0;31>t;t++)e.push(s);return e}function ub(s,e,t){s.pendingLanes|=e,e!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,e=31-oo(e),s[e]=t}function DI(s,e){var t=s.pendingLanes&~e;s.pendingLanes=e,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=e,s.mutableReadLanes&=e,s.entangledLanes&=e,e=s.entanglements;var r=s.eventTimes;for(s=s.expirationTimes;0<t;){var n=31-oo(t),i=1<<n;e[n]=0,r[n]=-1,s[n]=-1,t&=~i}}function fS(s,e){var t=s.entangledLanes|=e;for(s=s.entanglements;t;){var r=31-oo(t),n=1<<r;n&e|s[r]&e&&(s[r]|=e),t&=~n}}var Vs=0;function Rk(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var Dk,mS,Mk,Fk,Ok,P5=!1,hy=[],yd=null,vd=null,wd=null,hg=new Map,fg=new Map,Pc=[],MI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _A(s,e){switch(s){case"focusin":case"focusout":yd=null;break;case"dragenter":case"dragleave":vd=null;break;case"mouseover":case"mouseout":wd=null;break;case"pointerover":case"pointerout":hg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fg.delete(e.pointerId)}}function i0(s,e,t,r,n,i){return s===null||s.nativeEvent!==i?(s={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[n]},e!==null&&(e=fb(e),e!==null&&mS(e)),s):(s.eventSystemFlags|=r,e=s.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),s)}function FI(s,e,t,r,n){switch(e){case"focusin":return yd=i0(yd,s,e,t,r,n),!0;case"dragenter":return vd=i0(vd,s,e,t,r,n),!0;case"mouseover":return wd=i0(wd,s,e,t,r,n),!0;case"pointerover":var i=n.pointerId;return hg.set(i,i0(hg.get(i)||null,s,e,t,r,n)),!0;case"gotpointercapture":return i=n.pointerId,fg.set(i,i0(fg.get(i)||null,s,e,t,r,n)),!0}return!1}function Bk(s){var e=gu(s.target);if(e!==null){var t=qh(e);if(t!==null){if(e=t.tag,e===13){if(e=kk(t),e!==null){s.blockedOn=e,Ok(s.priority,function(){Mk(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){s.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}s.blockedOn=null}function qy(s){if(s.blockedOn!==null)return!1;for(var e=s.targetContainers;0<e.length;){var t=T5(s.domEventName,s.eventSystemFlags,e[0],s.nativeEvent);if(t===null){t=s.nativeEvent;var r=new t.constructor(t.type,t);A5=r,t.target.dispatchEvent(r),A5=null}else return e=fb(t),e!==null&&mS(e),s.blockedOn=t,!1;e.shift()}return!0}function SA(s,e,t){qy(s)&&t.delete(e)}function OI(){P5=!1,yd!==null&&qy(yd)&&(yd=null),vd!==null&&qy(vd)&&(vd=null),wd!==null&&qy(wd)&&(wd=null),hg.forEach(SA),fg.forEach(SA)}function a0(s,e){s.blockedOn===e&&(s.blockedOn=null,P5||(P5=!0,ta.unstable_scheduleCallback(ta.unstable_NormalPriority,OI)))}function mg(s){function e(n){return a0(n,s)}if(0<hy.length){a0(hy[0],s);for(var t=1;t<hy.length;t++){var r=hy[t];r.blockedOn===s&&(r.blockedOn=null)}}for(yd!==null&&a0(yd,s),vd!==null&&a0(vd,s),wd!==null&&a0(wd,s),hg.forEach(e),fg.forEach(e),t=0;t<Pc.length;t++)r=Pc[t],r.blockedOn===s&&(r.blockedOn=null);for(;0<Pc.length&&(t=Pc[0],t.blockedOn===null);)Bk(t),t.blockedOn===null&&Pc.shift()}var tm=oc.ReactCurrentBatchConfig,zv=!0;function BI(s,e,t,r){var n=Vs,i=tm.transition;tm.transition=null;try{Vs=1,pS(s,e,t,r)}finally{Vs=n,tm.transition=i}}function $I(s,e,t,r){var n=Vs,i=tm.transition;tm.transition=null;try{Vs=4,pS(s,e,t,r)}finally{Vs=n,tm.transition=i}}function pS(s,e,t,r){if(zv){var n=T5(s,e,t,r);if(n===null)jw(s,e,r,Uv,t),_A(s,r);else if(FI(n,s,e,t,r))r.stopPropagation();else if(_A(s,r),e&4&&-1<MI.indexOf(s)){for(;n!==null;){var i=fb(n);if(i!==null&&Dk(i),i=T5(s,e,t,r),i===null&&jw(s,e,r,Uv,t),i===n)break;n=i}n!==null&&r.stopPropagation()}else jw(s,e,r,null,t)}}var Uv=null;function T5(s,e,t,r){if(Uv=null,s=uS(r),s=gu(s),s!==null)if(e=qh(s),e===null)s=null;else if(t=e.tag,t===13){if(s=kk(e),s!==null)return s;s=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;s=null}else e!==s&&(s=null);return Uv=s,null}function $k(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kI()){case hS:return 1;case Pk:return 4;case Bv:case CI:return 16;case Tk:return 536870912;default:return 16}default:return 16}}var gd=null,gS=null,Hy=null;function zk(){if(Hy)return Hy;var s,e=gS,t=e.length,r,n="value"in gd?gd.value:gd.textContent,i=n.length;for(s=0;s<t&&e[s]===n[s];s++);var o=t-s;for(r=1;r<=o&&e[t-r]===n[i-r];r++);return Hy=n.slice(s,1<r?1-r:void 0)}function Wy(s){var e=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&e===13&&(s=13)):s=e,s===10&&(s=13),32<=s||s===13?s:0}function fy(){return!0}function jA(){return!1}function ra(s){function e(t,r,n,i,o){this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in s)s.hasOwnProperty(l)&&(t=s[l],this[l]=t?t(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?fy:jA,this.isPropagationStopped=jA,this}return yr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=fy)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=fy)},persist:function(){},isPersistent:fy}),e}var _p={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xS=ra(_p),hb=yr({},_p,{view:0,detail:0}),zI=ra(hb),gw,xw,o0,G1=yr({},hb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bS,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==o0&&(o0&&s.type==="mousemove"?(gw=s.screenX-o0.screenX,xw=s.screenY-o0.screenY):xw=gw=0,o0=s),gw)},movementY:function(s){return"movementY"in s?s.movementY:xw}}),AA=ra(G1),UI=yr({},G1,{dataTransfer:0}),qI=ra(UI),HI=yr({},hb,{relatedTarget:0}),bw=ra(HI),WI=yr({},_p,{animationName:0,elapsedTime:0,pseudoElement:0}),VI=ra(WI),GI=yr({},_p,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),YI=ra(GI),KI=yr({},_p,{data:0}),kA=ra(KI),XI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZI(s){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(s):(s=QI[s])?!!e[s]:!1}function bS(){return ZI}var e8=yr({},hb,{key:function(s){if(s.key){var e=XI[s.key]||s.key;if(e!=="Unidentified")return e}return s.type==="keypress"?(s=Wy(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?JI[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bS,charCode:function(s){return s.type==="keypress"?Wy(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Wy(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),t8=ra(e8),s8=yr({},G1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),CA=ra(s8),r8=yr({},hb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bS}),n8=ra(r8),i8=yr({},_p,{propertyName:0,elapsedTime:0,pseudoElement:0}),a8=ra(i8),o8=yr({},G1,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),l8=ra(o8),c8=[9,13,27,32],yS=Zl&&"CompositionEvent"in window,W0=null;Zl&&"documentMode"in document&&(W0=document.documentMode);var d8=Zl&&"TextEvent"in window&&!W0,Uk=Zl&&(!yS||W0&&8<W0&&11>=W0),EA=" ",LA=!1;function qk(s,e){switch(s){case"keyup":return c8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hk(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var $f=!1;function u8(s,e){switch(s){case"compositionend":return Hk(e);case"keypress":return e.which!==32?null:(LA=!0,EA);case"textInput":return s=e.data,s===EA&&LA?null:s;default:return null}}function h8(s,e){if($f)return s==="compositionend"||!yS&&qk(s,e)?(s=zk(),Hy=gS=gd=null,$f=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Uk&&e.locale!=="ko"?null:e.data;default:return null}}var f8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function PA(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e==="input"?!!f8[s.type]:e==="textarea"}function Wk(s,e,t,r){Nk(r),e=qv(e,"onChange"),0<e.length&&(t=new xS("onChange","change",null,t,r),s.push({event:t,listeners:e}))}var V0=null,pg=null;function m8(s){s6(s,0)}function Y1(s){var e=qf(s);if(pk(e))return s}function p8(s,e){if(s==="change")return e}var Vk=!1;if(Zl){var yw;if(Zl){var vw="oninput"in document;if(!vw){var TA=document.createElement("div");TA.setAttribute("oninput","return;"),vw=typeof TA.oninput=="function"}yw=vw}else yw=!1;Vk=yw&&(!document.documentMode||9<document.documentMode)}function IA(){V0&&(V0.detachEvent("onpropertychange",Gk),pg=V0=null)}function Gk(s){if(s.propertyName==="value"&&Y1(pg)){var e=[];Wk(e,pg,s,uS(s)),Ak(m8,e)}}function g8(s,e,t){s==="focusin"?(IA(),V0=e,pg=t,V0.attachEvent("onpropertychange",Gk)):s==="focusout"&&IA()}function x8(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Y1(pg)}function b8(s,e){if(s==="click")return Y1(e)}function y8(s,e){if(s==="input"||s==="change")return Y1(e)}function v8(s,e){return s===e&&(s!==0||1/s===1/e)||s!==s&&e!==e}var uo=typeof Object.is=="function"?Object.is:v8;function gg(s,e){if(uo(s,e))return!0;if(typeof s!="object"||s===null||typeof e!="object"||e===null)return!1;var t=Object.keys(s),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var n=t[r];if(!m5.call(e,n)||!uo(s[n],e[n]))return!1}return!0}function RA(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function DA(s,e){var t=RA(s);s=0;for(var r;t;){if(t.nodeType===3){if(r=s+t.textContent.length,s<=e&&r>=e)return{node:t,offset:e-s};s=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=RA(t)}}function Yk(s,e){return s&&e?s===e?!0:s&&s.nodeType===3?!1:e&&e.nodeType===3?Yk(s,e.parentNode):"contains"in s?s.contains(e):s.compareDocumentPosition?!!(s.compareDocumentPosition(e)&16):!1:!1}function Kk(){for(var s=window,e=Mv();e instanceof s.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)s=e.contentWindow;else break;e=Mv(s.document)}return e}function vS(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e&&(e==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||e==="textarea"||s.contentEditable==="true")}function w8(s){var e=Kk(),t=s.focusedElem,r=s.selectionRange;if(e!==t&&t&&t.ownerDocument&&Yk(t.ownerDocument.documentElement,t)){if(r!==null&&vS(t)){if(e=r.start,s=r.end,s===void 0&&(s=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(s,t.value.length);else if(s=(e=t.ownerDocument||document)&&e.defaultView||window,s.getSelection){s=s.getSelection();var n=t.textContent.length,i=Math.min(r.start,n);r=r.end===void 0?i:Math.min(r.end,n),!s.extend&&i>r&&(n=r,r=i,i=n),n=DA(t,i);var o=DA(t,r);n&&o&&(s.rangeCount!==1||s.anchorNode!==n.node||s.anchorOffset!==n.offset||s.focusNode!==o.node||s.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),s.removeAllRanges(),i>r?(s.addRange(e),s.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),s.addRange(e)))}}for(e=[],s=t;s=s.parentNode;)s.nodeType===1&&e.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)s=e[t],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var N8=Zl&&"documentMode"in document&&11>=document.documentMode,zf=null,I5=null,G0=null,R5=!1;function MA(s,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;R5||zf==null||zf!==Mv(r)||(r=zf,"selectionStart"in r&&vS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),G0&&gg(G0,r)||(G0=r,r=qv(I5,"onSelect"),0<r.length&&(e=new xS("onSelect","select",null,e,t),s.push({event:e,listeners:r}),e.target=zf)))}function my(s,e){var t={};return t[s.toLowerCase()]=e.toLowerCase(),t["Webkit"+s]="webkit"+e,t["Moz"+s]="moz"+e,t}var Uf={animationend:my("Animation","AnimationEnd"),animationiteration:my("Animation","AnimationIteration"),animationstart:my("Animation","AnimationStart"),transitionend:my("Transition","TransitionEnd")},ww={},Xk={};Zl&&(Xk=document.createElement("div").style,"AnimationEvent"in window||(delete Uf.animationend.animation,delete Uf.animationiteration.animation,delete Uf.animationstart.animation),"TransitionEvent"in window||delete Uf.transitionend.transition);function K1(s){if(ww[s])return ww[s];if(!Uf[s])return s;var e=Uf[s],t;for(t in e)if(e.hasOwnProperty(t)&&t in Xk)return ww[s]=e[t];return s}var Jk=K1("animationend"),Qk=K1("animationiteration"),Zk=K1("animationstart"),e6=K1("transitionend"),t6=new Map,FA="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Od(s,e){t6.set(s,e),Uh(e,[s])}for(var Nw=0;Nw<FA.length;Nw++){var _w=FA[Nw],_8=_w.toLowerCase(),S8=_w[0].toUpperCase()+_w.slice(1);Od(_8,"on"+S8)}Od(Jk,"onAnimationEnd");Od(Qk,"onAnimationIteration");Od(Zk,"onAnimationStart");Od("dblclick","onDoubleClick");Od("focusin","onFocus");Od("focusout","onBlur");Od(e6,"onTransitionEnd");fp("onMouseEnter",["mouseout","mouseover"]);fp("onMouseLeave",["mouseout","mouseover"]);fp("onPointerEnter",["pointerout","pointerover"]);fp("onPointerLeave",["pointerout","pointerover"]);Uh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var S0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),j8=new Set("cancel close invalid load scroll toggle".split(" ").concat(S0));function OA(s,e,t){var r=s.type||"unknown-event";s.currentTarget=t,_I(r,e,void 0,s),s.currentTarget=null}function s6(s,e){e=(e&4)!==0;for(var t=0;t<s.length;t++){var r=s[t],n=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&n.isPropagationStopped())break e;OA(n,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&n.isPropagationStopped())break e;OA(n,l,d),i=c}}}if(Ov)throw s=E5,Ov=!1,E5=null,s}function ir(s,e){var t=e[B5];t===void 0&&(t=e[B5]=new Set);var r=s+"__bubble";t.has(r)||(r6(e,s,2,!1),t.add(r))}function Sw(s,e,t){var r=0;e&&(r|=4),r6(t,s,r,e)}var py="_reactListening"+Math.random().toString(36).slice(2);function xg(s){if(!s[py]){s[py]=!0,dk.forEach(function(t){t!=="selectionchange"&&(j8.has(t)||Sw(t,!1,s),Sw(t,!0,s))});var e=s.nodeType===9?s:s.ownerDocument;e===null||e[py]||(e[py]=!0,Sw("selectionchange",!1,e))}}function r6(s,e,t,r){switch($k(e)){case 1:var n=BI;break;case 4:n=$I;break;default:n=pS}t=n.bind(null,e,t,s),n=void 0,!C5||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),r?n!==void 0?s.addEventListener(e,t,{capture:!0,passive:n}):s.addEventListener(e,t,!0):n!==void 0?s.addEventListener(e,t,{passive:n}):s.addEventListener(e,t,!1)}function jw(s,e,t,r,n){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;o=o.return}for(;l!==null;){if(o=gu(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Ak(function(){var d=i,u=uS(t),h=[];e:{var m=t6.get(s);if(m!==void 0){var p=xS,x=s;switch(s){case"keypress":if(Wy(t)===0)break e;case"keydown":case"keyup":p=t8;break;case"focusin":x="focus",p=bw;break;case"focusout":x="blur",p=bw;break;case"beforeblur":case"afterblur":p=bw;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=AA;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=qI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=n8;break;case Jk:case Qk:case Zk:p=VI;break;case e6:p=a8;break;case"scroll":p=zI;break;case"wheel":p=l8;break;case"copy":case"cut":case"paste":p=YI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=CA}var w=(e&4)!==0,S=!w&&s==="scroll",b=w?m!==null?m+"Capture":null:m;w=[];for(var v=d,N;v!==null;){N=v;var j=N.stateNode;if(N.tag===5&&j!==null&&(N=j,b!==null&&(j=ug(v,b),j!=null&&w.push(bg(v,j,N)))),S)break;v=v.return}0<w.length&&(m=new p(m,x,null,t,u),h.push({event:m,listeners:w}))}}if(!(e&7)){e:{if(m=s==="mouseover"||s==="pointerover",p=s==="mouseout"||s==="pointerout",m&&t!==A5&&(x=t.relatedTarget||t.fromElement)&&(gu(x)||x[ec]))break e;if((p||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,p?(x=t.relatedTarget||t.toElement,p=d,x=x?gu(x):null,x!==null&&(S=qh(x),x!==S||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=d),p!==x)){if(w=AA,j="onMouseLeave",b="onMouseEnter",v="mouse",(s==="pointerout"||s==="pointerover")&&(w=CA,j="onPointerLeave",b="onPointerEnter",v="pointer"),S=p==null?m:qf(p),N=x==null?m:qf(x),m=new w(j,v+"leave",p,t,u),m.target=S,m.relatedTarget=N,j=null,gu(u)===d&&(w=new w(b,v+"enter",x,t,u),w.target=N,w.relatedTarget=S,j=w),S=j,p&&x)t:{for(w=p,b=x,v=0,N=w;N;N=xf(N))v++;for(N=0,j=b;j;j=xf(j))N++;for(;0<v-N;)w=xf(w),v--;for(;0<N-v;)b=xf(b),N--;for(;v--;){if(w===b||b!==null&&w===b.alternate)break t;w=xf(w),b=xf(b)}w=null}else w=null;p!==null&&BA(h,m,p,w,!1),x!==null&&S!==null&&BA(h,S,x,w,!0)}}e:{if(m=d?qf(d):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var E=p8;else if(PA(m))if(Vk)E=y8;else{E=x8;var A=g8}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(E=b8);if(E&&(E=E(s,d))){Wk(h,E,t,u);break e}A&&A(s,m,d),s==="focusout"&&(A=m._wrapperState)&&A.controlled&&m.type==="number"&&w5(m,"number",m.value)}switch(A=d?qf(d):window,s){case"focusin":(PA(A)||A.contentEditable==="true")&&(zf=A,I5=d,G0=null);break;case"focusout":G0=I5=zf=null;break;case"mousedown":R5=!0;break;case"contextmenu":case"mouseup":case"dragend":R5=!1,MA(h,t,u);break;case"selectionchange":if(N8)break;case"keydown":case"keyup":MA(h,t,u)}var L;if(yS)e:{switch(s){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else $f?qk(s,t)&&(C="onCompositionEnd"):s==="keydown"&&t.keyCode===229&&(C="onCompositionStart");C&&(Uk&&t.locale!=="ko"&&($f||C!=="onCompositionStart"?C==="onCompositionEnd"&&$f&&(L=zk()):(gd=u,gS="value"in gd?gd.value:gd.textContent,$f=!0)),A=qv(d,C),0<A.length&&(C=new kA(C,s,null,t,u),h.push({event:C,listeners:A}),L?C.data=L:(L=Hk(t),L!==null&&(C.data=L)))),(L=d8?u8(s,t):h8(s,t))&&(d=qv(d,"onBeforeInput"),0<d.length&&(u=new kA("onBeforeInput","beforeinput",null,t,u),h.push({event:u,listeners:d}),u.data=L))}s6(h,e)})}function bg(s,e,t){return{instance:s,listener:e,currentTarget:t}}function qv(s,e){for(var t=e+"Capture",r=[];s!==null;){var n=s,i=n.stateNode;n.tag===5&&i!==null&&(n=i,i=ug(s,t),i!=null&&r.unshift(bg(s,i,n)),i=ug(s,e),i!=null&&r.push(bg(s,i,n))),s=s.return}return r}function xf(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function BA(s,e,t,r,n){for(var i=e._reactName,o=[];t!==null&&t!==r;){var l=t,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,n?(c=ug(t,i),c!=null&&o.unshift(bg(t,c,l))):n||(c=ug(t,i),c!=null&&o.push(bg(t,c,l)))),t=t.return}o.length!==0&&s.push({event:e,listeners:o})}var A8=/\r\n?/g,k8=/\u0000|\uFFFD/g;function $A(s){return(typeof s=="string"?s:""+s).replace(A8,`
`).replace(k8,"")}function gy(s,e,t){if(e=$A(e),$A(s)!==e&&t)throw Error(_t(425))}function Hv(){}var D5=null,M5=null;function F5(s,e){return s==="textarea"||s==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var O5=typeof setTimeout=="function"?setTimeout:void 0,C8=typeof clearTimeout=="function"?clearTimeout:void 0,zA=typeof Promise=="function"?Promise:void 0,E8=typeof queueMicrotask=="function"?queueMicrotask:typeof zA<"u"?function(s){return zA.resolve(null).then(s).catch(L8)}:O5;function L8(s){setTimeout(function(){throw s})}function Aw(s,e){var t=e,r=0;do{var n=t.nextSibling;if(s.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(r===0){s.removeChild(n),mg(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=n}while(t);mg(e)}function Nd(s){for(;s!=null;s=s.nextSibling){var e=s.nodeType;if(e===1||e===3)break;if(e===8){if(e=s.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return s}function UA(s){s=s.previousSibling;for(var e=0;s;){if(s.nodeType===8){var t=s.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return s;e--}else t==="/$"&&e++}s=s.previousSibling}return null}var Sp=Math.random().toString(36).slice(2),Vo="__reactFiber$"+Sp,yg="__reactProps$"+Sp,ec="__reactContainer$"+Sp,B5="__reactEvents$"+Sp,P8="__reactListeners$"+Sp,T8="__reactHandles$"+Sp;function gu(s){var e=s[Vo];if(e)return e;for(var t=s.parentNode;t;){if(e=t[ec]||t[Vo]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(s=UA(s);s!==null;){if(t=s[Vo])return t;s=UA(s)}return e}s=t,t=s.parentNode}return null}function fb(s){return s=s[Vo]||s[ec],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function qf(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(_t(33))}function X1(s){return s[yg]||null}var $5=[],Hf=-1;function Bd(s){return{current:s}}function lr(s){0>Hf||(s.current=$5[Hf],$5[Hf]=null,Hf--)}function nr(s,e){Hf++,$5[Hf]=s.current,s.current=e}var Pd={},qn=Bd(Pd),ji=Bd(!1),Th=Pd;function mp(s,e){var t=s.type.contextTypes;if(!t)return Pd;var r=s.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var n={},i;for(i in t)n[i]=e[i];return r&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=e,s.__reactInternalMemoizedMaskedChildContext=n),n}function Ai(s){return s=s.childContextTypes,s!=null}function Wv(){lr(ji),lr(qn)}function qA(s,e,t){if(qn.current!==Pd)throw Error(_t(168));nr(qn,e),nr(ji,t)}function n6(s,e,t){var r=s.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var n in r)if(!(n in e))throw Error(_t(108,gI(s)||"Unknown",n));return yr({},t,r)}function Vv(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Pd,Th=qn.current,nr(qn,s),nr(ji,ji.current),!0}function HA(s,e,t){var r=s.stateNode;if(!r)throw Error(_t(169));t?(s=n6(s,e,Th),r.__reactInternalMemoizedMergedChildContext=s,lr(ji),lr(qn),nr(qn,s)):lr(ji),nr(ji,t)}var wl=null,J1=!1,kw=!1;function i6(s){wl===null?wl=[s]:wl.push(s)}function I8(s){J1=!0,i6(s)}function $d(){if(!kw&&wl!==null){kw=!0;var s=0,e=Vs;try{var t=wl;for(Vs=1;s<t.length;s++){var r=t[s];do r=r(!0);while(r!==null)}wl=null,J1=!1}catch(n){throw wl!==null&&(wl=wl.slice(s+1)),Lk(hS,$d),n}finally{Vs=e,kw=!1}}return null}var Wf=[],Vf=0,Gv=null,Yv=0,wa=[],Na=0,Ih=null,Yl=1,Kl="";function au(s,e){Wf[Vf++]=Yv,Wf[Vf++]=Gv,Gv=s,Yv=e}function a6(s,e,t){wa[Na++]=Yl,wa[Na++]=Kl,wa[Na++]=Ih,Ih=s;var r=Yl;s=Kl;var n=32-oo(r)-1;r&=~(1<<n),t+=1;var i=32-oo(e)+n;if(30<i){var o=n-n%5;i=(r&(1<<o)-1).toString(32),r>>=o,n-=o,Yl=1<<32-oo(e)+n|t<<n|r,Kl=i+s}else Yl=1<<i|t<<n|r,Kl=s}function wS(s){s.return!==null&&(au(s,1),a6(s,1,0))}function NS(s){for(;s===Gv;)Gv=Wf[--Vf],Wf[Vf]=null,Yv=Wf[--Vf],Wf[Vf]=null;for(;s===Ih;)Ih=wa[--Na],wa[Na]=null,Kl=wa[--Na],wa[Na]=null,Yl=wa[--Na],wa[Na]=null}var Zi=null,Ji=null,hr=!1,io=null;function o6(s,e){var t=ja(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=s,e=s.deletions,e===null?(s.deletions=[t],s.flags|=16):e.push(t)}function WA(s,e){switch(s.tag){case 5:var t=s.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(s.stateNode=e,Zi=s,Ji=Nd(e.firstChild),!0):!1;case 6:return e=s.pendingProps===""||e.nodeType!==3?null:e,e!==null?(s.stateNode=e,Zi=s,Ji=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Ih!==null?{id:Yl,overflow:Kl}:null,s.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ja(18,null,null,0),t.stateNode=e,t.return=s,s.child=t,Zi=s,Ji=null,!0):!1;default:return!1}}function z5(s){return(s.mode&1)!==0&&(s.flags&128)===0}function U5(s){if(hr){var e=Ji;if(e){var t=e;if(!WA(s,e)){if(z5(s))throw Error(_t(418));e=Nd(t.nextSibling);var r=Zi;e&&WA(s,e)?o6(r,t):(s.flags=s.flags&-4097|2,hr=!1,Zi=s)}}else{if(z5(s))throw Error(_t(418));s.flags=s.flags&-4097|2,hr=!1,Zi=s}}}function VA(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Zi=s}function xy(s){if(s!==Zi)return!1;if(!hr)return VA(s),hr=!0,!1;var e;if((e=s.tag!==3)&&!(e=s.tag!==5)&&(e=s.type,e=e!=="head"&&e!=="body"&&!F5(s.type,s.memoizedProps)),e&&(e=Ji)){if(z5(s))throw l6(),Error(_t(418));for(;e;)o6(s,e),e=Nd(e.nextSibling)}if(VA(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(_t(317));e:{for(s=s.nextSibling,e=0;s;){if(s.nodeType===8){var t=s.data;if(t==="/$"){if(e===0){Ji=Nd(s.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}s=s.nextSibling}Ji=null}}else Ji=Zi?Nd(s.stateNode.nextSibling):null;return!0}function l6(){for(var s=Ji;s;)s=Nd(s.nextSibling)}function pp(){Ji=Zi=null,hr=!1}function _S(s){io===null?io=[s]:io.push(s)}var R8=oc.ReactCurrentBatchConfig;function l0(s,e,t){if(s=t.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(_t(309));var r=t.stateNode}if(!r)throw Error(_t(147,s));var n=r,i=""+s;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=n.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof s!="string")throw Error(_t(284));if(!t._owner)throw Error(_t(290,s))}return s}function by(s,e){throw s=Object.prototype.toString.call(e),Error(_t(31,s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s))}function GA(s){var e=s._init;return e(s._payload)}function c6(s){function e(b,v){if(s){var N=b.deletions;N===null?(b.deletions=[v],b.flags|=16):N.push(v)}}function t(b,v){if(!s)return null;for(;v!==null;)e(b,v),v=v.sibling;return null}function r(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function n(b,v){return b=Ad(b,v),b.index=0,b.sibling=null,b}function i(b,v,N){return b.index=N,s?(N=b.alternate,N!==null?(N=N.index,N<v?(b.flags|=2,v):N):(b.flags|=2,v)):(b.flags|=1048576,v)}function o(b){return s&&b.alternate===null&&(b.flags|=2),b}function l(b,v,N,j){return v===null||v.tag!==6?(v=Rw(N,b.mode,j),v.return=b,v):(v=n(v,N),v.return=b,v)}function c(b,v,N,j){var E=N.type;return E===Bf?u(b,v,N.props.children,j,N.key):v!==null&&(v.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ec&&GA(E)===v.type)?(j=n(v,N.props),j.ref=l0(b,v,N),j.return=b,j):(j=Qy(N.type,N.key,N.props,null,b.mode,j),j.ref=l0(b,v,N),j.return=b,j)}function d(b,v,N,j){return v===null||v.tag!==4||v.stateNode.containerInfo!==N.containerInfo||v.stateNode.implementation!==N.implementation?(v=Dw(N,b.mode,j),v.return=b,v):(v=n(v,N.children||[]),v.return=b,v)}function u(b,v,N,j,E){return v===null||v.tag!==7?(v=kh(N,b.mode,j,E),v.return=b,v):(v=n(v,N),v.return=b,v)}function h(b,v,N){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Rw(""+v,b.mode,N),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case oy:return N=Qy(v.type,v.key,v.props,null,b.mode,N),N.ref=l0(b,null,v),N.return=b,N;case Of:return v=Dw(v,b.mode,N),v.return=b,v;case Ec:var j=v._init;return h(b,j(v._payload),N)}if(N0(v)||r0(v))return v=kh(v,b.mode,N,null),v.return=b,v;by(b,v)}return null}function m(b,v,N,j){var E=v!==null?v.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return E!==null?null:l(b,v,""+N,j);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case oy:return N.key===E?c(b,v,N,j):null;case Of:return N.key===E?d(b,v,N,j):null;case Ec:return E=N._init,m(b,v,E(N._payload),j)}if(N0(N)||r0(N))return E!==null?null:u(b,v,N,j,null);by(b,N)}return null}function p(b,v,N,j,E){if(typeof j=="string"&&j!==""||typeof j=="number")return b=b.get(N)||null,l(v,b,""+j,E);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case oy:return b=b.get(j.key===null?N:j.key)||null,c(v,b,j,E);case Of:return b=b.get(j.key===null?N:j.key)||null,d(v,b,j,E);case Ec:var A=j._init;return p(b,v,N,A(j._payload),E)}if(N0(j)||r0(j))return b=b.get(N)||null,u(v,b,j,E,null);by(v,j)}return null}function x(b,v,N,j){for(var E=null,A=null,L=v,C=v=0,B=null;L!==null&&C<N.length;C++){L.index>C?(B=L,L=null):B=L.sibling;var U=m(b,L,N[C],j);if(U===null){L===null&&(L=B);break}s&&L&&U.alternate===null&&e(b,L),v=i(U,v,C),A===null?E=U:A.sibling=U,A=U,L=B}if(C===N.length)return t(b,L),hr&&au(b,C),E;if(L===null){for(;C<N.length;C++)L=h(b,N[C],j),L!==null&&(v=i(L,v,C),A===null?E=L:A.sibling=L,A=L);return hr&&au(b,C),E}for(L=r(b,L);C<N.length;C++)B=p(L,b,C,N[C],j),B!==null&&(s&&B.alternate!==null&&L.delete(B.key===null?C:B.key),v=i(B,v,C),A===null?E=B:A.sibling=B,A=B);return s&&L.forEach(function(P){return e(b,P)}),hr&&au(b,C),E}function w(b,v,N,j){var E=r0(N);if(typeof E!="function")throw Error(_t(150));if(N=E.call(N),N==null)throw Error(_t(151));for(var A=E=null,L=v,C=v=0,B=null,U=N.next();L!==null&&!U.done;C++,U=N.next()){L.index>C?(B=L,L=null):B=L.sibling;var P=m(b,L,U.value,j);if(P===null){L===null&&(L=B);break}s&&L&&P.alternate===null&&e(b,L),v=i(P,v,C),A===null?E=P:A.sibling=P,A=P,L=B}if(U.done)return t(b,L),hr&&au(b,C),E;if(L===null){for(;!U.done;C++,U=N.next())U=h(b,U.value,j),U!==null&&(v=i(U,v,C),A===null?E=U:A.sibling=U,A=U);return hr&&au(b,C),E}for(L=r(b,L);!U.done;C++,U=N.next())U=p(L,b,C,U.value,j),U!==null&&(s&&U.alternate!==null&&L.delete(U.key===null?C:U.key),v=i(U,v,C),A===null?E=U:A.sibling=U,A=U);return s&&L.forEach(function(T){return e(b,T)}),hr&&au(b,C),E}function S(b,v,N,j){if(typeof N=="object"&&N!==null&&N.type===Bf&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case oy:e:{for(var E=N.key,A=v;A!==null;){if(A.key===E){if(E=N.type,E===Bf){if(A.tag===7){t(b,A.sibling),v=n(A,N.props.children),v.return=b,b=v;break e}}else if(A.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ec&&GA(E)===A.type){t(b,A.sibling),v=n(A,N.props),v.ref=l0(b,A,N),v.return=b,b=v;break e}t(b,A);break}else e(b,A);A=A.sibling}N.type===Bf?(v=kh(N.props.children,b.mode,j,N.key),v.return=b,b=v):(j=Qy(N.type,N.key,N.props,null,b.mode,j),j.ref=l0(b,v,N),j.return=b,b=j)}return o(b);case Of:e:{for(A=N.key;v!==null;){if(v.key===A)if(v.tag===4&&v.stateNode.containerInfo===N.containerInfo&&v.stateNode.implementation===N.implementation){t(b,v.sibling),v=n(v,N.children||[]),v.return=b,b=v;break e}else{t(b,v);break}else e(b,v);v=v.sibling}v=Dw(N,b.mode,j),v.return=b,b=v}return o(b);case Ec:return A=N._init,S(b,v,A(N._payload),j)}if(N0(N))return x(b,v,N,j);if(r0(N))return w(b,v,N,j);by(b,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,v!==null&&v.tag===6?(t(b,v.sibling),v=n(v,N),v.return=b,b=v):(t(b,v),v=Rw(N,b.mode,j),v.return=b,b=v),o(b)):t(b,v)}return S}var gp=c6(!0),d6=c6(!1),Kv=Bd(null),Xv=null,Gf=null,SS=null;function jS(){SS=Gf=Xv=null}function AS(s){var e=Kv.current;lr(Kv),s._currentValue=e}function q5(s,e,t){for(;s!==null;){var r=s.alternate;if((s.childLanes&e)!==e?(s.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),s===t)break;s=s.return}}function sm(s,e){Xv=s,SS=Gf=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&e&&(Si=!0),s.firstContext=null)}function Ca(s){var e=s._currentValue;if(SS!==s)if(s={context:s,memoizedValue:e,next:null},Gf===null){if(Xv===null)throw Error(_t(308));Gf=s,Xv.dependencies={lanes:0,firstContext:s}}else Gf=Gf.next=s;return e}var xu=null;function kS(s){xu===null?xu=[s]:xu.push(s)}function u6(s,e,t,r){var n=e.interleaved;return n===null?(t.next=t,kS(e)):(t.next=n.next,n.next=t),e.interleaved=t,tc(s,r)}function tc(s,e){s.lanes|=e;var t=s.alternate;for(t!==null&&(t.lanes|=e),t=s,s=s.return;s!==null;)s.childLanes|=e,t=s.alternate,t!==null&&(t.childLanes|=e),t=s,s=s.return;return t.tag===3?t.stateNode:null}var Lc=!1;function CS(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function h6(s,e){s=s.updateQueue,e.updateQueue===s&&(e.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Xl(s,e){return{eventTime:s,lane:e,tag:0,payload:null,callback:null,next:null}}function _d(s,e,t){var r=s.updateQueue;if(r===null)return null;if(r=r.shared,Rs&2){var n=r.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e,tc(s,t)}return n=r.interleaved,n===null?(e.next=e,kS(r)):(e.next=n.next,n.next=e),r.interleaved=e,tc(s,t)}function Vy(s,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=s.pendingLanes,t|=r,e.lanes=t,fS(s,t)}}function YA(s,e){var t=s.updateQueue,r=s.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var n=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?n=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?n=i=e:i=i.next=e}else n=i=e;t={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:i,shared:r.shared,effects:r.effects},s.updateQueue=t;return}s=t.lastBaseUpdate,s===null?t.firstBaseUpdate=e:s.next=e,t.lastBaseUpdate=e}function Jv(s,e,t,r){var n=s.updateQueue;Lc=!1;var i=n.firstBaseUpdate,o=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=s.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var h=n.baseState;o=0,u=d=c=null,l=i;do{var m=l.lane,p=l.eventTime;if((r&m)===m){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=s,w=l;switch(m=e,p=t,w.tag){case 1:if(x=w.payload,typeof x=="function"){h=x.call(p,h,m);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,m=typeof x=="function"?x.call(p,h,m):x,m==null)break e;h=yr({},h,m);break e;case 2:Lc=!0}}l.callback!==null&&l.lane!==0&&(s.flags|=64,m=n.effects,m===null?n.effects=[l]:m.push(l))}else p={eventTime:p,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=p,c=h):u=u.next=p,o|=m;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;m=l,l=m.next,m.next=null,n.lastBaseUpdate=m,n.shared.pending=null}}while(!0);if(u===null&&(c=h),n.baseState=c,n.firstBaseUpdate=d,n.lastBaseUpdate=u,e=n.shared.interleaved,e!==null){n=e;do o|=n.lane,n=n.next;while(n!==e)}else i===null&&(n.shared.lanes=0);Dh|=o,s.lanes=o,s.memoizedState=h}}function KA(s,e,t){if(s=e.effects,e.effects=null,s!==null)for(e=0;e<s.length;e++){var r=s[e],n=r.callback;if(n!==null){if(r.callback=null,r=t,typeof n!="function")throw Error(_t(191,n));n.call(r)}}}var mb={},Ko=Bd(mb),vg=Bd(mb),wg=Bd(mb);function bu(s){if(s===mb)throw Error(_t(174));return s}function ES(s,e){switch(nr(wg,e),nr(vg,s),nr(Ko,mb),s=e.nodeType,s){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_5(null,"");break;default:s=s===8?e.parentNode:e,e=s.namespaceURI||null,s=s.tagName,e=_5(e,s)}lr(Ko),nr(Ko,e)}function xp(){lr(Ko),lr(vg),lr(wg)}function f6(s){bu(wg.current);var e=bu(Ko.current),t=_5(e,s.type);e!==t&&(nr(vg,s),nr(Ko,t))}function LS(s){vg.current===s&&(lr(Ko),lr(vg))}var gr=Bd(0);function Qv(s){for(var e=s;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Cw=[];function PS(){for(var s=0;s<Cw.length;s++)Cw[s]._workInProgressVersionPrimary=null;Cw.length=0}var Gy=oc.ReactCurrentDispatcher,Ew=oc.ReactCurrentBatchConfig,Rh=0,br=null,Xr=null,dn=null,Zv=!1,Y0=!1,Ng=0,D8=0;function jn(){throw Error(_t(321))}function TS(s,e){if(e===null)return!1;for(var t=0;t<e.length&&t<s.length;t++)if(!uo(s[t],e[t]))return!1;return!0}function IS(s,e,t,r,n,i){if(Rh=i,br=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Gy.current=s===null||s.memoizedState===null?B8:$8,s=t(r,n),Y0){i=0;do{if(Y0=!1,Ng=0,25<=i)throw Error(_t(301));i+=1,dn=Xr=null,e.updateQueue=null,Gy.current=z8,s=t(r,n)}while(Y0)}if(Gy.current=e1,e=Xr!==null&&Xr.next!==null,Rh=0,dn=Xr=br=null,Zv=!1,e)throw Error(_t(300));return s}function RS(){var s=Ng!==0;return Ng=0,s}function Ao(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?br.memoizedState=dn=s:dn=dn.next=s,dn}function Ea(){if(Xr===null){var s=br.alternate;s=s!==null?s.memoizedState:null}else s=Xr.next;var e=dn===null?br.memoizedState:dn.next;if(e!==null)dn=e,Xr=s;else{if(s===null)throw Error(_t(310));Xr=s,s={memoizedState:Xr.memoizedState,baseState:Xr.baseState,baseQueue:Xr.baseQueue,queue:Xr.queue,next:null},dn===null?br.memoizedState=dn=s:dn=dn.next=s}return dn}function _g(s,e){return typeof e=="function"?e(s):e}function Lw(s){var e=Ea(),t=e.queue;if(t===null)throw Error(_t(311));t.lastRenderedReducer=s;var r=Xr,n=r.baseQueue,i=t.pending;if(i!==null){if(n!==null){var o=n.next;n.next=i.next,i.next=o}r.baseQueue=n=i,t.pending=null}if(n!==null){i=n.next,r=r.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((Rh&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:s(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,br.lanes|=u,Dh|=u}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,uo(r,e.memoizedState)||(Si=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,t.lastRenderedState=r}if(s=t.interleaved,s!==null){n=s;do i=n.lane,br.lanes|=i,Dh|=i,n=n.next;while(n!==s)}else n===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Pw(s){var e=Ea(),t=e.queue;if(t===null)throw Error(_t(311));t.lastRenderedReducer=s;var r=t.dispatch,n=t.pending,i=e.memoizedState;if(n!==null){t.pending=null;var o=n=n.next;do i=s(i,o.action),o=o.next;while(o!==n);uo(i,e.memoizedState)||(Si=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function m6(){}function p6(s,e){var t=br,r=Ea(),n=e(),i=!uo(r.memoizedState,n);if(i&&(r.memoizedState=n,Si=!0),r=r.queue,DS(b6.bind(null,t,r,s),[s]),r.getSnapshot!==e||i||dn!==null&&dn.memoizedState.tag&1){if(t.flags|=2048,Sg(9,x6.bind(null,t,r,n,e),void 0,null),un===null)throw Error(_t(349));Rh&30||g6(t,e,n)}return n}function g6(s,e,t){s.flags|=16384,s={getSnapshot:e,value:t},e=br.updateQueue,e===null?(e={lastEffect:null,stores:null},br.updateQueue=e,e.stores=[s]):(t=e.stores,t===null?e.stores=[s]:t.push(s))}function x6(s,e,t,r){e.value=t,e.getSnapshot=r,y6(e)&&v6(s)}function b6(s,e,t){return t(function(){y6(e)&&v6(s)})}function y6(s){var e=s.getSnapshot;s=s.value;try{var t=e();return!uo(s,t)}catch{return!0}}function v6(s){var e=tc(s,1);e!==null&&lo(e,s,1,-1)}function XA(s){var e=Ao();return typeof s=="function"&&(s=s()),e.memoizedState=e.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_g,lastRenderedState:s},e.queue=s,s=s.dispatch=O8.bind(null,br,s),[e.memoizedState,s]}function Sg(s,e,t,r){return s={tag:s,create:e,destroy:t,deps:r,next:null},e=br.updateQueue,e===null?(e={lastEffect:null,stores:null},br.updateQueue=e,e.lastEffect=s.next=s):(t=e.lastEffect,t===null?e.lastEffect=s.next=s:(r=t.next,t.next=s,s.next=r,e.lastEffect=s)),s}function w6(){return Ea().memoizedState}function Yy(s,e,t,r){var n=Ao();br.flags|=s,n.memoizedState=Sg(1|e,t,void 0,r===void 0?null:r)}function Q1(s,e,t,r){var n=Ea();r=r===void 0?null:r;var i=void 0;if(Xr!==null){var o=Xr.memoizedState;if(i=o.destroy,r!==null&&TS(r,o.deps)){n.memoizedState=Sg(e,t,i,r);return}}br.flags|=s,n.memoizedState=Sg(1|e,t,i,r)}function JA(s,e){return Yy(8390656,8,s,e)}function DS(s,e){return Q1(2048,8,s,e)}function N6(s,e){return Q1(4,2,s,e)}function _6(s,e){return Q1(4,4,s,e)}function S6(s,e){if(typeof e=="function")return s=s(),e(s),function(){e(null)};if(e!=null)return s=s(),e.current=s,function(){e.current=null}}function j6(s,e,t){return t=t!=null?t.concat([s]):null,Q1(4,4,S6.bind(null,e,s),t)}function MS(){}function A6(s,e){var t=Ea();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&TS(e,r[1])?r[0]:(t.memoizedState=[s,e],s)}function k6(s,e){var t=Ea();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&TS(e,r[1])?r[0]:(s=s(),t.memoizedState=[s,e],s)}function C6(s,e,t){return Rh&21?(uo(t,e)||(t=Ik(),br.lanes|=t,Dh|=t,s.baseState=!0),e):(s.baseState&&(s.baseState=!1,Si=!0),s.memoizedState=t)}function M8(s,e){var t=Vs;Vs=t!==0&&4>t?t:4,s(!0);var r=Ew.transition;Ew.transition={};try{s(!1),e()}finally{Vs=t,Ew.transition=r}}function E6(){return Ea().memoizedState}function F8(s,e,t){var r=jd(s);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},L6(s))P6(e,t);else if(t=u6(s,e,t,r),t!==null){var n=ri();lo(t,s,r,n),T6(t,e,r)}}function O8(s,e,t){var r=jd(s),n={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(L6(s))P6(e,n);else{var i=s.alternate;if(s.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,t);if(n.hasEagerState=!0,n.eagerState=l,uo(l,o)){var c=e.interleaved;c===null?(n.next=n,kS(e)):(n.next=c.next,c.next=n),e.interleaved=n;return}}catch{}finally{}t=u6(s,e,n,r),t!==null&&(n=ri(),lo(t,s,r,n),T6(t,e,r))}}function L6(s){var e=s.alternate;return s===br||e!==null&&e===br}function P6(s,e){Y0=Zv=!0;var t=s.pending;t===null?e.next=e:(e.next=t.next,t.next=e),s.pending=e}function T6(s,e,t){if(t&4194240){var r=e.lanes;r&=s.pendingLanes,t|=r,e.lanes=t,fS(s,t)}}var e1={readContext:Ca,useCallback:jn,useContext:jn,useEffect:jn,useImperativeHandle:jn,useInsertionEffect:jn,useLayoutEffect:jn,useMemo:jn,useReducer:jn,useRef:jn,useState:jn,useDebugValue:jn,useDeferredValue:jn,useTransition:jn,useMutableSource:jn,useSyncExternalStore:jn,useId:jn,unstable_isNewReconciler:!1},B8={readContext:Ca,useCallback:function(s,e){return Ao().memoizedState=[s,e===void 0?null:e],s},useContext:Ca,useEffect:JA,useImperativeHandle:function(s,e,t){return t=t!=null?t.concat([s]):null,Yy(4194308,4,S6.bind(null,e,s),t)},useLayoutEffect:function(s,e){return Yy(4194308,4,s,e)},useInsertionEffect:function(s,e){return Yy(4,2,s,e)},useMemo:function(s,e){var t=Ao();return e=e===void 0?null:e,s=s(),t.memoizedState=[s,e],s},useReducer:function(s,e,t){var r=Ao();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:e},r.queue=s,s=s.dispatch=F8.bind(null,br,s),[r.memoizedState,s]},useRef:function(s){var e=Ao();return s={current:s},e.memoizedState=s},useState:XA,useDebugValue:MS,useDeferredValue:function(s){return Ao().memoizedState=s},useTransition:function(){var s=XA(!1),e=s[0];return s=M8.bind(null,s[1]),Ao().memoizedState=s,[e,s]},useMutableSource:function(){},useSyncExternalStore:function(s,e,t){var r=br,n=Ao();if(hr){if(t===void 0)throw Error(_t(407));t=t()}else{if(t=e(),un===null)throw Error(_t(349));Rh&30||g6(r,e,t)}n.memoizedState=t;var i={value:t,getSnapshot:e};return n.queue=i,JA(b6.bind(null,r,i,s),[s]),r.flags|=2048,Sg(9,x6.bind(null,r,i,t,e),void 0,null),t},useId:function(){var s=Ao(),e=un.identifierPrefix;if(hr){var t=Kl,r=Yl;t=(r&~(1<<32-oo(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Ng++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=D8++,e=":"+e+"r"+t.toString(32)+":";return s.memoizedState=e},unstable_isNewReconciler:!1},$8={readContext:Ca,useCallback:A6,useContext:Ca,useEffect:DS,useImperativeHandle:j6,useInsertionEffect:N6,useLayoutEffect:_6,useMemo:k6,useReducer:Lw,useRef:w6,useState:function(){return Lw(_g)},useDebugValue:MS,useDeferredValue:function(s){var e=Ea();return C6(e,Xr.memoizedState,s)},useTransition:function(){var s=Lw(_g)[0],e=Ea().memoizedState;return[s,e]},useMutableSource:m6,useSyncExternalStore:p6,useId:E6,unstable_isNewReconciler:!1},z8={readContext:Ca,useCallback:A6,useContext:Ca,useEffect:DS,useImperativeHandle:j6,useInsertionEffect:N6,useLayoutEffect:_6,useMemo:k6,useReducer:Pw,useRef:w6,useState:function(){return Pw(_g)},useDebugValue:MS,useDeferredValue:function(s){var e=Ea();return Xr===null?e.memoizedState=s:C6(e,Xr.memoizedState,s)},useTransition:function(){var s=Pw(_g)[0],e=Ea().memoizedState;return[s,e]},useMutableSource:m6,useSyncExternalStore:p6,useId:E6,unstable_isNewReconciler:!1};function Ua(s,e){if(s&&s.defaultProps){e=yr({},e),s=s.defaultProps;for(var t in s)e[t]===void 0&&(e[t]=s[t]);return e}return e}function H5(s,e,t,r){e=s.memoizedState,t=t(r,e),t=t==null?e:yr({},e,t),s.memoizedState=t,s.lanes===0&&(s.updateQueue.baseState=t)}var Z1={isMounted:function(s){return(s=s._reactInternals)?qh(s)===s:!1},enqueueSetState:function(s,e,t){s=s._reactInternals;var r=ri(),n=jd(s),i=Xl(r,n);i.payload=e,t!=null&&(i.callback=t),e=_d(s,i,n),e!==null&&(lo(e,s,n,r),Vy(e,s,n))},enqueueReplaceState:function(s,e,t){s=s._reactInternals;var r=ri(),n=jd(s),i=Xl(r,n);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=_d(s,i,n),e!==null&&(lo(e,s,n,r),Vy(e,s,n))},enqueueForceUpdate:function(s,e){s=s._reactInternals;var t=ri(),r=jd(s),n=Xl(t,r);n.tag=2,e!=null&&(n.callback=e),e=_d(s,n,r),e!==null&&(lo(e,s,r,t),Vy(e,s,r))}};function QA(s,e,t,r,n,i,o){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!gg(t,r)||!gg(n,i):!0}function I6(s,e,t){var r=!1,n=Pd,i=e.contextType;return typeof i=="object"&&i!==null?i=Ca(i):(n=Ai(e)?Th:qn.current,r=e.contextTypes,i=(r=r!=null)?mp(s,n):Pd),e=new e(t,i),s.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Z1,s.stateNode=e,e._reactInternals=s,r&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=n,s.__reactInternalMemoizedMaskedChildContext=i),e}function ZA(s,e,t,r){s=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==s&&Z1.enqueueReplaceState(e,e.state,null)}function W5(s,e,t,r){var n=s.stateNode;n.props=t,n.state=s.memoizedState,n.refs={},CS(s);var i=e.contextType;typeof i=="object"&&i!==null?n.context=Ca(i):(i=Ai(e)?Th:qn.current,n.context=mp(s,i)),n.state=s.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(H5(s,e,i,t),n.state=s.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&Z1.enqueueReplaceState(n,n.state,null),Jv(s,t,n,r),n.state=s.memoizedState),typeof n.componentDidMount=="function"&&(s.flags|=4194308)}function bp(s,e){try{var t="",r=e;do t+=pI(r),r=r.return;while(r);var n=t}catch(i){n=`
Error generating stack: `+i.message+`
`+i.stack}return{value:s,source:e,stack:n,digest:null}}function Tw(s,e,t){return{value:s,source:null,stack:t??null,digest:e??null}}function V5(s,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var U8=typeof WeakMap=="function"?WeakMap:Map;function R6(s,e,t){t=Xl(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){s1||(s1=!0,sN=r),V5(s,e)},t}function D6(s,e,t){t=Xl(-1,t),t.tag=3;var r=s.type.getDerivedStateFromError;if(typeof r=="function"){var n=e.value;t.payload=function(){return r(n)},t.callback=function(){V5(s,e)}}var i=s.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){V5(s,e),typeof r!="function"&&(Sd===null?Sd=new Set([this]):Sd.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function e4(s,e,t){var r=s.pingCache;if(r===null){r=s.pingCache=new U8;var n=new Set;r.set(e,n)}else n=r.get(e),n===void 0&&(n=new Set,r.set(e,n));n.has(t)||(n.add(t),s=sR.bind(null,s,e,t),e.then(s,s))}function t4(s){do{var e;if((e=s.tag===13)&&(e=s.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return s;s=s.return}while(s!==null);return null}function s4(s,e,t,r,n){return s.mode&1?(s.flags|=65536,s.lanes=n,s):(s===e?s.flags|=65536:(s.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Xl(-1,1),e.tag=2,_d(t,e,1))),t.lanes|=1),s)}var q8=oc.ReactCurrentOwner,Si=!1;function ti(s,e,t,r){e.child=s===null?d6(e,null,t,r):gp(e,s.child,t,r)}function r4(s,e,t,r,n){t=t.render;var i=e.ref;return sm(e,n),r=IS(s,e,t,r,i,n),t=RS(),s!==null&&!Si?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~n,sc(s,e,n)):(hr&&t&&wS(e),e.flags|=1,ti(s,e,r,n),e.child)}function n4(s,e,t,r,n){if(s===null){var i=t.type;return typeof i=="function"&&!HS(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,M6(s,e,i,r,n)):(s=Qy(t.type,null,r,e,e.mode,n),s.ref=e.ref,s.return=e,e.child=s)}if(i=s.child,!(s.lanes&n)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:gg,t(o,r)&&s.ref===e.ref)return sc(s,e,n)}return e.flags|=1,s=Ad(i,r),s.ref=e.ref,s.return=e,e.child=s}function M6(s,e,t,r,n){if(s!==null){var i=s.memoizedProps;if(gg(i,r)&&s.ref===e.ref)if(Si=!1,e.pendingProps=r=i,(s.lanes&n)!==0)s.flags&131072&&(Si=!0);else return e.lanes=s.lanes,sc(s,e,n)}return G5(s,e,t,r,n)}function F6(s,e,t){var r=e.pendingProps,n=r.children,i=s!==null?s.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},nr(Kf,Gi),Gi|=t;else{if(!(t&1073741824))return s=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:s,cachePool:null,transitions:null},e.updateQueue=null,nr(Kf,Gi),Gi|=s,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,nr(Kf,Gi),Gi|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,nr(Kf,Gi),Gi|=r;return ti(s,e,n,t),e.child}function O6(s,e){var t=e.ref;(s===null&&t!==null||s!==null&&s.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function G5(s,e,t,r,n){var i=Ai(t)?Th:qn.current;return i=mp(e,i),sm(e,n),t=IS(s,e,t,r,i,n),r=RS(),s!==null&&!Si?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~n,sc(s,e,n)):(hr&&r&&wS(e),e.flags|=1,ti(s,e,t,n),e.child)}function i4(s,e,t,r,n){if(Ai(t)){var i=!0;Vv(e)}else i=!1;if(sm(e,n),e.stateNode===null)Ky(s,e),I6(e,t,r),W5(e,t,r,n),r=!0;else if(s===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=t.contextType;typeof d=="object"&&d!==null?d=Ca(d):(d=Ai(t)?Th:qn.current,d=mp(e,d));var u=t.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&ZA(e,o,r,d),Lc=!1;var m=e.memoizedState;o.state=m,Jv(e,r,o,n),c=e.memoizedState,l!==r||m!==c||ji.current||Lc?(typeof u=="function"&&(H5(e,t,u,r),c=e.memoizedState),(l=Lc||QA(e,t,l,r,m,c,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,h6(s,e),l=e.memoizedProps,d=e.type===e.elementType?l:Ua(e.type,l),o.props=d,h=e.pendingProps,m=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=Ca(c):(c=Ai(t)?Th:qn.current,c=mp(e,c));var p=t.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||m!==c)&&ZA(e,o,r,c),Lc=!1,m=e.memoizedState,o.state=m,Jv(e,r,o,n);var x=e.memoizedState;l!==h||m!==x||ji.current||Lc?(typeof p=="function"&&(H5(e,t,p,r),x=e.memoizedState),(d=Lc||QA(e,t,d,r,m,x,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===s.memoizedProps&&m===s.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===s.memoizedProps&&m===s.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===s.memoizedProps&&m===s.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===s.memoizedProps&&m===s.memoizedState||(e.flags|=1024),r=!1)}return Y5(s,e,t,r,i,n)}function Y5(s,e,t,r,n,i){O6(s,e);var o=(e.flags&128)!==0;if(!r&&!o)return n&&HA(e,t,!1),sc(s,e,i);r=e.stateNode,q8.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,s!==null&&o?(e.child=gp(e,s.child,null,i),e.child=gp(e,null,l,i)):ti(s,e,l,i),e.memoizedState=r.state,n&&HA(e,t,!0),e.child}function B6(s){var e=s.stateNode;e.pendingContext?qA(s,e.pendingContext,e.pendingContext!==e.context):e.context&&qA(s,e.context,!1),ES(s,e.containerInfo)}function a4(s,e,t,r,n){return pp(),_S(n),e.flags|=256,ti(s,e,t,r),e.child}var K5={dehydrated:null,treeContext:null,retryLane:0};function X5(s){return{baseLanes:s,cachePool:null,transitions:null}}function $6(s,e,t){var r=e.pendingProps,n=gr.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=s!==null&&s.memoizedState===null?!1:(n&2)!==0),l?(i=!0,e.flags&=-129):(s===null||s.memoizedState!==null)&&(n|=1),nr(gr,n&1),s===null)return U5(e),s=e.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(e.mode&1?s.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,s=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=s2(o,r,0,null),s=kh(s,r,t,null),i.return=e,s.return=e,i.sibling=s,e.child=i,e.child.memoizedState=X5(t),e.memoizedState=K5,s):FS(e,o));if(n=s.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return H8(s,e,o,r,l,n,t);if(i){i=r.fallback,o=e.mode,n=s.child,l=n.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==n?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ad(n,c),r.subtreeFlags=n.subtreeFlags&14680064),l!==null?i=Ad(l,i):(i=kh(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=s.child.memoizedState,o=o===null?X5(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=s.childLanes&~t,e.memoizedState=K5,r}return i=s.child,s=i.sibling,r=Ad(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,s!==null&&(t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)),e.child=r,e.memoizedState=null,r}function FS(s,e){return e=s2({mode:"visible",children:e},s.mode,0,null),e.return=s,s.child=e}function yy(s,e,t,r){return r!==null&&_S(r),gp(e,s.child,null,t),s=FS(e,e.pendingProps.children),s.flags|=2,e.memoizedState=null,s}function H8(s,e,t,r,n,i,o){if(t)return e.flags&256?(e.flags&=-257,r=Tw(Error(_t(422))),yy(s,e,o,r)):e.memoizedState!==null?(e.child=s.child,e.flags|=128,null):(i=r.fallback,n=e.mode,r=s2({mode:"visible",children:r.children},n,0,null),i=kh(i,n,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&gp(e,s.child,null,o),e.child.memoizedState=X5(o),e.memoizedState=K5,i);if(!(e.mode&1))return yy(s,e,o,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(_t(419)),r=Tw(i,r,void 0),yy(s,e,o,r)}if(l=(o&s.childLanes)!==0,Si||l){if(r=un,r!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|o)?0:n,n!==0&&n!==i.retryLane&&(i.retryLane=n,tc(s,n),lo(r,s,n,-1))}return qS(),r=Tw(Error(_t(421))),yy(s,e,o,r)}return n.data==="$?"?(e.flags|=128,e.child=s.child,e=rR.bind(null,s),n._reactRetry=e,null):(s=i.treeContext,Ji=Nd(n.nextSibling),Zi=e,hr=!0,io=null,s!==null&&(wa[Na++]=Yl,wa[Na++]=Kl,wa[Na++]=Ih,Yl=s.id,Kl=s.overflow,Ih=e),e=FS(e,r.children),e.flags|=4096,e)}function o4(s,e,t){s.lanes|=e;var r=s.alternate;r!==null&&(r.lanes|=e),q5(s.return,e,t)}function Iw(s,e,t,r,n){var i=s.memoizedState;i===null?s.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:n}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=n)}function z6(s,e,t){var r=e.pendingProps,n=r.revealOrder,i=r.tail;if(ti(s,e,r.children,t),r=gr.current,r&2)r=r&1|2,e.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=e.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&o4(s,t,e);else if(s.tag===19)o4(s,t,e);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}r&=1}if(nr(gr,r),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;t!==null;)s=t.alternate,s!==null&&Qv(s)===null&&(n=t),t=t.sibling;t=n,t===null?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),Iw(e,!1,n,t,i);break;case"backwards":for(t=null,n=e.child,e.child=null;n!==null;){if(s=n.alternate,s!==null&&Qv(s)===null){e.child=n;break}s=n.sibling,n.sibling=t,t=n,n=s}Iw(e,!0,t,null,i);break;case"together":Iw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ky(s,e){!(e.mode&1)&&s!==null&&(s.alternate=null,e.alternate=null,e.flags|=2)}function sc(s,e,t){if(s!==null&&(e.dependencies=s.dependencies),Dh|=e.lanes,!(t&e.childLanes))return null;if(s!==null&&e.child!==s.child)throw Error(_t(153));if(e.child!==null){for(s=e.child,t=Ad(s,s.pendingProps),e.child=t,t.return=e;s.sibling!==null;)s=s.sibling,t=t.sibling=Ad(s,s.pendingProps),t.return=e;t.sibling=null}return e.child}function W8(s,e,t){switch(e.tag){case 3:B6(e),pp();break;case 5:f6(e);break;case 1:Ai(e.type)&&Vv(e);break;case 4:ES(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,n=e.memoizedProps.value;nr(Kv,r._currentValue),r._currentValue=n;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(nr(gr,gr.current&1),e.flags|=128,null):t&e.child.childLanes?$6(s,e,t):(nr(gr,gr.current&1),s=sc(s,e,t),s!==null?s.sibling:null);nr(gr,gr.current&1);break;case 19:if(r=(t&e.childLanes)!==0,s.flags&128){if(r)return z6(s,e,t);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),nr(gr,gr.current),r)break;return null;case 22:case 23:return e.lanes=0,F6(s,e,t)}return sc(s,e,t)}var U6,J5,q6,H6;U6=function(s,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)s.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};J5=function(){};q6=function(s,e,t,r){var n=s.memoizedProps;if(n!==r){s=e.stateNode,bu(Ko.current);var i=null;switch(t){case"input":n=y5(s,n),r=y5(s,r),i=[];break;case"select":n=yr({},n,{value:void 0}),r=yr({},r,{value:void 0}),i=[];break;case"textarea":n=N5(s,n),r=N5(s,r),i=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(s.onclick=Hv)}S5(t,r);var o;t=null;for(d in n)if(!r.hasOwnProperty(d)&&n.hasOwnProperty(d)&&n[d]!=null)if(d==="style"){var l=n[d];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(cg.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=n!=null?n[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(i||(i=[]),i.push(d,t)),t=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(cg.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ir("scroll",s),i||l===c||(i=[])):(i=i||[]).push(d,c))}t&&(i=i||[]).push("style",t);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};H6=function(s,e,t,r){t!==r&&(e.flags|=4)};function c0(s,e){if(!hr)switch(s.tailMode){case"hidden":e=s.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?s.tail=null:t.sibling=null;break;case"collapsed":t=s.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||s.tail===null?s.tail=null:s.tail.sibling=null:r.sibling=null}}function An(s){var e=s.alternate!==null&&s.alternate.child===s.child,t=0,r=0;if(e)for(var n=s.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=s,n=n.sibling;else for(n=s.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=s,n=n.sibling;return s.subtreeFlags|=r,s.childLanes=t,e}function V8(s,e,t){var r=e.pendingProps;switch(NS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(e),null;case 1:return Ai(e.type)&&Wv(),An(e),null;case 3:return r=e.stateNode,xp(),lr(ji),lr(qn),PS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(s===null||s.child===null)&&(xy(e)?e.flags|=4:s===null||s.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,io!==null&&(iN(io),io=null))),J5(s,e),An(e),null;case 5:LS(e);var n=bu(wg.current);if(t=e.type,s!==null&&e.stateNode!=null)q6(s,e,t,r,n),s.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(_t(166));return An(e),null}if(s=bu(Ko.current),xy(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Vo]=e,r[yg]=i,s=(e.mode&1)!==0,t){case"dialog":ir("cancel",r),ir("close",r);break;case"iframe":case"object":case"embed":ir("load",r);break;case"video":case"audio":for(n=0;n<S0.length;n++)ir(S0[n],r);break;case"source":ir("error",r);break;case"img":case"image":case"link":ir("error",r),ir("load",r);break;case"details":ir("toggle",r);break;case"input":gA(r,i),ir("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ir("invalid",r);break;case"textarea":bA(r,i),ir("invalid",r)}S5(t,i),n=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&gy(r.textContent,l,s),n=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&gy(r.textContent,l,s),n=["children",""+l]):cg.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ir("scroll",r)}switch(t){case"input":ly(r),xA(r,i,!0);break;case"textarea":ly(r),yA(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Hv)}r=n,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=bk(t)),s==="http://www.w3.org/1999/xhtml"?t==="script"?(s=o.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof r.is=="string"?s=o.createElement(t,{is:r.is}):(s=o.createElement(t),t==="select"&&(o=s,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):s=o.createElementNS(s,t),s[Vo]=e,s[yg]=r,U6(s,e,!1,!1),e.stateNode=s;e:{switch(o=j5(t,r),t){case"dialog":ir("cancel",s),ir("close",s),n=r;break;case"iframe":case"object":case"embed":ir("load",s),n=r;break;case"video":case"audio":for(n=0;n<S0.length;n++)ir(S0[n],s);n=r;break;case"source":ir("error",s),n=r;break;case"img":case"image":case"link":ir("error",s),ir("load",s),n=r;break;case"details":ir("toggle",s),n=r;break;case"input":gA(s,r),n=y5(s,r),ir("invalid",s);break;case"option":n=r;break;case"select":s._wrapperState={wasMultiple:!!r.multiple},n=yr({},r,{value:void 0}),ir("invalid",s);break;case"textarea":bA(s,r),n=N5(s,r),ir("invalid",s);break;default:n=r}S5(t,n),l=n;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?wk(s,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&yk(s,c)):i==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&dg(s,c):typeof c=="number"&&dg(s,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(cg.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ir("scroll",s):c!=null&&oS(s,i,c,o))}switch(t){case"input":ly(s),xA(s,r,!1);break;case"textarea":ly(s),yA(s);break;case"option":r.value!=null&&s.setAttribute("value",""+Ld(r.value));break;case"select":s.multiple=!!r.multiple,i=r.value,i!=null?Qf(s,!!r.multiple,i,!1):r.defaultValue!=null&&Qf(s,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(s.onclick=Hv)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return An(e),null;case 6:if(s&&e.stateNode!=null)H6(s,e,s.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(_t(166));if(t=bu(wg.current),bu(Ko.current),xy(e)){if(r=e.stateNode,t=e.memoizedProps,r[Vo]=e,(i=r.nodeValue!==t)&&(s=Zi,s!==null))switch(s.tag){case 3:gy(r.nodeValue,t,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&gy(r.nodeValue,t,(s.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Vo]=e,e.stateNode=r}return An(e),null;case 13:if(lr(gr),r=e.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(hr&&Ji!==null&&e.mode&1&&!(e.flags&128))l6(),pp(),e.flags|=98560,i=!1;else if(i=xy(e),r!==null&&r.dehydrated!==null){if(s===null){if(!i)throw Error(_t(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(_t(317));i[Vo]=e}else pp(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;An(e),i=!1}else io!==null&&(iN(io),io=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(s!==null&&s.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(s===null||gr.current&1?Qr===0&&(Qr=3):qS())),e.updateQueue!==null&&(e.flags|=4),An(e),null);case 4:return xp(),J5(s,e),s===null&&xg(e.stateNode.containerInfo),An(e),null;case 10:return AS(e.type._context),An(e),null;case 17:return Ai(e.type)&&Wv(),An(e),null;case 19:if(lr(gr),i=e.memoizedState,i===null)return An(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)c0(i,!1);else{if(Qr!==0||s!==null&&s.flags&128)for(s=e.child;s!==null;){if(o=Qv(s),o!==null){for(e.flags|=128,c0(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,s=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,s=o.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),t=t.sibling;return nr(gr,gr.current&1|2),e.child}s=s.sibling}i.tail!==null&&Er()>yp&&(e.flags|=128,r=!0,c0(i,!1),e.lanes=4194304)}else{if(!r)if(s=Qv(o),s!==null){if(e.flags|=128,r=!0,t=s.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),c0(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!hr)return An(e),null}else 2*Er()-i.renderingStartTime>yp&&t!==1073741824&&(e.flags|=128,r=!0,c0(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Er(),e.sibling=null,t=gr.current,nr(gr,r?t&1|2:t&1),e):(An(e),null);case 22:case 23:return US(),r=e.memoizedState!==null,s!==null&&s.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Gi&1073741824&&(An(e),e.subtreeFlags&6&&(e.flags|=8192)):An(e),null;case 24:return null;case 25:return null}throw Error(_t(156,e.tag))}function G8(s,e){switch(NS(e),e.tag){case 1:return Ai(e.type)&&Wv(),s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 3:return xp(),lr(ji),lr(qn),PS(),s=e.flags,s&65536&&!(s&128)?(e.flags=s&-65537|128,e):null;case 5:return LS(e),null;case 13:if(lr(gr),s=e.memoizedState,s!==null&&s.dehydrated!==null){if(e.alternate===null)throw Error(_t(340));pp()}return s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 19:return lr(gr),null;case 4:return xp(),null;case 10:return AS(e.type._context),null;case 22:case 23:return US(),null;case 24:return null;default:return null}}var vy=!1,$n=!1,Y8=typeof WeakSet=="function"?WeakSet:Set,Ht=null;function Yf(s,e){var t=s.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Sr(s,e,r)}else t.current=null}function Q5(s,e,t){try{t()}catch(r){Sr(s,e,r)}}var l4=!1;function K8(s,e){if(D5=zv,s=Kk(),vS(s)){if("selectionStart"in s)var t={start:s.selectionStart,end:s.selectionEnd};else e:{t=(t=s.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var n=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=s,m=null;t:for(;;){for(var p;h!==t||n!==0&&h.nodeType!==3||(l=o+n),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===s)break t;if(m===t&&++d===n&&(l=o),m===i&&++u===r&&(c=o),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(M5={focusedElem:s,selectionRange:t},zv=!1,Ht=e;Ht!==null;)if(e=Ht,s=e.child,(e.subtreeFlags&1028)!==0&&s!==null)s.return=e,Ht=s;else for(;Ht!==null;){e=Ht;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var w=x.memoizedProps,S=x.memoizedState,b=e.stateNode,v=b.getSnapshotBeforeUpdate(e.elementType===e.type?w:Ua(e.type,w),S);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_t(163))}}catch(j){Sr(e,e.return,j)}if(s=e.sibling,s!==null){s.return=e.return,Ht=s;break}Ht=e.return}return x=l4,l4=!1,x}function K0(s,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&s)===s){var i=n.destroy;n.destroy=void 0,i!==void 0&&Q5(e,t,i)}n=n.next}while(n!==r)}}function e2(s,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&s)===s){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Z5(s){var e=s.ref;if(e!==null){var t=s.stateNode;switch(s.tag){case 5:s=t;break;default:s=t}typeof e=="function"?e(s):e.current=s}}function W6(s){var e=s.alternate;e!==null&&(s.alternate=null,W6(e)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(e=s.stateNode,e!==null&&(delete e[Vo],delete e[yg],delete e[B5],delete e[P8],delete e[T8])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function V6(s){return s.tag===5||s.tag===3||s.tag===4}function c4(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||V6(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function eN(s,e,t){var r=s.tag;if(r===5||r===6)s=s.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(s,e):t.insertBefore(s,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(s,t)):(e=t,e.appendChild(s)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Hv));else if(r!==4&&(s=s.child,s!==null))for(eN(s,e,t),s=s.sibling;s!==null;)eN(s,e,t),s=s.sibling}function tN(s,e,t){var r=s.tag;if(r===5||r===6)s=s.stateNode,e?t.insertBefore(s,e):t.appendChild(s);else if(r!==4&&(s=s.child,s!==null))for(tN(s,e,t),s=s.sibling;s!==null;)tN(s,e,t),s=s.sibling}var yn=null,ro=!1;function _c(s,e,t){for(t=t.child;t!==null;)G6(s,e,t),t=t.sibling}function G6(s,e,t){if(Yo&&typeof Yo.onCommitFiberUnmount=="function")try{Yo.onCommitFiberUnmount(V1,t)}catch{}switch(t.tag){case 5:$n||Yf(t,e);case 6:var r=yn,n=ro;yn=null,_c(s,e,t),yn=r,ro=n,yn!==null&&(ro?(s=yn,t=t.stateNode,s.nodeType===8?s.parentNode.removeChild(t):s.removeChild(t)):yn.removeChild(t.stateNode));break;case 18:yn!==null&&(ro?(s=yn,t=t.stateNode,s.nodeType===8?Aw(s.parentNode,t):s.nodeType===1&&Aw(s,t),mg(s)):Aw(yn,t.stateNode));break;case 4:r=yn,n=ro,yn=t.stateNode.containerInfo,ro=!0,_c(s,e,t),yn=r,ro=n;break;case 0:case 11:case 14:case 15:if(!$n&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var i=n,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Q5(t,e,o),n=n.next}while(n!==r)}_c(s,e,t);break;case 1:if(!$n&&(Yf(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){Sr(t,e,l)}_c(s,e,t);break;case 21:_c(s,e,t);break;case 22:t.mode&1?($n=(r=$n)||t.memoizedState!==null,_c(s,e,t),$n=r):_c(s,e,t);break;default:_c(s,e,t)}}function d4(s){var e=s.updateQueue;if(e!==null){s.updateQueue=null;var t=s.stateNode;t===null&&(t=s.stateNode=new Y8),e.forEach(function(r){var n=nR.bind(null,s,r);t.has(r)||(t.add(r),r.then(n,n))})}}function Fa(s,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var n=t[r];try{var i=s,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:yn=l.stateNode,ro=!1;break e;case 3:yn=l.stateNode.containerInfo,ro=!0;break e;case 4:yn=l.stateNode.containerInfo,ro=!0;break e}l=l.return}if(yn===null)throw Error(_t(160));G6(i,o,n),yn=null,ro=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(d){Sr(n,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Y6(e,s),e=e.sibling}function Y6(s,e){var t=s.alternate,r=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Fa(e,s),wo(s),r&4){try{K0(3,s,s.return),e2(3,s)}catch(w){Sr(s,s.return,w)}try{K0(5,s,s.return)}catch(w){Sr(s,s.return,w)}}break;case 1:Fa(e,s),wo(s),r&512&&t!==null&&Yf(t,t.return);break;case 5:if(Fa(e,s),wo(s),r&512&&t!==null&&Yf(t,t.return),s.flags&32){var n=s.stateNode;try{dg(n,"")}catch(w){Sr(s,s.return,w)}}if(r&4&&(n=s.stateNode,n!=null)){var i=s.memoizedProps,o=t!==null?t.memoizedProps:i,l=s.type,c=s.updateQueue;if(s.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&gk(n,i),j5(l,o);var d=j5(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];u==="style"?wk(n,h):u==="dangerouslySetInnerHTML"?yk(n,h):u==="children"?dg(n,h):oS(n,u,h,d)}switch(l){case"input":v5(n,i);break;case"textarea":xk(n,i);break;case"select":var m=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Qf(n,!!i.multiple,p,!1):m!==!!i.multiple&&(i.defaultValue!=null?Qf(n,!!i.multiple,i.defaultValue,!0):Qf(n,!!i.multiple,i.multiple?[]:"",!1))}n[yg]=i}catch(w){Sr(s,s.return,w)}}break;case 6:if(Fa(e,s),wo(s),r&4){if(s.stateNode===null)throw Error(_t(162));n=s.stateNode,i=s.memoizedProps;try{n.nodeValue=i}catch(w){Sr(s,s.return,w)}}break;case 3:if(Fa(e,s),wo(s),r&4&&t!==null&&t.memoizedState.isDehydrated)try{mg(e.containerInfo)}catch(w){Sr(s,s.return,w)}break;case 4:Fa(e,s),wo(s);break;case 13:Fa(e,s),wo(s),n=s.child,n.flags&8192&&(i=n.memoizedState!==null,n.stateNode.isHidden=i,!i||n.alternate!==null&&n.alternate.memoizedState!==null||($S=Er())),r&4&&d4(s);break;case 22:if(u=t!==null&&t.memoizedState!==null,s.mode&1?($n=(d=$n)||u,Fa(e,s),$n=d):Fa(e,s),wo(s),r&8192){if(d=s.memoizedState!==null,(s.stateNode.isHidden=d)&&!u&&s.mode&1)for(Ht=s,u=s.child;u!==null;){for(h=Ht=u;Ht!==null;){switch(m=Ht,p=m.child,m.tag){case 0:case 11:case 14:case 15:K0(4,m,m.return);break;case 1:Yf(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){r=m,t=m.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(w){Sr(r,t,w)}}break;case 5:Yf(m,m.return);break;case 22:if(m.memoizedState!==null){h4(h);continue}}p!==null?(p.return=m,Ht=p):h4(h)}u=u.sibling}e:for(u=null,h=s;;){if(h.tag===5){if(u===null){u=h;try{n=h.stateNode,d?(i=n.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=vk("display",o))}catch(w){Sr(s,s.return,w)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(w){Sr(s,s.return,w)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===s)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===s)break e;for(;h.sibling===null;){if(h.return===null||h.return===s)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Fa(e,s),wo(s),r&4&&d4(s);break;case 21:break;default:Fa(e,s),wo(s)}}function wo(s){var e=s.flags;if(e&2){try{e:{for(var t=s.return;t!==null;){if(V6(t)){var r=t;break e}t=t.return}throw Error(_t(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(dg(n,""),r.flags&=-33);var i=c4(s);tN(s,i,n);break;case 3:case 4:var o=r.stateNode.containerInfo,l=c4(s);eN(s,l,o);break;default:throw Error(_t(161))}}catch(c){Sr(s,s.return,c)}s.flags&=-3}e&4096&&(s.flags&=-4097)}function X8(s,e,t){Ht=s,K6(s)}function K6(s,e,t){for(var r=(s.mode&1)!==0;Ht!==null;){var n=Ht,i=n.child;if(n.tag===22&&r){var o=n.memoizedState!==null||vy;if(!o){var l=n.alternate,c=l!==null&&l.memoizedState!==null||$n;l=vy;var d=$n;if(vy=o,($n=c)&&!d)for(Ht=n;Ht!==null;)o=Ht,c=o.child,o.tag===22&&o.memoizedState!==null?f4(n):c!==null?(c.return=o,Ht=c):f4(n);for(;i!==null;)Ht=i,K6(i),i=i.sibling;Ht=n,vy=l,$n=d}u4(s)}else n.subtreeFlags&8772&&i!==null?(i.return=n,Ht=i):u4(s)}}function u4(s){for(;Ht!==null;){var e=Ht;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$n||e2(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$n)if(t===null)r.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:Ua(e.type,t.memoizedProps);r.componentDidUpdate(n,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&KA(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}KA(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&mg(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_t(163))}$n||e.flags&512&&Z5(e)}catch(m){Sr(e,e.return,m)}}if(e===s){Ht=null;break}if(t=e.sibling,t!==null){t.return=e.return,Ht=t;break}Ht=e.return}}function h4(s){for(;Ht!==null;){var e=Ht;if(e===s){Ht=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Ht=t;break}Ht=e.return}}function f4(s){for(;Ht!==null;){var e=Ht;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{e2(4,e)}catch(c){Sr(e,t,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var n=e.return;try{r.componentDidMount()}catch(c){Sr(e,n,c)}}var i=e.return;try{Z5(e)}catch(c){Sr(e,i,c)}break;case 5:var o=e.return;try{Z5(e)}catch(c){Sr(e,o,c)}}}catch(c){Sr(e,e.return,c)}if(e===s){Ht=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Ht=l;break}Ht=e.return}}var J8=Math.ceil,t1=oc.ReactCurrentDispatcher,OS=oc.ReactCurrentOwner,Aa=oc.ReactCurrentBatchConfig,Rs=0,un=null,$r=null,wn=0,Gi=0,Kf=Bd(0),Qr=0,jg=null,Dh=0,t2=0,BS=0,X0=null,Ni=null,$S=0,yp=1/0,xl=null,s1=!1,sN=null,Sd=null,wy=!1,xd=null,r1=0,J0=0,rN=null,Xy=-1,Jy=0;function ri(){return Rs&6?Er():Xy!==-1?Xy:Xy=Er()}function jd(s){return s.mode&1?Rs&2&&wn!==0?wn&-wn:R8.transition!==null?(Jy===0&&(Jy=Ik()),Jy):(s=Vs,s!==0||(s=window.event,s=s===void 0?16:$k(s.type)),s):1}function lo(s,e,t,r){if(50<J0)throw J0=0,rN=null,Error(_t(185));ub(s,t,r),(!(Rs&2)||s!==un)&&(s===un&&(!(Rs&2)&&(t2|=t),Qr===4&&Tc(s,wn)),ki(s,r),t===1&&Rs===0&&!(e.mode&1)&&(yp=Er()+500,J1&&$d()))}function ki(s,e){var t=s.callbackNode;RI(s,e);var r=$v(s,s===un?wn:0);if(r===0)t!==null&&NA(t),s.callbackNode=null,s.callbackPriority=0;else if(e=r&-r,s.callbackPriority!==e){if(t!=null&&NA(t),e===1)s.tag===0?I8(m4.bind(null,s)):i6(m4.bind(null,s)),E8(function(){!(Rs&6)&&$d()}),t=null;else{switch(Rk(r)){case 1:t=hS;break;case 4:t=Pk;break;case 16:t=Bv;break;case 536870912:t=Tk;break;default:t=Bv}t=rC(t,X6.bind(null,s))}s.callbackPriority=e,s.callbackNode=t}}function X6(s,e){if(Xy=-1,Jy=0,Rs&6)throw Error(_t(327));var t=s.callbackNode;if(rm()&&s.callbackNode!==t)return null;var r=$v(s,s===un?wn:0);if(r===0)return null;if(r&30||r&s.expiredLanes||e)e=n1(s,r);else{e=r;var n=Rs;Rs|=2;var i=Q6();(un!==s||wn!==e)&&(xl=null,yp=Er()+500,Ah(s,e));do try{eR();break}catch(l){J6(s,l)}while(!0);jS(),t1.current=i,Rs=n,$r!==null?e=0:(un=null,wn=0,e=Qr)}if(e!==0){if(e===2&&(n=L5(s),n!==0&&(r=n,e=nN(s,n))),e===1)throw t=jg,Ah(s,0),Tc(s,r),ki(s,Er()),t;if(e===6)Tc(s,r);else{if(n=s.current.alternate,!(r&30)&&!Q8(n)&&(e=n1(s,r),e===2&&(i=L5(s),i!==0&&(r=i,e=nN(s,i))),e===1))throw t=jg,Ah(s,0),Tc(s,r),ki(s,Er()),t;switch(s.finishedWork=n,s.finishedLanes=r,e){case 0:case 1:throw Error(_t(345));case 2:ou(s,Ni,xl);break;case 3:if(Tc(s,r),(r&130023424)===r&&(e=$S+500-Er(),10<e)){if($v(s,0)!==0)break;if(n=s.suspendedLanes,(n&r)!==r){ri(),s.pingedLanes|=s.suspendedLanes&n;break}s.timeoutHandle=O5(ou.bind(null,s,Ni,xl),e);break}ou(s,Ni,xl);break;case 4:if(Tc(s,r),(r&4194240)===r)break;for(e=s.eventTimes,n=-1;0<r;){var o=31-oo(r);i=1<<o,o=e[o],o>n&&(n=o),r&=~i}if(r=n,r=Er()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*J8(r/1960))-r,10<r){s.timeoutHandle=O5(ou.bind(null,s,Ni,xl),r);break}ou(s,Ni,xl);break;case 5:ou(s,Ni,xl);break;default:throw Error(_t(329))}}}return ki(s,Er()),s.callbackNode===t?X6.bind(null,s):null}function nN(s,e){var t=X0;return s.current.memoizedState.isDehydrated&&(Ah(s,e).flags|=256),s=n1(s,e),s!==2&&(e=Ni,Ni=t,e!==null&&iN(e)),s}function iN(s){Ni===null?Ni=s:Ni.push.apply(Ni,s)}function Q8(s){for(var e=s;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var n=t[r],i=n.getSnapshot;n=n.value;try{if(!uo(i(),n))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Tc(s,e){for(e&=~BS,e&=~t2,s.suspendedLanes|=e,s.pingedLanes&=~e,s=s.expirationTimes;0<e;){var t=31-oo(e),r=1<<t;s[t]=-1,e&=~r}}function m4(s){if(Rs&6)throw Error(_t(327));rm();var e=$v(s,0);if(!(e&1))return ki(s,Er()),null;var t=n1(s,e);if(s.tag!==0&&t===2){var r=L5(s);r!==0&&(e=r,t=nN(s,r))}if(t===1)throw t=jg,Ah(s,0),Tc(s,e),ki(s,Er()),t;if(t===6)throw Error(_t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=e,ou(s,Ni,xl),ki(s,Er()),null}function zS(s,e){var t=Rs;Rs|=1;try{return s(e)}finally{Rs=t,Rs===0&&(yp=Er()+500,J1&&$d())}}function Mh(s){xd!==null&&xd.tag===0&&!(Rs&6)&&rm();var e=Rs;Rs|=1;var t=Aa.transition,r=Vs;try{if(Aa.transition=null,Vs=1,s)return s()}finally{Vs=r,Aa.transition=t,Rs=e,!(Rs&6)&&$d()}}function US(){Gi=Kf.current,lr(Kf)}function Ah(s,e){s.finishedWork=null,s.finishedLanes=0;var t=s.timeoutHandle;if(t!==-1&&(s.timeoutHandle=-1,C8(t)),$r!==null)for(t=$r.return;t!==null;){var r=t;switch(NS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Wv();break;case 3:xp(),lr(ji),lr(qn),PS();break;case 5:LS(r);break;case 4:xp();break;case 13:lr(gr);break;case 19:lr(gr);break;case 10:AS(r.type._context);break;case 22:case 23:US()}t=t.return}if(un=s,$r=s=Ad(s.current,null),wn=Gi=e,Qr=0,jg=null,BS=t2=Dh=0,Ni=X0=null,xu!==null){for(e=0;e<xu.length;e++)if(t=xu[e],r=t.interleaved,r!==null){t.interleaved=null;var n=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=n,r.next=o}t.pending=r}xu=null}return s}function J6(s,e){do{var t=$r;try{if(jS(),Gy.current=e1,Zv){for(var r=br.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}Zv=!1}if(Rh=0,dn=Xr=br=null,Y0=!1,Ng=0,OS.current=null,t===null||t.return===null){Qr=1,jg=e,$r=null;break}e:{var i=s,o=t.return,l=t,c=e;if(e=wn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=t4(o);if(p!==null){p.flags&=-257,s4(p,o,l,i,e),p.mode&1&&e4(i,d,e),e=p,c=d;var x=e.updateQueue;if(x===null){var w=new Set;w.add(c),e.updateQueue=w}else x.add(c);break e}else{if(!(e&1)){e4(i,d,e),qS();break e}c=Error(_t(426))}}else if(hr&&l.mode&1){var S=t4(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),s4(S,o,l,i,e),_S(bp(c,l));break e}}i=c=bp(c,l),Qr!==4&&(Qr=2),X0===null?X0=[i]:X0.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=R6(i,c,e);YA(i,b);break e;case 1:l=c;var v=i.type,N=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Sd===null||!Sd.has(N)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=D6(i,l,e);YA(i,j);break e}}i=i.return}while(i!==null)}eC(t)}catch(E){e=E,$r===t&&t!==null&&($r=t=t.return);continue}break}while(!0)}function Q6(){var s=t1.current;return t1.current=e1,s===null?e1:s}function qS(){(Qr===0||Qr===3||Qr===2)&&(Qr=4),un===null||!(Dh&268435455)&&!(t2&268435455)||Tc(un,wn)}function n1(s,e){var t=Rs;Rs|=2;var r=Q6();(un!==s||wn!==e)&&(xl=null,Ah(s,e));do try{Z8();break}catch(n){J6(s,n)}while(!0);if(jS(),Rs=t,t1.current=r,$r!==null)throw Error(_t(261));return un=null,wn=0,Qr}function Z8(){for(;$r!==null;)Z6($r)}function eR(){for(;$r!==null&&!jI();)Z6($r)}function Z6(s){var e=sC(s.alternate,s,Gi);s.memoizedProps=s.pendingProps,e===null?eC(s):$r=e,OS.current=null}function eC(s){var e=s;do{var t=e.alternate;if(s=e.return,e.flags&32768){if(t=G8(t,e),t!==null){t.flags&=32767,$r=t;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Qr=6,$r=null;return}}else if(t=V8(t,e,Gi),t!==null){$r=t;return}if(e=e.sibling,e!==null){$r=e;return}$r=e=s}while(e!==null);Qr===0&&(Qr=5)}function ou(s,e,t){var r=Vs,n=Aa.transition;try{Aa.transition=null,Vs=1,tR(s,e,t,r)}finally{Aa.transition=n,Vs=r}return null}function tR(s,e,t,r){do rm();while(xd!==null);if(Rs&6)throw Error(_t(327));t=s.finishedWork;var n=s.finishedLanes;if(t===null)return null;if(s.finishedWork=null,s.finishedLanes=0,t===s.current)throw Error(_t(177));s.callbackNode=null,s.callbackPriority=0;var i=t.lanes|t.childLanes;if(DI(s,i),s===un&&($r=un=null,wn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||wy||(wy=!0,rC(Bv,function(){return rm(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Aa.transition,Aa.transition=null;var o=Vs;Vs=1;var l=Rs;Rs|=4,OS.current=null,K8(s,t),Y6(t,s),w8(M5),zv=!!D5,M5=D5=null,s.current=t,X8(t),AI(),Rs=l,Vs=o,Aa.transition=i}else s.current=t;if(wy&&(wy=!1,xd=s,r1=n),i=s.pendingLanes,i===0&&(Sd=null),EI(t.stateNode),ki(s,Er()),e!==null)for(r=s.onRecoverableError,t=0;t<e.length;t++)n=e[t],r(n.value,{componentStack:n.stack,digest:n.digest});if(s1)throw s1=!1,s=sN,sN=null,s;return r1&1&&s.tag!==0&&rm(),i=s.pendingLanes,i&1?s===rN?J0++:(J0=0,rN=s):J0=0,$d(),null}function rm(){if(xd!==null){var s=Rk(r1),e=Aa.transition,t=Vs;try{if(Aa.transition=null,Vs=16>s?16:s,xd===null)var r=!1;else{if(s=xd,xd=null,r1=0,Rs&6)throw Error(_t(331));var n=Rs;for(Rs|=4,Ht=s.current;Ht!==null;){var i=Ht,o=i.child;if(Ht.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Ht=d;Ht!==null;){var u=Ht;switch(u.tag){case 0:case 11:case 15:K0(8,u,i)}var h=u.child;if(h!==null)h.return=u,Ht=h;else for(;Ht!==null;){u=Ht;var m=u.sibling,p=u.return;if(W6(u),u===d){Ht=null;break}if(m!==null){m.return=p,Ht=m;break}Ht=p}}}var x=i.alternate;if(x!==null){var w=x.child;if(w!==null){x.child=null;do{var S=w.sibling;w.sibling=null,w=S}while(w!==null)}}Ht=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ht=o;else e:for(;Ht!==null;){if(i=Ht,i.flags&2048)switch(i.tag){case 0:case 11:case 15:K0(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,Ht=b;break e}Ht=i.return}}var v=s.current;for(Ht=v;Ht!==null;){o=Ht;var N=o.child;if(o.subtreeFlags&2064&&N!==null)N.return=o,Ht=N;else e:for(o=v;Ht!==null;){if(l=Ht,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:e2(9,l)}}catch(E){Sr(l,l.return,E)}if(l===o){Ht=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,Ht=j;break e}Ht=l.return}}if(Rs=n,$d(),Yo&&typeof Yo.onPostCommitFiberRoot=="function")try{Yo.onPostCommitFiberRoot(V1,s)}catch{}r=!0}return r}finally{Vs=t,Aa.transition=e}}return!1}function p4(s,e,t){e=bp(t,e),e=R6(s,e,1),s=_d(s,e,1),e=ri(),s!==null&&(ub(s,1,e),ki(s,e))}function Sr(s,e,t){if(s.tag===3)p4(s,s,t);else for(;e!==null;){if(e.tag===3){p4(e,s,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Sd===null||!Sd.has(r))){s=bp(t,s),s=D6(e,s,1),e=_d(e,s,1),s=ri(),e!==null&&(ub(e,1,s),ki(e,s));break}}e=e.return}}function sR(s,e,t){var r=s.pingCache;r!==null&&r.delete(e),e=ri(),s.pingedLanes|=s.suspendedLanes&t,un===s&&(wn&t)===t&&(Qr===4||Qr===3&&(wn&130023424)===wn&&500>Er()-$S?Ah(s,0):BS|=t),ki(s,e)}function tC(s,e){e===0&&(s.mode&1?(e=uy,uy<<=1,!(uy&130023424)&&(uy=4194304)):e=1);var t=ri();s=tc(s,e),s!==null&&(ub(s,e,t),ki(s,t))}function rR(s){var e=s.memoizedState,t=0;e!==null&&(t=e.retryLane),tC(s,t)}function nR(s,e){var t=0;switch(s.tag){case 13:var r=s.stateNode,n=s.memoizedState;n!==null&&(t=n.retryLane);break;case 19:r=s.stateNode;break;default:throw Error(_t(314))}r!==null&&r.delete(e),tC(s,t)}var sC;sC=function(s,e,t){if(s!==null)if(s.memoizedProps!==e.pendingProps||ji.current)Si=!0;else{if(!(s.lanes&t)&&!(e.flags&128))return Si=!1,W8(s,e,t);Si=!!(s.flags&131072)}else Si=!1,hr&&e.flags&1048576&&a6(e,Yv,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ky(s,e),s=e.pendingProps;var n=mp(e,qn.current);sm(e,t),n=IS(null,e,r,s,n,t);var i=RS();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ai(r)?(i=!0,Vv(e)):i=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,CS(e),n.updater=Z1,e.stateNode=n,n._reactInternals=e,W5(e,r,s,t),e=Y5(null,e,r,!0,i,t)):(e.tag=0,hr&&i&&wS(e),ti(null,e,n,t),e=e.child),e;case 16:r=e.elementType;e:{switch(Ky(s,e),s=e.pendingProps,n=r._init,r=n(r._payload),e.type=r,n=e.tag=aR(r),s=Ua(r,s),n){case 0:e=G5(null,e,r,s,t);break e;case 1:e=i4(null,e,r,s,t);break e;case 11:e=r4(null,e,r,s,t);break e;case 14:e=n4(null,e,r,Ua(r.type,s),t);break e}throw Error(_t(306,r,""))}return e;case 0:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:Ua(r,n),G5(s,e,r,n,t);case 1:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:Ua(r,n),i4(s,e,r,n,t);case 3:e:{if(B6(e),s===null)throw Error(_t(387));r=e.pendingProps,i=e.memoizedState,n=i.element,h6(s,e),Jv(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){n=bp(Error(_t(423)),e),e=a4(s,e,r,t,n);break e}else if(r!==n){n=bp(Error(_t(424)),e),e=a4(s,e,r,t,n);break e}else for(Ji=Nd(e.stateNode.containerInfo.firstChild),Zi=e,hr=!0,io=null,t=d6(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(pp(),r===n){e=sc(s,e,t);break e}ti(s,e,r,t)}e=e.child}return e;case 5:return f6(e),s===null&&U5(e),r=e.type,n=e.pendingProps,i=s!==null?s.memoizedProps:null,o=n.children,F5(r,n)?o=null:i!==null&&F5(r,i)&&(e.flags|=32),O6(s,e),ti(s,e,o,t),e.child;case 6:return s===null&&U5(e),null;case 13:return $6(s,e,t);case 4:return ES(e,e.stateNode.containerInfo),r=e.pendingProps,s===null?e.child=gp(e,null,r,t):ti(s,e,r,t),e.child;case 11:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:Ua(r,n),r4(s,e,r,n,t);case 7:return ti(s,e,e.pendingProps,t),e.child;case 8:return ti(s,e,e.pendingProps.children,t),e.child;case 12:return ti(s,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,n=e.pendingProps,i=e.memoizedProps,o=n.value,nr(Kv,r._currentValue),r._currentValue=o,i!==null)if(uo(i.value,o)){if(i.children===n.children&&!ji.current){e=sc(s,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Xl(-1,t&-t),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=t,c=i.alternate,c!==null&&(c.lanes|=t),q5(i.return,t,e),l.lanes|=t;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(_t(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),q5(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ti(s,e,n.children,t),e=e.child}return e;case 9:return n=e.type,r=e.pendingProps.children,sm(e,t),n=Ca(n),r=r(n),e.flags|=1,ti(s,e,r,t),e.child;case 14:return r=e.type,n=Ua(r,e.pendingProps),n=Ua(r.type,n),n4(s,e,r,n,t);case 15:return M6(s,e,e.type,e.pendingProps,t);case 17:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:Ua(r,n),Ky(s,e),e.tag=1,Ai(r)?(s=!0,Vv(e)):s=!1,sm(e,t),I6(e,r,n),W5(e,r,n,t),Y5(null,e,r,!0,s,t);case 19:return z6(s,e,t);case 22:return F6(s,e,t)}throw Error(_t(156,e.tag))};function rC(s,e){return Lk(s,e)}function iR(s,e,t,r){this.tag=s,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ja(s,e,t,r){return new iR(s,e,t,r)}function HS(s){return s=s.prototype,!(!s||!s.isReactComponent)}function aR(s){if(typeof s=="function")return HS(s)?1:0;if(s!=null){if(s=s.$$typeof,s===cS)return 11;if(s===dS)return 14}return 2}function Ad(s,e){var t=s.alternate;return t===null?(t=ja(s.tag,e,s.key,s.mode),t.elementType=s.elementType,t.type=s.type,t.stateNode=s.stateNode,t.alternate=s,s.alternate=t):(t.pendingProps=e,t.type=s.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=s.flags&14680064,t.childLanes=s.childLanes,t.lanes=s.lanes,t.child=s.child,t.memoizedProps=s.memoizedProps,t.memoizedState=s.memoizedState,t.updateQueue=s.updateQueue,e=s.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=s.sibling,t.index=s.index,t.ref=s.ref,t}function Qy(s,e,t,r,n,i){var o=2;if(r=s,typeof s=="function")HS(s)&&(o=1);else if(typeof s=="string")o=5;else e:switch(s){case Bf:return kh(t.children,n,i,e);case lS:o=8,n|=8;break;case p5:return s=ja(12,t,e,n|2),s.elementType=p5,s.lanes=i,s;case g5:return s=ja(13,t,e,n),s.elementType=g5,s.lanes=i,s;case x5:return s=ja(19,t,e,n),s.elementType=x5,s.lanes=i,s;case fk:return s2(t,n,i,e);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case uk:o=10;break e;case hk:o=9;break e;case cS:o=11;break e;case dS:o=14;break e;case Ec:o=16,r=null;break e}throw Error(_t(130,s==null?s:typeof s,""))}return e=ja(o,t,e,n),e.elementType=s,e.type=r,e.lanes=i,e}function kh(s,e,t,r){return s=ja(7,s,r,e),s.lanes=t,s}function s2(s,e,t,r){return s=ja(22,s,r,e),s.elementType=fk,s.lanes=t,s.stateNode={isHidden:!1},s}function Rw(s,e,t){return s=ja(6,s,null,e),s.lanes=t,s}function Dw(s,e,t){return e=ja(4,s.children!==null?s.children:[],s.key,e),e.lanes=t,e.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},e}function oR(s,e,t,r,n){this.tag=e,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pw(0),this.expirationTimes=pw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pw(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function WS(s,e,t,r,n,i,o,l,c){return s=new oR(s,e,t,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ja(3,null,null,e),s.current=i,i.stateNode=s,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},CS(i),s}function lR(s,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Of,key:r==null?null:""+r,children:s,containerInfo:e,implementation:t}}function nC(s){if(!s)return Pd;s=s._reactInternals;e:{if(qh(s)!==s||s.tag!==1)throw Error(_t(170));var e=s;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ai(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(_t(171))}if(s.tag===1){var t=s.type;if(Ai(t))return n6(s,t,e)}return e}function iC(s,e,t,r,n,i,o,l,c){return s=WS(t,r,!0,s,n,i,o,l,c),s.context=nC(null),t=s.current,r=ri(),n=jd(t),i=Xl(r,n),i.callback=e??null,_d(t,i,n),s.current.lanes=n,ub(s,n,r),ki(s,r),s}function r2(s,e,t,r){var n=e.current,i=ri(),o=jd(n);return t=nC(t),e.context===null?e.context=t:e.pendingContext=t,e=Xl(i,o),e.payload={element:s},r=r===void 0?null:r,r!==null&&(e.callback=r),s=_d(n,e,o),s!==null&&(lo(s,n,o,i),Vy(s,n,o)),o}function i1(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function g4(s,e){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var t=s.retryLane;s.retryLane=t!==0&&t<e?t:e}}function VS(s,e){g4(s,e),(s=s.alternate)&&g4(s,e)}function cR(){return null}var aC=typeof reportError=="function"?reportError:function(s){console.error(s)};function GS(s){this._internalRoot=s}n2.prototype.render=GS.prototype.render=function(s){var e=this._internalRoot;if(e===null)throw Error(_t(409));r2(s,e,null,null)};n2.prototype.unmount=GS.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var e=s.containerInfo;Mh(function(){r2(null,s,null,null)}),e[ec]=null}};function n2(s){this._internalRoot=s}n2.prototype.unstable_scheduleHydration=function(s){if(s){var e=Fk();s={blockedOn:null,target:s,priority:e};for(var t=0;t<Pc.length&&e!==0&&e<Pc[t].priority;t++);Pc.splice(t,0,s),t===0&&Bk(s)}};function YS(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i2(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function x4(){}function dR(s,e,t,r,n){if(n){if(typeof r=="function"){var i=r;r=function(){var d=i1(o);i.call(d)}}var o=iC(e,r,s,0,null,!1,!1,"",x4);return s._reactRootContainer=o,s[ec]=o.current,xg(s.nodeType===8?s.parentNode:s),Mh(),o}for(;n=s.lastChild;)s.removeChild(n);if(typeof r=="function"){var l=r;r=function(){var d=i1(c);l.call(d)}}var c=WS(s,0,!1,null,null,!1,!1,"",x4);return s._reactRootContainer=c,s[ec]=c.current,xg(s.nodeType===8?s.parentNode:s),Mh(function(){r2(e,c,t,r)}),c}function a2(s,e,t,r,n){var i=t._reactRootContainer;if(i){var o=i;if(typeof n=="function"){var l=n;n=function(){var c=i1(o);l.call(c)}}r2(e,o,s,n)}else o=dR(t,e,s,n,r);return i1(o)}Dk=function(s){switch(s.tag){case 3:var e=s.stateNode;if(e.current.memoizedState.isDehydrated){var t=_0(e.pendingLanes);t!==0&&(fS(e,t|1),ki(e,Er()),!(Rs&6)&&(yp=Er()+500,$d()))}break;case 13:Mh(function(){var r=tc(s,1);if(r!==null){var n=ri();lo(r,s,1,n)}}),VS(s,1)}};mS=function(s){if(s.tag===13){var e=tc(s,134217728);if(e!==null){var t=ri();lo(e,s,134217728,t)}VS(s,134217728)}};Mk=function(s){if(s.tag===13){var e=jd(s),t=tc(s,e);if(t!==null){var r=ri();lo(t,s,e,r)}VS(s,e)}};Fk=function(){return Vs};Ok=function(s,e){var t=Vs;try{return Vs=s,e()}finally{Vs=t}};k5=function(s,e,t){switch(e){case"input":if(v5(s,t),e=t.name,t.type==="radio"&&e!=null){for(t=s;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==s&&r.form===s.form){var n=X1(r);if(!n)throw Error(_t(90));pk(r),v5(r,n)}}}break;case"textarea":xk(s,t);break;case"select":e=t.value,e!=null&&Qf(s,!!t.multiple,e,!1)}};Sk=zS;jk=Mh;var uR={usingClientEntryPoint:!1,Events:[fb,qf,X1,Nk,_k,zS]},d0={findFiberByHostInstance:gu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},hR={bundleType:d0.bundleType,version:d0.version,rendererPackageName:d0.rendererPackageName,rendererConfig:d0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oc.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Ck(s),s===null?null:s.stateNode},findFiberByHostInstance:d0.findFiberByHostInstance||cR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ny=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ny.isDisabled&&Ny.supportsFiber)try{V1=Ny.inject(hR),Yo=Ny}catch{}}sa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uR;sa.createPortal=function(s,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!YS(e))throw Error(_t(200));return lR(s,e,null,t)};sa.createRoot=function(s,e){if(!YS(s))throw Error(_t(299));var t=!1,r="",n=aC;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=WS(s,1,!1,null,null,t,!1,r,n),s[ec]=e.current,xg(s.nodeType===8?s.parentNode:s),new GS(e)};sa.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var e=s._reactInternals;if(e===void 0)throw typeof s.render=="function"?Error(_t(188)):(s=Object.keys(s).join(","),Error(_t(268,s)));return s=Ck(e),s=s===null?null:s.stateNode,s};sa.flushSync=function(s){return Mh(s)};sa.hydrate=function(s,e,t){if(!i2(e))throw Error(_t(200));return a2(null,s,e,!0,t)};sa.hydrateRoot=function(s,e,t){if(!YS(s))throw Error(_t(405));var r=t!=null&&t.hydratedSources||null,n=!1,i="",o=aC;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=iC(e,null,s,1,t??null,n,!1,i,o),s[ec]=e.current,xg(s),r)for(s=0;s<r.length;s++)t=r[s],n=t._getVersion,n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new n2(e)};sa.render=function(s,e,t){if(!i2(e))throw Error(_t(200));return a2(null,s,e,!1,t)};sa.unmountComponentAtNode=function(s){if(!i2(s))throw Error(_t(40));return s._reactRootContainer?(Mh(function(){a2(null,null,s,!1,function(){s._reactRootContainer=null,s[ec]=null})}),!0):!1};sa.unstable_batchedUpdates=zS;sa.unstable_renderSubtreeIntoContainer=function(s,e,t,r){if(!i2(t))throw Error(_t(200));if(s==null||s._reactInternals===void 0)throw Error(_t(38));return a2(s,e,t,!1,r)};sa.version="18.3.1-next-f1338f8080-20240426";function oC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(oC)}catch(s){console.error(s)}}oC(),ok.exports=sa;var lC=ok.exports,cC,b4=lC;cC=b4.createRoot,b4.hydrateRoot;/**
 * react-router v7.9.4
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var dC=s=>{throw TypeError(s)},fR=(s,e,t)=>e.has(s)||dC("Cannot "+t),Mw=(s,e,t)=>(fR(s,e,"read from private field"),t?t.call(s):e.get(s)),mR=(s,e,t)=>e.has(s)?dC("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),y4="popstate";function pR(s={}){function e(r,n){let{pathname:i,search:o,hash:l}=r.location;return Ag("",{pathname:i,search:o,hash:l},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function t(r,n){return typeof n=="string"?n:Td(n)}return xR(e,t,null,s)}function Ss(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Ir(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function gR(){return Math.random().toString(36).substring(2,10)}function v4(s,e){return{usr:s.state,key:s.key,idx:e}}function Ag(s,e,t=null,r){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?zd(e):e,state:t,key:e&&e.key||r||gR()}}function Td({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function zd(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let r=s.indexOf("?");r>=0&&(e.search=s.substring(r),s=s.substring(0,r)),s&&(e.pathname=s)}return e}function xR(s,e,t,r={}){let{window:n=document.defaultView,v5Compat:i=!1}=r,o=n.history,l="POP",c=null,d=u();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function u(){return(o.state||{idx:null}).idx}function h(){l="POP";let S=u(),b=S==null?null:S-d;d=S,c&&c({action:l,location:w.location,delta:b})}function m(S,b){l="PUSH";let v=Ag(w.location,S,b);d=u()+1;let N=v4(v,d),j=w.createHref(v);try{o.pushState(N,"",j)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;n.location.assign(j)}i&&c&&c({action:l,location:w.location,delta:1})}function p(S,b){l="REPLACE";let v=Ag(w.location,S,b);d=u();let N=v4(v,d),j=w.createHref(v);o.replaceState(N,"",j),i&&c&&c({action:l,location:w.location,delta:0})}function x(S){return uC(S)}let w={get action(){return l},get location(){return s(n,o)},listen(S){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(y4,h),c=S,()=>{n.removeEventListener(y4,h),c=null}},createHref(S){return e(n,S)},createURL:x,encodeLocation(S){let b=x(S);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:p,go(S){return o.go(S)}};return w}function uC(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ss(t,"No window.location.(origin|href) available to create URL");let r=typeof s=="string"?s:Td(s);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}var j0,w4=class{constructor(s){if(mR(this,j0,new Map),s)for(let[e,t]of s)this.set(e,t)}get(s){if(Mw(this,j0).has(s))return Mw(this,j0).get(s);if(s.defaultValue!==void 0)return s.defaultValue;throw new Error("No value found for context")}set(s,e){Mw(this,j0).set(s,e)}};j0=new WeakMap;var bR=new Set(["lazy","caseSensitive","path","id","index","children"]);function yR(s){return bR.has(s)}var vR=new Set(["lazy","caseSensitive","path","id","index","middleware","children"]);function wR(s){return vR.has(s)}function NR(s){return s.index===!0}function kg(s,e,t=[],r={},n=!1){return s.map((i,o)=>{let l=[...t,String(o)],c=typeof i.id=="string"?i.id:l.join("-");if(Ss(i.index!==!0||!i.children,"Cannot specify children on an index route"),Ss(n||!r[c],`Found a route id collision on id "${c}".  Route id's must be globally unique within Data Router usages`),NR(i)){let d={...i,...e(i),id:c};return r[c]=d,d}else{let d={...i,...e(i),id:c,children:void 0};return r[c]=d,i.children&&(d.children=kg(i.children,e,l,r,n)),d}})}function Ic(s,e,t="/"){return Zy(s,e,t,!1)}function Zy(s,e,t,r){let n=typeof e=="string"?zd(e):e,i=La(n.pathname||"/",t);if(i==null)return null;let o=hC(s);SR(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=DR(i);l=IR(o[c],d,r)}return l}function _R(s,e){let{route:t,pathname:r,params:n}=s;return{id:t.id,pathname:r,params:n,data:e[t.id],loaderData:e[t.id],handle:t.handle}}function hC(s,e=[],t=[],r="",n=!1){let i=(o,l,c=n,d)=>{let u={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(r)&&c)return;Ss(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length)}let h=Xo([r,u.relativePath]),m=t.concat(u);o.children&&o.children.length>0&&(Ss(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),hC(o.children,e,m,h,c)),!(o.path==null&&!o.index)&&e.push({path:h,score:PR(h,o.index),routesMeta:m})};return s.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))i(o,l);else for(let d of fC(o.path))i(o,l,!0,d)}),e}function fC(s){let e=s.split("/");if(e.length===0)return[];let[t,...r]=e,n=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return n?[i,""]:[i];let o=fC(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),n&&l.push(...o),l.map(c=>s.startsWith("/")&&c===""?"/":c)}function SR(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:TR(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var jR=/^:[\w-]+$/,AR=3,kR=2,CR=1,ER=10,LR=-2,N4=s=>s==="*";function PR(s,e){let t=s.split("/"),r=t.length;return t.some(N4)&&(r+=LR),e&&(r+=kR),t.filter(n=>!N4(n)).reduce((n,i)=>n+(jR.test(i)?AR:i===""?CR:ER),r)}function TR(s,e){return s.length===e.length&&s.slice(0,-1).every((r,n)=>r===e[n])?s[s.length-1]-e[e.length-1]:0}function IR(s,e,t=!1){let{routesMeta:r}=s,n={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=a1({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),m=c.route;if(!h&&d&&t&&!r[r.length-1].route.index&&(h=a1({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!h)return null;Object.assign(n,h.params),o.push({params:n,pathname:Xo([i,h.pathname]),pathnameBase:BR(Xo([i,h.pathnameBase])),route:m}),h.pathnameBase!=="/"&&(i=Xo([i,h.pathnameBase]))}return o}function a1(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,r]=RR(s.path,s.caseSensitive,s.end),n=e.match(t);if(!n)return null;let i=n[0],o=i.replace(/(.)\/+$/,"$1"),l=n.slice(1);return{params:r.reduce((d,{paramName:u,isOptional:h},m)=>{if(u==="*"){let x=l[m]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const p=l[m];return h&&!p?d[u]=void 0:d[u]=(p||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:s}}function RR(s,e=!1,t=!0){Ir(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let r=[],n="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(r.push({paramName:"*"}),n+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":s!==""&&s!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),r]}function DR(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ir(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function La(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=s.charAt(t);return r&&r!=="/"?null:s.slice(t)||"/"}function MR({basename:s,pathname:e}){return e==="/"?s:Xo([s,e])}function FR(s,e="/"){let{pathname:t,search:r="",hash:n=""}=typeof s=="string"?zd(s):s;return{pathname:t?t.startsWith("/")?t:OR(t,e):e,search:$R(r),hash:zR(n)}}function OR(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function Fw(s,e,t,r){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function mC(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function o2(s){let e=mC(s);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function l2(s,e,t,r=!1){let n;typeof s=="string"?n=zd(s):(n={...s},Ss(!n.pathname||!n.pathname.includes("?"),Fw("?","pathname","search",n)),Ss(!n.pathname||!n.pathname.includes("#"),Fw("#","pathname","hash",n)),Ss(!n.search||!n.search.includes("#"),Fw("#","search","hash",n)));let i=s===""||n.pathname==="",o=i?"/":n.pathname,l;if(o==null)l=t;else{let h=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),h-=1;n.pathname=m.join("/")}l=h>=0?e[h]:"/"}let c=FR(n,l),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}var Xo=s=>s.join("/").replace(/\/\/+/g,"/"),BR=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),$R=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,zR=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,o1=class{constructor(s,e,t,r=!1){this.status=s,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function Cg(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var pC=["POST","PUT","PATCH","DELETE"],UR=new Set(pC),qR=["GET",...pC],HR=new Set(qR),WR=new Set([301,302,303,307,308]),VR=new Set([307,308]),Ow={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},GR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},u0={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},YR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KS=s=>YR.test(s),KR=s=>({hasErrorBoundary:!!s.hasErrorBoundary}),gC="remix-router-transitions",xC=Symbol("ResetLoaderData");function XR(s){const e=s.window?s.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";Ss(s.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=s.hydrationRouteProperties||[],n=s.mapRouteProperties||KR,i={},o=kg(s.routes,n,void 0,i),l,c=s.basename||"/";c.startsWith("/")||(c=`/${c}`);let d=s.dataStrategy||tD,u={...s.future},h=null,m=new Set,p=null,x=null,w=null,S=s.hydrationData!=null,b=Ic(o,s.history.location,c),v=!1,N=null,j;if(b==null&&!s.patchRoutesOnNavigation){let be=va(404,{pathname:s.history.location.pathname}),{matches:ve,route:Ve}=_y(o);j=!0,b=ve,N={[Ve.id]:be}}else if(b&&!s.hydrationData&&Ot(b,o,s.history.location.pathname).active&&(b=null),b)if(b.some(be=>be.route.lazy))j=!1;else if(!b.some(be=>XS(be.route)))j=!0;else{let be=s.hydrationData?s.hydrationData.loaderData:null,ve=s.hydrationData?s.hydrationData.errors:null;if(ve){let Ve=b.findIndex(ct=>ve[ct.route.id]!==void 0);j=b.slice(0,Ve+1).every(ct=>!oN(ct.route,be,ve))}else j=b.every(Ve=>!oN(Ve.route,be,ve))}else{j=!1,b=[];let be=Ot(null,o,s.history.location.pathname);be.active&&be.matches&&(v=!0,b=be.matches)}let E,A={historyAction:s.history.action,location:s.history.location,matches:b,initialized:j,navigation:Ow,restoreScrollPosition:s.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:s.hydrationData&&s.hydrationData.loaderData||{},actionData:s.hydrationData&&s.hydrationData.actionData||null,errors:s.hydrationData&&s.hydrationData.errors||N,fetchers:new Map,blockers:new Map},L="POP",C=!1,B,U=!1,P=new Map,T=null,z=!1,H=!1,D=new Set,M=new Map,$=0,q=-1,K=new Map,de=new Set,Ne=new Map,R=new Map,W=new Set,Z=new Map,ue,ce=null;function ye(){if(h=s.history.listen(({action:be,location:ve,delta:Ve})=>{if(ue){ue(),ue=void 0;return}Ir(Z.size===0||Ve!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ct=St({currentLocation:A.location,nextLocation:ve,historyAction:be});if(ct&&Ve!=null){let Y=new Promise(ie=>{ue=ie});s.history.go(Ve*-1),at(ct,{state:"blocked",location:ve,proceed(){at(ct,{state:"proceeding",proceed:void 0,reset:void 0,location:ve}),Y.then(()=>s.history.go(Ve))},reset(){let ie=new Map(A.blockers);ie.set(ct,u0),De({blockers:ie})}});return}return Be(be,ve)}),t){gD(e,P);let be=()=>xD(e,P);e.addEventListener("pagehide",be),T=()=>e.removeEventListener("pagehide",be)}return A.initialized||Be("POP",A.location,{initialHydration:!0}),E}function Se(){h&&h(),T&&T(),m.clear(),B&&B.abort(),A.fetchers.forEach((be,ve)=>Dt(ve)),A.blockers.forEach((be,ve)=>_e(ve))}function Ee(be){return m.add(be),()=>m.delete(be)}function De(be,ve={}){be.matches&&(be.matches=be.matches.map(Y=>{let ie=i[Y.route.id],je=Y.route;return je.element!==ie.element||je.errorElement!==ie.errorElement||je.hydrateFallbackElement!==ie.hydrateFallbackElement?{...Y,route:ie}:Y})),A={...A,...be};let Ve=[],ct=[];A.fetchers.forEach((Y,ie)=>{Y.state==="idle"&&(W.has(ie)?Ve.push(ie):ct.push(ie))}),W.forEach(Y=>{!A.fetchers.has(Y)&&!M.has(Y)&&Ve.push(Y)}),[...m].forEach(Y=>Y(A,{deletedFetchers:Ve,viewTransitionOpts:ve.viewTransitionOpts,flushSync:ve.flushSync===!0})),Ve.forEach(Y=>Dt(Y)),ct.forEach(Y=>A.fetchers.delete(Y))}function We(be,ve,{flushSync:Ve}={}){var Ie,He;let ct=A.actionData!=null&&A.navigation.formMethod!=null&&wi(A.navigation.formMethod)&&A.navigation.state==="loading"&&((Ie=be.state)==null?void 0:Ie._isRedirect)!==!0,Y;ve.actionData?Object.keys(ve.actionData).length>0?Y=ve.actionData:Y=null:ct?Y=A.actionData:Y=null;let ie=ve.loaderData?T4(A.loaderData,ve.loaderData,ve.matches||[],ve.errors):A.loaderData,je=A.blockers;je.size>0&&(je=new Map(je),je.forEach((Me,st)=>je.set(st,u0)));let se=z?!1:Rt(be,ve.matches||A.matches),le=C===!0||A.navigation.formMethod!=null&&wi(A.navigation.formMethod)&&((He=be.state)==null?void 0:He._isRedirect)!==!0;l&&(o=l,l=void 0),z||L==="POP"||(L==="PUSH"?s.history.push(be,be.state):L==="REPLACE"&&s.history.replace(be,be.state));let Ue;if(L==="POP"){let Me=P.get(A.location.pathname);Me&&Me.has(be.pathname)?Ue={currentLocation:A.location,nextLocation:be}:P.has(be.pathname)&&(Ue={currentLocation:be,nextLocation:A.location})}else if(U){let Me=P.get(A.location.pathname);Me?Me.add(be.pathname):(Me=new Set([be.pathname]),P.set(A.location.pathname,Me)),Ue={currentLocation:A.location,nextLocation:be}}De({...ve,actionData:Y,loaderData:ie,historyAction:L,location:be,initialized:!0,navigation:Ow,revalidation:"idle",restoreScrollPosition:se,preventScrollReset:le,blockers:je},{viewTransitionOpts:Ue,flushSync:Ve===!0}),L="POP",C=!1,U=!1,z=!1,H=!1,ce==null||ce.resolve(),ce=null}async function Je(be,ve){if(typeof be=="number"){s.history.go(be);return}let Ve=aN(A.location,A.matches,c,be,ve==null?void 0:ve.fromRouteId,ve==null?void 0:ve.relative),{path:ct,submission:Y,error:ie}=_4(!1,Ve,ve),je=A.location,se=Ag(A.location,ct,ve&&ve.state);se={...se,...s.history.encodeLocation(se)};let le=ve&&ve.replace!=null?ve.replace:void 0,Ue="PUSH";le===!0?Ue="REPLACE":le===!1||Y!=null&&wi(Y.formMethod)&&Y.formAction===A.location.pathname+A.location.search&&(Ue="REPLACE");let Ie=ve&&"preventScrollReset"in ve?ve.preventScrollReset===!0:void 0,He=(ve&&ve.flushSync)===!0,Me=St({currentLocation:je,nextLocation:se,historyAction:Ue});if(Me){at(Me,{state:"blocked",location:se,proceed(){at(Me,{state:"proceeding",proceed:void 0,reset:void 0,location:se}),Je(be,ve)},reset(){let st=new Map(A.blockers);st.set(Me,u0),De({blockers:st})}});return}await Be(Ue,se,{submission:Y,pendingError:ie,preventScrollReset:Ie,replace:ve&&ve.replace,enableViewTransition:ve&&ve.viewTransition,flushSync:He})}function it(){ce||(ce=bD()),Qe(),De({revalidation:"loading"});let be=ce.promise;return A.navigation.state==="submitting"?be:A.navigation.state==="idle"?(Be(A.historyAction,A.location,{startUninterruptedRevalidation:!0}),be):(Be(L||A.historyAction,A.navigation.location,{overrideNavigation:A.navigation,enableViewTransition:U===!0}),be)}async function Be(be,ve,Ve){B&&B.abort(),B=null,L=be,z=(Ve&&Ve.startUninterruptedRevalidation)===!0,jt(A.location,A.matches),C=(Ve&&Ve.preventScrollReset)===!0,U=(Ve&&Ve.enableViewTransition)===!0;let ct=l||o,Y=Ve&&Ve.overrideNavigation,ie=Ve!=null&&Ve.initialHydration&&A.matches&&A.matches.length>0&&!v?A.matches:Ic(ct,ve,c),je=(Ve&&Ve.flushSync)===!0;if(ie&&A.initialized&&!H&&cD(A.location,ve)&&!(Ve&&Ve.submission&&wi(Ve.submission.formMethod))){We(ve,{matches:ie},{flushSync:je});return}let se=Ot(ie,ct,ve.pathname);if(se.active&&se.matches&&(ie=se.matches),!ie){let{error:wt,notFoundMatches:xt,route:X}=Tt(ve.pathname);We(ve,{matches:xt,loaderData:{},errors:{[X.id]:wt}},{flushSync:je});return}B=new AbortController;let le=Af(s.history,ve,B.signal,Ve&&Ve.submission),Ue=s.getContext?await s.getContext():new w4,Ie;if(Ve&&Ve.pendingError)Ie=[Rc(ie).route.id,{type:"error",error:Ve.pendingError}];else if(Ve&&Ve.submission&&wi(Ve.submission.formMethod)){let wt=await Te(le,ve,Ve.submission,ie,Ue,se.active,Ve&&Ve.initialHydration===!0,{replace:Ve.replace,flushSync:je});if(wt.shortCircuited)return;if(wt.pendingActionResult){let[xt,X]=wt.pendingActionResult;if(Yi(X)&&Cg(X.error)&&X.error.status===404){B=null,We(ve,{matches:wt.matches,loaderData:{},errors:{[xt]:X.error}});return}}ie=wt.matches||ie,Ie=wt.pendingActionResult,Y=Bw(ve,Ve.submission),je=!1,se.active=!1,le=Af(s.history,le.url,le.signal)}let{shortCircuited:He,matches:Me,loaderData:st,errors:ut}=await oe(le,ve,ie,Ue,se.active,Y,Ve&&Ve.submission,Ve&&Ve.fetcherSubmission,Ve&&Ve.replace,Ve&&Ve.initialHydration===!0,je,Ie);He||(B=null,We(ve,{matches:Me||ie,...I4(Ie),loaderData:st,errors:ut}))}async function Te(be,ve,Ve,ct,Y,ie,je,se={}){Qe();let le=mD(ve,Ve);if(De({navigation:le},{flushSync:se.flushSync===!0}),ie){let He=await Ps(ct,ve.pathname,be.signal);if(He.type==="aborted")return{shortCircuited:!0};if(He.type==="error"){if(He.partialMatches.length===0){let{matches:st,route:ut}=_y(o);return{matches:st,pendingActionResult:[ut.id,{type:"error",error:He.error}]}}let Me=Rc(He.partialMatches).route.id;return{matches:He.partialMatches,pendingActionResult:[Me,{type:"error",error:He.error}]}}else if(He.matches)ct=He.matches;else{let{notFoundMatches:Me,error:st,route:ut}=Tt(ve.pathname);return{matches:Me,pendingActionResult:[ut.id,{type:"error",error:st}]}}}let Ue,Ie=ev(ct,ve);if(!Ie.route.action&&!Ie.route.lazy)Ue={type:"error",error:va(405,{method:be.method,pathname:ve.pathname,routeId:Ie.route.id})};else{let He=nm(n,i,be,ct,Ie,je?[]:r,Y),Me=await Ze(be,He,Y,null);if(Ue=Me[Ie.route.id],!Ue){for(let st of ct)if(Me[st.route.id]){Ue=Me[st.route.id];break}}if(be.signal.aborted)return{shortCircuited:!0}}if(yu(Ue)){let He;return se&&se.replace!=null?He=se.replace:He=E4(Ue.response.headers.get("Location"),new URL(be.url),c)===A.location.pathname+A.location.search,await Ae(be,Ue,!0,{submission:Ve,replace:He}),{shortCircuited:!0}}if(Yi(Ue)){let He=Rc(ct,Ie.route.id);return(se&&se.replace)!==!0&&(L="PUSH"),{matches:ct,pendingActionResult:[He.route.id,Ue,Ie.route.id]}}return{matches:ct,pendingActionResult:[Ie.route.id,Ue]}}async function oe(be,ve,Ve,ct,Y,ie,je,se,le,Ue,Ie,He){let Me=ie||Bw(ve,je),st=je||se||D4(Me),ut=!z&&!Ue;if(Y){if(ut){let mt=et(He);De({navigation:Me,...mt!==void 0?{actionData:mt}:{}},{flushSync:Ie})}let Gt=await Ps(Ve,ve.pathname,be.signal);if(Gt.type==="aborted")return{shortCircuited:!0};if(Gt.type==="error"){if(Gt.partialMatches.length===0){let{matches:Jt,route:ds}=_y(o);return{matches:Jt,loaderData:{},errors:{[ds.id]:Gt.error}}}let mt=Rc(Gt.partialMatches).route.id;return{matches:Gt.partialMatches,loaderData:{},errors:{[mt]:Gt.error}}}else if(Gt.matches)Ve=Gt.matches;else{let{error:mt,notFoundMatches:Jt,route:ds}=Tt(ve.pathname);return{matches:Jt,loaderData:{},errors:{[ds.id]:mt}}}}let wt=l||o,{dsMatches:xt,revalidatingFetchers:X}=S4(be,ct,n,i,s.history,A,Ve,st,ve,Ue?[]:r,Ue===!0,H,D,W,Ne,de,wt,c,s.patchRoutesOnNavigation!=null,He);if(q=++$,!s.dataStrategy&&!xt.some(Gt=>Gt.shouldLoad)&&!xt.some(Gt=>Gt.route.middleware&&Gt.route.middleware.length>0)&&X.length===0){let Gt=Ce();return We(ve,{matches:Ve,loaderData:{},errors:He&&Yi(He[1])?{[He[0]]:He[1].error}:null,...I4(He),...Gt?{fetchers:new Map(A.fetchers)}:{}},{flushSync:Ie}),{shortCircuited:!0}}if(ut){let Gt={};if(!Y){Gt.navigation=Me;let mt=et(He);mt!==void 0&&(Gt.actionData=mt)}X.length>0&&(Gt.fetchers=pe(X)),De(Gt,{flushSync:Ie})}X.forEach(Gt=>{os(Gt.key),Gt.controller&&M.set(Gt.key,Gt.controller)});let Ke=()=>X.forEach(Gt=>os(Gt.key));B&&B.signal.addEventListener("abort",Ke);let{loaderResults:Oe,fetcherResults:Xe}=await $e(xt,X,be,ct);if(be.signal.aborted)return{shortCircuited:!0};B&&B.signal.removeEventListener("abort",Ke),X.forEach(Gt=>M.delete(Gt.key));let nt=Sy(Oe);if(nt)return await Ae(be,nt.result,!0,{replace:le}),{shortCircuited:!0};if(nt=Sy(Xe),nt)return de.add(nt.key),await Ae(be,nt.result,!0,{replace:le}),{shortCircuited:!0};let{loaderData:Et,errors:ot}=P4(A,Ve,Oe,He,X,Xe);Ue&&A.errors&&(ot={...A.errors,...ot});let gt=Ce(),Fe=dt(q),ns=gt||Fe||X.length>0;return{matches:Ve,loaderData:Et,errors:ot,...ns?{fetchers:new Map(A.fetchers)}:{}}}function et(be){if(be&&!Yi(be[1]))return{[be[0]]:be[1].data};if(A.actionData)return Object.keys(A.actionData).length===0?null:A.actionData}function pe(be){return be.forEach(ve=>{let Ve=A.fetchers.get(ve.key),ct=h0(void 0,Ve?Ve.data:void 0);A.fetchers.set(ve.key,ct)}),new Map(A.fetchers)}async function xe(be,ve,Ve,ct){os(be);let Y=(ct&&ct.flushSync)===!0,ie=l||o,je=aN(A.location,A.matches,c,Ve,ve,ct==null?void 0:ct.relative),se=Ic(ie,je,c),le=Ot(se,ie,je);if(le.active&&le.matches&&(se=le.matches),!se){At(be,ve,va(404,{pathname:je}),{flushSync:Y});return}let{path:Ue,submission:Ie,error:He}=_4(!0,je,ct);if(He){At(be,ve,He,{flushSync:Y});return}let Me=s.getContext?await s.getContext():new w4,st=(ct&&ct.preventScrollReset)===!0;if(Ie&&wi(Ie.formMethod)){await he(be,ve,Ue,se,Me,le.active,Y,st,Ie);return}Ne.set(be,{routeId:ve,path:Ue}),await we(be,ve,Ue,se,Me,le.active,Y,st,Ie)}async function he(be,ve,Ve,ct,Y,ie,je,se,le){Qe(),Ne.delete(be);let Ue=A.fetchers.get(be);lt(be,pD(le,Ue),{flushSync:je});let Ie=new AbortController,He=Af(s.history,Ve,Ie.signal,le);if(ie){let ts=await Ps(ct,new URL(He.url).pathname,He.signal,be);if(ts.type==="aborted")return;if(ts.type==="error"){At(be,ve,ts.error,{flushSync:je});return}else if(ts.matches)ct=ts.matches;else{At(be,ve,va(404,{pathname:Ve}),{flushSync:je});return}}let Me=ev(ct,Ve);if(!Me.route.action&&!Me.route.lazy){let ts=va(405,{method:le.formMethod,pathname:Ve,routeId:ve});At(be,ve,ts,{flushSync:je});return}M.set(be,Ie);let st=$,ut=nm(n,i,He,ct,Me,r,Y),xt=(await Ze(He,ut,Y,be))[Me.route.id];if(He.signal.aborted){M.get(be)===Ie&&M.delete(be);return}if(W.has(be)){if(yu(xt)||Yi(xt)){lt(be,hl(void 0));return}}else{if(yu(xt))if(M.delete(be),q>st){lt(be,hl(void 0));return}else return de.add(be),lt(be,h0(le)),Ae(He,xt,!1,{fetcherSubmission:le,preventScrollReset:se});if(Yi(xt)){At(be,ve,xt.error);return}}let X=A.navigation.location||A.location,Ke=Af(s.history,X,Ie.signal),Oe=l||o,Xe=A.navigation.state!=="idle"?Ic(Oe,A.navigation.location,c):A.matches;Ss(Xe,"Didn't find any matches after fetcher action");let nt=++$;K.set(be,nt);let Et=h0(le,xt.data);A.fetchers.set(be,Et);let{dsMatches:ot,revalidatingFetchers:gt}=S4(Ke,Y,n,i,s.history,A,Xe,le,X,r,!1,H,D,W,Ne,de,Oe,c,s.patchRoutesOnNavigation!=null,[Me.route.id,xt]);gt.filter(ts=>ts.key!==be).forEach(ts=>{let It=ts.key,fs=A.fetchers.get(It),Zs=h0(void 0,fs?fs.data:void 0);A.fetchers.set(It,Zs),os(It),ts.controller&&M.set(It,ts.controller)}),De({fetchers:new Map(A.fetchers)});let Fe=()=>gt.forEach(ts=>os(ts.key));Ie.signal.addEventListener("abort",Fe);let{loaderResults:ns,fetcherResults:Gt}=await $e(ot,gt,Ke,Y);if(Ie.signal.aborted)return;if(Ie.signal.removeEventListener("abort",Fe),K.delete(be),M.delete(be),gt.forEach(ts=>M.delete(ts.key)),A.fetchers.has(be)){let ts=hl(xt.data);A.fetchers.set(be,ts)}let mt=Sy(ns);if(mt)return Ae(Ke,mt.result,!1,{preventScrollReset:se});if(mt=Sy(Gt),mt)return de.add(mt.key),Ae(Ke,mt.result,!1,{preventScrollReset:se});let{loaderData:Jt,errors:ds}=P4(A,Xe,ns,void 0,gt,Gt);dt(nt),A.navigation.state==="loading"&&nt>q?(Ss(L,"Expected pending action"),B&&B.abort(),We(A.navigation.location,{matches:Xe,loaderData:Jt,errors:ds,fetchers:new Map(A.fetchers)})):(De({errors:ds,loaderData:T4(A.loaderData,Jt,Xe,ds),fetchers:new Map(A.fetchers)}),H=!1)}async function we(be,ve,Ve,ct,Y,ie,je,se,le){let Ue=A.fetchers.get(be);lt(be,h0(le,Ue?Ue.data:void 0),{flushSync:je});let Ie=new AbortController,He=Af(s.history,Ve,Ie.signal);if(ie){let X=await Ps(ct,new URL(He.url).pathname,He.signal,be);if(X.type==="aborted")return;if(X.type==="error"){At(be,ve,X.error,{flushSync:je});return}else if(X.matches)ct=X.matches;else{At(be,ve,va(404,{pathname:Ve}),{flushSync:je});return}}let Me=ev(ct,Ve);M.set(be,Ie);let st=$,ut=nm(n,i,He,ct,Me,r,Y),xt=(await Ze(He,ut,Y,be))[Me.route.id];if(M.get(be)===Ie&&M.delete(be),!He.signal.aborted){if(W.has(be)){lt(be,hl(void 0));return}if(yu(xt))if(q>st){lt(be,hl(void 0));return}else{de.add(be),await Ae(He,xt,!1,{preventScrollReset:se});return}if(Yi(xt)){At(be,ve,xt.error);return}lt(be,hl(xt.data))}}async function Ae(be,ve,Ve,{submission:ct,fetcherSubmission:Y,preventScrollReset:ie,replace:je}={}){ve.response.headers.has("X-Remix-Revalidate")&&(H=!0);let se=ve.response.headers.get("Location");Ss(se,"Expected a Location header on the redirect Response"),se=E4(se,new URL(be.url),c);let le=Ag(A.location,se,{_isRedirect:!0});if(t){let ut=!1;if(ve.response.headers.has("X-Remix-Reload-Document"))ut=!0;else if(KS(se)){const wt=uC(se,!0);ut=wt.origin!==e.location.origin||La(wt.pathname,c)==null}if(ut){je?e.location.replace(se):e.location.assign(se);return}}B=null;let Ue=je===!0||ve.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:Ie,formAction:He,formEncType:Me}=A.navigation;!ct&&!Y&&Ie&&He&&Me&&(ct=D4(A.navigation));let st=ct||Y;if(VR.has(ve.response.status)&&st&&wi(st.formMethod))await Be(Ue,le,{submission:{...st,formAction:se},preventScrollReset:ie||C,enableViewTransition:Ve?U:void 0});else{let ut=Bw(le,ct);await Be(Ue,le,{overrideNavigation:ut,fetcherSubmission:Y,preventScrollReset:ie||C,enableViewTransition:Ve?U:void 0})}}async function Ze(be,ve,Ve,ct){let Y,ie={};try{Y=await rD(d,be,ve,ct,Ve,!1)}catch(je){return ve.filter(se=>se.shouldLoad).forEach(se=>{ie[se.route.id]={type:"error",error:je}}),ie}if(be.signal.aborted)return ie;for(let[je,se]of Object.entries(Y))if(hD(se)){let le=se.result;ie[je]={type:"redirect",response:oD(le,be,je,ve,c)}}else ie[je]=await aD(se);return ie}async function $e(be,ve,Ve,ct){let Y=Ze(Ve,be,ct,null),ie=Promise.all(ve.map(async le=>{if(le.matches&&le.match&&le.request&&le.controller){let Ie=(await Ze(le.request,le.matches,ct,le.key))[le.match.route.id];return{[le.key]:Ie}}else return Promise.resolve({[le.key]:{type:"error",error:va(404,{pathname:le.path})}})})),je=await Y,se=(await ie).reduce((le,Ue)=>Object.assign(le,Ue),{});return{loaderResults:je,fetcherResults:se}}function Qe(){H=!0,Ne.forEach((be,ve)=>{M.has(ve)&&D.add(ve),os(ve)})}function lt(be,ve,Ve={}){A.fetchers.set(be,ve),De({fetchers:new Map(A.fetchers)},{flushSync:(Ve&&Ve.flushSync)===!0})}function At(be,ve,Ve,ct={}){let Y=Rc(A.matches,ve);Dt(be),De({errors:{[Y.route.id]:Ve},fetchers:new Map(A.fetchers)},{flushSync:(ct&&ct.flushSync)===!0})}function Nt(be){return R.set(be,(R.get(be)||0)+1),W.has(be)&&W.delete(be),A.fetchers.get(be)||GR}function Lt(be,ve){os(be,ve==null?void 0:ve.reason),lt(be,hl(null))}function Dt(be){let ve=A.fetchers.get(be);M.has(be)&&!(ve&&ve.state==="loading"&&K.has(be))&&os(be),Ne.delete(be),K.delete(be),de.delete(be),W.delete(be),D.delete(be),A.fetchers.delete(be)}function yt(be){let ve=(R.get(be)||0)-1;ve<=0?(R.delete(be),W.add(be)):R.set(be,ve),De({fetchers:new Map(A.fetchers)})}function os(be,ve){let Ve=M.get(be);Ve&&(Ve.abort(ve),M.delete(be))}function me(be){for(let ve of be){let Ve=Nt(ve),ct=hl(Ve.data);A.fetchers.set(ve,ct)}}function Ce(){let be=[],ve=!1;for(let Ve of de){let ct=A.fetchers.get(Ve);Ss(ct,`Expected fetcher: ${Ve}`),ct.state==="loading"&&(de.delete(Ve),be.push(Ve),ve=!0)}return me(be),ve}function dt(be){let ve=[];for(let[Ve,ct]of K)if(ct<be){let Y=A.fetchers.get(Ve);Ss(Y,`Expected fetcher: ${Ve}`),Y.state==="loading"&&(os(Ve),K.delete(Ve),ve.push(Ve))}return me(ve),ve.length>0}function O(be,ve){let Ve=A.blockers.get(be)||u0;return Z.get(be)!==ve&&Z.set(be,ve),Ve}function _e(be){A.blockers.delete(be),Z.delete(be)}function at(be,ve){let Ve=A.blockers.get(be)||u0;Ss(Ve.state==="unblocked"&&ve.state==="blocked"||Ve.state==="blocked"&&ve.state==="blocked"||Ve.state==="blocked"&&ve.state==="proceeding"||Ve.state==="blocked"&&ve.state==="unblocked"||Ve.state==="proceeding"&&ve.state==="unblocked",`Invalid blocker state transition: ${Ve.state} -> ${ve.state}`);let ct=new Map(A.blockers);ct.set(be,ve),De({blockers:ct})}function St({currentLocation:be,nextLocation:ve,historyAction:Ve}){if(Z.size===0)return;Z.size>1&&Ir(!1,"A router only supports one blocker at a time");let ct=Array.from(Z.entries()),[Y,ie]=ct[ct.length-1],je=A.blockers.get(Y);if(!(je&&je.state==="proceeding")&&ie({currentLocation:be,nextLocation:ve,historyAction:Ve}))return Y}function Tt(be){let ve=va(404,{pathname:be}),Ve=l||o,{matches:ct,route:Y}=_y(Ve);return{notFoundMatches:ct,route:Y,error:ve}}function Pt(be,ve,Ve){if(p=be,w=ve,x=Ve||null,!S&&A.navigation===Ow){S=!0;let ct=Rt(A.location,A.matches);ct!=null&&De({restoreScrollPosition:ct})}return()=>{p=null,w=null,x=null}}function kt(be,ve){return x&&x(be,ve.map(ct=>_R(ct,A.loaderData)))||be.key}function jt(be,ve){if(p&&w){let Ve=kt(be,ve);p[Ve]=w()}}function Rt(be,ve){if(p){let Ve=kt(be,ve),ct=p[Ve];if(typeof ct=="number")return ct}return null}function Ot(be,ve,Ve){if(s.patchRoutesOnNavigation)if(be){if(Object.keys(be[0].params).length>0)return{active:!0,matches:Zy(ve,Ve,c,!0)}}else return{active:!0,matches:Zy(ve,Ve,c,!0)||[]};return{active:!1,matches:null}}async function Ps(be,ve,Ve,ct){if(!s.patchRoutesOnNavigation)return{type:"success",matches:be};let Y=be;for(;;){let ie=l==null,je=l||o,se=i;try{await s.patchRoutesOnNavigation({signal:Ve,path:ve,matches:Y,fetcherKey:ct,patch:(Ie,He)=>{Ve.aborted||j4(Ie,He,je,se,n,!1)}})}catch(Ie){return{type:"error",error:Ie,partialMatches:Y}}finally{ie&&!Ve.aborted&&(o=[...o])}if(Ve.aborted)return{type:"aborted"};let le=Ic(je,ve,c);if(le)return{type:"success",matches:le};let Ue=Zy(je,ve,c,!0);if(!Ue||Y.length===Ue.length&&Y.every((Ie,He)=>Ie.route.id===Ue[He].route.id))return{type:"success",matches:null};Y=Ue}}function Fs(be){i={},l=kg(be,n,void 0,i)}function Os(be,ve,Ve=!1){let ct=l==null;j4(be,ve,l||o,i,n,Ve),ct&&(o=[...o],De({}))}return E={get basename(){return c},get future(){return u},get state(){return A},get routes(){return o},get window(){return e},initialize:ye,subscribe:Ee,enableScrollRestoration:Pt,navigate:Je,fetch:xe,revalidate:it,createHref:be=>s.history.createHref(be),encodeLocation:be=>s.history.encodeLocation(be),getFetcher:Nt,resetFetcher:Lt,deleteFetcher:yt,dispose:Se,getBlocker:O,deleteBlocker:_e,patchRoutes:Os,_internalFetchControllers:M,_internalSetRoutes:Fs,_internalSetStateDoNotUseOrYouWillBreakYourApp(be){De(be)}},E}function JR(s){return s!=null&&("formData"in s&&s.formData!=null||"body"in s&&s.body!==void 0)}function aN(s,e,t,r,n,i){let o,l;if(n){o=[];for(let d of e)if(o.push(d),d.route.id===n){l=d;break}}else o=e,l=e[e.length-1];let c=l2(r||".",o2(o),La(s.pathname,t)||s.pathname,i==="path");if(r==null&&(c.search=s.search,c.hash=s.hash),(r==null||r===""||r===".")&&l){let d=JS(c.search);if(l.route.index&&!d)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!l.route.index&&d){let u=new URLSearchParams(c.search),h=u.getAll("index");u.delete("index"),h.filter(p=>p).forEach(p=>u.append("index",p));let m=u.toString();c.search=m?`?${m}`:""}}return t!=="/"&&(c.pathname=MR({basename:t,pathname:c.pathname})),Td(c)}function _4(s,e,t){if(!t||!JR(t))return{path:e};if(t.formMethod&&!fD(t.formMethod))return{path:e,error:va(405,{method:t.formMethod})};let r=()=>({path:e,error:va(400,{type:"invalid-body"})}),i=(t.formMethod||"get").toUpperCase(),o=_C(e);if(t.body!==void 0){if(t.formEncType==="text/plain"){if(!wi(i))return r();let h=typeof t.body=="string"?t.body:t.body instanceof FormData||t.body instanceof URLSearchParams?Array.from(t.body.entries()).reduce((m,[p,x])=>`${m}${p}=${x}
`,""):String(t.body);return{path:e,submission:{formMethod:i,formAction:o,formEncType:t.formEncType,formData:void 0,json:void 0,text:h}}}else if(t.formEncType==="application/json"){if(!wi(i))return r();try{let h=typeof t.body=="string"?JSON.parse(t.body):t.body;return{path:e,submission:{formMethod:i,formAction:o,formEncType:t.formEncType,formData:void 0,json:h,text:void 0}}}catch{return r()}}}Ss(typeof FormData=="function","FormData is not available in this environment");let l,c;if(t.formData)l=cN(t.formData),c=t.formData;else if(t.body instanceof FormData)l=cN(t.body),c=t.body;else if(t.body instanceof URLSearchParams)l=t.body,c=L4(l);else if(t.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(t.body),c=L4(l)}catch{return r()}let d={formMethod:i,formAction:o,formEncType:t&&t.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(wi(d.formMethod))return{path:e,submission:d};let u=zd(e);return s&&u.search&&JS(u.search)&&l.append("index",""),u.search=`?${l}`,{path:Td(u),submission:d}}function S4(s,e,t,r,n,i,o,l,c,d,u,h,m,p,x,w,S,b,v,N){var z;let j=N?Yi(N[1])?N[1].error:N[1].data:void 0,E=n.createURL(i.location),A=n.createURL(c),L;if(u&&i.errors){let H=Object.keys(i.errors)[0];L=o.findIndex(D=>D.route.id===H)}else if(N&&Yi(N[1])){let H=N[0];L=o.findIndex(D=>D.route.id===H)-1}let C=N?N[1].statusCode:void 0,B=C&&C>=400,U={currentUrl:E,currentParams:((z=i.matches[0])==null?void 0:z.params)||{},nextUrl:A,nextParams:o[0].params,...l,actionResult:j,actionStatus:C},P=o.map((H,D)=>{let{route:M}=H,$=null;if(L!=null&&D>L?$=!1:M.lazy?$=!0:XS(M)?u?$=oN(M,i.loaderData,i.errors):QR(i.loaderData,i.matches[D],H)&&($=!0):$=!1,$!==null)return lN(t,r,s,H,d,e,$);let q=B?!1:h||E.pathname+E.search===A.pathname+A.search||E.search!==A.search||ZR(i.matches[D],H),K={...U,defaultShouldRevalidate:q},de=l1(H,K);return lN(t,r,s,H,d,e,de,K)}),T=[];return x.forEach((H,D)=>{if(u||!o.some(W=>W.route.id===H.routeId)||p.has(D))return;let M=i.fetchers.get(D),$=M&&M.state!=="idle"&&M.data===void 0,q=Ic(S,H.path,b);if(!q){if(v&&$)return;T.push({key:D,routeId:H.routeId,path:H.path,matches:null,match:null,request:null,controller:null});return}if(w.has(D))return;let K=ev(q,H.path),de=new AbortController,Ne=Af(n,H.path,de.signal),R=null;if(m.has(D))m.delete(D),R=nm(t,r,Ne,q,K,d,e);else if($)h&&(R=nm(t,r,Ne,q,K,d,e));else{let W={...U,defaultShouldRevalidate:B?!1:h};l1(K,W)&&(R=nm(t,r,Ne,q,K,d,e,W))}R&&T.push({key:D,routeId:H.routeId,path:H.path,matches:R,match:K,request:Ne,controller:de})}),{dsMatches:P,revalidatingFetchers:T}}function XS(s){return s.loader!=null||s.middleware!=null&&s.middleware.length>0}function oN(s,e,t){if(s.lazy)return!0;if(!XS(s))return!1;let r=e!=null&&s.id in e,n=t!=null&&t[s.id]!==void 0;return!r&&n?!1:typeof s.loader=="function"&&s.loader.hydrate===!0?!0:!r&&!n}function QR(s,e,t){let r=!e||t.route.id!==e.route.id,n=!s.hasOwnProperty(t.route.id);return r||n}function ZR(s,e){let t=s.route.path;return s.pathname!==e.pathname||t!=null&&t.endsWith("*")&&s.params["*"]!==e.params["*"]}function l1(s,e){if(s.route.shouldRevalidate){let t=s.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}function j4(s,e,t,r,n,i){let o;if(s){let d=r[s];Ss(d,`No route found to patch children into: routeId = ${s}`),d.children||(d.children=[]),o=d.children}else o=t;let l=[],c=[];if(e.forEach(d=>{let u=o.find(h=>bC(d,h));u?c.push({existingRoute:u,newRoute:d}):l.push(d)}),l.length>0){let d=kg(l,n,[s||"_","patch",String((o==null?void 0:o.length)||"0")],r);o.push(...d)}if(i&&c.length>0)for(let d=0;d<c.length;d++){let{existingRoute:u,newRoute:h}=c[d],m=u,[p]=kg([h],n,[],{},!0);Object.assign(m,{element:p.element?p.element:m.element,errorElement:p.errorElement?p.errorElement:m.errorElement,hydrateFallbackElement:p.hydrateFallbackElement?p.hydrateFallbackElement:m.hydrateFallbackElement})}}function bC(s,e){return"id"in s&&"id"in e&&s.id===e.id?!0:s.index===e.index&&s.path===e.path&&s.caseSensitive===e.caseSensitive?(!s.children||s.children.length===0)&&(!e.children||e.children.length===0)?!0:s.children.every((t,r)=>{var n;return(n=e.children)==null?void 0:n.some(i=>bC(t,i))}):!1}var A4=new WeakMap,yC=({key:s,route:e,manifest:t,mapRouteProperties:r})=>{let n=t[e.id];if(Ss(n,"No route found in manifest"),!n.lazy||typeof n.lazy!="object")return;let i=n.lazy[s];if(!i)return;let o=A4.get(n);o||(o={},A4.set(n,o));let l=o[s];if(l)return l;let c=(async()=>{let d=yR(s),h=n[s]!==void 0&&s!=="hasErrorBoundary";if(d)Ir(!d,"Route property "+s+" is not a supported lazy route property. This property will be ignored."),o[s]=Promise.resolve();else if(h)Ir(!1,`Route "${n.id}" has a static property "${s}" defined. The lazy property will be ignored.`);else{let m=await i();m!=null&&(Object.assign(n,{[s]:m}),Object.assign(n,r(n)))}typeof n.lazy=="object"&&(n.lazy[s]=void 0,Object.values(n.lazy).every(m=>m===void 0)&&(n.lazy=void 0))})();return o[s]=c,c},k4=new WeakMap;function eD(s,e,t,r,n){let i=t[s.id];if(Ss(i,"No route found in manifest"),!s.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof s.lazy=="function"){let u=k4.get(i);if(u)return{lazyRoutePromise:u,lazyHandlerPromise:u};let h=(async()=>{Ss(typeof s.lazy=="function","No lazy route function found");let m=await s.lazy(),p={};for(let x in m){let w=m[x];if(w===void 0)continue;let S=wR(x),v=i[x]!==void 0&&x!=="hasErrorBoundary";S?Ir(!S,"Route property "+x+" is not a supported property to be returned from a lazy route function. This property will be ignored."):v?Ir(!v,`Route "${i.id}" has a static property "${x}" defined but its lazy function is also returning a value for this property. The lazy route property "${x}" will be ignored.`):p[x]=w}Object.assign(i,p),Object.assign(i,{...r(i),lazy:void 0})})();return k4.set(i,h),h.catch(()=>{}),{lazyRoutePromise:h,lazyHandlerPromise:h}}let o=Object.keys(s.lazy),l=[],c;for(let u of o){if(n&&n.includes(u))continue;let h=yC({key:u,route:s,manifest:t,mapRouteProperties:r});h&&(l.push(h),u===e&&(c=h))}let d=l.length>0?Promise.all(l).then(()=>{}):void 0;return d==null||d.catch(()=>{}),c==null||c.catch(()=>{}),{lazyRoutePromise:d,lazyHandlerPromise:c}}async function C4(s){let e=s.matches.filter(n=>n.shouldLoad),t={};return(await Promise.all(e.map(n=>n.resolve()))).forEach((n,i)=>{t[e[i].route.id]=n}),t}async function tD(s){return s.matches.some(e=>e.route.middleware)?vC(s,()=>C4(s)):C4(s)}function vC(s,e){return sD(s,e,r=>r,dD,t);function t(r,n,i){if(i)return Promise.resolve(Object.assign(i.value,{[n]:{type:"error",result:r}}));{let{matches:o}=s,l=Math.min(Math.max(o.findIndex(d=>d.route.id===n),0),Math.max(o.findIndex(d=>d.unstable_shouldCallHandler()),0)),c=Rc(o,o[l].route.id).route.id;return Promise.resolve({[c]:{type:"error",result:r}})}}}async function sD(s,e,t,r,n){let{matches:i,request:o,params:l,context:c}=s,d=i.flatMap(h=>h.route.middleware?h.route.middleware.map(m=>[h.route.id,m]):[]);return await wC({request:o,params:l,context:c},d,e,t,r,n)}async function wC(s,e,t,r,n,i,o=0){let{request:l}=s;if(l.signal.aborted)throw l.signal.reason??new Error(`Request aborted: ${l.method} ${l.url}`);let c=e[o];if(!c)return await t();let[d,u]=c,h,m=async()=>{if(h)throw new Error("You may only call `next()` once per middleware");try{return h={value:await wC(s,e,t,r,n,i,o+1)},h.value}catch(p){return h={value:await i(p,d,h)},h.value}};try{let p=await u(s,m),x=p!=null?r(p):void 0;return n(x)?x:h?x??h.value:(h={value:await m()},h.value)}catch(p){return await i(p,d,h)}}function NC(s,e,t,r,n){let i=yC({key:"middleware",route:r.route,manifest:e,mapRouteProperties:s}),o=eD(r.route,wi(t.method)?"action":"loader",e,s,n);return{middleware:i,route:o.lazyRoutePromise,handler:o.lazyHandlerPromise}}function lN(s,e,t,r,n,i,o,l=null){let c=!1,d=NC(s,e,t,r,n);return{...r,_lazyPromises:d,shouldLoad:o,unstable_shouldRevalidateArgs:l,unstable_shouldCallHandler(u){return c=!0,l?typeof u=="boolean"?l1(r,{...l,defaultShouldRevalidate:u}):l1(r,l):o},resolve(u){let{lazy:h,loader:m,middleware:p}=r.route,x=c||o||u&&!wi(t.method)&&(h||m),w=p&&p.length>0&&!m&&!h;return x&&!w?nD({request:t,match:r,lazyHandlerPromise:d==null?void 0:d.handler,lazyRoutePromise:d==null?void 0:d.route,handlerOverride:u,scopedContext:i}):Promise.resolve({type:"data",result:void 0})}}}function nm(s,e,t,r,n,i,o,l=null){return r.map(c=>c.route.id!==n.route.id?{...c,shouldLoad:!1,unstable_shouldRevalidateArgs:l,unstable_shouldCallHandler:()=>!1,_lazyPromises:NC(s,e,t,c,i),resolve:()=>Promise.resolve({type:"data",result:void 0})}:lN(s,e,t,c,i,o,!0,l))}async function rD(s,e,t,r,n,i){t.some(d=>{var u;return(u=d._lazyPromises)==null?void 0:u.middleware})&&await Promise.all(t.map(d=>{var u;return(u=d._lazyPromises)==null?void 0:u.middleware}));let o={request:e,params:t[0].params,context:n,matches:t},c=await s({...o,fetcherKey:r,runClientMiddleware:d=>{let u=o;return vC(u,()=>d({...u,fetcherKey:r,runClientMiddleware:()=>{throw new Error("Cannot call `runClientMiddleware()` from within an `runClientMiddleware` handler")}}))}});try{await Promise.all(t.flatMap(d=>{var u,h;return[(u=d._lazyPromises)==null?void 0:u.handler,(h=d._lazyPromises)==null?void 0:h.route]}))}catch{}return c}async function nD({request:s,match:e,lazyHandlerPromise:t,lazyRoutePromise:r,handlerOverride:n,scopedContext:i}){let o,l,c=wi(s.method),d=c?"action":"loader",u=h=>{let m,p=new Promise((S,b)=>m=b);l=()=>m(),s.signal.addEventListener("abort",l);let x=S=>typeof h!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${d}" [routeId: ${e.route.id}]`)):h({request:s,params:e.params,context:i},...S!==void 0?[S]:[]),w=(async()=>{try{return{type:"data",result:await(n?n(b=>x(b)):x())}}catch(S){return{type:"error",result:S}}})();return Promise.race([w,p])};try{let h=c?e.route.action:e.route.loader;if(t||r)if(h){let m,[p]=await Promise.all([u(h).catch(x=>{m=x}),t,r]);if(m!==void 0)throw m;o=p}else{await t;let m=c?e.route.action:e.route.loader;if(m)[o]=await Promise.all([u(m),r]);else if(d==="action"){let p=new URL(s.url),x=p.pathname+p.search;throw va(405,{method:s.method,pathname:x,routeId:e.route.id})}else return{type:"data",result:void 0}}else if(h)o=await u(h);else{let m=new URL(s.url),p=m.pathname+m.search;throw va(404,{pathname:p})}}catch(h){return{type:"error",result:h}}finally{l&&s.signal.removeEventListener("abort",l)}return o}async function iD(s){let e=s.headers.get("Content-Type");return e&&/\bapplication\/json\b/.test(e)?s.body==null?null:s.json():s.text()}async function aD(s){var r,n,i,o,l,c;let{result:e,type:t}=s;if(SC(e)){let d;try{d=await iD(e)}catch(u){return{type:"error",error:u}}return t==="error"?{type:"error",error:new o1(e.status,e.statusText,d),statusCode:e.status,headers:e.headers}:{type:"data",data:d,statusCode:e.status,headers:e.headers}}return t==="error"?R4(e)?e.data instanceof Error?{type:"error",error:e.data,statusCode:(r=e.init)==null?void 0:r.status,headers:(n=e.init)!=null&&n.headers?new Headers(e.init.headers):void 0}:{type:"error",error:new o1(((i=e.init)==null?void 0:i.status)||500,void 0,e.data),statusCode:Cg(e)?e.status:void 0,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}:{type:"error",error:e,statusCode:Cg(e)?e.status:void 0}:R4(e)?{type:"data",data:e.data,statusCode:(l=e.init)==null?void 0:l.status,headers:(c=e.init)!=null&&c.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function oD(s,e,t,r,n){let i=s.headers.get("Location");if(Ss(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!KS(i)){let o=r.slice(0,r.findIndex(l=>l.route.id===t)+1);i=aN(new URL(e.url),o,n,i),s.headers.set("Location",i)}return s}function E4(s,e,t){if(KS(s)){let r=s,n=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=La(n.pathname,t)!=null;if(n.origin===e.origin&&i)return n.pathname+n.search+n.hash}return s}function Af(s,e,t,r){let n=s.createURL(_C(e)).toString(),i={signal:t};if(r&&wi(r.formMethod)){let{formMethod:o,formEncType:l}=r;i.method=o.toUpperCase(),l==="application/json"?(i.headers=new Headers({"Content-Type":l}),i.body=JSON.stringify(r.json)):l==="text/plain"?i.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?i.body=cN(r.formData):i.body=r.formData}return new Request(n,i)}function cN(s){let e=new URLSearchParams;for(let[t,r]of s.entries())e.append(t,typeof r=="string"?r:r.name);return e}function L4(s){let e=new FormData;for(let[t,r]of s.entries())e.append(t,r);return e}function lD(s,e,t,r=!1,n=!1){let i={},o=null,l,c=!1,d={},u=t&&Yi(t[1])?t[1].error:void 0;return s.forEach(h=>{if(!(h.route.id in e))return;let m=h.route.id,p=e[m];if(Ss(!yu(p),"Cannot handle redirect results in processLoaderData"),Yi(p)){let x=p.error;if(u!==void 0&&(x=u,u=void 0),o=o||{},n)o[m]=x;else{let w=Rc(s,m);o[w.route.id]==null&&(o[w.route.id]=x)}r||(i[m]=xC),c||(c=!0,l=Cg(p.error)?p.error.status:500),p.headers&&(d[m]=p.headers)}else i[m]=p.data,p.statusCode&&p.statusCode!==200&&!c&&(l=p.statusCode),p.headers&&(d[m]=p.headers)}),u!==void 0&&t&&(o={[t[0]]:u},t[2]&&(i[t[2]]=void 0)),{loaderData:i,errors:o,statusCode:l||200,loaderHeaders:d}}function P4(s,e,t,r,n,i){let{loaderData:o,errors:l}=lD(e,t,r);return n.filter(c=>!c.matches||c.matches.some(d=>d.shouldLoad)).forEach(c=>{let{key:d,match:u,controller:h}=c;if(h&&h.signal.aborted)return;let m=i[d];if(Ss(m,"Did not find corresponding fetcher result"),Yi(m)){let p=Rc(s.matches,u==null?void 0:u.route.id);l&&l[p.route.id]||(l={...l,[p.route.id]:m.error}),s.fetchers.delete(d)}else if(yu(m))Ss(!1,"Unhandled fetcher revalidation redirect");else{let p=hl(m.data);s.fetchers.set(d,p)}}),{loaderData:o,errors:l}}function T4(s,e,t,r){let n=Object.entries(e).filter(([,i])=>i!==xC).reduce((i,[o,l])=>(i[o]=l,i),{});for(let i of t){let o=i.route.id;if(!e.hasOwnProperty(o)&&s.hasOwnProperty(o)&&i.route.loader&&(n[o]=s[o]),r&&r.hasOwnProperty(o))break}return n}function I4(s){return s?Yi(s[1])?{actionData:{}}:{actionData:{[s[0]]:s[1].data}}:{}}function Rc(s,e){return(e?s.slice(0,s.findIndex(r=>r.route.id===e)+1):[...s]).reverse().find(r=>r.route.hasErrorBoundary===!0)||s[0]}function _y(s){let e=s.length===1?s[0]:s.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function va(s,{pathname:e,routeId:t,method:r,type:n,message:i}={}){let o="Unknown Server Error",l="Unknown @remix-run/router error";return s===400?(o="Bad Request",r&&e&&t?l=`You made a ${r} request to "${e}" but did not provide a \`loader\` for route "${t}", so there is no way to handle the request.`:n==="invalid-body"&&(l="Unable to encode submission body")):s===403?(o="Forbidden",l=`Route "${t}" does not match URL "${e}"`):s===404?(o="Not Found",l=`No route matches URL "${e}"`):s===405&&(o="Method Not Allowed",r&&e&&t?l=`You made a ${r.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${t}", so there is no way to handle the request.`:r&&(l=`Invalid request method "${r.toUpperCase()}"`)),new o1(s||500,o,new Error(l),!0)}function Sy(s){let e=Object.entries(s);for(let t=e.length-1;t>=0;t--){let[r,n]=e[t];if(yu(n))return{key:r,result:n}}}function _C(s){let e=typeof s=="string"?zd(s):s;return Td({...e,hash:""})}function cD(s,e){return s.pathname!==e.pathname||s.search!==e.search?!1:s.hash===""?e.hash!=="":s.hash===e.hash?!0:e.hash!==""}function dD(s){return s!=null&&typeof s=="object"&&Object.entries(s).every(([e,t])=>typeof e=="string"&&uD(t))}function uD(s){return s!=null&&typeof s=="object"&&"type"in s&&"result"in s&&(s.type==="data"||s.type==="error")}function hD(s){return SC(s.result)&&WR.has(s.result.status)}function Yi(s){return s.type==="error"}function yu(s){return(s&&s.type)==="redirect"}function R4(s){return typeof s=="object"&&s!=null&&"type"in s&&"data"in s&&"init"in s&&s.type==="DataWithResponseInit"}function SC(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.headers=="object"&&typeof s.body<"u"}function fD(s){return HR.has(s.toUpperCase())}function wi(s){return UR.has(s.toUpperCase())}function JS(s){return new URLSearchParams(s).getAll("index").some(e=>e==="")}function ev(s,e){let t=typeof e=="string"?zd(e).search:e.search;if(s[s.length-1].route.index&&JS(t||""))return s[s.length-1];let r=mC(s);return r[r.length-1]}function D4(s){let{formMethod:e,formAction:t,formEncType:r,text:n,formData:i,json:o}=s;if(!(!e||!t||!r)){if(n!=null)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:void 0,text:n};if(i!=null)return{formMethod:e,formAction:t,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:o,text:void 0}}}function Bw(s,e){return e?{state:"loading",location:s,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:s,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function mD(s,e){return{state:"submitting",location:s,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function h0(s,e){return s?{state:"loading",formMethod:s.formMethod,formAction:s.formAction,formEncType:s.formEncType,formData:s.formData,json:s.json,text:s.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function pD(s,e){return{state:"submitting",formMethod:s.formMethod,formAction:s.formAction,formEncType:s.formEncType,formData:s.formData,json:s.json,text:s.text,data:e?e.data:void 0}}function hl(s){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:s}}function gD(s,e){try{let t=s.sessionStorage.getItem(gC);if(t){let r=JSON.parse(t);for(let[n,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(n,new Set(i||[]))}}catch{}}function xD(s,e){if(e.size>0){let t={};for(let[r,n]of e)t[r]=[...n];try{s.sessionStorage.setItem(gC,JSON.stringify(t))}catch(r){Ir(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function bD(){let s,e,t=new Promise((r,n)=>{s=async i=>{r(i);try{await t}catch{}},e=async i=>{n(i);try{await t}catch{}}});return{promise:t,resolve:s,reject:e}}var Hh=ne.createContext(null);Hh.displayName="DataRouter";var pb=ne.createContext(null);pb.displayName="DataRouterState";ne.createContext(!1);var QS=ne.createContext({isTransitioning:!1});QS.displayName="ViewTransition";var jC=ne.createContext(new Map);jC.displayName="Fetchers";var yD=ne.createContext(null);yD.displayName="Await";var mo=ne.createContext(null);mo.displayName="Navigation";var c2=ne.createContext(null);c2.displayName="Location";var el=ne.createContext({outlet:null,matches:[],isDataRoute:!1});el.displayName="Route";var ZS=ne.createContext(null);ZS.displayName="RouteError";function vD(s,{relative:e}={}){Ss(jp(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=ne.useContext(mo),{hash:n,pathname:i,search:o}=gb(s,{relative:e}),l=i;return t!=="/"&&(l=i==="/"?t:Xo([t,i])),r.createHref({pathname:l,search:o,hash:n})}function jp(){return ne.useContext(c2)!=null}function Ud(){return Ss(jp(),"useLocation() may be used only in the context of a <Router> component."),ne.useContext(c2).location}var AC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function kC(s){ne.useContext(mo).static||ne.useLayoutEffect(s)}function ej(){let{isDataRoute:s}=ne.useContext(el);return s?ID():wD()}function wD(){Ss(jp(),"useNavigate() may be used only in the context of a <Router> component.");let s=ne.useContext(Hh),{basename:e,navigator:t}=ne.useContext(mo),{matches:r}=ne.useContext(el),{pathname:n}=Ud(),i=JSON.stringify(o2(r)),o=ne.useRef(!1);return kC(()=>{o.current=!0}),ne.useCallback((c,d={})=>{if(Ir(o.current,AC),!o.current)return;if(typeof c=="number"){t.go(c);return}let u=l2(c,JSON.parse(i),n,d.relative==="path");s==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:Xo([e,u.pathname])),(d.replace?t.replace:t.push)(u,d.state,d)},[e,t,i,n,s])}ne.createContext(null);function gb(s,{relative:e}={}){let{matches:t}=ne.useContext(el),{pathname:r}=Ud(),n=JSON.stringify(o2(t));return ne.useMemo(()=>l2(s,JSON.parse(n),r,e==="path"),[s,n,r,e])}function ND(s,e,t,r,n){Ss(jp(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=ne.useContext(mo),{matches:o}=ne.useContext(el),l=o[o.length-1],c=l?l.params:{},d=l?l.pathname:"/",u=l?l.pathnameBase:"/",h=l&&l.route;{let v=h&&h.path||"";CC(d,!h||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let m=Ud(),p;p=m;let x=p.pathname||"/",w=x;if(u!=="/"){let v=u.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(v.length).join("/")}let S=Ic(s,{pathname:w});return Ir(h||S!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Ir(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),kD(S&&S.map(v=>Object.assign({},v,{params:Object.assign({},c,v.params),pathname:Xo([u,i.encodeLocation?i.encodeLocation(v.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:Xo([u,i.encodeLocation?i.encodeLocation(v.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathnameBase])})),o,t,r,n)}function _D(){let s=TD(),e=Cg(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,r="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",s),o=ne.createElement(ne.Fragment,null,ne.createElement("p",null,"💿 Hey developer 👋"),ne.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ne.createElement("code",{style:i},"ErrorBoundary")," or"," ",ne.createElement("code",{style:i},"errorElement")," prop on your route.")),ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},e),t?ne.createElement("pre",{style:n},t):null,o)}var SD=ne.createElement(_D,null),jD=class extends ne.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.unstable_onError?this.props.unstable_onError(s,e):console.error("React Router caught the following error during render",s)}render(){return this.state.error!==void 0?ne.createElement(el.Provider,{value:this.props.routeContext},ne.createElement(ZS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function AD({routeContext:s,match:e,children:t}){let r=ne.useContext(Hh);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),ne.createElement(el.Provider,{value:s},t)}function kD(s,e=[],t=null,r=null,n=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let i=s,o=t==null?void 0:t.errors;if(o!=null){let d=i.findIndex(u=>u.route.id&&(o==null?void 0:o[u.route.id])!==void 0);Ss(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,c=-1;if(t)for(let d=0;d<i.length;d++){let u=i[d];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(c=d),u.route.id){let{loaderData:h,errors:m}=t,p=u.route.loader&&!h.hasOwnProperty(u.route.id)&&(!m||m[u.route.id]===void 0);if(u.route.lazy||p){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((d,u,h)=>{let m,p=!1,x=null,w=null;t&&(m=o&&u.route.id?o[u.route.id]:void 0,x=u.route.errorElement||SD,l&&(c<0&&h===0?(CC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,w=null):c===h&&(p=!0,w=u.route.hydrateFallbackElement||null)));let S=e.concat(i.slice(0,h+1)),b=()=>{let v;return m?v=x:p?v=w:u.route.Component?v=ne.createElement(u.route.Component,null):u.route.element?v=u.route.element:v=d,ne.createElement(AD,{match:u,routeContext:{outlet:d,matches:S,isDataRoute:t!=null},children:v})};return t&&(u.route.ErrorBoundary||u.route.errorElement||h===0)?ne.createElement(jD,{location:t.location,revalidation:t.revalidation,component:x,error:m,children:b(),routeContext:{outlet:null,matches:S,isDataRoute:!0},unstable_onError:r}):b()},null)}function tj(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CD(s){let e=ne.useContext(Hh);return Ss(e,tj(s)),e}function ED(s){let e=ne.useContext(pb);return Ss(e,tj(s)),e}function LD(s){let e=ne.useContext(el);return Ss(e,tj(s)),e}function sj(s){let e=LD(s),t=e.matches[e.matches.length-1];return Ss(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function PD(){return sj("useRouteId")}function TD(){var r;let s=ne.useContext(ZS),e=ED("useRouteError"),t=sj("useRouteError");return s!==void 0?s:(r=e.errors)==null?void 0:r[t]}function ID(){let{router:s}=CD("useNavigate"),e=sj("useNavigate"),t=ne.useRef(!1);return kC(()=>{t.current=!0}),ne.useCallback(async(n,i={})=>{Ir(t.current,AC),t.current&&(typeof n=="number"?s.navigate(n):await s.navigate(n,{fromRouteId:e,...i}))},[s,e])}var M4={};function CC(s,e,t){!e&&!M4[s]&&(M4[s]=!0,Ir(!1,t))}var F4={};function O4(s,e){!s&&!F4[e]&&(F4[e]=!0,console.warn(e))}function RD(s){let e={hasErrorBoundary:s.hasErrorBoundary||s.ErrorBoundary!=null||s.errorElement!=null};return s.Component&&(s.element&&Ir(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:ne.createElement(s.Component),Component:void 0})),s.HydrateFallback&&(s.hydrateFallbackElement&&Ir(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:ne.createElement(s.HydrateFallback),HydrateFallback:void 0})),s.ErrorBoundary&&(s.errorElement&&Ir(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:ne.createElement(s.ErrorBoundary),ErrorBoundary:void 0})),e}var DD=["HydrateFallback","hydrateFallbackElement"],MD=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",t(r))}})}};function FD({router:s,flushSync:e,unstable_onError:t}){let[r,n]=ne.useState(s.state),[i,o]=ne.useState(),[l,c]=ne.useState({isTransitioning:!1}),[d,u]=ne.useState(),[h,m]=ne.useState(),[p,x]=ne.useState(),w=ne.useRef(new Map),S=ne.useCallback(E=>{n(A=>(E.errors&&t&&Object.entries(E.errors).forEach(([L,C])=>{var B;((B=A.errors)==null?void 0:B[L])!==C&&t(C)}),E))},[t]),b=ne.useCallback((E,{deletedFetchers:A,flushSync:L,viewTransitionOpts:C})=>{E.fetchers.forEach((U,P)=>{U.data!==void 0&&w.current.set(P,U.data)}),A.forEach(U=>w.current.delete(U)),O4(L===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let B=s.window!=null&&s.window.document!=null&&typeof s.window.document.startViewTransition=="function";if(O4(C==null||B,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!C||!B){e&&L?e(()=>S(E)):ne.startTransition(()=>S(E));return}if(e&&L){e(()=>{h&&(d&&d.resolve(),h.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:C.currentLocation,nextLocation:C.nextLocation})});let U=s.window.document.startViewTransition(()=>{e(()=>S(E))});U.finished.finally(()=>{e(()=>{u(void 0),m(void 0),o(void 0),c({isTransitioning:!1})})}),e(()=>m(U));return}h?(d&&d.resolve(),h.skipTransition(),x({state:E,currentLocation:C.currentLocation,nextLocation:C.nextLocation})):(o(E),c({isTransitioning:!0,flushSync:!1,currentLocation:C.currentLocation,nextLocation:C.nextLocation}))},[s.window,e,h,d,S]);ne.useLayoutEffect(()=>s.subscribe(b),[s,b]),ne.useEffect(()=>{l.isTransitioning&&!l.flushSync&&u(new MD)},[l]),ne.useEffect(()=>{if(d&&i&&s.window){let E=i,A=d.promise,L=s.window.document.startViewTransition(async()=>{ne.startTransition(()=>S(E)),await A});L.finished.finally(()=>{u(void 0),m(void 0),o(void 0),c({isTransitioning:!1})}),m(L)}},[i,d,s.window,S]),ne.useEffect(()=>{d&&i&&r.location.key===i.location.key&&d.resolve()},[d,h,r.location,i]),ne.useEffect(()=>{!l.isTransitioning&&p&&(o(p.state),c({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),x(void 0))},[l.isTransitioning,p]);let v=ne.useMemo(()=>({createHref:s.createHref,encodeLocation:s.encodeLocation,go:E=>s.navigate(E),push:(E,A,L)=>s.navigate(E,{state:A,preventScrollReset:L==null?void 0:L.preventScrollReset}),replace:(E,A,L)=>s.navigate(E,{replace:!0,state:A,preventScrollReset:L==null?void 0:L.preventScrollReset})}),[s]),N=s.basename||"/",j=ne.useMemo(()=>({router:s,navigator:v,static:!1,basename:N,unstable_onError:t}),[s,v,N,t]);return ne.createElement(ne.Fragment,null,ne.createElement(Hh.Provider,{value:j},ne.createElement(pb.Provider,{value:r},ne.createElement(jC.Provider,{value:w.current},ne.createElement(QS.Provider,{value:l},ne.createElement($D,{basename:N,location:r.location,navigationType:r.historyAction,navigator:v},ne.createElement(OD,{routes:s.routes,future:s.future,state:r,unstable_onError:t})))))),null)}var OD=ne.memo(BD);function BD({routes:s,future:e,state:t,unstable_onError:r}){return ND(s,void 0,t,r,e)}function Eg({to:s,replace:e,state:t,relative:r}){Ss(jp(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=ne.useContext(mo);Ir(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=ne.useContext(el),{pathname:o}=Ud(),l=ej(),c=l2(s,o2(i),o,r==="path"),d=JSON.stringify(c);return ne.useEffect(()=>{l(JSON.parse(d),{replace:e,state:t,relative:r})},[l,d,r,e,t]),null}function $D({basename:s="/",children:e=null,location:t,navigationType:r="POP",navigator:n,static:i=!1}){Ss(!jp(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=s.replace(/^\/*/,"/"),l=ne.useMemo(()=>({basename:o,navigator:n,static:i,future:{}}),[o,n,i]);typeof t=="string"&&(t=zd(t));let{pathname:c="/",search:d="",hash:u="",state:h=null,key:m="default"}=t,p=ne.useMemo(()=>{let x=La(c,o);return x==null?null:{location:{pathname:x,search:d,hash:u,state:h,key:m},navigationType:r}},[o,c,d,u,h,m,r]);return Ir(p!=null,`<Router basename="${o}"> is not able to match the URL "${c}${d}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:ne.createElement(mo.Provider,{value:l},ne.createElement(c2.Provider,{children:e,value:p}))}var tv="get",sv="application/x-www-form-urlencoded";function d2(s){return s!=null&&typeof s.tagName=="string"}function zD(s){return d2(s)&&s.tagName.toLowerCase()==="button"}function UD(s){return d2(s)&&s.tagName.toLowerCase()==="form"}function qD(s){return d2(s)&&s.tagName.toLowerCase()==="input"}function HD(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function WD(s,e){return s.button===0&&(!e||e==="_self")&&!HD(s)}var jy=null;function VD(){if(jy===null)try{new FormData(document.createElement("form"),0),jy=!1}catch{jy=!0}return jy}var GD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function $w(s){return s!=null&&!GD.has(s)?(Ir(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${sv}"`),null):s}function YD(s,e){let t,r,n,i,o;if(UD(s)){let l=s.getAttribute("action");r=l?La(l,e):null,t=s.getAttribute("method")||tv,n=$w(s.getAttribute("enctype"))||sv,i=new FormData(s)}else if(zD(s)||qD(s)&&(s.type==="submit"||s.type==="image")){let l=s.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=s.getAttribute("formaction")||l.getAttribute("action");if(r=c?La(c,e):null,t=s.getAttribute("formmethod")||l.getAttribute("method")||tv,n=$w(s.getAttribute("formenctype"))||$w(l.getAttribute("enctype"))||sv,i=new FormData(l,s),!VD()){let{name:d,type:u,value:h}=s;if(u==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,h)}}else{if(d2(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=tv,r=null,n=sv,o=s}return i&&n==="text/plain"&&(o=i,i=void 0),{action:r,method:t.toLowerCase(),encType:n,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function rj(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function KD(s,e,t){let r=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&La(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function XD(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function JD(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function QD(s,e,t){let r=await Promise.all(s.map(async n=>{let i=e.routes[n.route.id];if(i){let o=await XD(i,t);return o.links?o.links():[]}return[]}));return sM(r.flat(1).filter(JD).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function B4(s,e,t,r,n,i){let o=(c,d)=>t[d]?c.route.id!==t[d].route.id:!0,l=(c,d)=>{var u;return t[d].pathname!==c.pathname||((u=t[d].route.path)==null?void 0:u.endsWith("*"))&&t[d].params["*"]!==c.params["*"]};return i==="assets"?e.filter((c,d)=>o(c,d)||l(c,d)):i==="data"?e.filter((c,d)=>{var h;let u=r.routes[c.route.id];if(!u||!u.hasLoader)return!1;if(o(c,d)||l(c,d))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((h=t[0])==null?void 0:h.params)||{},nextUrl:new URL(s,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function ZD(s,e,{includeHydrateFallback:t}={}){return eM(s.map(r=>{let n=e.routes[r.route.id];if(!n)return[];let i=[n.module];return n.clientActionModule&&(i=i.concat(n.clientActionModule)),n.clientLoaderModule&&(i=i.concat(n.clientLoaderModule)),t&&n.hydrateFallbackModule&&(i=i.concat(n.hydrateFallbackModule)),n.imports&&(i=i.concat(n.imports)),i}).flat(1))}function eM(s){return[...new Set(s)]}function tM(s){let e={},t=Object.keys(s).sort();for(let r of t)e[r]=s[r];return e}function sM(s,e){let t=new Set;return new Set(e),s.reduce((r,n)=>{let i=JSON.stringify(tM(n));return t.has(i)||(t.add(i),r.push({key:i,link:n})),r},[])}function EC(){let s=ne.useContext(Hh);return rj(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function rM(){let s=ne.useContext(pb);return rj(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var nj=ne.createContext(void 0);nj.displayName="FrameworkContext";function LC(){let s=ne.useContext(nj);return rj(s,"You must render this element inside a <HydratedRouter> element"),s}function nM(s,e){let t=ne.useContext(nj),[r,n]=ne.useState(!1),[i,o]=ne.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:h}=e,m=ne.useRef(null);ne.useEffect(()=>{if(s==="render"&&o(!0),s==="viewport"){let w=b=>{b.forEach(v=>{o(v.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return m.current&&S.observe(m.current),()=>{S.disconnect()}}},[s]),ne.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let p=()=>{n(!0)},x=()=>{n(!1),o(!1)};return t?s!=="intent"?[i,m,{}]:[i,m,{onFocus:f0(l,p),onBlur:f0(c,x),onMouseEnter:f0(d,p),onMouseLeave:f0(u,x),onTouchStart:f0(h,p)}]:[!1,m,{}]}function f0(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function iM({page:s,...e}){let{router:t}=EC(),r=ne.useMemo(()=>Ic(t.routes,s,t.basename),[t.routes,s,t.basename]);return r?ne.createElement(oM,{page:s,matches:r,...e}):null}function aM(s){let{manifest:e,routeModules:t}=LC(),[r,n]=ne.useState([]);return ne.useEffect(()=>{let i=!1;return QD(s,e,t).then(o=>{i||n(o)}),()=>{i=!0}},[s,e,t]),r}function oM({page:s,matches:e,...t}){let r=Ud(),{manifest:n,routeModules:i}=LC(),{basename:o}=EC(),{loaderData:l,matches:c}=rM(),d=ne.useMemo(()=>B4(s,e,c,n,r,"data"),[s,e,c,n,r]),u=ne.useMemo(()=>B4(s,e,c,n,r,"assets"),[s,e,c,n,r]),h=ne.useMemo(()=>{if(s===r.pathname+r.search+r.hash)return[];let x=new Set,w=!1;if(e.forEach(b=>{var N;let v=n.routes[b.route.id];!v||!v.hasLoader||(!d.some(j=>j.route.id===b.route.id)&&b.route.id in l&&((N=i[b.route.id])!=null&&N.shouldRevalidate)||v.hasClientLoader?w=!0:x.add(b.route.id))}),x.size===0)return[];let S=KD(s,o,"data");return w&&x.size>0&&S.searchParams.set("_routes",e.filter(b=>x.has(b.route.id)).map(b=>b.route.id).join(",")),[S.pathname+S.search]},[o,l,r,n,d,e,s,i]),m=ne.useMemo(()=>ZD(u,n),[u,n]),p=aM(u);return ne.createElement(ne.Fragment,null,h.map(x=>ne.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),m.map(x=>ne.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),p.map(({key:x,link:w})=>ne.createElement("link",{key:x,nonce:t.nonce,...w})))}function lM(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var PC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{PC&&(window.__reactRouterVersion="7.9.4")}catch{}function cM(s,e){return XR({basename:e==null?void 0:e.basename,getContext:e==null?void 0:e.getContext,future:e==null?void 0:e.future,history:pR({window:e==null?void 0:e.window}),hydrationData:dM(),routes:s,mapRouteProperties:RD,hydrationRouteProperties:DD,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function dM(){let s=window==null?void 0:window.__staticRouterHydrationData;return s&&s.errors&&(s={...s,errors:uM(s.errors)}),s}function uM(s){if(!s)return null;let e=Object.entries(s),t={};for(let[r,n]of e)if(n&&n.__type==="RouteErrorResponse")t[r]=new o1(n.status,n.statusText,n.data,n.internal===!0);else if(n&&n.__type==="Error"){if(n.__subType){let i=window[n.__subType];if(typeof i=="function")try{let o=new i(n.message);o.stack="",t[r]=o}catch{}}if(t[r]==null){let i=new Error(n.message);i.stack="",t[r]=i}}else t[r]=n;return t}var TC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IC=ne.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:n,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:h,...m},p){let{basename:x}=ne.useContext(mo),w=typeof d=="string"&&TC.test(d),S,b=!1;if(typeof d=="string"&&w&&(S=d,PC))try{let B=new URL(window.location.href),U=d.startsWith("//")?new URL(B.protocol+d):new URL(d),P=La(U.pathname,x);U.origin===B.origin&&P!=null?d=P+U.search+U.hash:b=!0}catch{Ir(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let v=vD(d,{relative:n}),[N,j,E]=nM(r,m),A=pM(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:n,viewTransition:h});function L(B){e&&e(B),B.defaultPrevented||A(B)}let C=ne.createElement("a",{...m,...E,href:S||v,onClick:b||i?e:L,ref:lM(p,j),target:c,"data-discover":!w&&t==="render"?"true":void 0});return N&&!w?ne.createElement(ne.Fragment,null,C,ne.createElement(iM,{page:v})):C});IC.displayName="Link";var hM=ne.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:n=!1,style:i,to:o,viewTransition:l,children:c,...d},u){let h=gb(o,{relative:d.relative}),m=Ud(),p=ne.useContext(pb),{navigator:x,basename:w}=ne.useContext(mo),S=p!=null&&vM(h)&&l===!0,b=x.encodeLocation?x.encodeLocation(h).pathname:h.pathname,v=m.pathname,N=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(v=v.toLowerCase(),N=N?N.toLowerCase():null,b=b.toLowerCase()),N&&w&&(N=La(N,w)||N);const j=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let E=v===b||!n&&v.startsWith(b)&&v.charAt(j)==="/",A=N!=null&&(N===b||!n&&N.startsWith(b)&&N.charAt(b.length)==="/"),L={isActive:E,isPending:A,isTransitioning:S},C=E?e:void 0,B;typeof r=="function"?B=r(L):B=[r,E?"active":null,A?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let U=typeof i=="function"?i(L):i;return ne.createElement(IC,{...d,"aria-current":C,className:B,ref:u,style:U,to:o,viewTransition:l},typeof c=="function"?c(L):c)});hM.displayName="NavLink";var fM=ne.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:n,state:i,method:o=tv,action:l,onSubmit:c,relative:d,preventScrollReset:u,viewTransition:h,...m},p)=>{let x=bM(),w=yM(l,{relative:d}),S=o.toLowerCase()==="get"?"get":"post",b=typeof l=="string"&&TC.test(l),v=N=>{if(c&&c(N),N.defaultPrevented)return;N.preventDefault();let j=N.nativeEvent.submitter,E=(j==null?void 0:j.getAttribute("formmethod"))||o;x(j||N.currentTarget,{fetcherKey:e,method:E,navigate:t,replace:n,state:i,relative:d,preventScrollReset:u,viewTransition:h})};return ne.createElement("form",{ref:p,method:S,action:w,onSubmit:r?c:v,...m,"data-discover":!b&&s==="render"?"true":void 0})});fM.displayName="Form";function mM(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function RC(s){let e=ne.useContext(Hh);return Ss(e,mM(s)),e}function pM(s,{target:e,replace:t,state:r,preventScrollReset:n,relative:i,viewTransition:o}={}){let l=ej(),c=Ud(),d=gb(s,{relative:i});return ne.useCallback(u=>{if(WD(u,e)){u.preventDefault();let h=t!==void 0?t:Td(c)===Td(d);l(s,{replace:h,state:r,preventScrollReset:n,relative:i,viewTransition:o})}},[c,l,d,t,r,e,s,n,i,o])}var gM=0,xM=()=>`__${String(++gM)}__`;function bM(){let{router:s}=RC("useSubmit"),{basename:e}=ne.useContext(mo),t=PD();return ne.useCallback(async(r,n={})=>{let{action:i,method:o,encType:l,formData:c,body:d}=YD(r,e);if(n.navigate===!1){let u=n.fetcherKey||xM();await s.fetch(u,t,n.action||i,{preventScrollReset:n.preventScrollReset,formData:c,body:d,formMethod:n.method||o,formEncType:n.encType||l,flushSync:n.flushSync})}else await s.navigate(n.action||i,{preventScrollReset:n.preventScrollReset,formData:c,body:d,formMethod:n.method||o,formEncType:n.encType||l,replace:n.replace,state:n.state,fromRouteId:t,flushSync:n.flushSync,viewTransition:n.viewTransition})},[s,e,t])}function yM(s,{relative:e}={}){let{basename:t}=ne.useContext(mo),r=ne.useContext(el);Ss(r,"useFormAction must be used inside a RouteContext");let[n]=r.matches.slice(-1),i={...gb(s||".",{relative:e})},o=Ud();if(s==null){i.search=o.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(u=>u==="")){l.delete("index"),c.filter(h=>h).forEach(h=>l.append("index",h));let u=l.toString();i.search=u?`?${u}`:""}}return(!s||s===".")&&n.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Xo([t,i.pathname])),Td(i)}function vM(s,{relative:e}={}){let t=ne.useContext(QS);Ss(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=RC("useViewTransitionState"),n=gb(s,{relative:e});if(!t.isTransitioning)return!1;let i=La(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=La(t.nextLocation.pathname,r)||t.nextLocation.pathname;return a1(n.pathname,o)!=null||a1(n.pathname,i)!=null}function wM(s){return ne.createElement(FD,{flushSync:lC.flushSync,...s})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var NM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _M=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),as=(s,e)=>{const t=ne.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>ne.createElement("svg",{ref:u,...NM,width:n,height:n,stroke:r,strokeWidth:o?Number(i)*24/Number(n):i,className:["lucide",`lucide-${_M(s)}`,l].join(" "),...d},[...e.map(([h,m])=>ne.createElement(h,m)),...Array.isArray(c)?c:[c]]));return t.displayName=`${s}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SM=as("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=as("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=as("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=as("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z4=as("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c1=as("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kM=as("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=as("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CM=as("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EM=as("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LM=as("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=as("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PM=as("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dc=as("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=as("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TM=as("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IM=as("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dN=as("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rc=as("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=as("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=as("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RM=as("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DM=as("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rv=as("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uN=as("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MM=as("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DC=as("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d1=as("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FM=as("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OM=as("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nv=as("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MC=as("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=as("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ij=as("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=as("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=as("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iv=as("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=as("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q0=as("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hN=as("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=as("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vp=as("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=as("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u1=as("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=as("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=as("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=as("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=as("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=as("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),HM="modulepreload",WM=function(s){return"/"+s},q4={},nc=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(t.map(c=>{if(c=WM(c),c in q4)return;q4[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":HM,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,p)=>{h.addEventListener("load",m),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},VM=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>nc(async()=>{const{default:r}=await Promise.resolve().then(()=>Ap);return{default:r}},[]).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class aj extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class GM extends aj{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class H4 extends aj{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class W4 extends aj{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var fN;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(fN||(fN={}));var YM=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((r=r.apply(s,e||[])).next())})};class KM{constructor(e,{headers:t={},customFetch:r,region:n=fN.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=VM(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return YM(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=t;let l={},{region:c}=t;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:u}).catch(w=>{throw new GM(w)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new H4(h);if(!h.ok)throw new W4(h);let p=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),x;return p==="application/json"?x=yield h.json():p==="application/octet-stream"?x=yield h.blob():p==="text/event-stream"?x=h:p==="multipart/form-data"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof W4||n instanceof H4?n.context:void 0}}})}}var _i={},oj={},u2={},xb={},h2={},f2={},XM=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},wp=XM();const JM=wp.fetch,FC=wp.fetch.bind(wp),OC=wp.Headers,QM=wp.Request,ZM=wp.Response,Ap=Object.freeze(Object.defineProperty({__proto__:null,Headers:OC,Request:QM,Response:ZM,default:FC,fetch:JM},Symbol.toStringTag,{value:"Module"})),e7=K3(Ap);var m2={};Object.defineProperty(m2,"__esModule",{value:!0});let t7=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};m2.default=t7;var BC=si&&si.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(f2,"__esModule",{value:!0});const s7=BC(e7),r7=BC(m2);let n7=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=s7.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let n=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c,d;let u=null,h=null,m=null,p=i.status,x=i.statusText;if(i.ok){if(this.method!=="HEAD"){const v=await i.text();v===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?h=v:h=JSON.parse(v))}const S=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),b=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");S&&b&&b.length>1&&(m=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,m=null,p=406,x="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const S=await i.text();try{u=JSON.parse(S),Array.isArray(u)&&i.status===404&&(h=[],u=null,p=200,x="OK")}catch{i.status===404&&S===""?(p=204,x="No Content"):u={message:S}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,p=200,x="OK"),u&&this.shouldThrowOnError)throw new r7.default(u)}return{error:u,data:h,count:m,status:p,statusText:x}});return this.shouldThrowOnError||(n=n.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}};f2.default=n7;var i7=si&&si.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(h2,"__esModule",{value:!0});const a7=i7(f2);let o7=class extends a7.default{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};h2.default=o7;var l7=si&&si.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(xb,"__esModule",{value:!0});const c7=l7(h2);let d7=class extends c7.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};xb.default=d7;var u7=si&&si.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(u2,"__esModule",{value:!0});const m0=u7(xb);let h7=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){const n=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new m0.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new m0.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new m0.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:t}={}){var r;const n="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new m0.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new m0.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};u2.default=h7;var $C=si&&si.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(oj,"__esModule",{value:!0});const f7=$C(u2),m7=$C(xb);let p7=class zC{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new f7.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new zC(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let d;r||n?(l=r?"HEAD":"GET",Object.entries(t).filter(([h,m])=>m!==void 0).map(([h,m])=>[h,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([h,m])=>{c.searchParams.append(h,m)})):(l="POST",d=t);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new m7.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};oj.default=p7;var kp=si&&si.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(_i,"__esModule",{value:!0});_i.PostgrestError=_i.PostgrestBuilder=_i.PostgrestTransformBuilder=_i.PostgrestFilterBuilder=_i.PostgrestQueryBuilder=_i.PostgrestClient=void 0;const UC=kp(oj);_i.PostgrestClient=UC.default;const qC=kp(u2);_i.PostgrestQueryBuilder=qC.default;const HC=kp(xb);_i.PostgrestFilterBuilder=HC.default;const WC=kp(h2);_i.PostgrestTransformBuilder=WC.default;const VC=kp(f2);_i.PostgrestBuilder=VC.default;const GC=kp(m2);_i.PostgrestError=GC.default;var g7=_i.default={PostgrestClient:UC.default,PostgrestQueryBuilder:qC.default,PostgrestFilterBuilder:HC.default,PostgrestTransformBuilder:WC.default,PostgrestBuilder:VC.default,PostgrestError:GC.default};const{PostgrestClient:x7,PostgrestQueryBuilder:ez,PostgrestFilterBuilder:tz,PostgrestTransformBuilder:sz,PostgrestBuilder:rz,PostgrestError:nz}=g7;class b7{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const y7="2.15.1",v7=`realtime-js/${y7}`,w7="1.0.0",mN=1e4,N7=1e3,_7=100;var Z0;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Z0||(Z0={}));var Wr;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Wr||(Wr={}));var no;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(no||(no={}));var pN;(function(s){s.websocket="websocket"})(pN||(pN={}));var fu;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(fu||(fu={}));class S7{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+n));o=o+n;const c=r.decode(e.slice(o,o+i));o=o+i;const d=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class YC{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var sr;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(sr||(sr={}));const V4=(s,e,t={})=>{var r;const n=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=j7(o,s,e,n),i),{})},j7=(s,e,t,r)=>{const n=e.find(l=>l.name===s),i=n==null?void 0:n.type,o=t[s];return i&&!r.includes(i)?KC(i,o):gN(o)},KC=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return E7(e,t)}switch(s){case sr.bool:return A7(e);case sr.float4:case sr.float8:case sr.int2:case sr.int4:case sr.int8:case sr.numeric:case sr.oid:return k7(e);case sr.json:case sr.jsonb:return C7(e);case sr.timestamp:return L7(e);case sr.abstime:case sr.date:case sr.daterange:case sr.int4range:case sr.int8range:case sr.money:case sr.reltime:case sr.text:case sr.time:case sr.timestamptz:case sr.timetz:case sr.tsrange:case sr.tstzrange:return gN(e);default:return gN(e)}},gN=s=>s,A7=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},k7=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},C7=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},E7=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,r=s[t];if(s[0]==="{"&&r==="}"){let i;const o=s.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>KC(e,l))}return s},L7=s=>typeof s=="string"?s.replace(" ","T"):s,XC=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Uw{constructor(e,t,r={},n=mN){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var G4;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(G4||(G4={}));class eg{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=eg.syncState(this.state,n,i,o),this.pendingDiffs.forEach(c=>{this.state=eg.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=eg.syncDiff(this.state,n,i,o),l())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const i=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=i[d];if(h){const m=u.map(S=>S.presence_ref),p=h.map(S=>S.presence_ref),x=u.filter(S=>p.indexOf(S.presence_ref)<0),w=h.filter(S=>m.indexOf(S.presence_ref)<0);x.length>0&&(l[d]=x),w.length>0&&(c[d]=w)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},r,n)}static syncDiff(e,t,r,n){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(p=>p.presence_ref),m=u.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(...m)}r(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,n(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return"metas"in n?t[r]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Y4;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(Y4||(Y4={}));var tg;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(tg||(tg={}));var bl;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(bl||(bl={}));class lj{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Wr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Uw(this,no.join,this.params,this.timeout),this.rejoinTimer=new YC(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Wr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Wr.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Wr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Wr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Wr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(no.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new eg(this),this.broadcastEndpointURL=XC(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.state==Wr.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(m=>m.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[tg.PRESENCE]&&this.bindings[tg.PRESENCE].length>0,u={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(bl.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(bl.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:m})=>{var p;if(this.socket.setAuth(),m===void 0){e==null||e(bl.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,w=(p=x==null?void 0:x.length)!==null&&p!==void 0?p:0,S=[];for(let b=0;b<w;b++){const v=x[b],{filter:{event:N,schema:j,table:E,filter:A}}=v,L=m&&m[b];if(L&&L.event===N&&L.schema===j&&L.table===E&&L.filter===A)S.push(Object.assign(Object.assign({},v),{id:L.id}));else{this.unsubscribe(),this.state=Wr.errored,e==null||e(bl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e(bl.SUBSCRIBED);return}}).receive("error",m=>{this.state=Wr.errored,e==null||e(bl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(bl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===Wr.joined&&e===tg.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Wr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(no.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new Uw(this,no.leave,{},e),r.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Wr.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const n=new AbortController,i=setTimeout(()=>n.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Uw(this,e,t,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>_7){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=no;if(r&&[l,c,d,u].indexOf(o)>=0&&r!==this._joinRef())return;let m=this._onMessage(o,t,r);if(t&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var x,w,S;return((x=p.filter)===null||x===void 0?void 0:x.event)==="*"||((S=(w=p.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(p=>p.callback(m,r)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var x,w,S,b,v,N;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const j=p.id,E=(x=p.filter)===null||x===void 0?void 0:x.event;return j&&((w=t.ids)===null||w===void 0?void 0:w.includes(j))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((S=t.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const j=(v=(b=p==null?void 0:p.filter)===null||b===void 0?void 0:b.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return j==="*"||j===((N=t==null?void 0:t.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof m=="object"&&"ids"in m){const x=m.data,{schema:w,table:S,commit_timestamp:b,type:v,errors:N}=x;m=Object.assign(Object.assign({},{schema:w,table:S,commit_timestamp:b,eventType:v,new:{},old:{},errors:N}),this._getPayloadRecords(x))}p.callback(m,r)})}_isClosed(){return this.state===Wr.closed}_isJoined(){return this.state===Wr.joined}_isJoining(){return this.state===Wr.joining}_isLeaving(){return this.state===Wr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&lj.isEqual(n.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(no.close,{},e)}_onError(e){this._on(no.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Wr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=V4(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=V4(e.columns,e.old_record)),t}}const K4=()=>{},Ay={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},P7=[1e3,2e3,5e3,1e4],T7=1e4,I7=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class R7{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=mN,this.transport=null,this.heartbeatIntervalMs=Ay.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=K4,this.ref=0,this.reconnectTimer=null,this.logger=K4,this.conn=null,this.sendBuffer=[],this.serializer=new S7,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let i;return n?i=n:typeof fetch>"u"?i=(...o)=>nc(async()=>{const{default:l}=await Promise.resolve().then(()=>Ap);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((r=t==null?void 0:t.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${pN.websocket}`,this.httpEndpoint=XC(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=b7.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:w7}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Z0.connecting:return fu.Connecting;case Z0.open:return fu.Open;case Z0.closing:return fu.Closing;default:return fu.Closed}}isConnected(){return this.connectionState()===fu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===r);if(n)return n;{const i=new lj(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:n,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(N7,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Ay.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:n,payload:i,ref:o}=t,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${n} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(n,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(no.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([I7],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const n={access_token:t,version:v7};t&&r.updateJoinPayload(n),r.joinedOnce&&r._isJoined()&&r._push(no.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new YC(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ay.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,n,i,o,l,c,d;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:mN,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:Ay.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:u=>P7[u-1]||T7,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(u,h)=>h(JSON.stringify(u)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class cj extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Kr(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class D7 extends cj{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class xN extends cj{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var M7=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((r=r.apply(s,e||[])).next())})};const JC=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>nc(async()=>{const{default:r}=await Promise.resolve().then(()=>Ap);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},F7=()=>M7(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield nc(()=>Promise.resolve().then(()=>Ap),void 0)).Response:Response}),bN=s=>{if(Array.isArray(s))return s.map(t=>bN(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,r])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=bN(r)}),e},O7=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)};var Wh=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((r=r.apply(s,e||[])).next())})};const qw=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),B7=(s,e,t)=>Wh(void 0,void 0,void 0,function*(){const r=yield F7();s instanceof r&&!(t!=null&&t.noResolveJson)?s.json().then(n=>{const i=s.status||500,o=(n==null?void 0:n.statusCode)||i+"";e(new D7(qw(n),i,o))}).catch(n=>{e(new xN(qw(n),n))}):e(new xN(qw(s),s))}),$7=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"||!r?n:(O7(r)?(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(r)):n.body=r,e!=null&&e.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),t))};function bb(s,e,t,r,n,i){return Wh(this,void 0,void 0,function*(){return new Promise((o,l)=>{s(t,$7(e,r,n,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>B7(c,l,r))})})}function h1(s,e,t,r){return Wh(this,void 0,void 0,function*(){return bb(s,"GET",e,t,r)})}function Co(s,e,t,r,n){return Wh(this,void 0,void 0,function*(){return bb(s,"POST",e,r,n,t)})}function yN(s,e,t,r,n){return Wh(this,void 0,void 0,function*(){return bb(s,"PUT",e,r,n,t)})}function z7(s,e,t,r){return Wh(this,void 0,void 0,function*(){return bb(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function QC(s,e,t,r,n){return Wh(this,void 0,void 0,function*(){return bb(s,"DELETE",e,r,n,t)})}var Yn=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((r=r.apply(s,e||[])).next())})};const U7={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},X4={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class q7{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=JC(n)}uploadOrUpdate(e,t,r,n){return Yn(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},X4),n);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),h=yield(e=="PUT"?yN:Co)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(Kr(i))return{data:null,error:i};throw i}})}upload(e,t,r){return Yn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return Yn(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:X4.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield yN(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(Kr(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return Yn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const i=yield Co(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new cj("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(Kr(r))return{data:null,error:r};throw r}})}update(e,t,r){return Yn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Yn(this,void 0,void 0,function*(){try{return{data:yield Co(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Kr(n))return{data:null,error:n};throw n}})}copy(e,t,r){return Yn(this,void 0,void 0,function*(){try{return{data:{path:(yield Co(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Kr(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,r){return Yn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Co(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(Kr(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,r){return Yn(this,void 0,void 0,function*(){try{const n=yield Co(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(Kr(n))return{data:null,error:n};throw n}})}download(e,t){return Yn(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield h1(this.fetch,`${this.url}/${n}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Kr(l))return{data:null,error:l};throw l}})}info(e){return Yn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield h1(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:bN(r),error:null}}catch(r){if(Kr(r))return{data:null,error:r};throw r}})}exists(e){return Yn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield z7(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Kr(r)&&r instanceof xN){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return Yn(this,void 0,void 0,function*(){try{return{data:yield QC(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Kr(t))return{data:null,error:t};throw t}})}list(e,t,r){return Yn(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},U7),t),{prefix:e||""});return{data:yield Co(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Kr(n))return{data:null,error:n};throw n}})}listV2(e,t){return Yn(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Co(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(Kr(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const H7="2.11.0",W7={"X-Client-Info":`storage-js/${H7}`};var bf=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((r=r.apply(s,e||[])).next())})};class V7{constructor(e,t={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},W7),t),this.fetch=JC(r)}listBuckets(){return bf(this,void 0,void 0,function*(){try{return{data:yield h1(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Kr(e))return{data:null,error:e};throw e}})}getBucket(e){return bf(this,void 0,void 0,function*(){try{return{data:yield h1(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Kr(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return bf(this,void 0,void 0,function*(){try{return{data:yield Co(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Kr(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return bf(this,void 0,void 0,function*(){try{return{data:yield yN(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Kr(r))return{data:null,error:r};throw r}})}emptyBucket(e){return bf(this,void 0,void 0,function*(){try{return{data:yield Co(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Kr(t))return{data:null,error:t};throw t}})}deleteBucket(e){return bf(this,void 0,void 0,function*(){try{return{data:yield QC(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Kr(t))return{data:null,error:t};throw t}})}}class G7 extends V7{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new q7(this.url,this.headers,e,this.fetch)}}const Y7="2.56.0";let A0="";typeof Deno<"u"?A0="deno":typeof document<"u"?A0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?A0="react-native":A0="node";const K7={"X-Client-Info":`supabase-js-${A0}/${Y7}`},X7={headers:K7},J7={schema:"public"},Q7={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Z7={};var eF=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((r=r.apply(s,e||[])).next())})};const tF=s=>{let e;return s?e=s:typeof fetch>"u"?e=FC:e=fetch,(...t)=>e(...t)},sF=()=>typeof Headers>"u"?OC:Headers,rF=(s,e,t)=>{const r=tF(t),n=sF();return(i,o)=>eF(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:s;let d=new n(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",s),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:d}))})};var nF=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((r=r.apply(s,e||[])).next())})};function iF(s){return s.endsWith("/")?s:s+"/"}function aF(s,e){var t,r;const{db:n,auth:i,realtime:o,global:l}=s,{db:c,auth:d,realtime:u,global:h}=e,m={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>nF(this,void 0,void 0,function*(){return""})};return s.accessToken?m.accessToken=s.accessToken:delete m.accessToken,m}const ZC="2.71.1",kf=30*1e3,vN=3,Hw=vN*kf,oF="http://localhost:9999",lF="supabase.auth.token",cF={"X-Client-Info":`gotrue-js/${ZC}`},wN="X-Supabase-Api-Version",eE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},dF=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,uF=10*60*1e3;class dj extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function xs(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class hF extends dj{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function fF(s){return xs(s)&&s.name==="AuthApiError"}class tE extends dj{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class qd extends dj{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class kc extends qd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function mF(s){return xs(s)&&s.name==="AuthSessionMissingError"}class ky extends qd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Cy extends qd{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ey extends qd{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function pF(s){return xs(s)&&s.name==="AuthImplicitGrantRedirectError"}class J4 extends qd{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class NN extends qd{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ww(s){return xs(s)&&s.name==="AuthRetryableFetchError"}class Q4 extends qd{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class _N extends qd{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const f1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Z4=` 	
\r=`.split(""),gF=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<Z4.length;e+=1)s[Z4[e].charCodeAt(0)]=-2;for(let e=0;e<f1.length;e+=1)s[f1[e].charCodeAt(0)]=e;return s})();function e3(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(f1[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(f1[r]),e.queuedBits-=6}}function sE(s,e,t){const r=gF[s];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function t3(s){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{yF(o,r,t)};for(let o=0;o<s.length;o+=1)sE(s.charCodeAt(o),n,i);return e.join("")}function xF(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function bF(s,e){for(let t=0;t<s.length;t+=1){let r=s.charCodeAt(t);if(r>55295&&r<=56319){const n=(r-55296)*1024&65535;r=(s.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}xF(r,e)}}function yF(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let r=1;r<6;r+=1)if(!(s>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function vF(s){const e=[],t={queue:0,queuedBits:0},r=n=>{e.push(n)};for(let n=0;n<s.length;n+=1)sE(s.charCodeAt(n),t,r);return new Uint8Array(e)}function wF(s){const e=[];return bF(s,t=>e.push(t)),new Uint8Array(e)}function NF(s){const e=[],t={queue:0,queuedBits:0},r=n=>{e.push(n)};return s.forEach(n=>e3(n,t,r)),e3(null,t,r),e.join("")}function _F(s){return Math.round(Date.now()/1e3)+s}function SF(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const $a=()=>typeof window<"u"&&typeof document<"u",su={tested:!1,writable:!1},rE=()=>{if(!$a())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(su.tested)return su.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),su.tested=!0,su.writable=!0}catch{su.tested=!0,su.writable=!1}return su.writable};function jF(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((r,n)=>{e[n]=r}),e}const nE=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>nc(async()=>{const{default:r}=await Promise.resolve().then(()=>Ap);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},AF=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",Cf=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},ru=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Sc=async(s,e)=>{await s.removeItem(e)};class p2{constructor(){this.promise=new p2.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}p2.promiseConstructor=Promise;function Vw(s){const e=s.split(".");if(e.length!==3)throw new _N("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!dF.test(e[r]))throw new _N("JWT not in base64url format");return{header:JSON.parse(t3(e[0])),payload:JSON.parse(t3(e[1])),signature:vF(e[2]),raw:{header:e[0],payload:e[1]}}}async function kF(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function CF(s,e){return new Promise((r,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await s(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function EF(s){return("0"+s.toString(16)).substr(-2)}function LF(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(e),Array.from(e,EF).join("")}async function PF(s){const t=new TextEncoder().encode(s),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function TF(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await PF(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yf(s,e,t=!1){const r=LF();let n=r;t&&(n+="/PASSWORD_RECOVERY"),await Cf(s,`${e}-code-verifier`,n);const i=await TF(r);return[i,r===i?"plain":"s256"]}const IF=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function RF(s){const e=s.headers.get(wN);if(!e||!e.match(IF))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function DF(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function MF(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const FF=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function vf(s){if(!FF.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gw(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function s3(s){return JSON.parse(JSON.stringify(s))}var OF=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};const lu=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),BF=[502,503,504];async function r3(s){var e;if(!AF(s))throw new NN(lu(s),0);if(BF.includes(s.status))throw new NN(lu(s),s.status);let t;try{t=await s.json()}catch(i){throw new tE(lu(i),i)}let r;const n=RF(s);if(n&&n.getTime()>=eE["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Q4(lu(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new kc}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Q4(lu(t),s.status,t.weak_password.reasons);throw new hF(lu(t),s.status||500,r)}const $F=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),t))};async function As(s,e,t,r){var n;const i=Object.assign({},r==null?void 0:r.headers);i[wN]||(i[wN]=eE["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await zF(s,e,t+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function zF(s,e,t,r,n,i){const o=$F(e,r,n,i);let l;try{l=await s(t,Object.assign({},o))}catch(c){throw console.error(c),new NN(lu(c),0)}if(l.ok||await r3(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await r3(c)}}function fl(s){var e;let t=null;WF(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=_F(s.expires_in)));const r=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:r},error:null}}function n3(s){const e=fl(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=s.weak_password),e}function Fc(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function UF(s){return{data:s,error:null}}function qF(s){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:i}=s,o=OF(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function HF(s){return s}function WF(s){return s.access_token&&s.refresh_token&&s.expires_in}const Yw=["global","local","others"];var VF=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};class GF{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=nE(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Yw[0]){if(Yw.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Yw.join(", ")}`);try{return await As(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(xs(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await As(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Fc})}catch(r){if(xs(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=VF(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),await As(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:qF,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(xs(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await As(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Fc})}catch(t){if(xs(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await As(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:HF});if(u.error)throw u.error;const h=await u.json(),m=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(x.split(";")[1].split("=")[1]);d[`${S}Page`]=w}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(xs(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){vf(e);try{return await As(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Fc})}catch(t){if(xs(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){vf(e);try{return await As(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Fc})}catch(r){if(xs(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){vf(e);try{return await As(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Fc})}catch(r){if(xs(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){vf(e.userId);try{const{data:t,error:r}=await As(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:r}}catch(t){if(xs(t))return{data:null,error:t};throw t}}async _deleteFactor(e){vf(e.userId),vf(e.id);try{return{data:await As(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(xs(t))return{data:null,error:t};throw t}}}function i3(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}function YF(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const wf={debug:!!(globalThis&&rE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class iE extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class KF extends iE{}async function XF(s,e,t){wf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),wf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){wf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,n.name);try{return await t()}finally{wf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,n.name)}}else{if(e===0)throw wf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new KF(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(wf.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}YF();const JF={url:oF,storageKey:lF,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:cF,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function a3(s,e,t){return await t()}const Nf={};class Tg{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Tg.nextInstanceID,Tg.nextInstanceID+=1,this.instanceID>0&&$a()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},JF),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new GF({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=nE(n.fetch),this.lock=n.lock||a3,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:$a()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=XF:this.lock=a3,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:rE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=i3(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=i3(this.memoryStorage)),$a()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Nf[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Nf[this.storageKey]=Object.assign(Object.assign({},Nf[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Nf[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Nf[this.storageKey]=Object.assign(Object.assign({},Nf[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ZC}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=jF(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),$a()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),pF(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return xs(t)?{error:t}:{error:new tE("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const i=await As(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:fl}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(xs(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,n;try{let i;if("email"in e){const{email:u,password:h,options:m}=e;let p=null,x=null;this.flowType==="pkce"&&([p,x]=await yf(this.storage,this.storageKey)),i=await As(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:h,data:(t=m==null?void 0:m.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:p,code_challenge_method:x},xform:fl})}else if("phone"in e){const{phone:u,password:h,options:m}=e;i=await As(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},channel:(n=m==null?void 0:m.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:fl})}else throw new Cy("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(xs(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await As(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:n3})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await As(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:n3})}else throw new Cy("You must provide either an email or phone number and a password");const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new ky}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(t){if(xs(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,n,i,o,l,c,d,u,h,m,p;let x,w;if("message"in e)x=e.message,w=e.signature;else{const{chain:S,wallet:b,statement:v,options:N}=e;let j;if($a())if(typeof b=="object")j=b;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))j=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=b}const E=new URL((t=N==null?void 0:N.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in j&&j.signIn){const A=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),v?{statement:v}:null));let L;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")L=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)L=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)x=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),w=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${E.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(n=(r=N==null?void 0:N.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=N==null?void 0:N.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((o=N==null?void 0:N.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((l=N==null?void 0:N.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((d=N==null?void 0:N.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((h=(u=N==null?void 0:N.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...N.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const A=await j.signMessage(new TextEncoder().encode(x),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=A}}try{const{data:S,error:b}=await As(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:NF(w)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:fl});if(b)throw b;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new ky}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:b})}catch(S){if(xs(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(e){const t=await ru(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(t??"").split("/");try{const{data:i,error:o}=await As(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:fl});if(await Sc(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ky}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(xs(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:i,nonce:o}=e,l=await As(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:fl}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new ky}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(t){if(xs(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,i,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await yf(this.storage,this.storageKey));const{error:h}=await As(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await As(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Cy("You must provide either an email or phone number.")}catch(l){if(xs(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,r;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await As(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:fl});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(n){if(xs(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await yf(this.storage,this.storageKey)),await As(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:UF})}catch(i){if(xs(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new kc;const{error:n}=await As(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(xs(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:i}=e,{error:o}=await As(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:n,options:i}=e,{data:o,error:l}=await As(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Cy("You must provide either an email or phone number and a type")}catch(t){if(xs(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ru(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Hw:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await ru(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Gw()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await As(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Fc}):await this._useSession(async t=>{var r,n,i;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kc}:await As(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Fc})})}catch(t){if(xs(t))return mF(t)&&(await this._removeSession(),await Sc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new kc;const o=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await yf(this.storage,this.storageKey));const{data:d,error:u}=await As(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Fc});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(xs(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new kc;const t=Date.now()/1e3;let r=t,n=!0,i=null;const{payload:o}=Vw(e.access_token);if(o.exp&&(r=o.exp,n=r<=t),n){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(xs(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new kc;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(xs(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!$a())throw new Ey("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ey(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new J4("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ey("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new J4("No code detected.");const{data:v,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!o||!d)throw new Ey("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let m=u+h;c&&(m=parseInt(c));const p=m-u;p*1e3<=kf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const x=m-h;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,m,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,m,u);const{data:w,error:S}=await this._getUser(i);if(S)throw S;const b={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:m,refresh_token:o,token_type:d,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(r){if(xs(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ru(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{error:i};const o=(r=n.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(fF(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Sc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=SF(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await yf(this.storage,this.storageKey,!0));try{return await As(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(xs(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(xs(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession(async i=>{var o,l,c,d,u;const{data:h,error:m}=i;if(m)throw m;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await As(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return $a()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(xs(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:o}=t;if(o)throw o;return await As(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(xs(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await CF(async n=>(n>0&&await kF(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await As(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:fl})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Ww(i)&&Date.now()+o-r<kf})}catch(r){if(this._debug(t,"error",r),xs(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),$a()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await ru(this.storage,this.storageKey);if(n&&this.userStorage){let o=await ru(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await Cf(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Gw()}else if(n&&!n.user&&!n.user){const o=await ru(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(n.user=o.user,await Sc(this.storage,this.storageKey+"-user"),await Cf(this.storage,this.storageKey,n)):n.user=Gw()}if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Hw;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Hw}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),Ww(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(n.access_token);!l&&(o!=null&&o.user)?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new kc;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new p2;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new kc;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(n,"error",i),xs(i)){const o={session:null,error:i};return Ww(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Cf(this.userStorage,this.storageKey+"-user",{user:t.user});const n=Object.assign({},t);delete n.user;const i=s3(n);await Cf(this.storage,this.storageKey,i)}else{const n=s3(t);await Cf(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await Sc(this.storage,this.storageKey),await Sc(this.storage,this.storageKey+"-code-verifier"),await Sc(this.storage,this.storageKey+"-user"),this.userStorage&&await Sc(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&$a()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),kf);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-e)/kf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${kf}ms, refresh threshold is ${vN} ticks`),n<=vN&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof iE)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!$a()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await yf(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await As(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(xs(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await As(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(xs(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:l}=await As(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(xs(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await As(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(xs(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],n=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Vw(n.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(l=>l.kid===e);if(r)return r;const n=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+uF>n)return r;const{data:i,error:o}=await As(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,r=i.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:p,error:x}=await this.getSession();if(x||!p.session)return{data:null,error:x};r=p.session.access_token}const{header:n,payload:i,signature:o,raw:{header:l,payload:c}}=Vw(r);t!=null&&t.allowExpired||DF(i.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!d){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:i,header:n,signature:o},error:null}}const u=MF(n.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,wF(`${l}.${c}`)))throw new _N("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(r){if(xs(r))return{data:null,error:r};throw r}}}Tg.nextInstanceID=0;const QF=Tg;class ZF extends QF{constructor(e){super(e)}}var eO=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(r.next(u))}catch(h){o(h)}}function c(u){try{d(r.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((r=r.apply(s,e||[])).next())})};class tO{constructor(e,t,r){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=iF(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:J7,realtime:Z7,auth:Object.assign(Object.assign({},Q7),{storageKey:d}),global:X7},h=aF(r??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=rF(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new x7(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new G7(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new KM(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return eO(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:i,flowType:o,lock:l,debug:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ZF({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:o,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new R7(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const sO=(s,e,t)=>new tO(s,e,t);function rO(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const e=s.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}rO()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const nO="https://lkwrmqpmgkwyvykjqvel.supabase.co",iO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxrd3JtcXBtZ2t3eXZ5a2pxdmVsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxNTE2NTUsImV4cCI6MjA3MTcyNzY1NX0.Q7XUj3hTLz0XdfnhsrrhrG9EetC7a_5F98nufecKx4Q",Fh=async s=>{const{data:e,error:t}=await Ct.from("application_additional").select("*").eq("application_id",s).order("created_at",{ascending:!1});if(t)throw t;return e||[]},aE=async(s,e)=>{const r=`docs/${s||"unassigned"}/additional/${Date.now()}-${e.name}`,{error:n}=await Ct.storage.from("application_documents").upload(r,e,{upsert:!0,contentType:e.type||"application/octet-stream",cacheControl:"3600"});if(n)throw n;const{data:i}=Ct.storage.from("application_documents").getPublicUrl(r);let o=(i==null?void 0:i.publicUrl)??null;if(!o){const{data:l}=await Ct.storage.from("application_documents").createSignedUrl(r,3600);o=l&&typeof l.signedUrl=="string"?l.signedUrl:null}return{publicUrl:o,storagePath:`application_documents/${r}`}},oE=async s=>{const e={application_id:s.application_id,file_name:s.file_name};s.file_size!==void 0&&(e.file_size=s.file_size),s.file_type!==void 0&&(e.file_type=s.file_type),s.file_url!==void 0&&(e.file_url=s.file_url),s.description!==void 0&&(e.description=s.description);const{data:t,error:r}=await Ct.from("application_additional").insert([e]).select().single();if(r)throw r;return t},lE=async s=>{const{data:e,error:t}=await Ct.from("application_form").select("*").eq("application_id",s).order("created_at",{ascending:!1});if(t)throw t;return e||[]},uj=async s=>{const{data:e,error:t}=await Ct.from("application_form").select("*").eq("user_id",s).is("application_id",null).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(t&&t.code!=="PGRST116")throw t;return e},SN=async s=>{const e={file_name:s.file_name};s.user_id!==void 0&&(e.user_id=s.user_id),s.file_size!==void 0&&(e.file_size=s.file_size),s.file_type!==void 0&&(e.file_type=s.file_type),s.file_url!==void 0&&(e.file_url=s.file_url),s.description!==void 0&&(e.description=s.description);const{data:t,error:r}=await Ct.from("application_form").insert([e]).select().single();if(r)throw r;return t},jN=async(s,e)=>{const r=`docs/${(e==null?void 0:e.applicationId)||(e==null?void 0:e.userId)||"unassigned"}/${Date.now()}-${s.name}`,{error:n}=await Ct.storage.from("application_documents").upload(r,s,{upsert:!0,contentType:s.type||"application/octet-stream",cacheControl:"3600"});if(n)throw n;const{data:i}=Ct.storage.from("application_documents").getPublicUrl(r);let o=(i==null?void 0:i.publicUrl)??null;if(!o){const{data:l}=await Ct.storage.from("application_documents").createSignedUrl(r,3600);o=l&&typeof l.signedUrl=="string"?l.signedUrl:null}return{publicUrl:o,storagePath:`application_documents/${r}`}},m1=async(s,e)=>{const{error:t}=await Ct.from("application_form").update(e).eq("id",s);if(t)throw t;return{id:s,...e}},cE=async s=>{const{data:e,error:t}=await Ct.from("application_access").select("user_id, can_access").eq("application_id",s);if(t)throw t;const r={};for(const n of e||[])r[n.user_id]=!!n.can_access;return r},AN=async(s,e,t)=>{const{error:r}=await Ct.from("application_access").upsert([{user_id:s,application_id:e,can_access:t}],{onConflict:"user_id,application_id"});if(r)throw r;return{userId:s,applicationId:e,can_access:t}},Ct=sO(nO,iO,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storageKey:"mcapro-auth-token",storage:{getItem:s=>typeof window<"u"?window.localStorage.getItem(s):null,setItem:(s,e)=>{typeof window<"u"&&window.localStorage.setItem(s,e)},removeItem:s=>{typeof window<"u"&&window.localStorage.removeItem(s)}}},global:{headers:{"X-Client-Info":"mcapro-portal@1.0.0"}}}),dE=async()=>{console.log("Starting Supabase signOut...");try{const s=setTimeout(()=>{console.warn("Supabase signOut taking too long, forcing logout...")},2e3),{error:e}=await Ct.auth.signOut();clearTimeout(s),e?console.error("Supabase signOut error:",e):console.log("Supabase signOut successful")}catch(s){console.error("Supabase signOut failed:",s)}typeof window<"u"&&(localStorage.removeItem("mcapro_user"),localStorage.removeItem("mcapro-auth-token"),localStorage.removeItem("adminLoggedIn"),console.log("LocalStorage items cleared in supabase.ts")),console.log("Logout process completed")},uE=async s=>{const{data:e,error:t}=await Ct.auth.signUp({email:s.email,password:s.password,options:{data:{full_name:s.fullName}}});if(t)throw t;if(await Ct.auth.signOut(),e.user){const{data:r,error:n}=await Ct.from("users").insert([{id:e.user.id,email:s.email,full_name:s.fullName,roles:null}]).select().single();if(n)throw n;return{authData:e,userRecord:r}}return{authData:e,userRecord:null}},hE=async s=>{const{data:e,error:t}=await Ct.auth.signInWithPassword({email:s.email,password:s.password});if(t)throw t;return e},fE=async s=>{const{data:e,error:t}=await Ct.from("users").select("id, email, full_name, roles, created_at, avatar_url").eq("id",s).single();if(t)throw t;return e},mE=async(s,e)=>{const{data:t,error:r}=await Ct.from("users").update(e).eq("id",s).select("id, email, full_name, roles, created_at, avatar_url").single();if(r)throw r;return t},pE=async(s,e)=>{const t=`avatars/${s}/${Date.now()}-${e.name}`,{error:r}=await Ct.storage.from("application_documents").upload(t,e,{upsert:!0,contentType:e.type||"image/jpeg",cacheControl:"3600"});if(r)throw r;const{data:n}=Ct.storage.from("application_documents").getPublicUrl(t);return n.publicUrl},gE=async s=>{const{data:e,error:t}=await Ct.from("applications").select("*").eq("user_id",s).order("created_at",{ascending:!1});if(t)throw t;const{data:r,error:n}=await Ct.from("application_access").select("application_id, can_access").eq("user_id",s);if(n)throw n;const i={};for(const u of r||[])i[u.application_id]=!!u.can_access;const o=(e||[]).filter(u=>{const h=i[u.id];return h===void 0?!0:h===!0}),c=Object.entries(i).filter(([,u])=>u===!0).map(([u])=>u).filter(u=>!(e!=null&&e.some(h=>h.id===u)));let d=[];if(c.length>0){const{data:u,error:h}=await Ct.from("applications").select("*").in("id",c);if(h)throw h;d=u||[]}return[...o,...d]},im=async s=>{const{data:e,error:t}=await Ct.from("users").select("id, created_at, email, full_name, roles").eq("roles",s).order("created_at",{ascending:!1});if(t)throw t;return e},vu=async s=>{const{data:e,error:t}=await Ct.from("applications").select("*").eq("id",s).single();if(t)throw t;return e},g2=async s=>{const{data:e,error:t}=await Ct.from("applications").insert([s]).select().single();if(t)throw t;return e},xE=async()=>{const{data:s,error:e}=await Ct.from("applications").select("*").order("created_at",{ascending:!1});if(e)throw e;return s},bE=async()=>{const{data:s,error:e}=await Ct.from("applications").select("*").order("created_at",{ascending:!1});if(e)throw e;return s},Cp=async(s,e)=>{if(!await vu(s))throw new Error("Application not found");const{error:r}=await Ct.from("applications").update({...e,updated_at:new Date().toISOString()}).eq("id",s);if(r)throw r;return await vu(s)},yE=async(s,e)=>{const{data:t,error:r}=await Ct.from("application_mtd").update({total_amount:e}).eq("id",s).select().single();if(r)throw r;return t},vE=async s=>{const{error:e}=await Ct.from("applications").delete().eq("id",s);if(e)throw e},Ig=async()=>{const{data:s,error:e}=await Ct.from("lenders").select("*").order("name");if(e)throw e;return s},wE=async s=>{const{data:e,error:t}=await Ct.from("lenders").insert([s]).select().single();if(t)throw t;return e},NE=async(s,e)=>{const{data:t,error:r}=await Ct.from("lenders").update({...e,updated_at:new Date().toISOString()}).eq("id",s).select().single();if(r)throw r;return t},_E=async s=>{const{error:e}=await Ct.from("lenders").delete().eq("id",s);if(e)throw e},hj=async(s,e)=>{const t=e.map(i=>({application_id:s,lender_id:i,status:"pending"})),{data:r,error:n}=await Ct.from("lender_submissions").upsert(t,{onConflict:"application_id,lender_id",ignoreDuplicates:!0}).select();if(n)throw n;return r},fj=async s=>{const{data:e,error:t}=await Ct.from("lender_submissions").select(`
      *,
      lender:lenders(*)
    `).eq("application_id",s);if(t)throw t;return e},SE=async s=>{const{data:e,error:t}=await Ct.from("lenders_notes").select("*").eq("application_id",s).order("created_at",{ascending:!1});if(t)throw t;return e||[]},jE=async(s,e)=>{const t={application_id:s,notes:e},{data:r,error:n}=await Ct.from("lenders_notes").insert([t]).select().single();if(n)throw n;return r},AE=async(s,e)=>{const{error:t}=await Ct.from("lenders_notes").update(e).eq("id",s);if(t)throw t;return{id:s}},kE=async s=>{const{error:e}=await Ct.from("lenders_notes").delete().eq("id",s);if(e)throw e;return{id:s}},CE=async(s,e)=>{const{data:t,error:r}=await Ct.from("lender_submissions").update({...e,updated_at:new Date().toISOString()}).eq("id",s).select().single();if(r)throw r;return t},Jo=async s=>{const{data:e,error:t}=await Ct.from("application_documents").select("*").eq("application_id",s).order("created_at",{ascending:!1});if(t)throw t;return e},mj=async s=>{const e={application_id:s.application_id,file_name:s.file_name,file_size:s.file_size??null,file_type:s.file_type??null,statement_date:s.statement_date??null,file_url:s.file_url??null,upload_status:s.upload_status??"pending"},{data:t,error:r}=await Ct.from("application_mtd").insert([e]).select().single();if(r)throw r;return t},kN=async(s,e)=>{const{data:t,error:r}=await Ct.from("application_mtd").update({upload_status:e}).eq("id",s).select().single();if(r)throw r;return t},co=async s=>{const{data:e,error:t}=await Ct.from("application_mtd").select("*").eq("application_id",s).order("created_at",{ascending:!1});if(t)throw t;return e||[]},EE=async s=>{const{data:e,error:t}=await Ct.from("application_mtd").select("id, mtd_summary, total_amount, available_balance, negative, funder_mtd, total_mtd, mtd_selected").eq("id",s).single();if(t)throw t;return e},LE=async(s,e)=>{const{data:t,error:r}=await Ct.from("application_mtd").update({total_mtd:e}).eq("id",s).select().single();if(r)throw r;return t},CN=async(s,e)=>{const{data:t,error:r}=await Ct.from("application_mtd").update({mtd_selected:e}).eq("id",s).select().single();if(r)throw r;return t},EN=async s=>{const{error:e}=await Ct.from("application_mtd").delete().eq("id",s);if(e)throw e},PE=async(s,e,t)=>{let r=Ct.from("application_mtd").delete().eq("application_id",s).eq("file_name",e);typeof t=="number"&&(r=r.eq("file_size",t));const{error:n}=await r;if(n)throw n},TE=async(s,e,t)=>{const r=Ct.from("application_mtd").select("id, file_size").eq("application_id",s).eq("file_name",e).order("created_at",{ascending:!1}).limit(1).maybeSingle(),{data:n,error:i}=await r;if(i)throw i;const o=n==null?void 0:n.id;if(o){await EN(o);return}const{data:l,error:c}=await Ct.from("application_mtd").select("id, file_name, created_at").eq("application_id",s).ilike("file_name",e).order("created_at",{ascending:!1}).limit(1);if(c)throw c;const d=Array.isArray(l)&&l.length>0?l[0].id:void 0;if(d){await EN(d);return}await PE(s,e,t)},p1=async s=>{const{error:e}=await Ct.from("application_documents").delete().eq("id",s);if(e)throw e},IE=async(s,e,t)=>{let r=Ct.from("application_documents").delete().eq("application_id",s).eq("statement_date",e);t&&(r=r.eq("file_name",t));const{error:n}=await r;if(n)throw n},RE=async(s,e)=>{const{data:t,error:r}=await Ct.from("application_documents").update({monthly_revenue:e}).eq("id",s).select().single();if(r)throw r;return t},pj=(s,e)=>{const t=(l,c,d)=>Math.min(d,Math.max(c,l)),r=(e.industry||"").toLowerCase().split(/[^a-z0-9]+/i).filter(Boolean),n=l=>{if(l.industries.some(c=>c.trim().toLowerCase()==="all industries"))return!0;if(r.length===0)return!1;for(const c of l.industries){const d=(c||"").toLowerCase().split(/[^a-z0-9]+/i).filter(Boolean);if(r.some(h=>d.includes(h)))return!0}return!1},o=(s||[]).filter(l=>l.status==="active").map(l=>{const c=e.credit_score>=l.min_credit_score&&e.credit_score<=l.max_credit_score,d=n(l),u=c&&d,h=Math.max(1,l.max_credit_score-l.min_credit_score),m=(e.credit_score-l.min_credit_score)/h*50;let x=t(m,0,50)+(d?50:0);const w=Math.random()*4+1;return x+=Math.random()<.5?-w:w,x=t(x,0,100),{...l,qualified:u,matchScore:Math.round(x)}}).filter(l=>l.qualified);return o.sort((l,c)=>c.matchScore!==l.matchScore?c.matchScore-l.matchScore:Math.random()-.5),o},aO=Object.freeze(Object.defineProperty({__proto__:null,addLenderNote:jE,createApplication:g2,createLender:wE,createLenderSubmissions:hj,deleteApplication:vE,deleteApplicationDocument:p1,deleteApplicationDocumentByAppAndDate:IE,deleteApplicationMTD:EN,deleteApplicationMTDByAppAndName:PE,deleteLender:_E,deleteLenderNote:kE,getAllApplications:bE,getApplicationAccessMapByApp:cE,getApplicationAdditionalByApplicationId:Fh,getApplicationById:vu,getApplicationDocuments:Jo,getApplicationFormByApplicationId:lE,getApplicationMTDAnalysisById:EE,getApplicationMTDByApplicationId:co,getApplications:xE,getApplicationsForMember:gE,getLatestPendingApplicationForm:uj,getLenderNotes:SE,getLenderSubmissions:fj,getLenders:Ig,getUserProfile:fE,getUsersByRole:im,insertApplicationAdditional:oE,insertApplicationForm:SN,insertApplicationMTD:mj,loginUser:hE,logoutUser:dE,qualifyLenders:pj,registerUser:uE,resolveAndDeleteApplicationMTD:TE,setApplicationAccess:AN,supabase:Ct,updateApplication:Cp,updateApplicationDocumentMonthlyRevenue:RE,updateApplicationForm:m1,updateApplicationMTDMtdSelected:CN,updateApplicationMTDStatus:kN,updateApplicationMTDTotalAmount:yE,updateApplicationMTDTotalMTD:LE,updateLender:NE,updateLenderNote:AE,updateLenderSubmission:CE,updateUserProfile:mE,uploadApplicationAdditionalFile:aE,uploadApplicationFormFile:jN,uploadUserAvatar:pE},Symbol.toStringTag,{value:"Module"}));var sg={};sg.d=(s,e)=>{for(var t in e)sg.o(e,t)&&!sg.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:e[t]})};sg.o=(s,e)=>Object.prototype.hasOwnProperty.call(s,e);var ls=globalThis.pdfjsLib={};sg.d(ls,{AbortException:()=>Id,AnnotationEditorLayer:()=>O_,AnnotationEditorParamsType:()=>Es,AnnotationEditorType:()=>ys,AnnotationEditorUIManager:()=>Bh,AnnotationLayer:()=>t9,AnnotationMode:()=>Oc,ColorPicker:()=>w1,DOMSVGFactory:()=>Sj,DrawLayer:()=>z_,FeatureTest:()=>ni,GlobalWorkerOptions:()=>Gl,ImageKind:()=>av,InvalidPDFException:()=>PN,MissingPDFException:()=>Rg,OPS:()=>qa,OutputScale:()=>IN,PDFDataRangeTransport:()=>ML,PDFDateString:()=>vj,PDFWorker:()=>om,PasswordResponses:()=>dO,PermissionFlag:()=>cO,PixelsPerInch:()=>Rd,RenderingCancelledException:()=>bj,TextLayer:()=>Dg,TouchManager:()=>y1,UnexpectedResponseException:()=>g1,Util:()=>Xt,VerbosityLevel:()=>x2,XfaLayer:()=>OL,build:()=>DB,createValidAbsoluteUrl:()=>mO,fetchData:()=>w2,getDocument:()=>AB,getFilenameFromUrl:()=>_O,getPdfFilenameFromUrl:()=>SO,getXfaPageViewport:()=>jO,isDataScheme:()=>N2,isPdfFile:()=>yj,noContextMenu:()=>ho,normalizeUnicode:()=>vO,setLayerDimensions:()=>Oh,shadow:()=>js,stopEvent:()=>Xi,version:()=>RB});const zn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),DE=[1,0,0,1,0,0],LN=[.001,0,0,.001,0,0],oO=1e7,Kw=1.35,Vi={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Oc={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},lO="pdfjs_internal_editor_",ys={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Es={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},cO={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Pn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},av={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Hr={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},p0={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},x2={ERRORS:0,WARNINGS:1,INFOS:5},qa={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},dO={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let b2=x2.WARNINGS;function uO(s){Number.isInteger(s)&&(b2=s)}function hO(){return b2}function y2(s){b2>=x2.INFOS&&console.log(`Info: ${s}`)}function vs(s){b2>=x2.WARNINGS&&console.log(`Warning: ${s}`)}function Qs(s){throw new Error(s)}function zr(s,e){s||Qs(e)}function fO(s){switch(s==null?void 0:s.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function mO(s,e=null,t=null){if(!s)return null;try{if(t&&typeof s=="string"){if(t.addDefaultProtocol&&s.startsWith("www.")){const n=s.match(/\./g);(n==null?void 0:n.length)>=2&&(s=`http://${s}`)}if(t.tryConvertEncoding)try{s=yO(s)}catch{}}const r=e?new URL(s,e):new URL(s);if(fO(r))return r}catch{}return null}function js(s,e,t,r=!1){return Object.defineProperty(s,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}const Hd=function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e}();class o3 extends Hd{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Xw extends Hd{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class PN extends Hd{constructor(e){super(e,"InvalidPDFException")}}class Rg extends Hd{constructor(e){super(e,"MissingPDFException")}}class g1 extends Hd{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class pO extends Hd{constructor(e){super(e,"FormatError")}}class Id extends Hd{constructor(e){super(e,"AbortException")}}function ME(s){(typeof s!="object"||(s==null?void 0:s.length)===void 0)&&Qs("Invalid argument for bytesToString");const e=s.length,t=8192;if(e<t)return String.fromCharCode.apply(null,s);const r=[];for(let n=0;n<e;n+=t){const i=Math.min(n+t,e),o=s.subarray(n,i);r.push(String.fromCharCode.apply(null,o))}return r.join("")}function v2(s){typeof s!="string"&&Qs("Invalid argument for stringToBytes");const e=s.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=s.charCodeAt(r)&255;return t}function gO(s){return String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255)}function gj(s){const e=Object.create(null);for(const[t,r]of s)e[t]=r;return e}function xO(){const s=new Uint8Array(4);return s[0]=1,new Uint32Array(s.buffer,0,1)[0]===1}function bO(){try{return new Function(""),!0}catch{return!1}}class ni{static get isLittleEndian(){return js(this,"isLittleEndian",xO())}static get isEvalSupported(){return js(this,"isEvalSupported",bO())}static get isOffscreenCanvasSupported(){return js(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return js(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?js(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):js(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return js(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Jw=Array.from(Array(256).keys(),s=>s.toString(16).padStart(2,"0"));var Jl,ov,TN;class Xt{static makeHexColor(e,t,r){return`#${Jw[e]}${Jw[t]}${Jw[r]}`}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const r=e[0]*t[0]+e[1]*t[2]+t[4],n=e[0]*t[1]+e[1]*t[3]+t[5];return[r,n]}static applyInverseTransform(e,t){const r=t[0]*t[3]-t[1]*t[2],n=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/r,i=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/r;return[n,i]}static getAxialAlignedBoundingBox(e,t){const r=this.applyTransform(e,t),n=this.applyTransform(e.slice(2,4),t),i=this.applyTransform([e[0],e[3]],t),o=this.applyTransform([e[2],e[1]],t);return[Math.min(r[0],n[0],i[0],o[0]),Math.min(r[1],n[1],i[1],o[1]),Math.max(r[0],n[0],i[0],o[0]),Math.max(r[1],n[1],i[1],o[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],r=e[0]*t[0]+e[1]*t[2],n=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],l=(r+o)/2,c=Math.sqrt((r+o)**2-4*(r*o-i*n))/2,d=l+c||1,u=l-c||1;return[Math.sqrt(d),Math.sqrt(u)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),n=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>n)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>o?null:[r,i,n,o]}static bezierBoundingBox(e,t,r,n,i,o,l,c,d){return d?(d[0]=Math.min(d[0],e,l),d[1]=Math.min(d[1],t,c),d[2]=Math.max(d[2],e,l),d[3]=Math.max(d[3],t,c)):d=[Math.min(e,l),Math.min(t,c),Math.max(e,l),Math.max(t,c)],te(this,Jl,TN).call(this,e,r,i,l,t,n,o,c,3*(-e+3*(r-i)+l),6*(e-2*r+i),3*(r-e),d),te(this,Jl,TN).call(this,e,r,i,l,t,n,o,c,3*(-t+3*(n-o)+c),6*(t-2*n+o),3*(n-t),d),d}}Jl=new WeakSet,ov=function(e,t,r,n,i,o,l,c,d,u){if(d<=0||d>=1)return;const h=1-d,m=d*d,p=m*d,x=h*(h*(h*e+3*d*t)+3*m*r)+p*n,w=h*(h*(h*i+3*d*o)+3*m*l)+p*c;u[0]=Math.min(u[0],x),u[1]=Math.min(u[1],w),u[2]=Math.max(u[2],x),u[3]=Math.max(u[3],w)},TN=function(e,t,r,n,i,o,l,c,d,u,h,m){if(Math.abs(d)<1e-12){Math.abs(u)>=1e-12&&te(this,Jl,ov).call(this,e,t,r,n,i,o,l,c,-h/u,m);return}const p=u**2-4*h*d;if(p<0)return;const x=Math.sqrt(p),w=2*d;te(this,Jl,ov).call(this,e,t,r,n,i,o,l,c,(-u+x)/w,m),te(this,Jl,ov).call(this,e,t,r,n,i,o,l,c,(-u-x)/w,m)},Q(Xt,Jl);function yO(s){return decodeURIComponent(escape(s))}let Qw=null,l3=null;function vO(s){return Qw||(Qw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,l3=new Map([["ﬅ","ſt"]])),s.replaceAll(Qw,(e,t,r)=>t?t.normalize("NFKC"):l3.get(r))}function wO(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const s=new Uint8Array(32);return crypto.getRandomValues(s),ME(s)}const xj="pdfjs_internal_id_";function NO(s){return Uint8Array.prototype.toBase64?s.toBase64():btoa(ME(s))}typeof Promise.try!="function"&&(Promise.try=function(s,...e){return new Promise(t=>{t(s(...e))})});const ml="http://www.w3.org/2000/svg",mu=class mu{};ss(mu,"CSS",96),ss(mu,"PDF",72),ss(mu,"PDF_TO_CSS_UNITS",mu.CSS/mu.PDF);let Rd=mu;async function w2(s,e="text"){if(k0(s,document.baseURI)){const t=await fetch(s);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{const n=new XMLHttpRequest;n.open("GET",s,!0),n.responseType=e,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(n.response);return}t(n.responseText);return}r(new Error(n.statusText))}},n.send(null)})}class yb{constructor({viewBox:e,userUnit:t,scale:r,rotation:n,offsetX:i=0,offsetY:o=0,dontFlip:l=!1}){this.viewBox=e,this.userUnit=t,this.scale=r,this.rotation=n,this.offsetX=i,this.offsetY=o,r*=t;const c=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let u,h,m,p;switch(n%=360,n<0&&(n+=360),n){case 180:u=-1,h=0,m=0,p=1;break;case 90:u=0,h=1,m=1,p=0;break;case 270:u=0,h=-1,m=-1,p=0;break;case 0:u=1,h=0,m=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,p=-p);let x,w,S,b;u===0?(x=Math.abs(d-e[1])*r+i,w=Math.abs(c-e[0])*r+o,S=(e[3]-e[1])*r,b=(e[2]-e[0])*r):(x=Math.abs(c-e[0])*r+i,w=Math.abs(d-e[1])*r+o,S=(e[2]-e[0])*r,b=(e[3]-e[1])*r),this.transform=[u*r,h*r,m*r,p*r,x-u*r*c-m*r*d,w-h*r*c-p*r*d],this.width=S,this.height=b}get rawDims(){const{userUnit:e,viewBox:t}=this,r=t.map(n=>n*e);return js(this,"rawDims",{pageWidth:r[2]-r[0],pageHeight:r[3]-r[1],pageX:r[0],pageY:r[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:n=this.offsetY,dontFlip:i=!1}={}){return new yb({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:n,dontFlip:i})}convertToViewportPoint(e,t){return Xt.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=Xt.applyTransform([e[0],e[1]],this.transform),r=Xt.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){return Xt.applyInverseTransform([e,t],this.transform)}}class bj extends Hd{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function N2(s){const e=s.length;let t=0;for(;t<e&&s[t].trim()==="";)t++;return s.substring(t,t+5).toLowerCase()==="data:"}function yj(s){return typeof s=="string"&&/\.pdf$/i.test(s)}function _O(s){return[s]=s.split(/[#?]/,1),s.substring(s.lastIndexOf("/")+1)}function SO(s,e="document.pdf"){if(typeof s!="string")return e;if(N2(s))return vs('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=t.exec(s);let i=r.exec(n[1])||r.exec(n[2])||r.exec(n[3]);if(i&&(i=i[0],i.includes("%")))try{i=r.exec(decodeURIComponent(i))[0]}catch{}return i||e}class c3{constructor(){ss(this,"started",Object.create(null));ss(this,"times",[])}time(e){e in this.started&&vs(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||vs(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:r}of this.times)t=Math.max(r.length,t);for(const{name:r,start:n,end:i}of this.times)e.push(`${r.padEnd(t)} ${i-n}ms
`);return e.join("")}}function k0(s,e){try{const{protocol:t}=e?new URL(s,e):new URL(s);return t==="http:"||t==="https:"}catch{return!1}}function ho(s){s.preventDefault()}function Xi(s){s.preventDefault(),s.stopPropagation()}var Bg;class vj{static toDateObject(e){if(!e||typeof e!="string")return null;f(this,Bg)||F(this,Bg,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=f(this,Bg).exec(e);if(!t)return null;const r=parseInt(t[1],10);let n=parseInt(t[2],10);n=n>=1&&n<=12?n-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let l=parseInt(t[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const d=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,d==="-"?(o+=u,l+=h):d==="+"&&(o-=u,l-=h),new Date(Date.UTC(r,n,i,o,l,c))}}Bg=new WeakMap,Q(vj,Bg);function jO(s,{scale:e=1,rotation:t=0}){const{width:r,height:n}=s.attributes.style,i=[0,0,parseInt(r),parseInt(n)];return new yb({viewBox:i,userUnit:1,scale:e,rotation:t})}function wj(s){if(s.startsWith("#")){const e=parseInt(s.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return s.startsWith("rgb(")?s.slice(4,-1).split(",").map(e=>parseInt(e)):s.startsWith("rgba(")?s.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(vs(`Not a valid color format: "${s}"`),[0,0,0])}function AO(s){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of s.keys()){e.style.color=t;const r=window.getComputedStyle(e).color;s.set(t,wj(r))}e.remove()}function dr(s){const{a:e,b:t,c:r,d:n,e:i,f:o}=s.getTransform();return[e,t,r,n,i,o]}function No(s){const{a:e,b:t,c:r,d:n,e:i,f:o}=s.getTransform().invertSelf();return[e,t,r,n,i,o]}function Oh(s,e,t=!1,r=!0){if(e instanceof yb){const{pageWidth:n,pageHeight:i}=e.rawDims,{style:o}=s,l=ni.isCSSRoundSupported,c=`var(--scale-factor) * ${n}px`,d=`var(--scale-factor) * ${i}px`,u=l?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,h=l?`round(down, ${d}, var(--scale-round-y, 1px))`:`calc(${d})`;!t||e.rotation%180===0?(o.width=u,o.height=h):(o.width=h,o.height=u)}r&&s.setAttribute("data-main-rotation",e.rotation)}class IN{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var $c,Nu,Wa,_u,$g,zg,A1,FE,ii,OE,BE,lv,$E,DN;const yl=class yl{constructor(e){Q(this,ii);Q(this,$c,null);Q(this,Nu,null);Q(this,Wa);Q(this,_u,null);Q(this,$g,null);F(this,Wa,e),f(yl,zg)||F(yl,zg,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=F(this,$c,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=f(this,Wa)._uiManager._signal;e.addEventListener("contextmenu",ho,{signal:t}),e.addEventListener("pointerdown",te(yl,A1,FE),{signal:t});const r=F(this,_u,document.createElement("div"));r.className="buttons",e.append(r);const n=f(this,Wa).toolbarPosition;if(n){const{style:i}=e,o=f(this,Wa)._uiManager.direction==="ltr"?1-n[0]:n[0];i.insetInlineEnd=`${100*o}%`,i.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return te(this,ii,$E).call(this),e}get div(){return f(this,$c)}hide(){var e;f(this,$c).classList.add("hidden"),(e=f(this,Nu))==null||e.hideDropdown()}show(){var e;f(this,$c).classList.remove("hidden"),(e=f(this,$g))==null||e.shown()}async addAltText(e){const t=await e.render();te(this,ii,lv).call(this,t),f(this,_u).prepend(t,f(this,ii,DN)),F(this,$g,e)}addColorPicker(e){F(this,Nu,e);const t=e.renderButton();te(this,ii,lv).call(this,t),f(this,_u).prepend(t,f(this,ii,DN))}remove(){var e;f(this,$c).remove(),(e=f(this,Nu))==null||e.destroy(),F(this,Nu,null)}};$c=new WeakMap,Nu=new WeakMap,Wa=new WeakMap,_u=new WeakMap,$g=new WeakMap,zg=new WeakMap,A1=new WeakSet,FE=function(e){e.stopPropagation()},ii=new WeakSet,OE=function(e){f(this,Wa)._focusEventsAllowed=!1,Xi(e)},BE=function(e){f(this,Wa)._focusEventsAllowed=!0,Xi(e)},lv=function(e){const t=f(this,Wa)._uiManager._signal;e.addEventListener("focusin",te(this,ii,OE).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",te(this,ii,BE).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ho,{signal:t})},$E=function(){const{editorType:e,_uiManager:t}=f(this,Wa),r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",f(yl,zg)[e]),te(this,ii,lv).call(this,r),r.addEventListener("click",n=>{t.delete()},{signal:t._signal}),f(this,_u).append(r)},DN=function(){const e=document.createElement("div");return e.className="divider",e},Q(yl,A1),Q(yl,zg,null);let RN=yl;var Ug,Su,ju,Fd,zE,UE,qE;class kO{constructor(e){Q(this,Fd);Q(this,Ug,null);Q(this,Su,null);Q(this,ju);F(this,ju,e)}show(e,t,r){const[n,i]=te(this,Fd,UE).call(this,t,r),{style:o}=f(this,Su)||F(this,Su,te(this,Fd,zE).call(this));e.append(f(this,Su)),o.insetInlineEnd=`${100*n}%`,o.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){f(this,Su).remove()}}Ug=new WeakMap,Su=new WeakMap,ju=new WeakMap,Fd=new WeakSet,zE=function(){const e=F(this,Su,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",ho,{signal:f(this,ju)._signal});const t=F(this,Ug,document.createElement("div"));return t.className="buttons",e.append(t),te(this,Fd,qE).call(this),e},UE=function(e,t){let r=0,n=0;for(const i of e){const o=i.y+i.height;if(o<r)continue;const l=i.x+(t?i.width:0);if(o>r){n=l,r=o;continue}t?l>n&&(n=l):l<n&&(n=l)}return[t?1-n:n,r]},qE=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const r=f(this,ju)._signal;e.addEventListener("contextmenu",ho,{signal:r}),e.addEventListener("click",()=>{f(this,ju).highlightSelection("floating_button")},{signal:r}),f(this,Ug).append(e)};function x1(s,e,t){for(const r of t)e.addEventListener(r,s[r].bind(s))}var k1;class CO{constructor(){Q(this,k1,0)}get id(){return`${lO}${Gn(this,k1)._++}`}}k1=new WeakMap;var lm,qg,Rn,cm,cv;const Ej=class Ej{constructor(){Q(this,cm);Q(this,lm,wO());Q(this,qg,0);Q(this,Rn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=e;const i=n.decode().then(()=>(r.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return js(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:r,size:n,type:i}=e;return te(this,cm,cv).call(this,`${t}_${r}_${n}_${i}`,e)}async getFromUrl(e){return te(this,cm,cv).call(this,e,e)}async getFromBlob(e,t){const r=await t;return te(this,cm,cv).call(this,e,r)}async getFromId(e){f(this,Rn)||F(this,Rn,new Map);const t=f(this,Rn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){f(this,Rn)||F(this,Rn,new Map);let r=f(this,Rn).get(e);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const n=new OffscreenCanvas(t.width,t.height);return n.getContext("2d").drawImage(t,0,0),r={bitmap:n.transferToImageBitmap(),id:`image_${f(this,lm)}_${Gn(this,qg)._++}`,refCounter:1,isSvg:!1},f(this,Rn).set(e,r),f(this,Rn).set(r.id,r),r}getSvgUrl(e){const t=f(this,Rn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var n;f(this,Rn)||F(this,Rn,new Map);const t=f(this,Rn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:r}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(r.width,r.height);i.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=i.convertToBlob()}(n=r.close)==null||n.call(r),t.bitmap=null}isValidId(e){return e.startsWith(`image_${f(this,lm)}_`)}};lm=new WeakMap,qg=new WeakMap,Rn=new WeakMap,cm=new WeakSet,cv=async function(e,t){f(this,Rn)||F(this,Rn,new Map);let r=f(this,Rn).get(e);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${f(this,lm)}_${Gn(this,qg)._++}`,refCounter:0,isSvg:!1});let n;if(typeof t=="string"?(r.url=t,n=await w2(t,"blob")):t instanceof File?n=r.file=t:t instanceof Blob&&(n=t),n.type==="image/svg+xml"){const i=Ej._isSVGFittingCanvas,o=new FileReader,l=new Image,c=new Promise((d,u)=>{l.onload=()=>{r.bitmap=l,r.isSvg=!0,d()},o.onload=async()=>{const h=r.svgUrl=o.result;l.src=await i?`${h}#svgView(preserveAspectRatio(none))`:h},l.onerror=o.onerror=u});o.readAsDataURL(n),await c}else r.bitmap=await createImageBitmap(n);r.refCounter=1}catch(n){vs(n),r=null}return f(this,Rn).set(e,r),r&&f(this,Rn).set(r.id,r),r};let MN=Ej;var kr,zc,Hg,mr;class EO{constructor(e=128){Q(this,kr,[]);Q(this,zc,!1);Q(this,Hg);Q(this,mr,-1);F(this,Hg,e)}add({cmd:e,undo:t,post:r,mustExec:n,type:i=NaN,overwriteIfSameType:o=!1,keepUndo:l=!1}){if(n&&e(),f(this,zc))return;const c={cmd:e,undo:t,post:r,type:i};if(f(this,mr)===-1){f(this,kr).length>0&&(f(this,kr).length=0),F(this,mr,0),f(this,kr).push(c);return}if(o&&f(this,kr)[f(this,mr)].type===i){l&&(c.undo=f(this,kr)[f(this,mr)].undo),f(this,kr)[f(this,mr)]=c;return}const d=f(this,mr)+1;d===f(this,Hg)?f(this,kr).splice(0,1):(F(this,mr,d),d<f(this,kr).length&&f(this,kr).splice(d)),f(this,kr).push(c)}undo(){if(f(this,mr)===-1)return;F(this,zc,!0);const{undo:e,post:t}=f(this,kr)[f(this,mr)];e(),t==null||t(),F(this,zc,!1),F(this,mr,f(this,mr)-1)}redo(){if(f(this,mr)<f(this,kr).length-1){F(this,mr,f(this,mr)+1),F(this,zc,!0);const{cmd:e,post:t}=f(this,kr)[f(this,mr)];e(),t==null||t(),F(this,zc,!1)}}hasSomethingToUndo(){return f(this,mr)!==-1}hasSomethingToRedo(){return f(this,mr)<f(this,kr).length-1}cleanType(e){if(f(this,mr)!==-1){for(let t=f(this,mr);t>=0;t--)if(f(this,kr)[t].type!==e){f(this,kr).splice(t+1,f(this,mr)-t),F(this,mr,t);return}f(this,kr).length=0,F(this,mr,-1)}}destroy(){F(this,kr,null)}}kr=new WeakMap,zc=new WeakMap,Hg=new WeakMap,mr=new WeakMap;var C1,HE;class vb{constructor(e){Q(this,C1);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=ni.platform;for(const[r,n,i={}]of e)for(const o of r){const l=o.startsWith("mac+");t&&l?(this.callbacks.set(o.slice(4),{callback:n,options:i}),this.allKeys.add(o.split("+").at(-1))):!t&&!l&&(this.callbacks.set(o,{callback:n,options:i}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const r=this.callbacks.get(te(this,C1,HE).call(this,t));if(!r)return;const{callback:n,options:{bubbles:i=!1,args:o=[],checker:l=null}}=r;l&&!l(e,t)||(n.bind(e,...o,t)(),i||Xi(t))}}C1=new WeakSet,HE=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const E1=class E1{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return AO(e),js(this,"_colors",e)}convert(e){const t=wj(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[r,n]of this._colors)if(n.every((i,o)=>i===t[o]))return E1._colorsMapping.get(r);return t}getHexCode(e){const t=this._colors.get(e);return t?Xt.makeHexColor(...t):e}};ss(E1,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let FN=E1;var dm,Ri,Gr,mn,um,Nl,hm,fa,Uc,Au,fm,ku,Eo,Va,Cu,Wg,Vg,mm,Gg,Lo,qc,pm,Hc,Po,L1,Wc,Yg,Vc,Eu,Kg,Xg,rn,qs,_l,Lu,Jg,Qg,Gc,To,Sl,Zg,ma,Ft,dv,ON,WE,VE,uv,GE,YE,KE,BN,XE,$N,zN,JE,Kn,pl,QE,ZE,UN,eL,C0,qN;const Xf=class Xf{constructor(e,t,r,n,i,o,l,c,d,u,h,m,p){Q(this,Ft);Q(this,dm,new AbortController);Q(this,Ri,null);Q(this,Gr,new Map);Q(this,mn,new Map);Q(this,um,null);Q(this,Nl,null);Q(this,hm,null);Q(this,fa,new EO);Q(this,Uc,null);Q(this,Au,null);Q(this,fm,0);Q(this,ku,new Set);Q(this,Eo,null);Q(this,Va,null);Q(this,Cu,new Set);ss(this,"_editorUndoBar",null);Q(this,Wg,!1);Q(this,Vg,!1);Q(this,mm,!1);Q(this,Gg,null);Q(this,Lo,null);Q(this,qc,null);Q(this,pm,null);Q(this,Hc,!1);Q(this,Po,null);Q(this,L1,new CO);Q(this,Wc,!1);Q(this,Yg,!1);Q(this,Vc,null);Q(this,Eu,null);Q(this,Kg,null);Q(this,Xg,null);Q(this,rn,ys.NONE);Q(this,qs,new Set);Q(this,_l,null);Q(this,Lu,null);Q(this,Jg,null);Q(this,Qg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});Q(this,Gc,[0,0]);Q(this,To,null);Q(this,Sl,null);Q(this,Zg,null);Q(this,ma,null);const x=this._signal=f(this,dm).signal;F(this,Sl,e),F(this,Zg,t),F(this,um,r),this._eventBus=n,n._on("editingaction",this.onEditingAction.bind(this),{signal:x}),n._on("pagechanging",this.onPageChanging.bind(this),{signal:x}),n._on("scalechanging",this.onScaleChanging.bind(this),{signal:x}),n._on("rotationchanging",this.onRotationChanging.bind(this),{signal:x}),n._on("setpreference",this.onSetPreference.bind(this),{signal:x}),n._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:x}),te(this,Ft,GE).call(this),te(this,Ft,JE).call(this),te(this,Ft,BN).call(this),F(this,Nl,i.annotationStorage),F(this,Gg,i.filterFactory),F(this,Lu,o),F(this,pm,l||null),F(this,Wg,c),F(this,Vg,d),F(this,mm,u),F(this,Xg,h||null),this.viewParameters={realScale:Rd.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=p!==!1}static get _keyboardManager(){const e=Xf.prototype,t=o=>f(o,Sl).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),r=(o,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},n=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return js(this,"_keyboardManager",new vb([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&f(o,Sl).contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&f(o,Sl).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,r,n,i;(e=f(this,ma))==null||e.resolve(),F(this,ma,null),(t=f(this,dm))==null||t.abort(),F(this,dm,null),this._signal=null;for(const o of f(this,mn).values())o.destroy();f(this,mn).clear(),f(this,Gr).clear(),f(this,Cu).clear(),F(this,Ri,null),f(this,qs).clear(),f(this,fa).destroy(),(r=f(this,um))==null||r.destroy(),(n=f(this,Po))==null||n.hide(),F(this,Po,null),f(this,Lo)&&(clearTimeout(f(this,Lo)),F(this,Lo,null)),f(this,To)&&(clearTimeout(f(this,To)),F(this,To,null)),(i=this._editorUndoBar)==null||i.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return f(this,Xg)}get useNewAltTextFlow(){return f(this,Vg)}get useNewAltTextWhenAddingImage(){return f(this,mm)}get hcmFilter(){return js(this,"hcmFilter",f(this,Lu)?f(this,Gg).addHCMFilter(f(this,Lu).foreground,f(this,Lu).background):"none")}get direction(){return js(this,"direction",getComputedStyle(f(this,Sl)).direction)}get highlightColors(){return js(this,"highlightColors",f(this,pm)?new Map(f(this,pm).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return js(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),F(this,Au,e)}setMainHighlightColorPicker(e){F(this,Kg,e)}editAltText(e,t=!1){var r;(r=f(this,um))==null||r.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":F(this,mm,t);break}}onPageChanging({pageNumber:e}){F(this,fm,e-1)}focusMainContainer(){f(this,Sl).focus()}findParent(e,t){for(const r of f(this,mn).values()){const{x:n,y:i,width:o,height:l}=r.div.getBoundingClientRect();if(e>=n&&e<=n+o&&t>=i&&t<=i+l)return r}return null}disableUserSelect(e=!1){f(this,Zg).classList.toggle("noUserSelect",e)}addShouldRescale(e){f(this,Cu).add(e)}removeShouldRescale(e){f(this,Cu).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Rd.PDF_TO_CSS_UNITS;for(const r of f(this,Cu))r.onScaleChanging();(t=f(this,Au))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:o}=t,l=t.toString(),d=te(this,Ft,dv).call(this,t).closest(".textLayer"),u=this.getSelectionBoxes(d);if(!u)return;t.empty();const h=te(this,Ft,ON).call(this,d),m=f(this,rn)===ys.NONE,p=()=>{h==null||h.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:o,text:l}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(ys.HIGHLIGHT,p);return}p()}addToAnnotationStorage(e){!e.isEmpty()&&f(this,Nl)&&!f(this,Nl).has(e.id)&&f(this,Nl).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,f(this,Hc)&&(F(this,Hc,!1),te(this,Ft,uv).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of f(this,qs))if(t.div.contains(e)){F(this,Eu,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!f(this,Eu))return;const[e,t]=f(this,Eu);F(this,Eu,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){te(this,Ft,BN).call(this),te(this,Ft,$N).call(this)}removeEditListeners(){te(this,Ft,XE).call(this),te(this,Ft,zN).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const r of f(this,Va))if(r.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const r of f(this,Va))if(r.isHandlingMimeForPasting(t.type)){r.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var r;if(e.preventDefault(),(r=f(this,Ri))==null||r.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of f(this,qs)){const i=n.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const o of f(this,Va))if(o.isHandlingMimeForPasting(i.type)){o.paste(i,this.currentLayer);return}let r=t.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(i){vs(`paste: "${i.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const n=this.currentLayer;try{const i=[];for(const c of r){const d=await n.deserialize(c);if(!d)return;i.push(d)}const o=()=>{for(const c of i)te(this,Ft,UN).call(this,c);te(this,Ft,qN).call(this,i)},l=()=>{for(const c of i)c.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(i){vs(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),f(this,rn)!==ys.NONE&&!this.isEditorHandlingKeyboard&&Xf._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,f(this,Hc)&&(F(this,Hc,!1),te(this,Ft,uv).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(te(this,Ft,YE).call(this),te(this,Ft,$N).call(this),te(this,Ft,Kn).call(this,{isEditing:f(this,rn)!==ys.NONE,isEmpty:te(this,Ft,C0).call(this),hasSomethingToUndo:f(this,fa).hasSomethingToUndo(),hasSomethingToRedo:f(this,fa).hasSomethingToRedo(),hasSelectedEditor:!1})):(te(this,Ft,KE).call(this),te(this,Ft,zN).call(this),te(this,Ft,Kn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!f(this,Va)){F(this,Va,e);for(const t of f(this,Va))te(this,Ft,pl).call(this,t.defaultPropertiesToUpdate)}}getId(){return f(this,L1).id}get currentLayer(){return f(this,mn).get(f(this,fm))}getLayer(e){return f(this,mn).get(e)}get currentPageIndex(){return f(this,fm)}addLayer(e){f(this,mn).set(e.pageIndex,e),f(this,Wc)?e.enable():e.disable()}removeLayer(e){f(this,mn).delete(e.pageIndex)}async updateMode(e,t=null,r=!1){var n;if(f(this,rn)!==e&&!(f(this,ma)&&(await f(this,ma).promise,!f(this,ma)))){if(F(this,ma,Promise.withResolvers()),F(this,rn,e),e===ys.NONE){this.setEditingState(!1),te(this,Ft,ZE).call(this),(n=this._editorUndoBar)==null||n.hide(),f(this,ma).resolve();return}this.setEditingState(!0),await te(this,Ft,QE).call(this),this.unselectAll();for(const i of f(this,mn).values())i.updateMode(e);if(!t){r&&this.addNewEditorFromKeyboard(),f(this,ma).resolve();return}for(const i of f(this,Gr).values())i.annotationElementId===t?(this.setSelected(i),i.enterInEditMode()):i.unselect();f(this,ma).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==f(this,rn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var r;if(f(this,Va)){switch(e){case Es.CREATE:this.currentLayer.addNewEditor();return;case Es.HIGHLIGHT_DEFAULT_COLOR:(r=f(this,Kg))==null||r.updateColor(t);break;case Es.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(f(this,Jg)||F(this,Jg,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const n of f(this,qs))n.updateParams(e,t);for(const n of f(this,Va))n.updateDefaultParams(e,t)}}showAllEditors(e,t,r=!1){var i;for(const o of f(this,Gr).values())o.editorType===e&&o.show(t);(((i=f(this,Jg))==null?void 0:i.get(Es.HIGHLIGHT_SHOW_ALL))??!0)!==t&&te(this,Ft,pl).call(this,[[Es.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(f(this,Yg)!==e){F(this,Yg,e);for(const t of f(this,mn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const r of f(this,Gr).values())r.pageIndex===e&&t.push(r);return t}getEditor(e){return f(this,Gr).get(e)}addEditor(e){f(this,Gr).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(f(this,Lo)&&clearTimeout(f(this,Lo)),F(this,Lo,setTimeout(()=>{this.focusMainContainer(),F(this,Lo,null)},0))),f(this,Gr).delete(e.id),this.unselect(e),(!e.annotationElementId||!f(this,ku).has(e.annotationElementId))&&((t=f(this,Nl))==null||t.remove(e.id))}addDeletedAnnotationElement(e){f(this,ku).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return f(this,ku).has(e)}removeDeletedAnnotationElement(e){f(this,ku).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){f(this,Ri)!==e&&(F(this,Ri,e),e&&te(this,Ft,pl).call(this,e.propertiesToUpdate))}updateUI(e){f(this,Ft,eL)===e&&te(this,Ft,pl).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){te(this,Ft,pl).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(f(this,qs).has(e)){f(this,qs).delete(e),e.unselect(),te(this,Ft,Kn).call(this,{hasSelectedEditor:this.hasSelection});return}f(this,qs).add(e),e.select(),te(this,Ft,pl).call(this,e.propertiesToUpdate),te(this,Ft,Kn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=f(this,Au))==null||t.commitOrRemove();for(const r of f(this,qs))r!==e&&r.unselect();f(this,qs).clear(),f(this,qs).add(e),e.select(),te(this,Ft,pl).call(this,e.propertiesToUpdate),te(this,Ft,Kn).call(this,{hasSelectedEditor:!0})}isSelected(e){return f(this,qs).has(e)}get firstSelectedEditor(){return f(this,qs).values().next().value}unselect(e){e.unselect(),f(this,qs).delete(e),te(this,Ft,Kn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return f(this,qs).size!==0}get isEnterHandled(){return f(this,qs).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;f(this,fa).undo(),te(this,Ft,Kn).call(this,{hasSomethingToUndo:f(this,fa).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:te(this,Ft,C0).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){f(this,fa).redo(),te(this,Ft,Kn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:f(this,fa).hasSomethingToRedo(),isEmpty:te(this,Ft,C0).call(this)})}addCommands(e){f(this,fa).add(e),te(this,Ft,Kn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:te(this,Ft,C0).call(this)})}cleanUndoStack(e){f(this,fa).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...f(this,qs)],r=()=>{var o;(o=this._editorUndoBar)==null||o.show(n,t.length===1?t[0].editorType:t.length);for(const l of t)l.remove()},n=()=>{for(const o of t)te(this,Ft,UN).call(this,o)};this.addCommands({cmd:r,undo:n,mustExec:!0})}commitOrRemove(){var e;(e=f(this,Ri))==null||e.commitOrRemove()}hasSomethingToControl(){return f(this,Ri)||this.hasSelection}selectAll(){for(const e of f(this,qs))e.commit();te(this,Ft,qN).call(this,f(this,Gr).values())}unselectAll(){var e;if(!(f(this,Ri)&&(f(this,Ri).commitOrRemove(),f(this,rn)!==ys.NONE))&&!((e=f(this,Au))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of f(this,qs))t.unselect();f(this,qs).clear(),te(this,Ft,Kn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;f(this,Gc)[0]+=e,f(this,Gc)[1]+=t;const[n,i]=f(this,Gc),o=[...f(this,qs)],l=1e3;f(this,To)&&clearTimeout(f(this,To)),F(this,To,setTimeout(()=>{F(this,To,null),f(this,Gc)[0]=f(this,Gc)[1]=0,this.addCommands({cmd:()=>{for(const c of o)f(this,Gr).has(c.id)&&c.translateInPage(n,i)},undo:()=>{for(const c of o)f(this,Gr).has(c.id)&&c.translateInPage(-n,-i)},mustExec:!1})},l));for(const c of o)c.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),F(this,Eo,new Map);for(const e of f(this,qs))f(this,Eo).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!f(this,Eo))return!1;this.disableUserSelect(!1);const e=f(this,Eo);F(this,Eo,null);let t=!1;for(const[{x:n,y:i,pageIndex:o},l]of e)l.newX=n,l.newY=i,l.newPageIndex=o,t||(t=n!==l.savedX||i!==l.savedY||o!==l.savedPageIndex);if(!t)return!1;const r=(n,i,o,l)=>{if(f(this,Gr).has(n.id)){const c=f(this,mn).get(l);c?n._setParentAndPosition(c,i,o):(n.pageIndex=l,n.x=i,n.y=o)}};return this.addCommands({cmd:()=>{for(const[n,{newX:i,newY:o,newPageIndex:l}]of e)r(n,i,o,l)},undo:()=>{for(const[n,{savedX:i,savedY:o,savedPageIndex:l}]of e)r(n,i,o,l)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(f(this,Eo))for(const r of f(this,Eo).keys())r.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||f(this,qs).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return f(this,Ri)===e}getActive(){return f(this,Ri)}getMode(){return f(this,rn)}get imageManager(){return js(this,"imageManager",new MN)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let d=0,u=t.rangeCount;d<u;d++)if(!e.contains(t.getRangeAt(d).commonAncestorContainer))return null;const{x:r,y:n,width:i,height:o}=e.getBoundingClientRect();let l;switch(e.getAttribute("data-main-rotation")){case"90":l=(d,u,h,m)=>({x:(u-n)/o,y:1-(d+h-r)/i,width:m/o,height:h/i});break;case"180":l=(d,u,h,m)=>({x:1-(d+h-r)/i,y:1-(u+m-n)/o,width:h/i,height:m/o});break;case"270":l=(d,u,h,m)=>({x:1-(u+m-n)/o,y:(d-r)/i,width:m/o,height:h/i});break;default:l=(d,u,h,m)=>({x:(d-r)/i,y:(u-n)/o,width:h/i,height:m/o});break}const c=[];for(let d=0,u=t.rangeCount;d<u;d++){const h=t.getRangeAt(d);if(!h.collapsed)for(const{x:m,y:p,width:x,height:w}of h.getClientRects())x===0||w===0||c.push(l(m,p,x,w))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(f(this,hm)||F(this,hm,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=f(this,hm))==null||t.delete(e)}renderAnnotationElement(e){var n;const t=(n=f(this,hm))==null?void 0:n.get(e.data.id);if(!t)return;const r=f(this,Nl).getRawValue(t);r&&(f(this,rn)===ys.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}};dm=new WeakMap,Ri=new WeakMap,Gr=new WeakMap,mn=new WeakMap,um=new WeakMap,Nl=new WeakMap,hm=new WeakMap,fa=new WeakMap,Uc=new WeakMap,Au=new WeakMap,fm=new WeakMap,ku=new WeakMap,Eo=new WeakMap,Va=new WeakMap,Cu=new WeakMap,Wg=new WeakMap,Vg=new WeakMap,mm=new WeakMap,Gg=new WeakMap,Lo=new WeakMap,qc=new WeakMap,pm=new WeakMap,Hc=new WeakMap,Po=new WeakMap,L1=new WeakMap,Wc=new WeakMap,Yg=new WeakMap,Vc=new WeakMap,Eu=new WeakMap,Kg=new WeakMap,Xg=new WeakMap,rn=new WeakMap,qs=new WeakMap,_l=new WeakMap,Lu=new WeakMap,Jg=new WeakMap,Qg=new WeakMap,Gc=new WeakMap,To=new WeakMap,Sl=new WeakMap,Zg=new WeakMap,ma=new WeakMap,Ft=new WeakSet,dv=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},ON=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const r of f(this,mn).values())if(r.hasTextLayer(e))return r;return null},WE=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=te(this,Ft,dv).call(this,e).closest(".textLayer"),n=this.getSelectionBoxes(r);n&&(f(this,Po)||F(this,Po,new kO(this)),f(this,Po).show(r,n,this.direction==="ltr"))},VE=function(){var i,o,l;const e=document.getSelection();if(!e||e.isCollapsed){f(this,_l)&&((i=f(this,Po))==null||i.hide(),F(this,_l,null),te(this,Ft,Kn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===f(this,_l))return;const n=te(this,Ft,dv).call(this,e).closest(".textLayer");if(!n){f(this,_l)&&((o=f(this,Po))==null||o.hide(),F(this,_l,null),te(this,Ft,Kn).call(this,{hasSelectedText:!1}));return}if((l=f(this,Po))==null||l.hide(),F(this,_l,t),te(this,Ft,Kn).call(this,{hasSelectedText:!0}),!(f(this,rn)!==ys.HIGHLIGHT&&f(this,rn)!==ys.NONE)&&(f(this,rn)===ys.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),F(this,Hc,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=f(this,rn)===ys.HIGHLIGHT?te(this,Ft,ON).call(this,n):null;c==null||c.toggleDrawing();const d=new AbortController,u=this.combinedSignal(d),h=m=>{m.type==="pointerup"&&m.button!==0||(d.abort(),c==null||c.toggleDrawing(!0),m.type==="pointerup"&&te(this,Ft,uv).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}},uv=function(e=""){f(this,rn)===ys.HIGHLIGHT?this.highlightSelection(e):f(this,Wg)&&te(this,Ft,WE).call(this)},GE=function(){document.addEventListener("selectionchange",te(this,Ft,VE).bind(this),{signal:this._signal})},YE=function(){if(f(this,qc))return;F(this,qc,new AbortController);const e=this.combinedSignal(f(this,qc));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},KE=function(){var e;(e=f(this,qc))==null||e.abort(),F(this,qc,null)},BN=function(){if(f(this,Vc))return;F(this,Vc,new AbortController);const e=this.combinedSignal(f(this,Vc));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},XE=function(){var e;(e=f(this,Vc))==null||e.abort(),F(this,Vc,null)},$N=function(){if(f(this,Uc))return;F(this,Uc,new AbortController);const e=this.combinedSignal(f(this,Uc));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},zN=function(){var e;(e=f(this,Uc))==null||e.abort(),F(this,Uc,null)},JE=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Kn=function(e){Object.entries(e).some(([r,n])=>f(this,Qg)[r]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(f(this,Qg),e)}),f(this,rn)===ys.HIGHLIGHT&&e.hasSelectedEditor===!1&&te(this,Ft,pl).call(this,[[Es.HIGHLIGHT_FREE,!0]]))},pl=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},QE=async function(){if(!f(this,Wc)){F(this,Wc,!0);const e=[];for(const t of f(this,mn).values())e.push(t.enable());await Promise.all(e);for(const t of f(this,Gr).values())t.enable()}},ZE=function(){if(this.unselectAll(),f(this,Wc)){F(this,Wc,!1);for(const e of f(this,mn).values())e.disable();for(const e of f(this,Gr).values())e.disable()}},UN=function(e){const t=f(this,mn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},eL=function(){let e=null;for(e of f(this,qs));return e},C0=function(){if(f(this,Gr).size===0)return!0;if(f(this,Gr).size===1)for(const e of f(this,Gr).values())return e.isEmpty();return!1},qN=function(e){for(const t of f(this,qs))t.unselect();f(this,qs).clear();for(const t of e)t.isEmpty()||(f(this,qs).add(t),t.select());te(this,Ft,Kn).call(this,{hasSelectedEditor:this.hasSelection})},ss(Xf,"TRANSLATE_SMALL",1),ss(Xf,"TRANSLATE_BIG",10);let Bh=Xf;var nn,Io,Ga,gm,Ro,Di,xm,Do,xi,jl,Pu,Mo,Yc,ao,E0,hv;const Jn=class Jn{constructor(e){Q(this,ao);Q(this,nn,null);Q(this,Io,!1);Q(this,Ga,null);Q(this,gm,null);Q(this,Ro,null);Q(this,Di,null);Q(this,xm,!1);Q(this,Do,null);Q(this,xi,null);Q(this,jl,null);Q(this,Pu,null);Q(this,Mo,!1);F(this,xi,e),F(this,Mo,e._uiManager.useNewAltTextFlow),f(Jn,Yc)||F(Jn,Yc,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Jn._l10n??(Jn._l10n=e)}async render(){const e=F(this,Ga,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=F(this,gm,document.createElement("span"));e.append(t),f(this,Mo)?(e.classList.add("new"),e.setAttribute("data-l10n-id",f(Jn,Yc).missing),t.setAttribute("data-l10n-id",f(Jn,Yc)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=f(this,xi)._uiManager._signal;e.addEventListener("contextmenu",ho,{signal:r}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:r});const n=i=>{i.preventDefault(),f(this,xi)._uiManager.editAltText(f(this,xi)),f(this,Mo)&&f(this,xi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:f(this,ao,E0)}})};return e.addEventListener("click",n,{capture:!0,signal:r}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(F(this,xm,!0),n(i))},{signal:r}),await te(this,ao,hv).call(this),e}finish(){f(this,Ga)&&(f(this,Ga).focus({focusVisible:f(this,xm)}),F(this,xm,!1))}isEmpty(){return f(this,Mo)?f(this,nn)===null:!f(this,nn)&&!f(this,Io)}hasData(){return f(this,Mo)?f(this,nn)!==null||!!f(this,jl):this.isEmpty()}get guessedText(){return f(this,jl)}async setGuessedText(e){f(this,nn)===null&&(F(this,jl,e),F(this,Pu,await Jn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),te(this,ao,hv).call(this))}toggleAltTextBadge(e=!1){var t;if(!f(this,Mo)||f(this,nn)){(t=f(this,Do))==null||t.remove(),F(this,Do,null);return}if(!f(this,Do)){const r=F(this,Do,document.createElement("div"));r.className="noAltTextBadge",f(this,xi).div.append(r)}f(this,Do).classList.toggle("hidden",!e)}serialize(e){let t=f(this,nn);return!e&&f(this,jl)===t&&(t=f(this,Pu)),{altText:t,decorative:f(this,Io),guessedText:f(this,jl),textWithDisclaimer:f(this,Pu)}}get data(){return{altText:f(this,nn),decorative:f(this,Io)}}set data({altText:e,decorative:t,guessedText:r,textWithDisclaimer:n,cancel:i=!1}){r&&(F(this,jl,r),F(this,Pu,n)),!(f(this,nn)===e&&f(this,Io)===t)&&(i||(F(this,nn,e),F(this,Io,t)),te(this,ao,hv).call(this))}toggle(e=!1){f(this,Ga)&&(!e&&f(this,Di)&&(clearTimeout(f(this,Di)),F(this,Di,null)),f(this,Ga).disabled=!e)}shown(){f(this,xi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:f(this,ao,E0)}})}destroy(){var e,t;(e=f(this,Ga))==null||e.remove(),F(this,Ga,null),F(this,gm,null),F(this,Ro,null),(t=f(this,Do))==null||t.remove(),F(this,Do,null)}};nn=new WeakMap,Io=new WeakMap,Ga=new WeakMap,gm=new WeakMap,Ro=new WeakMap,Di=new WeakMap,xm=new WeakMap,Do=new WeakMap,xi=new WeakMap,jl=new WeakMap,Pu=new WeakMap,Mo=new WeakMap,Yc=new WeakMap,ao=new WeakSet,E0=function(){return f(this,nn)&&"added"||f(this,nn)===null&&this.guessedText&&"review"||"missing"},hv=async function(){var n,i,o;const e=f(this,Ga);if(!e)return;if(f(this,Mo)){if(e.classList.toggle("done",!!f(this,nn)),e.setAttribute("data-l10n-id",f(Jn,Yc)[f(this,ao,E0)]),(n=f(this,gm))==null||n.setAttribute("data-l10n-id",f(Jn,Yc)[`${f(this,ao,E0)}-label`]),!f(this,nn)){(i=f(this,Ro))==null||i.remove();return}}else{if(!f(this,nn)&&!f(this,Io)){e.classList.remove("done"),(o=f(this,Ro))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=f(this,Ro);if(!t){F(this,Ro,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${f(this,xi).id}`;const l=100,c=f(this,xi)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(f(this,Di)),F(this,Di,null)},{once:!0}),e.addEventListener("mouseenter",()=>{F(this,Di,setTimeout(()=>{F(this,Di,null),f(this,Ro).classList.add("show"),f(this,xi)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:c}),e.addEventListener("mouseleave",()=>{var d;f(this,Di)&&(clearTimeout(f(this,Di)),F(this,Di,null)),(d=f(this,Ro))==null||d.classList.remove("show")},{signal:c})}f(this,Io)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=f(this,nn)),t.parentNode||e.append(t);const r=f(this,xi).getImageForAltText();r==null||r.setAttribute("aria-describedby",t.id)},Q(Jn,Yc,null),ss(Jn,"_l10n",null);let b1=Jn;var ex,Tu,tx,sx,rx,nx,ix,bm,Al,Iu,Kc,ic,tL,sL,HN;const Lj=class Lj{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:r=null,onPinchStart:n=null,onPinching:i=null,onPinchEnd:o=null,signal:l}){Q(this,ic);Q(this,ex);Q(this,Tu,!1);Q(this,tx,null);Q(this,sx);Q(this,rx);Q(this,nx);Q(this,ix);Q(this,bm);Q(this,Al,null);Q(this,Iu);Q(this,Kc,null);F(this,ex,e),F(this,tx,r),F(this,sx,t),F(this,rx,n),F(this,nx,i),F(this,ix,o),F(this,Iu,new AbortController),F(this,bm,AbortSignal.any([l,f(this,Iu).signal])),e.addEventListener("touchstart",te(this,ic,tL).bind(this),{passive:!1,signal:f(this,bm)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return js(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=f(this,Iu))==null||e.abort(),F(this,Iu,null)}};ex=new WeakMap,Tu=new WeakMap,tx=new WeakMap,sx=new WeakMap,rx=new WeakMap,nx=new WeakMap,ix=new WeakMap,bm=new WeakMap,Al=new WeakMap,Iu=new WeakMap,Kc=new WeakMap,ic=new WeakSet,tL=function(e){var n,i,o;if((n=f(this,sx))!=null&&n.call(this)||e.touches.length<2)return;if(!f(this,Kc)){F(this,Kc,new AbortController);const l=AbortSignal.any([f(this,bm),f(this,Kc).signal]),c=f(this,ex),d={signal:l,passive:!1};c.addEventListener("touchmove",te(this,ic,sL).bind(this),d),c.addEventListener("touchend",te(this,ic,HN).bind(this),d),c.addEventListener("touchcancel",te(this,ic,HN).bind(this),d),(i=f(this,rx))==null||i.call(this)}if(Xi(e),e.touches.length!==2||(o=f(this,tx))!=null&&o.call(this)){F(this,Al,null);return}let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]),F(this,Al,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:r.screenX,touch1Y:r.screenY})},sL=function(e){var j;if(!f(this,Al)||e.touches.length!==2)return;let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]);const{screenX:n,screenY:i}=t,{screenX:o,screenY:l}=r,c=f(this,Al),{touch0X:d,touch0Y:u,touch1X:h,touch1Y:m}=c,p=h-d,x=m-u,w=o-n,S=l-i,b=Math.hypot(w,S)||1,v=Math.hypot(p,x)||1;if(!f(this,Tu)&&Math.abs(v-b)<=Lj.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=n,c.touch0Y=i,c.touch1X=o,c.touch1Y=l,e.preventDefault(),!f(this,Tu)){F(this,Tu,!0);return}const N=[(n+o)/2,(i+l)/2];(j=f(this,nx))==null||j.call(this,N,v,b)},HN=function(e){var t;f(this,Kc).abort(),F(this,Kc,null),(t=f(this,ix))==null||t.call(this),f(this,Al)&&(e.preventDefault(),F(this,Al,null),F(this,Tu,!1))};let y1=Lj;var Ru,Ya,ar,ym,Xc,ax,Du,pn,Mu,kl,Jc,ox,Fu,Mi,lx,Ou,Cl,Fo,vm,wm,pa,Bu,cx,P1,rs,WN,dx,VN,fv,rL,nL,GN,mv,YN,iL,aL,oL,KN,lL,XN,cL,dL,uL,JN,L0;const ws=class ws{constructor(e){Q(this,rs);Q(this,Ru,null);Q(this,Ya,null);Q(this,ar,null);Q(this,ym,!1);Q(this,Xc,null);Q(this,ax,"");Q(this,Du,!1);Q(this,pn,null);Q(this,Mu,null);Q(this,kl,null);Q(this,Jc,null);Q(this,ox,"");Q(this,Fu,!1);Q(this,Mi,null);Q(this,lx,!1);Q(this,Ou,!1);Q(this,Cl,!1);Q(this,Fo,null);Q(this,vm,0);Q(this,wm,0);Q(this,pa,null);Q(this,Bu,null);ss(this,"_editToolbar",null);ss(this,"_initialOptions",Object.create(null));ss(this,"_initialData",null);ss(this,"_isVisible",!0);ss(this,"_uiManager",null);ss(this,"_focusEventsAllowed",!0);Q(this,cx,!1);Q(this,P1,ws._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:r,pageHeight:n,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,n],this.pageTranslation=[i,o];const[l,c]=this.parentDimensions;this.x=e.x/l,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ws.prototype._resizeWithKeyboard,t=Bh.TRANSLATE_SMALL,r=Bh.TRANSLATE_BIG;return js(this,"_resizerKeyboardManager",new vb([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],ws.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return js(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new LO({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ws._l10n??(ws._l10n=e),ws._l10nResizer||(ws._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ws._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);ws._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Qs("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return f(this,cx)}set _isDraggable(e){var t;F(this,cx,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=f(this,P1)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):te(this,rs,L0).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(f(this,Fu)?F(this,Fu,!1):this.parent.setSelected(this))}focusout(e){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,n){const[i,o]=this.parentDimensions;[r,n]=this.screenToPageTranslation(r,n),this.x=(e+r)/i,this.y=(t+n)/o,this.fixAndSetPosition()}translate(e,t){te(this,rs,WN).call(this,this.parentDimensions,e,t)}translateInPage(e,t){f(this,Mi)||F(this,Mi,[this.x,this.y,this.width,this.height]),te(this,rs,WN).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){f(this,Mi)||F(this,Mi,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[n,i]}=this;if(this.x+=e/n,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:l}=this;const[c,d]=this.getBaseTranslation();o+=c,l+=d;const{style:u}=r;u.left=`${(100*o).toFixed(2)}%`,u.top=`${(100*l).toFixed(2)}%`,this._onTranslating(o,l),r.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!f(this,Mi)&&(f(this,Mi)[0]!==this.x||f(this,Mi)[1]!==this.y)}get _hasBeenResized(){return!!f(this,Mi)&&(f(this,Mi)[2]!==this.width||f(this,Mi)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:r}=ws,n=r/e,i=r/t;switch(this.rotation){case 90:return[-n,i];case 180:return[n,i];case 270:return[n,-i];default:return[-n,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[r,n]}=this;let{x:i,y:o,width:l,height:c}=this;if(l*=r,c*=n,i*=r,o*=n,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(r-l,i)),o=Math.max(0,Math.min(n-c,o));break;case 90:i=Math.max(0,Math.min(r-c,i)),o=Math.min(n,Math.max(l,o));break;case 180:i=Math.min(r,Math.max(l,i)),o=Math.min(n,Math.max(c,o));break;case 270:i=Math.min(r,Math.max(c,i)),o=Math.max(0,Math.min(n-l,o));break}this.x=i/=r,this.y=o/=n;const[d,u]=this.getBaseTranslation();i+=d,o+=u,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var r;return te(r=ws,dx,VN).call(r,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var r;return te(r=ws,dx,VN).call(r,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(e,t){const[r,n]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/r).toFixed(2)}%`,f(this,Du)||(i.height=`${(100*t/n).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:r}=e,n=r.endsWith("%"),i=!f(this,Du)&&t.endsWith("%");if(n&&i)return;const[o,l]=this.parentDimensions;n||(e.width=`${(100*parseFloat(r)/o).toFixed(2)}%`),!f(this,Du)&&!i&&(e.height=`${(100*parseFloat(t)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=f(this,ar))==null||e.finish()}async addEditToolbar(){return this._editToolbar||f(this,Ou)?this._editToolbar:(this._editToolbar=new RN(this),this.div.append(this._editToolbar.render()),f(this,ar)&&await this._editToolbar.addAltText(f(this,ar)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=f(this,ar))==null||e.destroy())}addContainer(e){var r;const t=(r=this._editToolbar)==null?void 0:r.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){f(this,ar)||(b1.initialize(ws._l10n),F(this,ar,new b1(this)),f(this,Ru)&&(f(this,ar).data=f(this,Ru),F(this,Ru,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=f(this,ar))==null?void 0:e.data}set altTextData(e){f(this,ar)&&(f(this,ar).data=e)}get guessedAltText(){var e;return(e=f(this,ar))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=f(this,ar))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=f(this,ar))==null?void 0:t.serialize(e)}hasAltText(){return!!f(this,ar)&&!f(this,ar).isEmpty()}hasAltTextData(){var e;return((e=f(this,ar))==null?void 0:e.hasData())??!1}render(){var i;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=f(this,ym)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),te(this,rs,XN).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[r,n]=this.getInitialTranslation();return this.translate(r,n),x1(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(f(this,Bu)||F(this,Bu,new y1({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:te(this,rs,iL).bind(this),onPinching:te(this,rs,aL).bind(this),onPinchEnd:te(this,rs,oL).bind(this),signal:this._uiManager._signal}))),(i=this._uiManager._editorUndoBar)==null||i.hide(),this.div}pointerdown(e){const{isMac:t}=ni.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(F(this,Fu,!0),this._isDraggable){te(this,rs,lL).call(this,e);return}te(this,rs,KN).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){f(this,Fo)&&clearTimeout(f(this,Fo)),F(this,Fo,setTimeout(()=>{var e;F(this,Fo,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,r=this.rotation){const n=this.parentScale,[i,o]=this.pageDimensions,[l,c]=this.pageTranslation,d=e/n,u=t/n,h=this.x*i,m=this.y*o,p=this.width*i,x=this.height*o;switch(r){case 0:return[h+d+l,o-m-u-x+c,h+d+p+l,o-m-u+c];case 90:return[h+u+l,o-m+d+c,h+u+x+l,o-m+d+p+c];case 180:return[h-d-p+l,o-m+u+c,h-d+l,o-m+u+x+c];case 270:return[h-u-x+l,o-m-d-p+c,h-u+l,o-m-d+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[r,n,i,o]=e,l=i-r,c=o-n;switch(this.rotation){case 0:return[r,t-o,l,c];case 90:return[r,t-n,c,l];case 180:return[i,t-n,l,c];case 270:return[i,t-o,c,l];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){F(this,Ou,!0)}disableEditMode(){F(this,Ou,!1)}isInEditMode(){return f(this,Ou)}shouldGetKeyboardEvents(){return f(this,Cl)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:r,right:n}=this.getClientDimensions(),{innerHeight:i,innerWidth:o}=window;return t<o&&n>0&&e<i&&r>0}rebuild(){te(this,rs,XN).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Qs("An editor must be serializable")}static async deserialize(e,t,r){const n=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r});n.rotation=e.rotation,F(n,Ru,e.accessibilityData);const[i,o]=n.pageDimensions,[l,c,d,u]=n.getRectInCurrentCoords(e.rect,o);return n.x=l/i,n.y=c/o,n.width=d/i,n.height=u/o,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=f(this,Jc))==null||e.abort(),F(this,Jc,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),f(this,Fo)&&(clearTimeout(f(this,Fo)),F(this,Fo,null)),te(this,rs,L0).call(this),this.removeEditToolbar(),f(this,pa)){for(const r of f(this,pa).values())clearTimeout(r);F(this,pa,null)}this.parent=null,(t=f(this,Bu))==null||t.destroy(),F(this,Bu,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(te(this,rs,rL).call(this),f(this,pn).classList.remove("hidden"),x1(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),F(this,kl,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=f(this,pn).children;if(!f(this,Ya)){F(this,Ya,Array.from(t));const o=te(this,rs,cL).bind(this),l=te(this,rs,dL).bind(this),c=this._uiManager._signal;for(const d of f(this,Ya)){const u=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",o,{signal:c}),d.addEventListener("blur",l,{signal:c}),d.addEventListener("focus",te(this,rs,uL).bind(this,u),{signal:c}),d.setAttribute("data-l10n-id",ws._l10nResizer[u])}}const r=f(this,Ya)[0];let n=0;for(const o of t){if(o===r)break;n++}const i=(360-this.rotation+this.parentRotation)%360/90*(f(this,Ya).length/4);if(i!==n){if(i<n)for(let l=0;l<n-i;l++)f(this,pn).append(f(this,pn).firstChild);else if(i>n)for(let l=0;l<i-n;l++)f(this,pn).firstChild.before(f(this,pn).lastChild);let o=0;for(const l of t){const d=f(this,Ya)[o++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",ws._l10nResizer[d])}}te(this,rs,JN).call(this,0),F(this,Cl,!0),f(this,pn).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){f(this,Cl)&&te(this,rs,YN).call(this,f(this,ox),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){te(this,rs,L0).call(this),this.div.focus()}select(){var e,t,r;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var n,i;(n=this.div)!=null&&n.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(r=f(this,ar))==null||r.toggleAltTextBadge(!1)}unselect(){var e,t,r,n,i;(e=f(this,pn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(n=this._editToolbar)==null||n.hide(),(i=f(this,ar))==null||i.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return f(this,lx)}set isEditing(e){F(this,lx,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){F(this,Du,!0);const r=e/t,{style:n}=this.div;n.aspectRatio=r,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){f(this,pa)||F(this,pa,new Map);const{action:r}=e;let n=f(this,pa).get(r);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),f(this,pa).delete(r),f(this,pa).size===0&&F(this,pa,null)},ws._telemetryTimeout),f(this,pa).set(r,n);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),F(this,ym,!1)}disable(){this.div&&(this.div.tabIndex=-1),F(this,ym,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Ru=new WeakMap,Ya=new WeakMap,ar=new WeakMap,ym=new WeakMap,Xc=new WeakMap,ax=new WeakMap,Du=new WeakMap,pn=new WeakMap,Mu=new WeakMap,kl=new WeakMap,Jc=new WeakMap,ox=new WeakMap,Fu=new WeakMap,Mi=new WeakMap,lx=new WeakMap,Ou=new WeakMap,Cl=new WeakMap,Fo=new WeakMap,vm=new WeakMap,wm=new WeakMap,pa=new WeakMap,Bu=new WeakMap,cx=new WeakMap,P1=new WeakMap,rs=new WeakSet,WN=function([e,t],r,n){[r,n]=this.screenToPageTranslation(r,n),this.x+=r/e,this.y+=n/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},dx=new WeakSet,VN=function(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},fv=function(e){switch(e){case 90:{const[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}},rL=function(){if(f(this,pn))return;F(this,pn,document.createElement("div")),f(this,pn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const r of e){const n=document.createElement("div");f(this,pn).append(n),n.classList.add("resizer",r),n.setAttribute("data-resizer-name",r),n.addEventListener("pointerdown",te(this,rs,nL).bind(this,r),{signal:t}),n.addEventListener("contextmenu",ho,{signal:t}),n.tabIndex=-1}this.div.prepend(f(this,pn))},nL=function(e,t){var u;t.preventDefault();const{isMac:r}=ni.platform;if(t.button!==0||t.ctrlKey&&r)return;(u=f(this,ar))==null||u.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,F(this,Mu,[t.screenX,t.screenY]);const i=new AbortController,o=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",te(this,rs,YN).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Xi,{passive:!1,signal:o}),window.addEventListener("contextmenu",ho,{signal:o}),F(this,kl,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const d=()=>{var h;i.abort(),this.parent.togglePointerEvents(!0),(h=f(this,ar))==null||h.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=l,this.div.style.cursor=c,te(this,rs,mv).call(this)};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})},GN=function(e,t,r,n){this.width=r,this.height=n,this.x=e,this.y=t;const[i,o]=this.parentDimensions;this.setDims(i*r,o*n),this.fixAndSetPosition(),this._onResized()},mv=function(){if(!f(this,kl))return;const{savedX:e,savedY:t,savedWidth:r,savedHeight:n}=f(this,kl);F(this,kl,null);const i=this.x,o=this.y,l=this.width,c=this.height;i===e&&o===t&&l===r&&c===n||this.addCommands({cmd:te(this,rs,GN).bind(this,i,o,l,c),undo:te(this,rs,GN).bind(this,e,t,r,n),mustExec:!0})},YN=function(e,t){const[r,n]=this.parentDimensions,i=this.x,o=this.y,l=this.width,c=this.height,d=ws.MIN_SIZE/r,u=ws.MIN_SIZE/n,h=te(this,rs,fv).call(this,this.rotation),m=(M,$)=>[h[0]*M+h[2]*$,h[1]*M+h[3]*$],p=te(this,rs,fv).call(this,360-this.rotation),x=(M,$)=>[p[0]*M+p[2]*$,p[1]*M+p[3]*$];let w,S,b=!1,v=!1;switch(e){case"topLeft":b=!0,w=(M,$)=>[0,0],S=(M,$)=>[M,$];break;case"topMiddle":w=(M,$)=>[M/2,0],S=(M,$)=>[M/2,$];break;case"topRight":b=!0,w=(M,$)=>[M,0],S=(M,$)=>[0,$];break;case"middleRight":v=!0,w=(M,$)=>[M,$/2],S=(M,$)=>[0,$/2];break;case"bottomRight":b=!0,w=(M,$)=>[M,$],S=(M,$)=>[0,0];break;case"bottomMiddle":w=(M,$)=>[M/2,$],S=(M,$)=>[M/2,0];break;case"bottomLeft":b=!0,w=(M,$)=>[0,$],S=(M,$)=>[M,0];break;case"middleLeft":v=!0,w=(M,$)=>[0,$/2],S=(M,$)=>[M,$/2];break}const N=w(l,c),j=S(l,c);let E=m(...j);const A=ws._round(i+E[0]),L=ws._round(o+E[1]);let C=1,B=1,U,P;if(t.fromKeyboard)({deltaX:U,deltaY:P}=t);else{const{screenX:M,screenY:$}=t,[q,K]=f(this,Mu);[U,P]=this.screenToPageTranslation(M-q,$-K),f(this,Mu)[0]=M,f(this,Mu)[1]=$}if([U,P]=x(U/r,P/n),b){const M=Math.hypot(l,c);C=B=Math.max(Math.min(Math.hypot(j[0]-N[0]-U,j[1]-N[1]-P)/M,1/l,1/c),d/l,u/c)}else v?C=Math.max(d,Math.min(1,Math.abs(j[0]-N[0]-U)))/l:B=Math.max(u,Math.min(1,Math.abs(j[1]-N[1]-P)))/c;const T=ws._round(l*C),z=ws._round(c*B);E=m(...S(T,z));const H=A-E[0],D=L-E[1];f(this,Mi)||F(this,Mi,[this.x,this.y,this.width,this.height]),this.width=T,this.height=z,this.x=H,this.y=D,this.setDims(r*T,n*z),this.fixAndSetPosition(),this._onResizing()},iL=function(){var e;F(this,kl,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=f(this,ar))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},aL=function(e,t,r){let i=.7*(r/t)+1-.7;if(i===1)return;const o=te(this,rs,fv).call(this,this.rotation),l=(A,L)=>[o[0]*A+o[2]*L,o[1]*A+o[3]*L],[c,d]=this.parentDimensions,u=this.x,h=this.y,m=this.width,p=this.height,x=ws.MIN_SIZE/c,w=ws.MIN_SIZE/d;i=Math.max(Math.min(i,1/m,1/p),x/m,w/p);const S=ws._round(m*i),b=ws._round(p*i);if(S===m&&b===p)return;f(this,Mi)||F(this,Mi,[u,h,m,p]);const v=l(m/2,p/2),N=ws._round(u+v[0]),j=ws._round(h+v[1]),E=l(S/2,b/2);this.x=N-E[0],this.y=j-E[1],this.width=S,this.height=b,this.setDims(c*S,d*b),this.fixAndSetPosition(),this._onResizing()},oL=function(){var e;(e=f(this,ar))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),te(this,rs,mv).call(this)},KN=function(e){const{isMac:t}=ni.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},lL=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let r=!1;const n=new AbortController,i=this._uiManager.combinedSignal(n),o={capture:!0,passive:!1,signal:i},l=d=>{n.abort(),F(this,Xc,null),F(this,Fu,!1),this._uiManager.endDragSession()||te(this,rs,KN).call(this,d),r&&this._onStopDragging()};t&&(F(this,vm,e.clientX),F(this,wm,e.clientY),F(this,Xc,e.pointerId),F(this,ax,e.pointerType),window.addEventListener("pointermove",d=>{r||(r=!0,this._onStartDragging());const{clientX:u,clientY:h,pointerId:m}=d;if(m!==f(this,Xc)){Xi(d);return}const[p,x]=this.screenToPageTranslation(u-f(this,vm),h-f(this,wm));F(this,vm,u),F(this,wm,h),this._uiManager.dragSelectedEditors(p,x)},o),window.addEventListener("touchmove",Xi,o),window.addEventListener("pointerdown",d=>{d.pointerType===f(this,ax)&&(f(this,Bu)||d.isPrimary)&&l(d),Xi(d)},o));const c=d=>{if(!f(this,Xc)||f(this,Xc)===d.pointerId){l(d);return}Xi(d)};window.addEventListener("pointerup",c,{signal:i}),window.addEventListener("blur",c,{signal:i})},XN=function(){if(f(this,Jc)||!this.div)return;F(this,Jc,new AbortController);const e=this._uiManager.combinedSignal(f(this,Jc));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},cL=function(e){ws._resizerKeyboardManager.exec(this,e)},dL=function(e){var t;f(this,Cl)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==f(this,pn)&&te(this,rs,L0).call(this)},uL=function(e){F(this,ox,f(this,Cl)?e:"")},JN=function(e){if(f(this,Ya))for(const t of f(this,Ya))t.tabIndex=e},L0=function(){F(this,Cl,!1),te(this,rs,JN).call(this,-1),te(this,rs,mv).call(this)},Q(ws,dx),ss(ws,"_l10n",null),ss(ws,"_l10nResizer",null),ss(ws,"_borderLineWidth",-1),ss(ws,"_colorManager",new FN),ss(ws,"_zIndex",1),ss(ws,"_telemetryTimeout",1e3);let xr=ws;class LO extends xr{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const d3=3285377520,ha=4294901760,_o=65535;class hL{constructor(e){this.h1=e?e&4294967295:d3,this.h2=e?e&4294967295:d3}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let w=0,S=e.length;w<S;w++){const b=e.charCodeAt(w);b<=255?t[r++]=b:(t[r++]=b>>>8,t[r++]=b&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=r>>2,i=r-n*4,o=new Uint32Array(t.buffer,0,n);let l=0,c=0,d=this.h1,u=this.h2;const h=3432918353,m=461845907,p=h&_o,x=m&_o;for(let w=0;w<n;w++)w&1?(l=o[w],l=l*h&ha|l*p&_o,l=l<<15|l>>>17,l=l*m&ha|l*x&_o,d^=l,d=d<<13|d>>>19,d=d*5+3864292196):(c=o[w],c=c*h&ha|c*p&_o,c=c<<15|c>>>17,c=c*m&ha|c*x&_o,u^=c,u=u<<13|u>>>19,u=u*5+3864292196);switch(l=0,i){case 3:l^=t[n*4+2]<<16;case 2:l^=t[n*4+1]<<8;case 1:l^=t[n*4],l=l*h&ha|l*p&_o,l=l<<15|l>>>17,l=l*m&ha|l*x&_o,n&1?d^=l:u^=l}this.h1=d,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ha|e*36045&_o,t=t*4283543511&ha|((t<<16|e>>>16)*2950163797&ha)>>>16,e^=t>>>1,e=e*444984403&ha|e*60499&_o,t=t*3301882366&ha|((t<<16|e>>>16)*3120437893&ha)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const QN=Object.freeze({map:null,hash:"",transfer:void 0});var $u,zu,an,T1,fL;class Nj{constructor(){Q(this,T1);Q(this,$u,!1);Q(this,zu,null);Q(this,an,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const r=f(this,an).get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return f(this,an).get(e)}remove(e){if(f(this,an).delete(e),f(this,an).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of f(this,an).values())if(t instanceof xr)return;this.onAnnotationEditor(null)}}setValue(e,t){const r=f(this,an).get(e);let n=!1;if(r!==void 0)for(const[i,o]of Object.entries(t))r[i]!==o&&(n=!0,r[i]=o);else n=!0,f(this,an).set(e,t);n&&te(this,T1,fL).call(this),t instanceof xr&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return f(this,an).has(e)}getAll(){return f(this,an).size>0?gj(f(this,an)):null}setAll(e){for(const[t,r]of Object.entries(e))this.setValue(t,r)}get size(){return f(this,an).size}resetModified(){f(this,$u)&&(F(this,$u,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new mL(this)}get serializable(){if(f(this,an).size===0)return QN;const e=new Map,t=new hL,r=[],n=Object.create(null);let i=!1;for(const[o,l]of f(this,an)){const c=l instanceof xr?l.serialize(!1,n):l;c&&(e.set(o,c),t.update(`${o}:${JSON.stringify(c)}`),i||(i=!!c.bitmap))}if(i)for(const o of e.values())o.bitmap&&r.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:QN}get editorStats(){let e=null;const t=new Map;for(const r of f(this,an).values()){if(!(r instanceof xr))continue;const n=r.telemetryFinalData;if(!n)continue;const{type:i}=n;t.has(i)||t.set(i,Object.getPrototypeOf(r).constructor),e||(e=Object.create(null));const o=e[i]||(e[i]=new Map);for(const[l,c]of Object.entries(n)){if(l==="type")continue;let d=o.get(l);d||(d=new Map,o.set(l,d));const u=d.get(c)??0;d.set(c,u+1)}}for(const[r,n]of t)e[r]=n.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){F(this,zu,null)}get modifiedIds(){if(f(this,zu))return f(this,zu);const e=[];for(const t of f(this,an).values())!(t instanceof xr)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return F(this,zu,{ids:new Set(e),hash:e.join(",")})}}$u=new WeakMap,zu=new WeakMap,an=new WeakMap,T1=new WeakSet,fL=function(){f(this,$u)||(F(this,$u,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var ux;class mL extends Nj{constructor(t){super();Q(this,ux);const{map:r,hash:n,transfer:i}=t.serializable,o=structuredClone(r,i?{transfer:i}:null);F(this,ux,{map:o,hash:n,transfer:i})}get print(){Qs("Should not call PrintAnnotationStorage.print")}get serializable(){return f(this,ux)}get modifiedIds(){return js(this,"modifiedIds",{ids:new Set,hash:""})}}ux=new WeakMap;var Nm;class PO{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){Q(this,Nm,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),f(this,Nm).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||f(this,Nm).has(e.loadedName))){if(zr(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:n,style:i}=e,o=new FontFace(r,n,i);this.addNativeFontFace(o);try{await o.load(),f(this,Nm).add(r),t==null||t(e)}catch{vs(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Qs("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(n){throw vs(`Failed to load font '${r.family}': '${n}'.`),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const n=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return js(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(zn||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),js(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(zr(!n.done,"completeRequest() cannot be called twice."),n.done=!0;r.length>0&&r[0].done;){const i=r.shift();setTimeout(i.callback,0)}}const{loadingRequests:r}=this,n={done:!1,complete:t,callback:e};return r.push(n),n}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return js(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(j,E){return j.charCodeAt(E)<<24|j.charCodeAt(E+1)<<16|j.charCodeAt(E+2)<<8|j.charCodeAt(E+3)&255}function n(j,E,A,L){const C=j.substring(0,E),B=j.substring(E+A);return C+L+B}let i,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let d=0;function u(j,E){if(++d>30){vs("Load test font never loaded."),E();return}if(c.font="30px "+j,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){E();return}setTimeout(u.bind(null,j,E))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=n(m,976,h.length,h);const x=16,w=1482184792;let S=r(m,x);for(i=0,o=h.length-3;i<o;i+=4)S=S-w+r(h,i)|0;i<h.length&&(S=S-w+r(h+"XXX",i)|0),m=n(m,x,4,gO(S));const b=`url(data:font/opentype;base64,${btoa(m)});`,v=`@font-face {font-family:"${h}";src:${b}}`;this.insertRule(v);const N=this._document.createElement("div");N.style.visibility="hidden",N.style.width=N.style.height="10px",N.style.position="absolute",N.style.top=N.style.left="0px";for(const j of[e.loadedName,h]){const E=this._document.createElement("span");E.textContent="Hi",E.style.fontFamily=j,N.append(E)}this._document.body.append(N),u(h,()=>{N.remove(),t.complete()})}}Nm=new WeakMap;class TO{constructor(e,{disableFontFace:t=!1,fontExtraProperties:r=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this.disableFontFace=t===!0,this.fontExtraProperties=r===!0,this._inspectFont=n}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${NO(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return(r=this._inspectFont)==null||r.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const r=this.loadedName+"_path_"+t;let n;try{n=e.get(r)}catch(o){vs(`getPathGenerator - ignoring character: "${o}".`)}const i=new Path2D(n||"");return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[t]=i}}const Ly={DATA:1,ERROR:2},Or={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function u3(){}function pi(s){if(s instanceof Id||s instanceof PN||s instanceof Rg||s instanceof o3||s instanceof g1||s instanceof Xw)return s;switch(s instanceof Error||typeof s=="object"&&s!==null||Qs('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),s.name){case"AbortException":return new Id(s.message);case"InvalidPDFException":return new PN(s.message);case"MissingPDFException":return new Rg(s.message);case"PasswordException":return new o3(s.message,s.code);case"UnexpectedResponseException":return new g1(s.message,s.status);case"UnknownErrorException":return new Xw(s.message,s.details)}return new Xw(s.message,s.toString())}var _m,ka,pL,gL,xL,pv;class P0{constructor(e,t,r){Q(this,ka);Q(this,_m,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",te(this,ka,pL).bind(this),{signal:f(this,_m).signal})}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const n=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[n]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:n,data:t},r)}catch(o){i.reject(o)}return i.promise}sendWithStream(e,t,r,n){const i=this.streamId++,o=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:d=>{const u=Promise.withResolvers();return this.streamControllers[i]={controller:d,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:l,action:e,streamId:i,data:t,desiredSize:d.desiredSize},n),u.promise},pull:d=>{const u=Promise.withResolvers();return this.streamControllers[i].pullCall=u,c.postMessage({sourceName:o,targetName:l,stream:Or.PULL,streamId:i,desiredSize:d.desiredSize}),u.promise},cancel:d=>{zr(d instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[i].cancelCall=u,this.streamControllers[i].isClosed=!0,c.postMessage({sourceName:o,targetName:l,stream:Or.CANCEL,streamId:i,reason:pi(d)}),u.promise}},r)}destroy(){var e;(e=f(this,_m))==null||e.abort(),F(this,_m,null)}}_m=new WeakMap,ka=new WeakSet,pL=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){te(this,ka,xL).call(this,e);return}if(e.callback){const r=e.callbackId,n=this.callbackCapabilities[r];if(!n)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===Ly.DATA)n.resolve(e.data);else if(e.callback===Ly.ERROR)n.reject(pi(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,n=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(o){i.postMessage({sourceName:r,targetName:n,callback:Ly.DATA,callbackId:e.callbackId,data:o})},function(o){i.postMessage({sourceName:r,targetName:n,callback:Ly.ERROR,callbackId:e.callbackId,reason:pi(o)})});return}if(e.streamId){te(this,ka,gL).call(this,e);return}t(e.data)},gL=function(e){const t=e.streamId,r=this.sourceName,n=e.sourceName,i=this.comObj,o=this,l=this.actionHandler[e.action],c={enqueue(d,u=1,h){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=u,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:r,targetName:n,stream:Or.ENQUEUE,streamId:t,chunk:d},h)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:r,targetName:n,stream:Or.CLOSE,streamId:t}),delete o.streamSinks[t])},error(d){zr(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:r,targetName:n,stream:Or.ERROR,streamId:t,reason:pi(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(l,e.data,c).then(function(){i.postMessage({sourceName:r,targetName:n,stream:Or.START_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:r,targetName:n,stream:Or.START_COMPLETE,streamId:t,reason:pi(d)})})},xL=function(e){const t=e.streamId,r=this.sourceName,n=e.sourceName,i=this.comObj,o=this.streamControllers[t],l=this.streamSinks[t];switch(e.stream){case Or.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(pi(e.reason));break;case Or.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(pi(e.reason));break;case Or.PULL:if(!l){i.postMessage({sourceName:r,targetName:n,stream:Or.PULL_COMPLETE,streamId:t,success:!0});break}l.desiredSize<=0&&e.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=e.desiredSize,Promise.try(l.onPull||u3).then(function(){i.postMessage({sourceName:r,targetName:n,stream:Or.PULL_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:r,targetName:n,stream:Or.PULL_COMPLETE,streamId:t,reason:pi(d)})});break;case Or.ENQUEUE:if(zr(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Or.CLOSE:if(zr(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),te(this,ka,pv).call(this,o,t);break;case Or.ERROR:zr(o,"error should have stream controller"),o.controller.error(pi(e.reason)),te(this,ka,pv).call(this,o,t);break;case Or.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(pi(e.reason)),te(this,ka,pv).call(this,o,t);break;case Or.CANCEL:if(!l)break;const c=pi(e.reason);Promise.try(l.onCancel||u3,c).then(function(){i.postMessage({sourceName:r,targetName:n,stream:Or.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){i.postMessage({sourceName:r,targetName:n,stream:Or.CANCEL_COMPLETE,streamId:t,reason:pi(d)})}),l.sinkCapability.reject(c),l.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},pv=async function(e,t){var r,n,i;await Promise.allSettled([(r=e.startCall)==null?void 0:r.promise,(n=e.pullCall)==null?void 0:n.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var hx;class bL{constructor({enableHWA:e=!1}){Q(this,hx,!1);F(this,hx,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!f(this,hx)})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Qs("Abstract method `_createCanvas` called.")}}hx=new WeakMap;class IO extends bL{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const r=this._document.createElement("canvas");return r.width=e,r.height=t,r}}class yL{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Qs("Abstract method `_fetch` called.")}}class vL extends yL{async _fetch(e){const t=await w2(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):v2(t)}}class wL{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,n,i){return"none"}destroy(e=!1){}}var Uu,Sm,El,Ll,Dn,qu,Hu,Ut,Tn,T0,Ef,gv,Lf,NL,ZN,Pf,I0,R0,e_,D0;class RO extends wL{constructor({docId:t,ownerDocument:r=globalThis.document}){super();Q(this,Ut);Q(this,Uu);Q(this,Sm);Q(this,El);Q(this,Ll);Q(this,Dn);Q(this,qu);Q(this,Hu,0);F(this,Ll,t),F(this,Dn,r)}addFilter(t){if(!t)return"none";let r=f(this,Ut,Tn).get(t);if(r)return r;const[n,i,o]=te(this,Ut,gv).call(this,t),l=t.length===1?n:`${n}${i}${o}`;if(r=f(this,Ut,Tn).get(l),r)return f(this,Ut,Tn).set(t,r),r;const c=`g_${f(this,Ll)}_transfer_map_${Gn(this,Hu)._++}`,d=te(this,Ut,Lf).call(this,c);f(this,Ut,Tn).set(t,d),f(this,Ut,Tn).set(l,d);const u=te(this,Ut,Pf).call(this,c);return te(this,Ut,R0).call(this,n,i,o,u),d}addHCMFilter(t,r){var x;const n=`${t}-${r}`,i="base";let o=f(this,Ut,T0).get(i);if((o==null?void 0:o.key)===n||(o?((x=o.filter)==null||x.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},f(this,Ut,T0).set(i,o)),!t||!r))return o.url;const l=te(this,Ut,D0).call(this,t);t=Xt.makeHexColor(...l);const c=te(this,Ut,D0).call(this,r);if(r=Xt.makeHexColor(...c),f(this,Ut,Ef).style.color="",t==="#000000"&&r==="#ffffff"||t===r)return o.url;const d=new Array(256);for(let w=0;w<=255;w++){const S=w/255;d[w]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const u=d.join(","),h=`g_${f(this,Ll)}_hcm_filter`,m=o.filter=te(this,Ut,Pf).call(this,h);te(this,Ut,R0).call(this,u,u,u,m),te(this,Ut,ZN).call(this,m);const p=(w,S)=>{const b=l[w]/255,v=c[w]/255,N=new Array(S+1);for(let j=0;j<=S;j++)N[j]=b+j/S*(v-b);return N.join(",")};return te(this,Ut,R0).call(this,p(0,5),p(1,5),p(2,5),m),o.url=te(this,Ut,Lf).call(this,h),o.url}addAlphaFilter(t){let r=f(this,Ut,Tn).get(t);if(r)return r;const[n]=te(this,Ut,gv).call(this,[t]),i=`alpha_${n}`;if(r=f(this,Ut,Tn).get(i),r)return f(this,Ut,Tn).set(t,r),r;const o=`g_${f(this,Ll)}_alpha_map_${Gn(this,Hu)._++}`,l=te(this,Ut,Lf).call(this,o);f(this,Ut,Tn).set(t,l),f(this,Ut,Tn).set(i,l);const c=te(this,Ut,Pf).call(this,o);return te(this,Ut,e_).call(this,n,c),l}addLuminosityFilter(t){let r=f(this,Ut,Tn).get(t||"luminosity");if(r)return r;let n,i;if(t?([n]=te(this,Ut,gv).call(this,[t]),i=`luminosity_${n}`):i="luminosity",r=f(this,Ut,Tn).get(i),r)return f(this,Ut,Tn).set(t,r),r;const o=`g_${f(this,Ll)}_luminosity_map_${Gn(this,Hu)._++}`,l=te(this,Ut,Lf).call(this,o);f(this,Ut,Tn).set(t,l),f(this,Ut,Tn).set(i,l);const c=te(this,Ut,Pf).call(this,o);return te(this,Ut,NL).call(this,c),t&&te(this,Ut,e_).call(this,n,c),l}addHighlightHCMFilter(t,r,n,i,o){var v;const l=`${r}-${n}-${i}-${o}`;let c=f(this,Ut,T0).get(t);if((c==null?void 0:c.key)===l||(c?((v=c.filter)==null||v.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},f(this,Ut,T0).set(t,c)),!r||!n))return c.url;const[d,u]=[r,n].map(te(this,Ut,D0).bind(this));let h=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),m=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[p,x]=[i,o].map(te(this,Ut,D0).bind(this));m<h&&([h,m,p,x]=[m,h,x,p]),f(this,Ut,Ef).style.color="";const w=(N,j,E)=>{const A=new Array(256),L=(m-h)/E,C=N/255,B=(j-N)/(255*E);let U=0;for(let P=0;P<=E;P++){const T=Math.round(h+P*L),z=C+P*B;for(let H=U;H<=T;H++)A[H]=z;U=T+1}for(let P=U;P<256;P++)A[P]=A[U-1];return A.join(",")},S=`g_${f(this,Ll)}_hcm_${t}_filter`,b=c.filter=te(this,Ut,Pf).call(this,S);return te(this,Ut,ZN).call(this,b),te(this,Ut,R0).call(this,w(p[0],x[0],5),w(p[1],x[1],5),w(p[2],x[2],5),b),c.url=te(this,Ut,Lf).call(this,S),c.url}destroy(t=!1){var r,n,i,o;t&&((r=f(this,qu))!=null&&r.size)||((n=f(this,El))==null||n.parentNode.parentNode.remove(),F(this,El,null),(i=f(this,Sm))==null||i.clear(),F(this,Sm,null),(o=f(this,qu))==null||o.clear(),F(this,qu,null),F(this,Hu,0))}}Uu=new WeakMap,Sm=new WeakMap,El=new WeakMap,Ll=new WeakMap,Dn=new WeakMap,qu=new WeakMap,Hu=new WeakMap,Ut=new WeakSet,Tn=function(){return f(this,Sm)||F(this,Sm,new Map)},T0=function(){return f(this,qu)||F(this,qu,new Map)},Ef=function(){if(!f(this,El)){const t=f(this,Dn).createElement("div"),{style:r}=t;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const n=f(this,Dn).createElementNS(ml,"svg");n.setAttribute("width",0),n.setAttribute("height",0),F(this,El,f(this,Dn).createElementNS(ml,"defs")),t.append(n),n.append(f(this,El)),f(this,Dn).body.append(t)}return f(this,El)},gv=function(t){if(t.length===1){const d=t[0],u=new Array(256);for(let m=0;m<256;m++)u[m]=d[m]/255;const h=u.join(",");return[h,h,h]}const[r,n,i]=t,o=new Array(256),l=new Array(256),c=new Array(256);for(let d=0;d<256;d++)o[d]=r[d]/255,l[d]=n[d]/255,c[d]=i[d]/255;return[o.join(","),l.join(","),c.join(",")]},Lf=function(t){if(f(this,Uu)===void 0){F(this,Uu,"");const r=f(this,Dn).URL;r!==f(this,Dn).baseURI&&(N2(r)?vs('#createUrl: ignore "data:"-URL for performance reasons.'):F(this,Uu,r.split("#",1)[0]))}return`url(${f(this,Uu)}#${t})`},NL=function(t){const r=f(this,Dn).createElementNS(ml,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(r)},ZN=function(t){const r=f(this,Dn).createElementNS(ml,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(r)},Pf=function(t){const r=f(this,Dn).createElementNS(ml,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",t),f(this,Ut,Ef).append(r),r},I0=function(t,r,n){const i=f(this,Dn).createElementNS(ml,r);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),t.append(i)},R0=function(t,r,n,i){const o=f(this,Dn).createElementNS(ml,"feComponentTransfer");i.append(o),te(this,Ut,I0).call(this,o,"feFuncR",t),te(this,Ut,I0).call(this,o,"feFuncG",r),te(this,Ut,I0).call(this,o,"feFuncB",n)},e_=function(t,r){const n=f(this,Dn).createElementNS(ml,"feComponentTransfer");r.append(n),te(this,Ut,I0).call(this,n,"feFuncA",t)},D0=function(t){return f(this,Ut,Ef).style.color=t,wj(getComputedStyle(f(this,Ut,Ef)).getPropertyValue("color"))};class _L{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Qs("Abstract method `_fetch` called.")}}class SL extends _L{async _fetch(e){const t=await w2(e,"arraybuffer");return new Uint8Array(t)}}zn&&vs("Please use the `legacy` build in Node.js environments.");async function jL(s){const t=await process.getBuiltinModule("fs").promises.readFile(s);return new Uint8Array(t)}class DO extends wL{}class MO extends bL{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class FO extends yL{async _fetch(e){return jL(e)}}class OO extends _L{async _fetch(e){return jL(e)}}const Bn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function t_(s,e){if(!e)return;const t=e[2]-e[0],r=e[3]-e[1],n=new Path2D;n.rect(e[0],e[1],t,r),s.clip(n)}class _j{getPattern(){Qs("Abstract method `getPattern` called.")}}class BO extends _j{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,r,n){let i;if(n===Bn.STROKE||n===Bn.FILL){const o=t.current.getClippedPathBoundingBox(n,dr(e))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,d=t.cachedCanvases.getCanvas("pattern",l,c),u=d.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-o[0],-o[1]),r=Xt.transform(r,[1,0,0,1,o[0],o[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),t_(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),i=e.createPattern(d.canvas,"no-repeat");const h=new DOMMatrix(r);i.setTransform(h)}else t_(e,this._bbox),i=this._createGradient(e);return i}}function Zw(s,e,t,r,n,i,o,l){const c=e.coords,d=e.colors,u=s.data,h=s.width*4;let m;c[t+1]>c[r+1]&&(m=t,t=r,r=m,m=i,i=o,o=m),c[r+1]>c[n+1]&&(m=r,r=n,n=m,m=o,o=l,l=m),c[t+1]>c[r+1]&&(m=t,t=r,r=m,m=i,i=o,o=m);const p=(c[t]+e.offsetX)*e.scaleX,x=(c[t+1]+e.offsetY)*e.scaleY,w=(c[r]+e.offsetX)*e.scaleX,S=(c[r+1]+e.offsetY)*e.scaleY,b=(c[n]+e.offsetX)*e.scaleX,v=(c[n+1]+e.offsetY)*e.scaleY;if(x>=v)return;const N=d[i],j=d[i+1],E=d[i+2],A=d[o],L=d[o+1],C=d[o+2],B=d[l],U=d[l+1],P=d[l+2],T=Math.round(x),z=Math.round(v);let H,D,M,$,q,K,de,Ne;for(let R=T;R<=z;R++){if(R<S){const ye=R<x?0:(x-R)/(x-S);H=p-(p-w)*ye,D=N-(N-A)*ye,M=j-(j-L)*ye,$=E-(E-C)*ye}else{let ye;R>v?ye=1:S===v?ye=0:ye=(S-R)/(S-v),H=w-(w-b)*ye,D=A-(A-B)*ye,M=L-(L-U)*ye,$=C-(C-P)*ye}let W;R<x?W=0:R>v?W=1:W=(x-R)/(x-v),q=p-(p-b)*W,K=N-(N-B)*W,de=j-(j-U)*W,Ne=E-(E-P)*W;const Z=Math.round(Math.min(H,q)),ue=Math.round(Math.max(H,q));let ce=h*R+Z*4;for(let ye=Z;ye<=ue;ye++)W=(H-ye)/(H-q),W<0?W=0:W>1&&(W=1),u[ce++]=D-(D-K)*W|0,u[ce++]=M-(M-de)*W|0,u[ce++]=$-($-Ne)*W|0,u[ce++]=255}}function $O(s,e,t){const r=e.coords,n=e.colors;let i,o;switch(e.type){case"lattice":const l=e.verticesPerRow,c=Math.floor(r.length/l)-1,d=l-1;for(i=0;i<c;i++){let u=i*l;for(let h=0;h<d;h++,u++)Zw(s,t,r[u],r[u+1],r[u+l],n[u],n[u+1],n[u+l]),Zw(s,t,r[u+l+1],r[u+1],r[u+l],n[u+l+1],n[u+1],n[u+l])}break;case"triangles":for(i=0,o=r.length;i<o;i+=3)Zw(s,t,r[i],r[i+1],r[i+2],n[i],n[i+1],n[i+2]);break;default:throw new Error("illegal figure")}}class zO extends _j{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,r){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-l,u=Math.ceil(this._bounds[3])-c,h=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),p=d/h,x=u/m,w={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/p,scaleY:1/x},S=h+2*2,b=m+2*2,v=r.getCanvas("mesh",S,b),N=v.context,j=N.createImageData(h,m);if(t){const A=j.data;for(let L=0,C=A.length;L<C;L+=4)A[L]=t[0],A[L+1]=t[1],A[L+2]=t[2],A[L+3]=255}for(const A of this._figures)$O(j,A,w);return N.putImageData(j,2,2),{canvas:v.canvas,offsetX:l-2*p,offsetY:c-2*x,scaleX:p,scaleY:x}}getPattern(e,t,r,n){t_(e,this._bbox);let i;if(n===Bn.SHADING)i=Xt.singularValueDecompose2dScale(dr(e));else if(i=Xt.singularValueDecompose2dScale(t.baseTransform),this.matrix){const l=Xt.singularValueDecompose2dScale(this.matrix);i=[i[0]*l[0],i[1]*l[1]]}const o=this._createMeshCanvas(i,n===Bn.SHADING?null:this._background,t.cachedCanvases);return n!==Bn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class UO extends _j{getPattern(){return"hotpink"}}function qO(s){switch(s[0]){case"RadialAxial":return new BO(s);case"Mesh":return new zO(s);case"Dummy":return new UO}throw new Error(`Unknown IR type: ${s[0]}`)}const h3={COLORED:1,UNCOLORED:2},I1=class I1{constructor(e,t,r,n,i){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=r,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:r,paintType:n,tilingType:i,color:o,canvasGraphicsFactory:l}=this;let{xstep:c,ystep:d}=this;c=Math.abs(c),d=Math.abs(d),y2("TilingType: "+i);const u=t[0],h=t[1],m=t[2],p=t[3],x=m-u,w=p-h,S=Xt.singularValueDecompose2dScale(this.matrix),b=Xt.singularValueDecompose2dScale(this.baseTransform),v=S[0]*b[0],N=S[1]*b[1];let j=x,E=w,A=!1,L=!1;const C=Math.ceil(c*v),B=Math.ceil(d*N),U=Math.ceil(x*v),P=Math.ceil(w*N);C>=U?j=c:A=!0,B>=P?E=d:L=!0;const T=this.getSizeAndScale(j,this.ctx.canvas.width,v),z=this.getSizeAndScale(E,this.ctx.canvas.height,N),H=e.cachedCanvases.getCanvas("pattern",T.size,z.size),D=H.context,M=l.createCanvasGraphics(D);if(M.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(M,n,o),D.translate(-T.scale*u,-z.scale*h),M.transform(T.scale,0,0,z.scale,0,0),D.save(),this.clipBbox(M,u,h,m,p),M.baseTransform=dr(M.ctx),M.executeOperatorList(r),M.endDrawing(),D.restore(),A||L){const $=H.canvas;A&&(j=c),L&&(E=d);const q=this.getSizeAndScale(j,this.ctx.canvas.width,v),K=this.getSizeAndScale(E,this.ctx.canvas.height,N),de=q.size,Ne=K.size,R=e.cachedCanvases.getCanvas("pattern-workaround",de,Ne),W=R.context,Z=A?Math.floor(x/c):0,ue=L?Math.floor(w/d):0;for(let ce=0;ce<=Z;ce++)for(let ye=0;ye<=ue;ye++)W.drawImage($,de*ce,Ne*ye,de,Ne,0,0,de,Ne);return{canvas:R.canvas,scaleX:q.scale,scaleY:K.scale,offsetX:u,offsetY:h}}return{canvas:H.canvas,scaleX:T.scale,scaleY:z.scale,offsetX:u,offsetY:h}}getSizeAndScale(e,t,r){const n=Math.max(I1.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*r);return i>=n?i=n:r=i/e,{scale:r,size:i}}clipBbox(e,t,r,n,i){const o=n-t,l=i-r;e.ctx.rect(t,r,o,l),e.current.updateRectMinMax(dr(e.ctx),[t,r,n,i]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,r){const n=e.ctx,i=e.current;switch(t){case h3.COLORED:const o=this.ctx;n.fillStyle=o.fillStyle,n.strokeStyle=o.strokeStyle,i.fillColor=o.fillStyle,i.strokeColor=o.strokeStyle;break;case h3.UNCOLORED:const l=Xt.makeHexColor(r[0],r[1],r[2]);n.fillStyle=l,n.strokeStyle=l,i.fillColor=l,i.strokeColor=l;break;default:throw new pO(`Unsupported paint type: ${t}`)}}getPattern(e,t,r,n){let i=r;n!==Bn.SHADING&&(i=Xt.transform(i,t.baseTransform),this.matrix&&(i=Xt.transform(i,this.matrix)));const o=this.createPatternCanvas(t);let l=new DOMMatrix(i);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const c=e.createPattern(o.canvas,"repeat");return c.setTransform(l),c}};ss(I1,"MAX_PATTERN_SIZE",3e3);let s_=I1;function HO({src:s,srcPos:e=0,dest:t,width:r,height:n,nonBlackColor:i=4294967295,inverseDecode:o=!1}){const l=ni.isLittleEndian?4278190080:255,[c,d]=o?[i,l]:[l,i],u=r>>3,h=r&7,m=s.length;t=new Uint32Array(t.buffer);let p=0;for(let x=0;x<n;x++){for(const S=e+u;e<S;e++){const b=e<m?s[e]:255;t[p++]=b&128?d:c,t[p++]=b&64?d:c,t[p++]=b&32?d:c,t[p++]=b&16?d:c,t[p++]=b&8?d:c,t[p++]=b&4?d:c,t[p++]=b&2?d:c,t[p++]=b&1?d:c}if(h===0)continue;const w=e<m?s[e++]:255;for(let S=0;S<h;S++)t[p++]=w&1<<7-S?d:c}return{srcPos:e,destPos:p}}const f3=16,m3=100,WO=15,p3=10,g3=1e3,vi=16;function VO(s,e){if(s._removeMirroring)throw new Error("Context is already forwarding operations.");s.__originalSave=s.save,s.__originalRestore=s.restore,s.__originalRotate=s.rotate,s.__originalScale=s.scale,s.__originalTranslate=s.translate,s.__originalTransform=s.transform,s.__originalSetTransform=s.setTransform,s.__originalResetTransform=s.resetTransform,s.__originalClip=s.clip,s.__originalMoveTo=s.moveTo,s.__originalLineTo=s.lineTo,s.__originalBezierCurveTo=s.bezierCurveTo,s.__originalRect=s.rect,s.__originalClosePath=s.closePath,s.__originalBeginPath=s.beginPath,s._removeMirroring=()=>{s.save=s.__originalSave,s.restore=s.__originalRestore,s.rotate=s.__originalRotate,s.scale=s.__originalScale,s.translate=s.__originalTranslate,s.transform=s.__originalTransform,s.setTransform=s.__originalSetTransform,s.resetTransform=s.__originalResetTransform,s.clip=s.__originalClip,s.moveTo=s.__originalMoveTo,s.lineTo=s.__originalLineTo,s.bezierCurveTo=s.__originalBezierCurveTo,s.rect=s.__originalRect,s.closePath=s.__originalClosePath,s.beginPath=s.__originalBeginPath,delete s._removeMirroring},s.save=function(){e.save(),this.__originalSave()},s.restore=function(){e.restore(),this.__originalRestore()},s.translate=function(r,n){e.translate(r,n),this.__originalTranslate(r,n)},s.scale=function(r,n){e.scale(r,n),this.__originalScale(r,n)},s.transform=function(r,n,i,o,l,c){e.transform(r,n,i,o,l,c),this.__originalTransform(r,n,i,o,l,c)},s.setTransform=function(r,n,i,o,l,c){e.setTransform(r,n,i,o,l,c),this.__originalSetTransform(r,n,i,o,l,c)},s.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},s.rotate=function(r){e.rotate(r),this.__originalRotate(r)},s.clip=function(r){e.clip(r),this.__originalClip(r)},s.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},s.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},s.bezierCurveTo=function(t,r,n,i,o,l){e.bezierCurveTo(t,r,n,i,o,l),this.__originalBezierCurveTo(t,r,n,i,o,l)},s.rect=function(t,r,n,i){e.rect(t,r,n,i),this.__originalRect(t,r,n,i)},s.closePath=function(){e.closePath(),this.__originalClosePath()},s.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class GO{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let n;return this.cache[e]!==void 0?(n=this.cache[e],this.canvasFactory.reset(n,t,r)):(n=this.canvasFactory.create(t,r),this.cache[e]=n),n}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Py(s,e,t,r,n,i,o,l,c,d){const[u,h,m,p,x,w]=dr(s);if(h===0&&m===0){const v=o*u+x,N=Math.round(v),j=l*p+w,E=Math.round(j),A=(o+c)*u+x,L=Math.abs(Math.round(A)-N)||1,C=(l+d)*p+w,B=Math.abs(Math.round(C)-E)||1;return s.setTransform(Math.sign(u),0,0,Math.sign(p),N,E),s.drawImage(e,t,r,n,i,0,0,L,B),s.setTransform(u,h,m,p,x,w),[L,B]}if(u===0&&p===0){const v=l*m+x,N=Math.round(v),j=o*h+w,E=Math.round(j),A=(l+d)*m+x,L=Math.abs(Math.round(A)-N)||1,C=(o+c)*h+w,B=Math.abs(Math.round(C)-E)||1;return s.setTransform(0,Math.sign(h),Math.sign(m),0,N,E),s.drawImage(e,t,r,n,i,0,0,B,L),s.setTransform(u,h,m,p,x,w),[B,L]}s.drawImage(e,t,r,n,i,o,l,c,d);const S=Math.hypot(u,h),b=Math.hypot(m,p);return[S*c,b*d]}function YO(s){const{width:e,height:t}=s;if(e>g3||t>g3)return null;const r=1e3,n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=e+1;let o=new Uint8Array(i*(t+1)),l,c,d;const u=e+7&-8;let h=new Uint8Array(u*t),m=0;for(const b of s.data){let v=128;for(;v>0;)h[m++]=b&v?0:255,v>>=1}let p=0;for(m=0,h[m]!==0&&(o[0]=1,++p),c=1;c<e;c++)h[m]!==h[m+1]&&(o[c]=h[m]?2:1,++p),m++;for(h[m]!==0&&(o[c]=2,++p),l=1;l<t;l++){m=l*u,d=l*i,h[m-u]!==h[m]&&(o[d]=h[m]?1:8,++p);let b=(h[m]?4:0)+(h[m-u]?8:0);for(c=1;c<e;c++)b=(b>>2)+(h[m+1]?4:0)+(h[m-u+1]?8:0),n[b]&&(o[d+c]=n[b],++p),m++;if(h[m-u]!==h[m]&&(o[d+c]=h[m]?2:4,++p),p>r)return null}for(m=u*(t-1),d=l*i,h[m]!==0&&(o[d]=8,++p),c=1;c<e;c++)h[m]!==h[m+1]&&(o[d+c]=h[m]?4:8,++p),m++;if(h[m]!==0&&(o[d+c]=4,++p),p>r)return null;const x=new Int32Array([0,i,-1,0,-i,0,0,0,1]),w=new Path2D;for(l=0;p&&l<=t;l++){let b=l*i;const v=b+e;for(;b<v&&!o[b];)b++;if(b===v)continue;w.moveTo(b%i,l);const N=b;let j=o[b];do{const E=x[j];do b+=E;while(!o[b]);const A=o[b];A!==5&&A!==10?(j=A,o[b]=0):(j=A&51*j>>4,o[b]&=j>>2|j<<2),w.lineTo(b%i,b/i|0),o[b]||--p}while(N!==b);--l}return h=null,o=null,function(b){b.save(),b.scale(1/e,-1/t),b.translate(0,-t),b.fill(w),b.beginPath(),b.restore()}}class x3{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=DE,this.textMatrixScale=1,this.fontMatrix=LN,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Pn.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,r){[t,r]=Xt.applyTransform([t,r],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,r),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,r)}updateRectMinMax(e,t){const r=Xt.applyTransform(t,e),n=Xt.applyTransform(t.slice(2),e),i=Xt.applyTransform([t[0],t[3]],e),o=Xt.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,r[0],n[0],i[0],o[0]),this.minY=Math.min(this.minY,r[1],n[1],i[1],o[1]),this.maxX=Math.max(this.maxX,r[0],n[0],i[0],o[0]),this.maxY=Math.max(this.maxY,r[1],n[1],i[1],o[1])}updateScalingPathMinMax(e,t){Xt.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,r,n,i,o,l,c,d,u){const h=Xt.bezierBoundingBox(t,r,n,i,o,l,c,d,u);u||this.updateRectMinMax(e,h)}getPathBoundingBox(e=Bn.FILL,t=null){const r=[this.minX,this.minY,this.maxX,this.maxY];if(e===Bn.STROKE){t||Qs("Stroke bounding box must include transform.");const n=Xt.singularValueDecompose2dScale(t),i=n[0]*this.lineWidth/2,o=n[1]*this.lineWidth/2;r[0]-=i,r[1]-=o,r[2]+=i,r[3]+=o}return r}updateClipFromPath(){const e=Xt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Bn.FILL,t=null){return Xt.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function b3(s,e){if(e instanceof ImageData){s.putImageData(e,0,0);return}const t=e.height,r=e.width,n=t%vi,i=(t-n)/vi,o=n===0?i:i+1,l=s.createImageData(r,vi);let c=0,d;const u=e.data,h=l.data;let m,p,x,w;if(e.kind===av.GRAYSCALE_1BPP){const S=u.byteLength,b=new Uint32Array(h.buffer,0,h.byteLength>>2),v=b.length,N=r+7>>3,j=4294967295,E=ni.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(x=m<i?vi:n,d=0,p=0;p<x;p++){const A=S-c;let L=0;const C=A>N?r:A*8-7,B=C&-8;let U=0,P=0;for(;L<B;L+=8)P=u[c++],b[d++]=P&128?j:E,b[d++]=P&64?j:E,b[d++]=P&32?j:E,b[d++]=P&16?j:E,b[d++]=P&8?j:E,b[d++]=P&4?j:E,b[d++]=P&2?j:E,b[d++]=P&1?j:E;for(;L<C;L++)U===0&&(P=u[c++],U=128),b[d++]=P&U?j:E,U>>=1}for(;d<v;)b[d++]=0;s.putImageData(l,0,m*vi)}}else if(e.kind===av.RGBA_32BPP){for(p=0,w=r*vi*4,m=0;m<i;m++)h.set(u.subarray(c,c+w)),c+=w,s.putImageData(l,0,p),p+=vi;m<o&&(w=r*n*4,h.set(u.subarray(c,c+w)),s.putImageData(l,0,p))}else if(e.kind===av.RGB_24BPP)for(x=vi,w=r*x,m=0;m<o;m++){for(m>=i&&(x=n,w=r*x),d=0,p=w;p--;)h[d++]=u[c++],h[d++]=u[c++],h[d++]=u[c++],h[d++]=255;s.putImageData(l,0,m*vi)}else throw new Error(`bad image kind: ${e.kind}`)}function y3(s,e){if(e.bitmap){s.drawImage(e.bitmap,0,0);return}const t=e.height,r=e.width,n=t%vi,i=(t-n)/vi,o=n===0?i:i+1,l=s.createImageData(r,vi);let c=0;const d=e.data,u=l.data;for(let h=0;h<o;h++){const m=h<i?vi:n;({srcPos:c}=HO({src:d,srcPos:c,dest:u,width:r,height:m,nonBlackColor:0})),s.putImageData(l,0,h*vi)}}function g0(s,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of t)s[r]!==void 0&&(e[r]=s[r]);s.setLineDash!==void 0&&(e.setLineDash(s.getLineDash()),e.lineDashOffset=s.lineDashOffset)}function Ty(s){if(s.strokeStyle=s.fillStyle="#000000",s.fillRule="nonzero",s.globalAlpha=1,s.lineWidth=1,s.lineCap="butt",s.lineJoin="miter",s.miterLimit=10,s.globalCompositeOperation="source-over",s.font="10px sans-serif",s.setLineDash!==void 0&&(s.setLineDash([]),s.lineDashOffset=0),!zn){const{filter:e}=s;e!=="none"&&e!==""&&(s.filter="none")}}function v3(s,e){if(e)return!0;const t=Xt.singularValueDecompose2dScale(s);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const r=Math.fround((globalThis.devicePixelRatio||1)*Rd.PDF_TO_CSS_UNITS);return t[0]<=r&&t[1]<=r}const KO=["butt","round","square"],XO=["miter","round","bevel"],JO={},w3={};var fo,r_,n_,i_;const Pj=class Pj{constructor(e,t,r,n,i,{optionalContentConfig:o,markedContentStack:l=null},c,d){Q(this,fo);this.ctx=e,this.current=new x3(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=n,this.filterFactory=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=o,this.cachedCanvases=new GO(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:n=null}){const i=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,i,o),this.ctx.fillStyle=l,r){const c=this.cachedCanvases.getCanvas("transparent",i,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...dr(this.compositeCtx))}this.ctx.save(),Ty(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=dr(this.ctx)}executeOperatorList(e,t,r,n){const i=e.argsArray,o=e.fnArray;let l=t||0;const c=i.length;if(c===l)return l;const d=c-l>p3&&typeof r=="function",u=d?Date.now()+WO:0;let h=0;const m=this.commonObjs,p=this.objs;let x;for(;;){if(n!==void 0&&l===n.nextBreakPoint)return n.breakIt(l,r),l;if(x=o[l],x!==qa.dependency)this[x].apply(this,i[l]);else for(const w of i[l]){const S=w.startsWith("g_")?m:p;if(!S.has(w))return S.get(w,r),l}if(l++,l===c)return l;if(d&&++h>p3){if(Date.now()>u)return r(),l;h=0}}}endDrawing(){te(this,fo,r_).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),te(this,fo,n_).call(this)}_scaleImage(e,t){const r=e.width??e.displayWidth,n=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),l=r,c=n,d="prescale1",u,h;for(;i>2&&l>1||o>2&&c>1;){let m=l,p=c;i>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),i/=l/m),o>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/p),u=this.cachedCanvases.getCanvas(d,m,p),h=u.context,h.clearRect(0,0,m,p),h.drawImage(e,0,0,l,c,0,0,m,p),e=u.canvas,l=m,c=p,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:r,height:n}=e,i=this.current.fillColor,o=this.current.patternFill,l=dr(t);let c,d,u,h;if((e.bitmap||e.data)&&e.count>1){const C=e.bitmap||e.data.buffer;d=JSON.stringify(o?l:[l.slice(0,4),i]),c=this._cachedBitmapsMap.get(C),c||(c=new Map,this._cachedBitmapsMap.set(C,c));const B=c.get(d);if(B&&!o){const U=Math.round(Math.min(l[0],l[2])+l[4]),P=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:B,offsetX:U,offsetY:P}}u=B}u||(h=this.cachedCanvases.getCanvas("maskCanvas",r,n),y3(h.context,e));let m=Xt.transform(l,[1/r,0,0,-1/n,0,0]);m=Xt.transform(m,[1,0,0,1,0,-n]);const[p,x,w,S]=Xt.getAxialAlignedBoundingBox([0,0,r,n],m),b=Math.round(w-p)||1,v=Math.round(S-x)||1,N=this.cachedCanvases.getCanvas("fillCanvas",b,v),j=N.context,E=p,A=x;j.translate(-E,-A),j.transform(...m),u||(u=this._scaleImage(h.canvas,No(j)),u=u.img,c&&o&&c.set(d,u)),j.imageSmoothingEnabled=v3(dr(j),e.interpolate),Py(j,u,0,0,u.width,u.height,0,0,r,n),j.globalCompositeOperation="source-in";const L=Xt.transform(No(j),[1,0,0,1,-E,-A]);return j.fillStyle=o?i.getPattern(t,this,L,Bn.FILL):i,j.fillRect(0,0,r,n),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(d,N.canvas)),{canvas:N.canvas,offsetX:Math.round(E),offsetY:Math.round(A)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=KO[e]}setLineJoin(e){this.ctx.lineJoin=XO[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,r]of e)switch(t){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.current.fillAlpha=r,this.ctx.globalAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(r,e,t);this.suspendedCtx=this.ctx,this.ctx=n.context;const i=this.ctx;i.setTransform(...dr(this.suspendedCtx)),g0(this.suspendedCtx,i),VO(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),g0(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,n){const i=n[0],o=n[1],l=n[2]-i,c=n[3]-o;l===0||c===0||(this.genericComposeSMask(t.context,r,l,c,t.subtype,t.backdrop,t.transferMap,i,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,n,i,o,l,c,d,u,h){let m=e.canvas,p=c-u,x=d-h;if(o){const S=Xt.makeHexColor(...o);if(p<0||x<0||p+r>m.width||x+n>m.height){const b=this.cachedCanvases.getCanvas("maskExtension",r,n),v=b.context;v.drawImage(m,-p,-x),v.globalCompositeOperation="destination-atop",v.fillStyle=S,v.fillRect(0,0,r,n),v.globalCompositeOperation="source-over",m=b.canvas,p=x=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(p,x,r,n),e.clip(b),e.globalCompositeOperation="destination-atop",e.fillStyle=S,e.fillRect(p,x,r,n),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&l?t.filter=this.filterFactory.addAlphaFilter(l):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(l));const w=new Path2D;w.rect(c,d,r,n),t.clip(w),t.globalCompositeOperation="destination-in",t.drawImage(m,p,x,r,n,c,d,r,n),t.restore()}save(){this.inSMaskMode?(g0(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),g0(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,r,n,i,o){this.ctx.transform(e,t,r,n,i,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r){const n=this.ctx,i=this.current;let o=i.x,l=i.y,c,d;const u=dr(n),h=u[0]===0&&u[3]===0||u[1]===0&&u[2]===0,m=h?r.slice(0):null;for(let p=0,x=0,w=e.length;p<w;p++)switch(e[p]|0){case qa.rectangle:o=t[x++],l=t[x++];const S=t[x++],b=t[x++],v=o+S,N=l+b;n.moveTo(o,l),S===0||b===0?n.lineTo(v,N):(n.lineTo(v,l),n.lineTo(v,N),n.lineTo(o,N)),h||i.updateRectMinMax(u,[o,l,v,N]),n.closePath();break;case qa.moveTo:o=t[x++],l=t[x++],n.moveTo(o,l),h||i.updatePathMinMax(u,o,l);break;case qa.lineTo:o=t[x++],l=t[x++],n.lineTo(o,l),h||i.updatePathMinMax(u,o,l);break;case qa.curveTo:c=o,d=l,o=t[x+4],l=t[x+5],n.bezierCurveTo(t[x],t[x+1],t[x+2],t[x+3],o,l),i.updateCurvePathMinMax(u,c,d,t[x],t[x+1],t[x+2],t[x+3],o,l,m),x+=6;break;case qa.curveTo2:c=o,d=l,n.bezierCurveTo(o,l,t[x],t[x+1],t[x+2],t[x+3]),i.updateCurvePathMinMax(u,c,d,o,l,t[x],t[x+1],t[x+2],t[x+3],m),o=t[x+2],l=t[x+3],x+=4;break;case qa.curveTo3:c=o,d=l,o=t[x+2],l=t[x+3],n.bezierCurveTo(t[x],t[x+1],o,l,o,l),i.updateCurvePathMinMax(u,c,d,t[x],t[x+1],o,l,o,l,m),x+=4;break;case qa.closePath:n.closePath();break}h&&i.updateScalingPathMinMax(u,m),i.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,r=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof r=="object"&&(r!=null&&r.getPattern)?(t.save(),t.strokeStyle=r.getPattern(t,this,No(t),Bn.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,r=this.current.fillColor,n=this.current.patternFill;let i=!1;n&&(t.save(),t.fillStyle=r.getPattern(t,this,No(t),Bn.FILL),i=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),i&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=JO}eoClip(){this.pendingClip=w3}beginText(){this.current.textMatrix=DE,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const r=new Path2D,n=t.getTransform().invertSelf();for(const{transform:i,x:o,y:l,fontSize:c,path:d}of e)r.addPath(d,new DOMMatrix(i).preMultiplySelf(n).translate(o,l).scale(c,-c));t.clip(r),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var u;const r=this.commonObjs.get(e),n=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(n.fontMatrix=r.fontMatrix||LN,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&vs("Invalid font matrix for font "+e),t<0?(t=-t,n.fontDirection=-1):n.fontDirection=1,this.current.font=r,this.current.fontSize=t,r.isType3Font)return;const i=r.loadedName||"sans-serif",o=((u=r.systemFontInfo)==null?void 0:u.css)||`"${i}", ${r.fallbackName}`;let l="normal";r.black?l="900":r.bold&&(l="bold");const c=r.italic?"italic":"normal";let d=t;t<f3?d=f3:t>m3&&(d=m3),this.current.fontSizeScale=t/d,this.ctx.font=`${c} ${l} ${d}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,r,n,i,o){this.current.textMatrix=[e,t,r,n,i,o],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,r,n,i){const o=this.ctx,l=this.current,c=l.font,d=l.textRenderingMode,u=l.fontSize/l.fontSizeScale,h=d&Pn.FILL_STROKE_MASK,m=!!(d&Pn.ADD_TO_PATH_FLAG),p=l.patternFill&&!c.missingFile,x=l.patternStroke&&!c.missingFile;let w;if((c.disableFontFace||m||p||x)&&(w=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||p||x){if(o.save(),o.translate(t,r),o.scale(u,-u),h===Pn.FILL||h===Pn.FILL_STROKE)if(n){const S=o.getTransform();o.setTransform(...n),o.fill(te(this,fo,i_).call(this,w,S,n))}else o.fill(w);if(h===Pn.STROKE||h===Pn.FILL_STROKE)if(i){const S=o.getTransform();o.setTransform(...i),o.stroke(te(this,fo,i_).call(this,w,S,i))}else o.lineWidth/=u,o.stroke(w);o.restore()}else(h===Pn.FILL||h===Pn.FILL_STROKE)&&o.fillText(e,t,r),(h===Pn.STROKE||h===Pn.FILL_STROKE)&&o.strokeText(e,t,r);m&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:dr(o),x:t,y:r,fontSize:u,path:w})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let r=!1;for(let n=3;n<t.length;n+=4)if(t[n]>0&&t[n]<255){r=!0;break}return js(this,"isFontSubpixelAAEnabled",r)}showText(e){const t=this.current,r=t.font;if(r.isType3Font)return this.showType3Text(e);const n=t.fontSize;if(n===0)return;const i=this.ctx,o=t.fontSizeScale,l=t.charSpacing,c=t.wordSpacing,d=t.fontDirection,u=t.textHScale*d,h=e.length,m=r.vertical,p=m?1:-1,x=r.defaultVMetrics,w=n*t.fontMatrix[0],S=t.textRenderingMode===Pn.FILL&&!r.disableFontFace&&!t.patternFill;i.save(),i.transform(...t.textMatrix),i.translate(t.x,t.y+t.textRise),d>0?i.scale(u,-1):i.scale(u,1);let b,v;if(t.patternFill){i.save();const L=t.fillColor.getPattern(i,this,No(i),Bn.FILL);b=dr(i),i.restore(),i.fillStyle=L}if(t.patternStroke){i.save();const L=t.strokeColor.getPattern(i,this,No(i),Bn.STROKE);v=dr(i),i.restore(),i.strokeStyle=L}let N=t.lineWidth;const j=t.textMatrixScale;if(j===0||N===0){const L=t.textRenderingMode&Pn.FILL_STROKE_MASK;(L===Pn.STROKE||L===Pn.FILL_STROKE)&&(N=this.getSinglePixelWidth())}else N/=j;if(o!==1&&(i.scale(o,o),N/=o),i.lineWidth=N,r.isInvalidPDFjsFont){const L=[];let C=0;for(const B of e)L.push(B.unicode),C+=B.width;i.fillText(L.join(""),0,0),t.x+=C*w*u,i.restore(),this.compose();return}let E=0,A;for(A=0;A<h;++A){const L=e[A];if(typeof L=="number"){E+=p*L*n/1e3;continue}let C=!1;const B=(L.isSpace?c:0)+l,U=L.fontChar,P=L.accent;let T,z,H=L.width;if(m){const M=L.vmetric||x,$=-(L.vmetric?M[1]:H*.5)*w,q=M[2]*w;H=M?-M[0]:H,T=$/o,z=(E+q)/o}else T=E/o,z=0;if(r.remeasure&&H>0){const M=i.measureText(U).width*1e3/n*o;if(H<M&&this.isFontSubpixelAAEnabled){const $=H/M;C=!0,i.save(),i.scale($,1),T/=$}else H!==M&&(T+=(H-M)/2e3*n/o)}if(this.contentVisible&&(L.isInFont||r.missingFile)){if(S&&!P)i.fillText(U,T,z);else if(this.paintChar(U,T,z,b,v),P){const M=T+n*P.offset.x/o,$=z-n*P.offset.y/o;this.paintChar(P.fontChar,M,$,b,v)}}const D=m?H*w-B*d:H*w+B*d;E+=D,C&&i.restore()}m?t.y-=E:t.x+=E*u,i.restore(),this.compose()}showType3Text(e){const t=this.ctx,r=this.current,n=r.font,i=r.fontSize,o=r.fontDirection,l=n.vertical?1:-1,c=r.charSpacing,d=r.wordSpacing,u=r.textHScale*o,h=r.fontMatrix||LN,m=e.length,p=r.textRenderingMode===Pn.INVISIBLE;let x,w,S,b;if(!(p||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...r.textMatrix),t.translate(r.x,r.y),t.scale(u,o),x=0;x<m;++x){if(w=e[x],typeof w=="number"){b=l*w*i/1e3,this.ctx.translate(b,0),r.x+=b*u;continue}const v=(w.isSpace?d:0)+c,N=n.charProcOperatorList[w.operatorListId];if(!N){vs(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),t.scale(i,i),t.transform(...h),this.executeOperatorList(N),this.restore()),S=Xt.applyTransform([w.width,0],h)[0]*i+v,t.translate(S,0),r.x+=S*u}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,r,n,i,o){this.ctx.rect(r,n,i-r,o-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const r=e[1],n=this.baseTransform||dr(this.ctx),i={createCanvasGraphics:o=>new Pj(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new s_(e,r,this.ctx,i,n)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,r){this.ctx.strokeStyle=this.current.strokeColor=Xt.makeHexColor(e,t,r),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,r){this.ctx.fillStyle=this.current.fillColor=Xt.makeHexColor(e,t,r),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=qO(this.getObject(e)),this.cachedPatterns.set(e,r)),t&&(r.matrix=t),r}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const r=this._getPattern(e);t.fillStyle=r.getPattern(t,this,No(t),Bn.SHADING);const n=No(t);if(n){const{width:i,height:o}=t.canvas,[l,c,d,u]=Xt.getAxialAlignedBoundingBox([0,0,i,o],n);this.ctx.fillRect(l,c,d-l,u-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Qs("Should not call beginInlineImage")}beginImageData(){Qs("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=dr(this.ctx),t)){const r=t[2]-t[0],n=t[3]-t[1];this.ctx.rect(t[0],t[1],r,n),this.current.updateRectMinMax(dr(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||y2("TODO: Support non-isolated groups."),e.knockout&&vs("Knockout groups not supported.");const r=dr(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let n=Xt.getAxialAlignedBoundingBox(e.bbox,dr(t));const i=[0,0,t.canvas.width,t.canvas.height];n=Xt.intersect(n,i)||[0,0,0,0];const o=Math.floor(n[0]),l=Math.floor(n[1]),c=Math.max(Math.ceil(n[2])-o,1),d=Math.max(Math.ceil(n[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,d]);let u="groupAt"+this.groupLevel;e.smask&&(u+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(u,c,d),m=h.context;m.translate(-o,-l),m.transform(...r),e.smask?this.smaskStack.push({canvas:h.canvas,context:m,offsetX:o,offsetY:l,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,l),t.save()),g0(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const n=dr(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...n);const i=Xt.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],n);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(e,t,r,n,i){if(te(this,fo,r_).call(this),Ty(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],l=t[3]-t[1];if(i&&this.annotationCanvasMap){r=r.slice(),r[4]-=t[0],r[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=l;const[c,d]=Xt.singularValueDecompose2dScale(dr(this.ctx)),{viewportScale:u}=this,h=Math.ceil(o*this.outputScaleX*u),m=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,m);const{canvas:p,context:x}=this.annotationCanvas;this.annotationCanvasMap.set(e,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=x,this.ctx.save(),this.ctx.setTransform(c,0,0,-d,0,l*d),Ty(this.ctx)}else Ty(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],o,l),this.ctx.clip(),this.ctx.beginPath()}this.current=new x3(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),te(this,fo,n_).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const r=this.ctx,n=this.processingType3;if(n&&(n.compiled===void 0&&(n.compiled=YO(e)),n.compiled)){n.compiled(r);return}const i=this._createMaskCanvas(e),o=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,i.offsetX,i.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r=0,n=0,i,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const l=this.ctx;l.save();const c=dr(l);l.transform(t,r,n,i,0,0);const d=this._createMaskCanvas(e);l.setTransform(1,0,0,1,d.offsetX-c[4],d.offsetY-c[5]);for(let u=0,h=o.length;u<h;u+=2){const m=Xt.transform(c,[t,r,n,i,o[u],o[u+1]]),[p,x]=Xt.applyTransform([0,0],m);l.drawImage(d.canvas,p,x)}l.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,r=this.current.fillColor,n=this.current.patternFill;for(const i of e){const{data:o,width:l,height:c,transform:d}=i,u=this.cachedCanvases.getCanvas("maskCanvas",l,c),h=u.context;h.save();const m=this.getObject(o,i);y3(h,m),h.globalCompositeOperation="source-in",h.fillStyle=n?r.getPattern(h,this,No(t),Bn.FILL):r,h.fillRect(0,0,l,c),h.restore(),t.save(),t.transform(...d),t.scale(1,-1),Py(t,u.canvas,0,0,l,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){vs("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,r,n){if(!this.contentVisible)return;const i=this.getObject(e);if(!i){vs("Dependent image isn't ready yet");return}const o=i.width,l=i.height,c=[];for(let d=0,u=n.length;d<u;d+=2)c.push({transform:[t,0,0,r,n[d],n[d+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(i,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:r,height:n}=e,i=this.cachedCanvases.getCanvas("inlineImage",r,n),o=i.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,r=e.height,n=this.ctx;if(this.save(),!zn){const{filter:l}=n;l!=="none"&&l!==""&&(n.filter="none")}n.scale(1/t,-1/r);let i;if(e.bitmap)i=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)i=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,r).context;b3(c,e),i=this.applyTransferMapsToCanvas(c)}const o=this._scaleImage(i,No(n));n.imageSmoothingEnabled=v3(dr(n),e.interpolate),Py(n,o.img,0,0,o.paintWidth,o.paintHeight,0,-r,t,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const r=this.ctx;let n;if(e.bitmap)n=e.bitmap;else{const i=e.width,o=e.height,c=this.cachedCanvases.getCanvas("inlineImage",i,o).context;b3(c,e),n=this.applyTransferMapsToCanvas(c)}for(const i of t)r.save(),r.transform(...i.transform),r.scale(1,-1),Py(r,n,i.x,i.y,i.w,i.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const r=this.ctx;this.pendingClip&&(t||(this.pendingClip===w3?r.clip("evenodd"):r.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),r.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=dr(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),n=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,n)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:r,c:n,d:i}=this.ctx.getTransform();let o,l;if(r===0&&n===0){const c=Math.abs(t),d=Math.abs(i);if(c===d)if(e===0)o=l=1/c;else{const u=c*e;o=l=u<1?1/u:1}else if(e===0)o=1/c,l=1/d;else{const u=c*e,h=d*e;o=u<1?1/u:1,l=h<1?1/h:1}}else{const c=Math.abs(t*i-r*n),d=Math.hypot(t,r),u=Math.hypot(n,i);if(e===0)o=u/c,l=d/c;else{const h=e*c;o=u>h?u/h:1,l=d>h?d/h:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:r}=this.current,[n,i]=this.getScaleForStroking();if(t.lineWidth=r||1,n===1&&i===1){t.stroke();return}const o=t.getLineDash();if(e&&t.save(),t.scale(n,i),o.length>0){const l=Math.max(n,i);t.setLineDash(o.map(c=>c/l)),t.lineDashOffset/=l}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};fo=new WeakSet,r_=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},n_=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},i_=function(e,t,r){const n=new Path2D;return n.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(t)),n};let am=Pj;for(const s in qa)am.prototype[s]!==void 0&&(am.prototype[qa[s]]=am.prototype[s]);var fx,mx;class Gl{static get workerPort(){return f(this,fx)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");F(this,fx,e)}static get workerSrc(){return f(this,mx)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");F(this,mx,e)}}fx=new WeakMap,mx=new WeakMap,Q(Gl,fx,null),Q(Gl,mx,"");var Wu,px;class QO{constructor({parsedData:e,rawData:t}){Q(this,Wu);Q(this,px);F(this,Wu,e),F(this,px,t)}getRaw(){return f(this,px)}get(e){return f(this,Wu).get(e)??null}getAll(){return gj(f(this,Wu))}has(e){return f(this,Wu).has(e)}}Wu=new WeakMap,px=new WeakMap;const Tf=Symbol("INTERNAL");var gx,xx,bx,jm;class ZO{constructor(e,{name:t,intent:r,usage:n,rbGroups:i}){Q(this,gx,!1);Q(this,xx,!1);Q(this,bx,!1);Q(this,jm,!0);F(this,gx,!!(e&Vi.DISPLAY)),F(this,xx,!!(e&Vi.PRINT)),this.name=t,this.intent=r,this.usage=n,this.rbGroups=i}get visible(){if(f(this,bx))return f(this,jm);if(!f(this,jm))return!1;const{print:e,view:t}=this.usage;return f(this,gx)?(t==null?void 0:t.viewState)!=="OFF":f(this,xx)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,r=!1){e!==Tf&&Qs("Internal method `_setVisible` called."),F(this,bx,r),F(this,jm,t)}}gx=new WeakMap,xx=new WeakMap,bx=new WeakMap,jm=new WeakMap;var Qc,Hs,Am,km,yx,a_;class eB{constructor(e,t=Vi.DISPLAY){Q(this,yx);Q(this,Qc,null);Q(this,Hs,new Map);Q(this,Am,null);Q(this,km,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,F(this,km,e.order);for(const r of e.groups)f(this,Hs).set(r.id,new ZO(t,r));if(e.baseState==="OFF")for(const r of f(this,Hs).values())r._setVisible(Tf,!1);for(const r of e.on)f(this,Hs).get(r)._setVisible(Tf,!0);for(const r of e.off)f(this,Hs).get(r)._setVisible(Tf,!1);F(this,Am,this.getHash())}}isVisible(e){if(f(this,Hs).size===0)return!0;if(!e)return y2("Optional content group not defined."),!0;if(e.type==="OCG")return f(this,Hs).has(e.id)?f(this,Hs).get(e.id).visible:(vs(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return te(this,yx,a_).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!f(this,Hs).has(t))return vs(`Optional content group not found: ${t}`),!0;if(f(this,Hs).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!f(this,Hs).has(t))return vs(`Optional content group not found: ${t}`),!0;if(!f(this,Hs).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!f(this,Hs).has(t))return vs(`Optional content group not found: ${t}`),!0;if(!f(this,Hs).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!f(this,Hs).has(t))return vs(`Optional content group not found: ${t}`),!0;if(f(this,Hs).get(t).visible)return!1}return!0}return vs(`Unknown optional content policy ${e.policy}.`),!0}return vs(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){var i;const n=f(this,Hs).get(e);if(!n){vs(`Optional content group not found: ${e}`);return}if(r&&t&&n.rbGroups.length)for(const o of n.rbGroups)for(const l of o)l!==e&&((i=f(this,Hs).get(l))==null||i._setVisible(Tf,!1,!0));n._setVisible(Tf,!!t,!0),F(this,Qc,null)}setOCGState({state:e,preserveRB:t}){let r;for(const n of e){switch(n){case"ON":case"OFF":case"Toggle":r=n;continue}const i=f(this,Hs).get(n);if(i)switch(r){case"ON":this.setVisibility(n,!0,t);break;case"OFF":this.setVisibility(n,!1,t);break;case"Toggle":this.setVisibility(n,!i.visible,t);break}}F(this,Qc,null)}get hasInitialVisibility(){return f(this,Am)===null||this.getHash()===f(this,Am)}getOrder(){return f(this,Hs).size?f(this,km)?f(this,km).slice():[...f(this,Hs).keys()]:null}getGroups(){return f(this,Hs).size>0?gj(f(this,Hs)):null}getGroup(e){return f(this,Hs).get(e)||null}getHash(){if(f(this,Qc)!==null)return f(this,Qc);const e=new hL;for(const[t,r]of f(this,Hs))e.update(`${t}:${r.visible}`);return F(this,Qc,e.hexdigest())}}Qc=new WeakMap,Hs=new WeakMap,Am=new WeakMap,km=new WeakMap,yx=new WeakSet,a_=function(e){const t=e.length;if(t<2)return!0;const r=e[0];for(let n=1;n<t;n++){const i=e[n];let o;if(Array.isArray(i))o=te(this,yx,a_).call(this,i);else if(f(this,Hs).has(i))o=f(this,Hs).get(i).visible;else return vs(`Optional content group not found: ${i}`),!0;switch(r){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return r==="And"};class tB{constructor(e,{disableRange:t=!1,disableStream:r=!1}){zr(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:i,progressiveDone:o,contentDispositionFilename:l}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=l,(i==null?void 0:i.length)>0){const c=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,d)=>{this._onReceiveData({begin:c,chunk:d})}),e.addProgressListener((c,d)=>{this._onProgress({loaded:c,total:d})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const n=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(r),!0)});zr(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,r,n,i;e.total===void 0?(r=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||r.call(t,{loaded:e.loaded}):(i=(n=this._fullRequestReader)==null?void 0:n.onProgress)==null||i.call(n,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){zr(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new sB(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new rB(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeReaders.slice(0))r.cancel(e);this._pdfDataRangeTransport.abort()}}class sB{constructor(e,t,r=!1,n=null){this._stream=e,this._done=r||!1,this._filename=yj(n)?n:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class rB{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function nB(s){let e=!0,t=r("filename\\*","i").exec(s);if(t){t=t[1];let u=l(t);return u=unescape(u),u=c(u),u=d(u),i(u)}if(t=o(s),t){const u=d(t);return i(u)}if(t=r("filename","i").exec(s),t){t=t[1];let u=l(t);return u=d(u),i(u)}function r(u,h){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function n(u,h){if(u){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const m=new TextDecoder(u,{fatal:!0}),p=v2(h);h=m.decode(p),e=!1}catch{}}return h}function i(u){return e&&/[\x80-\xff]/.test(u)&&(u=n("utf-8",u),e&&(u=n("iso-8859-1",u))),u}function o(u){const h=[];let m;const p=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=p.exec(u))!==null;){let[,w,S,b]=m;if(w=parseInt(w,10),w in h){if(w===0)break;continue}h[w]=[S,b]}const x=[];for(let w=0;w<h.length&&w in h;++w){let[S,b]=h[w];b=l(b),S&&(b=unescape(b),w===0&&(b=c(b))),x.push(b)}return x.join("")}function l(u){if(u.startsWith('"')){const h=u.slice(1).split('\\"');for(let m=0;m<h.length;++m){const p=h[m].indexOf('"');p!==-1&&(h[m]=h[m].slice(0,p),h.length=m+1),h[m]=h[m].replaceAll(/\\(.)/g,"$1")}u=h.join('"')}return u}function c(u){const h=u.indexOf("'");if(h===-1)return u;const m=u.slice(0,h),x=u.slice(h+1).replace(/^[^']*'/,"");return n(m,x)}function d(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,m,p,x){if(p==="q"||p==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,S){return String.fromCharCode(parseInt(S,16))}),n(m,x);try{x=atob(x)}catch{}return n(m,x)})}return""}function AL(s,e){const t=new Headers;if(!s||!e||typeof e!="object")return t;for(const r in e){const n=e[r];n!==void 0&&t.append(r,n)}return t}function _2(s){try{return new URL(s).origin}catch{}return null}function kL({responseHeaders:s,isHttp:e,rangeChunkSize:t,disableRange:r}){const n={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(s.get("Content-Length"),10);return!Number.isInteger(i)||(n.suggestedLength=i,i<=2*t)||r||!e||s.get("Accept-Ranges")!=="bytes"||(s.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function CL(s){const e=s.get("Content-Disposition");if(e){let t=nB(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(yj(t))return t}return null}function S2(s,e){return s===404||s===0&&e.startsWith("file:")?new Rg('Missing PDF "'+e+'".'):new g1(`Unexpected server response (${s}) while retrieving PDF "${e}".`,s)}function EL(s){return s===200||s===206}function LL(s,e,t){return{method:"GET",headers:s,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function PL(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:(vs(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class N3{constructor(e){ss(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=AL(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return zr(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new iB(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new aB(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class iB{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const r=new Headers(e.headers),n=t.url;fetch(n,LL(r,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=_2(i.url),!EL(i.status))throw S2(i.status,n);this._reader=i.body.getReader(),this._headersCapability.resolve();const o=i.headers,{allowRangeRequests:l,suggestedLength:c}=kL({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=c||this._contentLength,this._filename=CL(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Id("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:PL(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class aB{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const n=e.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${r-1}`);const o=n.url;fetch(o,LL(i,this._withCredentials,this._abortController)).then(l=>{const c=_2(l.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!EL(l.status))throw S2(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:PL(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const e5=200,t5=206;function oB(s){const e=s.response;return typeof e!="string"?e:v2(e).buffer}class lB{constructor({url:e,httpHeaders:t,withCredentials:r}){ss(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=AL(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,r=this.currXhrId++,n=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,o]of this.headers)t.setRequestHeader(i,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.expectedStatus=t5):n.expectedStatus=e5,t.responseType="arraybuffer",zr(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),n.onHeadersReceived=e.onHeadersReceived,n.onDone=e.onDone,n.onError=e.onError,n.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){var n;const r=this.pendingRequests[e];r&&((n=r.onProgress)==null||n.call(r,t))}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const n=r.xhr;if(n.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),n.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],n.status===0&&this.isHttp){r.onError(n.status);return}const i=n.status||e5;if(!(i===e5&&r.expectedStatus===t5)&&i!==r.expectedStatus){r.onError(n.status);return}const l=oB(n);if(i===t5){const c=n.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);d?r.onDone({begin:parseInt(d[1],10),chunk:l}):(vs('Missing or invalid "Content-Range" header.'),r.onError(0))}else l?r.onDone({begin:0,chunk:l}):r.onError(n.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class cB{constructor(e){this._source=e,this._manager=new lB(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return zr(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new dB(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new uB(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class dB{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=_2(t.responseURL);const r=t.getAllResponseHeaders(),n=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[c,...d]=l.split(": ");return[c,d.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:o}=kL({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=CL(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=S2(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class uB{constructor(e,t,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=_2((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=S2(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const hB=/^[a-z][a-z0-9\-+.]+:/i;function fB(s){if(hB.test(s))return new URL(s);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(s))}class mB{constructor(e){this.source=e,this.url=fB(e.url),zr(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return zr(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new pB(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new gB(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class pB{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=new Rg(`Missing PDF "${this._url}".`)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Id("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class gB{constructor(e,t,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=e.source;this._isStreamingSupported=!n.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const xB=1e5,mi=30,bB=.8;var G3,Zc,bi,vx,wx,Vu,Pl,Nx,_x,Gu,Cm,Em,ed,Lm,Sx,Pm,Yu,jx,Ax,Ku,Xu,kx,td,Tm,ac,TL,IL,o_,ea,xv,l_,RL,DL;const Vr=class Vr{constructor({textContentSource:e,container:t,viewport:r}){Q(this,ac);Q(this,Zc,Promise.withResolvers());Q(this,bi,null);Q(this,vx,!1);Q(this,wx,!!((G3=globalThis.FontInspector)!=null&&G3.enabled));Q(this,Vu,null);Q(this,Pl,null);Q(this,Nx,0);Q(this,_x,0);Q(this,Gu,null);Q(this,Cm,null);Q(this,Em,0);Q(this,ed,0);Q(this,Lm,Object.create(null));Q(this,Sx,[]);Q(this,Pm,null);Q(this,Yu,[]);Q(this,jx,new WeakMap);Q(this,Ax,null);var c;if(e instanceof ReadableStream)F(this,Pm,e);else if(typeof e=="object")F(this,Pm,new ReadableStream({start(d){d.enqueue(e),d.close()}}));else throw new Error('No "textContentSource" parameter specified.');F(this,bi,F(this,Cm,t)),F(this,ed,r.scale*(globalThis.devicePixelRatio||1)),F(this,Em,r.rotation),F(this,Pl,{div:null,properties:null,ctx:null});const{pageWidth:n,pageHeight:i,pageX:o,pageY:l}=r.rawDims;F(this,Ax,[1,0,0,-1,-o,l+i]),F(this,_x,n),F(this,Nx,i),te(c=Vr,ea,RL).call(c),Oh(t,r),f(this,Zc).promise.finally(()=>{f(Vr,Tm).delete(this),F(this,Pl,null),F(this,Lm,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=ni.platform;return js(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{f(this,Gu).read().then(({value:t,done:r})=>{if(r){f(this,Zc).resolve();return}f(this,Vu)??F(this,Vu,t.lang),Object.assign(f(this,Lm),t.styles),te(this,ac,TL).call(this,t.items),e()},f(this,Zc).reject)};return F(this,Gu,f(this,Pm).getReader()),f(Vr,Tm).add(this),e(),f(this,Zc).promise}update({viewport:e,onBefore:t=null}){var i;const r=e.scale*(globalThis.devicePixelRatio||1),n=e.rotation;if(n!==f(this,Em)&&(t==null||t(),F(this,Em,n),Oh(f(this,Cm),{rotation:n})),r!==f(this,ed)){t==null||t(),F(this,ed,r);const o={div:null,properties:null,ctx:te(i=Vr,ea,xv).call(i,f(this,Vu))};for(const l of f(this,Yu))o.properties=f(this,jx).get(l),o.div=l,te(this,ac,o_).call(this,o)}}cancel(){var t;const e=new Id("TextLayer task cancelled.");(t=f(this,Gu))==null||t.cancel(e).catch(()=>{}),F(this,Gu,null),f(this,Zc).reject(e)}get textDivs(){return f(this,Yu)}get textContentItemsStr(){return f(this,Sx)}static cleanup(){if(!(f(this,Tm).size>0)){f(this,Ku).clear();for(const{canvas:e}of f(this,Xu).values())e.remove();f(this,Xu).clear()}}};Zc=new WeakMap,bi=new WeakMap,vx=new WeakMap,wx=new WeakMap,Vu=new WeakMap,Pl=new WeakMap,Nx=new WeakMap,_x=new WeakMap,Gu=new WeakMap,Cm=new WeakMap,Em=new WeakMap,ed=new WeakMap,Lm=new WeakMap,Sx=new WeakMap,Pm=new WeakMap,Yu=new WeakMap,jx=new WeakMap,Ax=new WeakMap,Ku=new WeakMap,Xu=new WeakMap,kx=new WeakMap,td=new WeakMap,Tm=new WeakMap,ac=new WeakSet,TL=function(e){var n,i;if(f(this,vx))return;(i=f(this,Pl)).ctx??(i.ctx=te(n=Vr,ea,xv).call(n,f(this,Vu)));const t=f(this,Yu),r=f(this,Sx);for(const o of e){if(t.length>xB){vs("Ignoring additional textDivs for performance reasons."),F(this,vx,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const l=f(this,bi);F(this,bi,document.createElement("span")),f(this,bi).classList.add("markedContent"),o.id!==null&&f(this,bi).setAttribute("id",`${o.id}`),l.append(f(this,bi))}else o.type==="endMarkedContent"&&F(this,bi,f(this,bi).parentNode);continue}r.push(o.str),te(this,ac,IL).call(this,o)}},IL=function(e){var w;const t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};f(this,Yu).push(t);const n=Xt.transform(f(this,Ax),e.transform);let i=Math.atan2(n[1],n[0]);const o=f(this,Lm)[e.fontName];o.vertical&&(i+=Math.PI/2);let l=f(this,wx)&&o.fontSubstitution||o.fontFamily;l=Vr.fontFamilyMap.get(l)||l;const c=Math.hypot(n[2],n[3]),d=c*te(w=Vr,ea,DL).call(w,l,f(this,Vu));let u,h;i===0?(u=n[4],h=n[5]-d):(u=n[4]+d*Math.sin(i),h=n[5]-d*Math.cos(i));const m="calc(var(--scale-factor)*",p=t.style;f(this,bi)===f(this,Cm)?(p.left=`${(100*u/f(this,_x)).toFixed(2)}%`,p.top=`${(100*h/f(this,Nx)).toFixed(2)}%`):(p.left=`${m}${u.toFixed(2)}px)`,p.top=`${m}${h.toFixed(2)}px)`),p.fontSize=`${m}${(f(Vr,td)*c).toFixed(2)}px)`,p.fontFamily=l,r.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,f(this,wx)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),i!==0&&(r.angle=i*(180/Math.PI));let x=!1;if(e.str.length>1)x=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const S=Math.abs(e.transform[0]),b=Math.abs(e.transform[3]);S!==b&&Math.max(S,b)/Math.min(S,b)>1.5&&(x=!0)}if(x&&(r.canvasWidth=o.vertical?e.height:e.width),f(this,jx).set(t,r),f(this,Pl).div=t,f(this,Pl).properties=r,te(this,ac,o_).call(this,f(this,Pl)),r.hasText&&f(this,bi).append(t),r.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),f(this,bi).append(S)}},o_=function(e){var l;const{div:t,properties:r,ctx:n}=e,{style:i}=t;let o="";if(f(Vr,td)>1&&(o=`scale(${1/f(Vr,td)})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:c}=i,{canvasWidth:d,fontSize:u}=r;te(l=Vr,ea,l_).call(l,n,u*f(this,ed),c);const{width:h}=n.measureText(t.textContent);h>0&&(o=`scaleX(${d*f(this,ed)/h}) ${o}`)}r.angle!==0&&(o=`rotate(${r.angle}deg) ${o}`),o.length>0&&(i.transform=o)},ea=new WeakSet,xv=function(e=null){let t=f(this,Xu).get(e||(e=""));if(!t){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),f(this,Xu).set(e,t),f(this,kx).set(t,{size:0,family:""})}return t},l_=function(e,t,r){const n=f(this,kx).get(e);t===n.size&&r===n.family||(e.font=`${t}px ${r}`,n.size=t,n.family=r)},RL=function(){if(f(this,td)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),F(this,td,e.getBoundingClientRect().height),e.remove()},DL=function(e,t){const r=f(this,Ku).get(e);if(r)return r;const n=te(this,ea,xv).call(this,t);n.canvas.width=n.canvas.height=mi,te(this,ea,l_).call(this,n,mi,e);const i=n.measureText("");let o=i.fontBoundingBoxAscent,l=Math.abs(i.fontBoundingBoxDescent);if(o){const u=o/(o+l);return f(this,Ku).set(e,u),n.canvas.width=n.canvas.height=0,u}n.strokeStyle="red",n.clearRect(0,0,mi,mi),n.strokeText("g",0,0);let c=n.getImageData(0,0,mi,mi).data;l=0;for(let u=c.length-1-3;u>=0;u-=4)if(c[u]>0){l=Math.ceil(u/4/mi);break}n.clearRect(0,0,mi,mi),n.strokeText("A",0,mi),c=n.getImageData(0,0,mi,mi).data,o=0;for(let u=0,h=c.length;u<h;u+=4)if(c[u]>0){o=mi-Math.floor(u/4/mi);break}n.canvas.width=n.canvas.height=0;const d=o?o/(o+l):bB;return f(this,Ku).set(e,d),d},Q(Vr,ea),Q(Vr,Ku,new Map),Q(Vr,Xu,new Map),Q(Vr,kx,new WeakMap),Q(Vr,td,null),Q(Vr,Tm,new Set);let Dg=Vr;class Mg{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};function n(i){var c;if(!i)return;let o=null;const l=i.name;if(l==="#text")o=i.value;else if(Mg.shouldBuildText(l))(c=i==null?void 0:i.attributes)!=null&&c.textContent?o=i.attributes.textContent:i.value&&(o=i.value);else return;if(o!==null&&t.push({str:o}),!!i.children)for(const d of i.children)n(d)}return n(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const yB=65536,vB=100,wB=5e3,NB=zn?MO:IO,_B=zn?FO:vL,SB=zn?DO:RO,jB=zn?OO:SL;function AB(s={}){typeof s=="string"||s instanceof URL?s={url:s}:(s instanceof ArrayBuffer||ArrayBuffer.isView(s))&&(s={data:s});const e=new c_,{docId:t}=e,r=s.url?kB(s.url):null,n=s.data?CB(s.data):null,i=s.httpHeaders||null,o=s.withCredentials===!0,l=s.password??null,c=s.range instanceof ML?s.range:null,d=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:yB;let u=s.worker instanceof om?s.worker:null;const h=s.verbosity,m=typeof s.docBaseUrl=="string"&&!N2(s.docBaseUrl)?s.docBaseUrl:null,p=typeof s.cMapUrl=="string"?s.cMapUrl:null,x=s.cMapPacked!==!1,w=s.CMapReaderFactory||_B,S=typeof s.standardFontDataUrl=="string"?s.standardFontDataUrl:null,b=s.StandardFontDataFactory||jB,v=s.stopAtErrors!==!0,N=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,j=s.isEvalSupported!==!1,E=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!zn,A=typeof s.isImageDecoderSupported=="boolean"?s.isImageDecoderSupported:!zn&&(ni.platform.isFirefox||!globalThis.chrome),L=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,C=typeof s.disableFontFace=="boolean"?s.disableFontFace:zn,B=s.fontExtraProperties===!0,U=s.enableXfa===!0,P=s.ownerDocument||globalThis.document,T=s.disableRange===!0,z=s.disableStream===!0,H=s.disableAutoFetch===!0,D=s.pdfBug===!0,M=s.CanvasFactory||NB,$=s.FilterFactory||SB,q=s.enableHWA===!0,K=c?c.length:s.length??NaN,de=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!zn&&!C,Ne=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:w===vL&&b===SL&&p&&S&&k0(p,document.baseURI)&&k0(S,document.baseURI),R=null;uO(h);const W={canvasFactory:new M({ownerDocument:P,enableHWA:q}),filterFactory:new $({docId:t,ownerDocument:P}),cMapReaderFactory:Ne?null:new w({baseUrl:p,isCompressed:x}),standardFontDataFactory:Ne?null:new b({baseUrl:S})};if(!u){const ce={verbosity:h,port:Gl.workerPort};u=ce.port?om.fromPort(ce):new om(ce),e._worker=u}const Z={docId:t,apiVersion:"4.10.38",data:n,password:l,disableAutoFetch:H,rangeChunkSize:d,length:K,docBaseUrl:m,enableXfa:U,evaluatorOptions:{maxImageSize:N,disableFontFace:C,ignoreErrors:v,isEvalSupported:j,isOffscreenCanvasSupported:E,isImageDecoderSupported:A,canvasMaxAreaInBytes:L,fontExtraProperties:B,useSystemFonts:de,cMapUrl:Ne?p:null,standardFontDataUrl:Ne?S:null}},ue={disableFontFace:C,fontExtraProperties:B,ownerDocument:P,pdfBug:D,styleElement:R,loadingParams:{disableAutoFetch:H,enableXfa:U}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const ce=u.messageHandler.sendWithPromise("GetDocRequest",Z,n?[n.buffer]:null);let ye;if(c)ye=new tB(c,{disableRange:T,disableStream:z});else if(!n){if(!r)throw new Error("getDocument - no `url` parameter provided.");let Se;if(zn)if(k0(r)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Se=N3}else Se=mB;else Se=k0(r)?N3:cB;ye=new Se({url:r,length:K,httpHeaders:i,withCredentials:o,rangeChunkSize:d,disableRange:T,disableStream:z})}return ce.then(Se=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Ee=new P0(t,Se,u.port),De=new TB(Ee,e,ye,ue,W);e._transport=De,Ee.send("Ready",null)})}).catch(e._capability.reject),e}function kB(s){if(s instanceof URL)return s.href;try{return new URL(s,window.location).href}catch{if(zn&&typeof s=="string")return s}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function CB(s){if(zn&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return v2(s);if(s instanceof ArrayBuffer||ArrayBuffer.isView(s)||typeof s=="object"&&!isNaN(s==null?void 0:s.length))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function _3(s){return typeof s=="object"&&Number.isInteger(s==null?void 0:s.num)&&s.num>=0&&Number.isInteger(s==null?void 0:s.gen)&&s.gen>=0}var R1;const D1=class D1{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Gn(D1,R1)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,r,n;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,i}this._transport=null,(n=this._worker)==null||n.destroy(),this._worker=null}};R1=new WeakMap,Q(D1,R1,0);let c_=D1;class ML{constructor(e,t,r=!1,n=null){this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const r of this._rangeListeners)r(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Qs("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class EB{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return js(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var sd,Tl,_a,If,bv;class LB{constructor(e,t,r,n=!1){Q(this,_a);Q(this,sd,null);Q(this,Tl,!1);this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=n?new c3:null,this._pdfBug=n,this.commonObjs=r.commonObjs,this.objs=new FL,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:n=0,dontFlip:i=!1}={}){return new yb({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:n,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return js(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:r="display",annotationMode:n=Oc.ENABLE,transform:i=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:d=null,printAnnotationStorage:u=null,isEditing:h=!1}){var j,E;(j=this._stats)==null||j.time("Overall");const m=this._transport.getRenderingIntent(r,n,u,h),{renderingIntent:p,cacheKey:x}=m;F(this,Tl,!1),te(this,_a,bv).call(this),l||(l=this._transport.getOptionalContentConfig(p));let w=this._intentStates.get(x);w||(w=Object.create(null),this._intentStates.set(x,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const S=!!(p&Vi.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(E=this._stats)==null||E.time("Page Request"),this._pumpOperatorList(m));const b=A=>{var L;w.renderTasks.delete(v),(this._maybeCleanupAfterRender||S)&&F(this,Tl,!0),te(this,_a,If).call(this,!S),A?(v.capability.reject(A),this._abortOperatorList({intentState:w,reason:A instanceof Error?A:new Error(A)})):v.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(L=globalThis.Stats)!=null&&L.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},v=new u_({callback:b,params:{canvasContext:e,viewport:t,transform:i,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:d});(w.renderTasks||(w.renderTasks=new Set)).add(v);const N=v.task;return Promise.all([w.displayReadyCapability.promise,l]).then(([A,L])=>{var C;if(this.destroyed){b();return}if((C=this._stats)==null||C.time("Rendering"),!(L.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");v.initializeGraphics({transparency:A,optionalContentConfig:L}),v.operatorListChanged()}).catch(b),N}getOperatorList({intent:e="display",annotationMode:t=Oc.ENABLE,printAnnotationStorage:r=null,isEditing:n=!1}={}){var d;function i(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(c))}const o=this._transport.getRenderingIntent(e,t,r,n,!0);let l=this._intentStates.get(o.cacheKey);l||(l=Object.create(null),this._intentStates.set(o.cacheKey,l));let c;return l.opListReadCapability||(c=Object.create(null),c.operatorListChanged=i,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(c),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(d=this._stats)==null||d.time("Page Request"),this._pumpOperatorList(o)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>Mg.textContent(r));const t=this.streamTextContent(e);return new Promise(function(r,n){function i(){o.read().then(function({value:c,done:d}){if(d){r(l);return}l.lang??(l.lang=c.lang),Object.assign(l.styles,c.styles),l.items.push(...c.items),i()},n)}const o=t.getReader(),l={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),F(this,Tl,!1),te(this,_a,bv).call(this),Promise.all(e)}cleanup(e=!1){F(this,Tl,!0);const t=te(this,_a,If).call(this,!1);return e&&t&&this._stats&&(this._stats=new c3),t}_startRenderPage(e,t){var n,i;const r=this._intentStates.get(t);r&&((n=this._stats)==null||n.timeEnd("Page Request"),(i=r.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let r=0,n=e.length;r<n;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const r of t.renderTasks)r.operatorListChanged();e.lastChunk&&te(this,_a,If).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:n}){const{map:i,transfer:o}=r,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:n},o).getReader(),d=this._intentStates.get(t);d.streamReader=c;const u=()=>{c.read().then(({value:h,done:m})=>{if(m){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,d),u())},h=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const m of d.renderTasks)m.operatorListChanged();te(this,_a,If).call(this,!0)}if(d.displayReadyCapability)d.displayReadyCapability.reject(h);else if(d.opListReadCapability)d.opListReadCapability.reject(h);else throw h}})};u()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof bj){let n=vB;t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},n);return}}if(e.streamReader.cancel(new Id(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[n,i]of this._intentStates)if(i===e){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}sd=new WeakMap,Tl=new WeakMap,_a=new WeakSet,If=function(e=!1){if(te(this,_a,bv).call(this),!f(this,Tl)||this.destroyed)return!1;if(e)return F(this,sd,setTimeout(()=>{F(this,sd,null),te(this,_a,If).call(this,!1)},wB)),!1;for(const{renderTasks:t,operatorList:r}of this._intentStates.values())if(t.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),F(this,Tl,!1),!0},bv=function(){f(this,sd)&&(clearTimeout(f(this,sd)),F(this,sd,null))};var Il,M1;class PB{constructor(){Q(this,Il,new Map);Q(this,M1,Promise.resolve())}postMessage(e,t){const r={data:structuredClone(e,t?{transfer:t}:null)};f(this,M1).then(()=>{for(const[n]of f(this,Il))n.call(this,r)})}addEventListener(e,t,r=null){let n=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:i}=r;if(i.aborted){vs("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);n=()=>i.removeEventListener("abort",o),i.addEventListener("abort",o)}f(this,Il).set(t,n)}removeEventListener(e,t){const r=f(this,Il).get(t);r==null||r(),f(this,Il).delete(t)}terminate(){for(const[,e]of f(this,Il))e==null||e();f(this,Il).clear()}}Il=new WeakMap,M1=new WeakMap;var F1,Ju,Qu,Im,yv,Rm,vv;const cr=class cr{constructor({name:e=null,port:t=null,verbosity:r=hO()}={}){Q(this,Im);var n;if(this.name=e,this.destroyed=!1,this.verbosity=r,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((n=f(cr,Qu))!=null&&n.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(f(cr,Qu)||F(cr,Qu,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new P0("main","worker",e),this._messageHandler.on("ready",function(){}),te(this,Im,yv).call(this)}_initialize(){if(f(cr,Ju)||f(cr,Rm,vv)){this._setupFakeWorker();return}let{workerSrc:e}=cr;try{cr._isSameOrigin(window.location.href,e)||(e=cr._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),r=new P0("main","worker",t),n=()=>{i.abort(),r.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=new AbortController;t.addEventListener("error",()=>{this._webWorker||n()},{signal:i.signal}),r.on("test",l=>{if(i.abort(),this.destroyed||!l){n();return}this._messageHandler=r,this._port=t,this._webWorker=t,te(this,Im,yv).call(this)}),r.on("ready",l=>{if(i.abort(),this.destroyed){n();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const l=new Uint8Array;r.send("test",l,[l.buffer])};o();return}catch{y2("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){f(cr,Ju)||(vs("Setting up fake worker."),F(cr,Ju,!0)),cr._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new PB;this._port=t;const r=`fake${Gn(cr,F1)._++}`,n=new P0(r+"_worker",r,t);e.setup(n,t),this._messageHandler=new P0(r,r+"_worker",t),te(this,Im,yv).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,r;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=f(cr,Qu))==null||t.delete(this._port),this._port=null,(r=this._messageHandler)==null||r.destroy(),this._messageHandler=null}static fromPort(e){var r;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(r=f(this,Qu))==null?void 0:r.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new cr(e)}static get workerSrc(){if(Gl.workerSrc)return Gl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return js(this,"_setupFakeWorkerGlobal",(async()=>f(this,Rm,vv)?f(this,Rm,vv):(await import(this.workerSrc)).WorkerMessageHandler)())}};F1=new WeakMap,Ju=new WeakMap,Qu=new WeakMap,Im=new WeakSet,yv=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Rm=new WeakSet,vv=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},Q(cr,Rm),Q(cr,F1,0),Q(cr,Ju,!1),Q(cr,Qu),zn&&(F(cr,Ju,!0),Gl.workerSrc||(Gl.workerSrc="./pdf.worker.mjs")),cr._isSameOrigin=(e,t)=>{let r;try{if(r=new URL(e),!r.origin||r.origin==="null")return!1}catch{return!1}const n=new URL(t,r);return r.origin===n.origin},cr._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let om=cr;var Rl,Oo,Dm,Mm,Dl,Zu,M0;class TB{constructor(e,t,r,n,i){Q(this,Zu);Q(this,Rl,new Map);Q(this,Oo,new Map);Q(this,Dm,new Map);Q(this,Mm,new Map);Q(this,Dl,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new FL,this.fontLoader=new PO({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return js(this,"annotationStorage",new Nj)}getRenderingIntent(e,t=Oc.ENABLE,r=null,n=!1,i=!1){let o=Vi.DISPLAY,l=QN;switch(e){case"any":o=Vi.ANY;break;case"display":break;case"print":o=Vi.PRINT;break;default:vs(`getRenderingIntent - invalid intent: ${e}`)}const c=o&Vi.PRINT&&r instanceof mL?r:this.annotationStorage;switch(t){case Oc.DISABLE:o+=Vi.ANNOTATIONS_DISABLE;break;case Oc.ENABLE:break;case Oc.ENABLE_FORMS:o+=Vi.ANNOTATIONS_FORMS;break;case Oc.ENABLE_STORAGE:o+=Vi.ANNOTATIONS_STORAGE,l=c.serializable;break;default:vs(`getRenderingIntent - invalid annotationMode: ${t}`)}n&&(o+=Vi.IS_EDITING),i&&(o+=Vi.OPLIST);const{ids:d,hash:u}=c.modifiedIds,h=[o,l.hash,u];return{renderingIntent:o,cacheKey:h.join("_"),annotationStorageSerializable:l,modifiedIds:d}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=f(this,Dl))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of f(this,Oo).values())e.push(n._destroy());f(this,Oo).clear(),f(this,Dm).clear(),f(this,Mm).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var n,i;this.commonObjs.clear(),this.fontLoader.clear(),f(this,Rl).clear(),this.filterFactory.destroy(),Dg.cleanup(),(n=this._networkStream)==null||n.cancelAllRequests(new Id("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,n)=>{zr(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},n.onPull=()=>{this._fullReader.read().then(function({value:i,done:o}){if(o){n.close();return}zr(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{n.error(i)})},n.onCancel=i=>{this._fullReader.cancel(i),n.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async r=>{var l;await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:o}=this._fullReader;return(!n||!i)&&(this._lastProgress&&((l=t.onProgress)==null||l.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var d;(d=t.onProgress)==null||d.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:n,isRangeSupported:i,contentLength:o}}),e.on("GetRangeReader",(r,n)=>{zr(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(r.begin,r.end);if(!i){n.close();return}n.onPull=()=>{i.read().then(function({value:o,done:l}){if(l){n.close();return}zr(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{n.error(o)})},n.onCancel=o=>{i.cancel(o),n.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new EB(r,this))}),e.on("DocException",r=>{t._capability.reject(pi(r))}),e.on("PasswordRequest",r=>{F(this,Dl,Promise.withResolvers());try{if(!t.onPassword)throw pi(r);const n=i=>{i instanceof Error?f(this,Dl).reject(i):f(this,Dl).resolve({password:i})};t.onPassword(n,r.code)}catch(n){f(this,Dl).reject(n)}return f(this,Dl).promise}),e.on("DataLoaded",r=>{var n;(n=t.onProgress)==null||n.call(t,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;f(this,Oo).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,n,i])=>{var o;if(this.destroyed||this.commonObjs.has(r))return null;switch(n){case"Font":const{disableFontFace:l,fontExtraProperties:c,pdfBug:d}=this._params;if("error"in i){const p=i.error;vs(`Error during font loading: ${p}`),this.commonObjs.resolve(r,p);break}const u=d&&((o=globalThis.FontInspector)!=null&&o.enabled)?(p,x)=>globalThis.FontInspector.fontAdded(p,x):null,h=new TO(i,{disableFontFace:l,fontExtraProperties:c,inspectFont:u});this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!c&&h.data&&(h.data=null),this.commonObjs.resolve(r,h)});break;case"CopyLocalImage":const{imageRef:m}=i;zr(m,"The imageRef must be defined.");for(const p of f(this,Oo).values())for(const[,x]of p.objs)if((x==null?void 0:x.ref)===m)return x.dataLen?(this.commonObjs.resolve(r,structuredClone(x)),x.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,i);break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),e.on("obj",([r,n,i,o])=>{var c;if(this.destroyed)return;const l=f(this,Oo).get(n);if(!l.objs.has(r)){if(l._intentStates.size===0){(c=o==null?void 0:o.bitmap)==null||c.close();return}switch(i){case"Image":l.objs.resolve(r,o),(o==null?void 0:o.dataLen)>oO&&(l._maybeCleanupAfterRender=!0);break;case"Pattern":l.objs.resolve(r,o);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",r=>{var n;this.destroyed||(n=t.onProgress)==null||n.call(t,{loaded:r.loaded,total:r.total})}),e.on("FetchBuiltInCMap",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(r)}),e.on("FetchStandardFontData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&vs("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((r=this._fullReader)==null?void 0:r.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,r=f(this,Dm).get(t);if(r)return r;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&f(this,Mm).set(i.refStr,e);const o=new LB(t,i,this,this._params.pdfBug);return f(this,Oo).set(t,o),o});return f(this,Dm).set(t,n),n}getPageIndex(e){return _3(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return te(this,Zu,M0).call(this,"GetFieldObjects")}hasJSActions(){return te(this,Zu,M0).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return te(this,Zu,M0).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return te(this,Zu,M0).call(this,"GetOptionalContentConfig").then(t=>new eB(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=f(this,Rl).get(e);if(t)return t;const r=this.messageHandler.sendWithPromise(e,null).then(n=>{var i,o;return{info:n[0],metadata:n[1]?new QO(n[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return f(this,Rl).set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of f(this,Oo).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),f(this,Rl).clear(),this.filterFactory.destroy(!0),Dg.cleanup()}}cachedPageNumber(e){if(!_3(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return f(this,Mm).get(t)??null}}Rl=new WeakMap,Oo=new WeakMap,Dm=new WeakMap,Mm=new WeakMap,Dl=new WeakMap,Zu=new WeakSet,M0=function(e,t=null){const r=f(this,Rl).get(e);if(r)return r;const n=this.messageHandler.sendWithPromise(e,t);return f(this,Rl).set(e,n),n};const x0=Symbol("INITIAL_DATA");var Fi,Cx,d_;class FL{constructor(){Q(this,Cx);Q(this,Fi,Object.create(null))}get(e,t=null){if(t){const n=te(this,Cx,d_).call(this,e);return n.promise.then(()=>t(n.data)),null}const r=f(this,Fi)[e];if(!r||r.data===x0)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=f(this,Fi)[e];return!!t&&t.data!==x0}delete(e){const t=f(this,Fi)[e];return!t||t.data===x0?!1:(delete f(this,Fi)[e],!0)}resolve(e,t=null){const r=te(this,Cx,d_).call(this,e);r.data=t,r.resolve()}clear(){var e;for(const t in f(this,Fi)){const{data:r}=f(this,Fi)[t];(e=r==null?void 0:r.bitmap)==null||e.close()}F(this,Fi,Object.create(null))}*[Symbol.iterator](){for(const e in f(this,Fi)){const{data:t}=f(this,Fi)[e];t!==x0&&(yield[e,t])}}}Fi=new WeakMap,Cx=new WeakSet,d_=function(e){var t;return(t=f(this,Fi))[e]||(t[e]={...Promise.withResolvers(),data:x0})};var rd;class IB{constructor(e){Q(this,rd,null);F(this,rd,e),this.onContinue=null}get promise(){return f(this,rd).capability.promise}cancel(e=0){f(this,rd).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=f(this,rd).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=f(this,rd);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}rd=new WeakMap;var nd,eh;const pu=class pu{constructor({callback:e,params:t,objs:r,commonObjs:n,annotationCanvasMap:i,operatorList:o,pageIndex:l,canvasFactory:c,filterFactory:d,useRequestAnimationFrame:u=!1,pdfBug:h=!1,pageColors:m=null}){Q(this,nd,null);this.callback=e,this.params=t,this.objs=r,this.commonObjs=n,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=d,this._pdfBug=h,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new IB(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,c;if(this.cancelled)return;if(this._canvas){if(f(pu,eh).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");f(pu,eh).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:n,transform:i,background:o}=this.params;this.gfx=new am(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:i,viewport:n,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var r;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),f(this,nd)&&(window.cancelAnimationFrame(f(this,nd)),F(this,nd,null)),f(pu,eh).delete(this._canvas),this.callback(e||new bj(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?F(this,nd,window.requestAnimationFrame(()=>{F(this,nd,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),f(pu,eh).delete(this._canvas),this.callback())))}};nd=new WeakMap,eh=new WeakMap,Q(pu,eh,new WeakSet);let u_=pu;const RB="4.10.38",DB="f9bea397f";function S3(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function b0(s){return Math.max(0,Math.min(255,255*s))}class j3{static CMYK_G([e,t,r,n]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+n)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=b0(e),[e,e,e]}static G_HTML([e]){const t=S3(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(b0)}static RGB_HTML(e){return`#${e.map(S3).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,n]){return["RGB",1-Math.min(1,e+n),1-Math.min(1,r+n),1-Math.min(1,t+n)]}static CMYK_rgb([e,t,r,n]){return[b0(1-Math.min(1,e+n)),b0(1-Math.min(1,r+n)),b0(1-Math.min(1,t+n))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){const n=1-e,i=1-t,o=1-r,l=Math.min(n,i,o);return["CMYK",n,i,o,l]}}class MB{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),r||(n.setAttribute("width",`${e}px`),n.setAttribute("height",`${t}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${e} ${t}`),n}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Qs("Abstract method `_createSVG` called.")}}class Sj extends MB{_createSVG(e){return document.createElementNS(ml,e)}}class OL{static setupStorage(e,t,r,n,i){const o=n.getValue(t,{value:null});switch(r.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),i==="print")break;e.addEventListener("input",l=>{n.setValue(t,{value:l.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(o.value===r.attributes.xfaOn?e.setAttribute("checked",!0):o.value===r.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",l=>{n.setValue(t,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),i==="print")break;e.addEventListener("input",l=>{n.setValue(t,{value:l.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const l of r.children)l.attributes.value===o.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}e.addEventListener("input",l=>{const c=l.target.options,d=c.selectedIndex===-1?"":c[c.selectedIndex].value;n.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:n,linkService:i}){const{attributes:o}=t,l=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${n}`);for(const[c,d]of Object.entries(o))if(d!=null)switch(c){case"class":d.length&&e.setAttribute(c,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!l||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,d)}l&&i.addLinkAttributes(e,o.href,o.newWindow),r&&o.dataId&&this.setupStorage(e,o.dataId,t,r)}static render(e){var h,m;const t=e.annotationStorage,r=e.linkService,n=e.xfaHtml,i=e.intent||"display",o=document.createElement(n.name);n.attributes&&this.setAttributes({html:o,element:n,intent:i,linkService:r});const l=i!=="richText",c=e.div;if(c.append(o),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=p}l&&c.setAttribute("class","xfaLayer xfaFont");const d=[];if(n.children.length===0){if(n.value){const p=document.createTextNode(n.value);o.append(p),l&&Mg.shouldBuildText(n.name)&&d.push(p)}return{textDivs:d}}const u=[[n,-1,o]];for(;u.length>0;){const[p,x,w]=u.at(-1);if(x+1===p.children.length){u.pop();continue}const S=p.children[++u.at(-1)[1]];if(S===null)continue;const{name:b}=S;if(b==="#text"){const N=document.createTextNode(S.value);d.push(N),w.append(N);continue}const v=(h=S==null?void 0:S.attributes)!=null&&h.xmlns?document.createElementNS(S.attributes.xmlns,b):document.createElement(b);if(w.append(v),S.attributes&&this.setAttributes({html:v,element:S,storage:t,intent:i,linkService:r}),((m=S.children)==null?void 0:m.length)>0)u.push([S,-1,v]);else if(S.value){const N=document.createTextNode(S.value);l&&Mg.shouldBuildText(b)&&d.push(N),v.append(N)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const wb=1e3,FB=9,$h=new WeakSet;function Cd(s){return{width:s[2]-s[0],height:s[3]-s[1]}}class OB{static create(e){switch(e.data.annotationType){case Hr.LINK:return new BL(e);case Hr.TEXT:return new BB(e);case Hr.WIDGET:switch(e.data.fieldType){case"Tx":return new $B(e);case"Btn":return e.data.radioButton?new UL(e):e.data.checkBox?new UB(e):new qB(e);case"Ch":return new HB(e);case"Sig":return new zB(e)}return new Vh(e);case Hr.POPUP:return new f_(e);case Hr.FREETEXT:return new GL(e);case Hr.LINE:return new VB(e);case Hr.SQUARE:return new GB(e);case Hr.CIRCLE:return new YB(e);case Hr.POLYLINE:return new YL(e);case Hr.CARET:return new XB(e);case Hr.INK:return new jj(e);case Hr.POLYGON:return new KB(e);case Hr.HIGHLIGHT:return new KL(e);case Hr.UNDERLINE:return new JB(e);case Hr.SQUIGGLY:return new QB(e);case Hr.STRIKEOUT:return new ZB(e);case Hr.STAMP:return new XL(e);case Hr.FILEATTACHMENT:return new e9(e);default:return new Rr(e)}}}var th,Fm,Om,Ex,h_;const Tj=class Tj{constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:n=!1}={}){Q(this,Ex);Q(this,th,null);Q(this,Fm,!1);Q(this,Om,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(r)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:r}){return!!(e!=null&&e.str||t!=null&&t.str||r!=null&&r.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Tj._hasPopupData(this.data)}updateEdited(e){var r;if(!this.container)return;f(this,th)||F(this,th,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&te(this,Ex,h_).call(this,t),(r=f(this,Om))==null||r.popup.updateEdited(e)}resetEdited(){var e;f(this,th)&&(te(this,Ex,h_).call(this,f(this,th).rect),(e=f(this,Om))==null||e.popup.resetEdited(),F(this,th,null))}_createContainer(e){const{data:t,parent:{page:r,viewport:n}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof Vh||(i.tabIndex=wb);const{style:o}=i;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof f_){const{rotation:w}=t;return!t.hasOwnCanvas&&w!==0&&this.setRotation(w,i),i}const{width:l,height:c}=Cd(t.rect);if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const w=t.borderStyle.horizontalCornerRadius,S=t.borderStyle.verticalCornerRadius;if(w>0||S>0){const v=`calc(${w}px * var(--scale-factor)) / calc(${S}px * var(--scale-factor))`;o.borderRadius=v}else if(this instanceof UL){const v=`calc(${l}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;o.borderRadius=v}switch(t.borderStyle.style){case p0.SOLID:o.borderStyle="solid";break;case p0.DASHED:o.borderStyle="dashed";break;case p0.BEVELED:vs("Unimplemented border style: beveled");break;case p0.INSET:vs("Unimplemented border style: inset");break;case p0.UNDERLINE:o.borderBottomStyle="solid";break}const b=t.borderColor||null;b?(F(this,Fm,!0),o.borderColor=Xt.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):o.borderWidth=0}const d=Xt.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:u,pageHeight:h,pageX:m,pageY:p}=n.rawDims;o.left=`${100*(d[0]-m)/u}%`,o.top=`${100*(d[1]-p)/h}%`;const{rotation:x}=t;return t.hasOwnCanvas||x===0?(o.width=`${100*l/u}%`,o.height=`${100*c/h}%`):this.setRotation(x,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:n}=this.parent.viewport.rawDims,{width:i,height:o}=Cd(this.data.rect);let l,c;e%180===0?(l=100*i/r,c=100*o/n):(l=100*o/r,c=100*i/n),t.style.width=`${l}%`,t.style.height=`${c}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,r,n)=>{const i=n.detail[t],o=i[0],l=i.slice(1);n.target.style[r]=j3[`${o}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[r]:j3[`${o}_rgb`](l)})};return js(this,"_commonActions",{display:t=>{const{display:r}=t.detail,n=r%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){const r=this._commonActions;for(const n of Object.keys(t.detail)){const i=e[n]||r[n];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const r=this._commonActions;for(const[n,i]of Object.entries(t)){const o=r[n];if(o){const l={detail:{[n]:i},target:e};o(l),delete t[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,r,n,i]=this.data.rect.map(w=>Math.fround(w));if(e.length===8){const[w,S,b,v]=e.subarray(2,6);if(n===w&&i===S&&t===b&&r===v)return}const{style:o}=this.container;let l;if(f(this,Fm)){const{borderColor:w,borderWidth:S}=o;o.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const c=n-t,d=i-r,{svgFactory:u}=this,h=u.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const m=u.createElement("defs");h.append(m);const p=u.createElement("clipPath"),x=`clippath_${this.data.id}`;p.setAttribute("id",x),p.setAttribute("clipPathUnits","objectBoundingBox"),m.append(p);for(let w=2,S=e.length;w<S;w+=8){const b=e[w],v=e[w+1],N=e[w+2],j=e[w+3],E=u.createElement("rect"),A=(N-t)/c,L=(i-v)/d,C=(b-N)/c,B=(v-j)/d;E.setAttribute("x",A),E.setAttribute("y",L),E.setAttribute("width",C),E.setAttribute("height",B),p.append(E),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${A}" y="${L}" width="${C}" height="${B}"/>`)}f(this,Fm)&&(l.push("</g></svg>')"),o.backgroundImage=l.join("")),this.container.append(h),this.container.style.clipPath=`url(#${x})`}_createPopup(){const{data:e}=this,t=F(this,Om,new f_({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Qs("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const r=[];if(this._fieldObjects){const n=this._fieldObjects[e];if(n)for(const{page:i,id:o,exportValues:l}of n){if(i===-1||o===t)continue;const c=typeof l=="string"?l:null,d=document.querySelector(`[data-element-id="${o}"]`);if(d&&!$h.has(d)){vs(`_getElementsByName - element not allowed: ${o}`);continue}r.push({id:o,exportValue:c,domElement:d})}return r}for(const n of document.getElementsByName(e)){const{exportValue:i}=n,o=n.getAttribute("data-element-id");o!==t&&$h.has(n)&&r.push({id:o,exportValue:i,domElement:n})}return r}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};th=new WeakMap,Fm=new WeakMap,Om=new WeakMap,Ex=new WeakSet,h_=function(e){const{container:{style:t},data:{rect:r,rotation:n},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:o,pageX:l,pageY:c}}}}=this;r==null||r.splice(0,4,...e);const{width:d,height:u}=Cd(e);t.left=`${100*(e[0]-l)/i}%`,t.top=`${100*(o-e[3]+c)/o}%`,n===0?(t.width=`${100*d/i}%`,t.height=`${100*u/o}%`):this.setRotation(n)};let Rr=Tj;var Ki,cu,$L,zL;class BL extends Rr{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});Q(this,Ki);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:r}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let i=!1;return t.url?(r.addLinkAttributes(n,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(n,t.action),i=!0):t.attachment?(te(this,Ki,$L).call(this,n,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(te(this,Ki,zL).call(this,n,t.setOCGState),i=!0):t.dest?(this._bindLink(n,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),i=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}_bindLink(t,r){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&te(this,Ki,cu).call(this)}_bindNamedAction(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),te(this,Ki,cu).call(this)}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(r.actions)){const o=n.get(i);o&&(t[o]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:i}}),!1})}t.onclick||(t.onclick=()=>!1),te(this,Ki,cu).call(this)}_bindResetFormAction(t,r){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),te(this,Ki,cu).call(this),!this._fieldObjects){vs('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{var h;n==null||n();const{fields:i,refs:o,include:l}=r,c=[];if(i.length!==0||o.length!==0){const m=new Set(o);for(const p of i){const x=this._fieldObjects[p]||[];for(const{id:w}of x)m.add(w)}for(const p of Object.values(this._fieldObjects))for(const x of p)m.has(x.id)===l&&c.push(x)}else for(const m of Object.values(this._fieldObjects))c.push(...m);const d=this.annotationStorage,u=[];for(const m of c){const{id:p}=m;switch(u.push(p),m.type){case"text":{const w=m.defaultValue||"";d.setValue(p,{value:w});break}case"checkbox":case"radiobutton":{const w=m.defaultValue===m.exportValues;d.setValue(p,{value:w});break}case"combobox":case"listbox":{const w=m.defaultValue||"";d.setValue(p,{value:w});break}default:continue}const x=document.querySelector(`[data-element-id="${p}"]`);if(x){if(!$h.has(x)){vs(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;x.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}})),!1}}}Ki=new WeakSet,cu=function(){this.container.setAttribute("data-internal-link","")},$L=function(t,r,n=null){t.href=this.linkService.getAnchorUrl(""),r.description&&(t.title=r.description),t.onclick=()=>{var i;return(i=this.downloadManager)==null||i.openOrDownloadData(r.content,r.filename,n),!1},te(this,Ki,cu).call(this)},zL=function(t,r){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(r),!1),te(this,Ki,cu).call(this)};class BB extends Rr{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Vh extends Rr{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return ni.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,n,i){r.includes("mouse")?e.addEventListener(r,o=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(r,o=>{var l;if(r==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}i&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(o)}}))})}_setEventListeners(e,t,r,n){var i,o,l;for(const[c,d]of r)(d==="Action"||(i=this.data.actions)!=null&&i[d])&&((d==="Focus"||d==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,d,n),d==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):d==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Xt.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||FB,i=e.style;let o;const l=2,c=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l),u=Math.round(d/(Kw*n))||1,h=d/u;o=Math.min(n,c(h/Kw))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l);o=Math.min(n,c(d/Kw))}i.fontSize=`calc(${o}px * var(--scale-factor))`,i.color=Xt.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class $B extends Vh{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,n){const i=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=r),i.setValue(o.id,{[n]:r})}render(){var n,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let l=o.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let d=o.formattedValue||((n=this.data.textContent)==null?void 0:n.join(`
`))||null;d&&this.data.comb&&(d=d.replaceAll(/\s+/g,""));const u={userValue:l,formattedValue:d,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=d??l,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type="text",r.setAttribute("value",d??l),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),$h.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=wb,this._setRequired(r,this.data.required),c&&(r.maxLength=c),r.addEventListener("input",m=>{e.setValue(t,{value:m.target.value}),this.setPropertyOnSiblings(r,"value",m.target.value,"value"),u.formattedValue=null}),r.addEventListener("resetform",m=>{const p=this.data.defaultFieldValue??"";r.value=u.userValue=p,u.formattedValue=null});let h=m=>{const{formattedValue:p}=u;p!=null&&(m.target.value=p),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",p=>{var w;if(u.focused)return;const{target:x}=p;u.userValue&&(x.value=u.userValue),u.lastCommittedValue=x.value,u.commitKey=1,(w=this.data.actions)!=null&&w.Focus||(u.focused=!0)}),r.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const x={value(w){u.userValue=w.detail.value??"",e.setValue(t,{value:u.userValue.toString()}),w.target.value=u.userValue},formattedValue(w){const{formattedValue:S}=w.detail;u.formattedValue=S,S!=null&&w.target!==document.activeElement&&(w.target.value=S),e.setValue(t,{formattedValue:S})},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{var N;const{charLimit:S}=w.detail,{target:b}=w;if(S===0){b.removeAttribute("maxLength");return}b.setAttribute("maxLength",S);let v=u.userValue;!v||v.length<=S||(v=v.slice(0,S),b.value=u.userValue=v,e.setValue(t,{value:v}),(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:1,selStart:b.selectionStart,selEnd:b.selectionEnd}}))}};this._dispatchEventFromSandbox(x,p)}),r.addEventListener("keydown",p=>{var S;u.commitKey=1;let x=-1;if(p.key==="Escape"?x=0:p.key==="Enter"&&!this.data.multiLine?x=2:p.key==="Tab"&&(u.commitKey=3),x===-1)return;const{value:w}=p.target;u.lastCommittedValue!==w&&(u.lastCommittedValue=w,u.userValue=w,(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:x,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const m=h;h=null,r.addEventListener("blur",p=>{var w,S;if(!u.focused||!p.relatedTarget)return;(w=this.data.actions)!=null&&w.Blur||(u.focused=!1);const{value:x}=p.target;u.userValue=x,u.lastCommittedValue!==x&&((S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:u.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),m(p)}),(i=this.data.actions)!=null&&i.Keystroke&&r.addEventListener("beforeinput",p=>{var E;u.lastCommittedValue=null;const{data:x,target:w}=p,{value:S,selectionStart:b,selectionEnd:v}=w;let N=b,j=v;switch(p.inputType){case"deleteWordBackward":{const A=S.substring(0,b).match(/\w*[^\w]*$/);A&&(N-=A[0].length);break}case"deleteWordForward":{const A=S.substring(b).match(/^[^\w]*\w*/);A&&(j+=A[0].length);break}case"deleteContentBackward":b===v&&(N-=1);break;case"deleteContentForward":b===v&&(j+=1);break}p.preventDefault(),(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,change:x||"",willCommit:!1,selStart:N,selEnd:j}})}),this._setEventListeners(r,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(h&&r.addEventListener("blur",h),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/c;r.classList.add("comb"),r.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class zB extends Vh{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class UB extends Vh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,r=t.id;let n=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",e.setValue(r,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return $h.add(i),i.setAttribute("data-element-id",r),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=wb,i.addEventListener("change",o=>{const{name:l,checked:c}=o.target;for(const d of this._getElementsByName(l,r)){const u=c&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=u),e.setValue(d.id,{value:u})}e.setValue(r,{value:c})}),i.addEventListener("resetform",o=>{const l=t.defaultFieldValue||"Off";o.target.checked=l===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",o=>{const l={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(r,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class UL extends Vh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,r=t.id;let n=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof n=="string"&&(n=n!==t.buttonValue,e.setValue(r,{value:n})),n)for(const o of this._getElementsByName(t.fieldName,r))e.setValue(o.id,{value:!1});const i=document.createElement("input");if($h.add(i),i.setAttribute("data-element-id",r),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.tabIndex=wb,i.addEventListener("change",o=>{const{name:l,checked:c}=o.target;for(const d of this._getElementsByName(l,r))e.setValue(d.id,{value:!1});e.setValue(r,{value:c})}),i.addEventListener("resetform",o=>{const l=t.defaultFieldValue;o.target.checked=l!=null&&l===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;i.addEventListener("updatefromsandbox",l=>{const c={value:d=>{const u=o===d.detail.value;for(const h of this._getElementsByName(d.target.name)){const m=u&&h.id===r;h.domElement&&(h.domElement.checked=m),e.setValue(h.id,{value:m})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class qB extends BL{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class HB extends Vh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),n=document.createElement("select");$h.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=wb;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",u=>{const h=this.data.defaultFieldValue;for(const m of n.options)m.selected=m.value===h});for(const u of this.data.options){const h=document.createElement("option");h.textContent=u.displayValue,h.value=u.exportValue,r.value.includes(u.exportValue)&&(h.setAttribute("selected",!0),i=!1),n.append(h)}let o=null;if(i){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),n.prepend(u),o=()=>{u.remove(),n.removeEventListener("input",o),o=null},n.addEventListener("input",o)}const l=u=>{const h=u?"value":"textContent",{options:m,multiple:p}=n;return p?Array.prototype.filter.call(m,x=>x.selected).map(x=>x[h]):m.selectedIndex===-1?null:m[m.selectedIndex][h]};let c=l(!1);const d=u=>{const h=u.target.options;return Array.prototype.map.call(h,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",u=>{const h={value(m){o==null||o();const p=m.detail.value,x=new Set(Array.isArray(p)?p:[p]);for(const w of n.options)w.selected=x.has(w.value);e.setValue(t,{value:l(!0)}),c=l(!1)},multipleSelection(m){n.multiple=!0},remove(m){const p=n.options,x=m.detail.remove;p[x].selected=!1,n.remove(x),p.length>0&&Array.prototype.findIndex.call(p,S=>S.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:l(!0),items:d(m)}),c=l(!1)},clear(m){for(;n.length!==0;)n.remove(0);e.setValue(t,{value:null,items:[]}),c=l(!1)},insert(m){const{index:p,displayValue:x,exportValue:w}=m.detail.insert,S=n.children[p],b=document.createElement("option");b.textContent=x,b.value=w,S?S.before(b):n.append(b),e.setValue(t,{value:l(!0),items:d(m)}),c=l(!1)},items(m){const{items:p}=m.detail;for(;n.length!==0;)n.remove(0);for(const x of p){const{displayValue:w,exportValue:S}=x,b=document.createElement("option");b.textContent=w,b.value=S,n.append(b)}n.options.length>0&&(n.options[0].selected=!0),e.setValue(t,{value:l(!0),items:d(m)}),c=l(!1)},indices(m){const p=new Set(m.detail.indices);for(const x of m.target.options)x.selected=p.has(x.index);e.setValue(t,{value:l(!0)}),c=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(h,u)}),n.addEventListener("input",u=>{var p;const h=l(!0),m=l(!1);e.setValue(t,{value:h}),u.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:m,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):n.addEventListener("input",function(u){e.setValue(t,{value:l(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class f_ extends Rr{constructor(e){const{data:t,elements:r}=e;super(e,{isRenderable:Rr._hasPopupData(t)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new WB({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",t.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(r=>`${xj}${r}`).join(",")),this.container}}var Bm,O1,B1,$m,sh,Nr,Ml,zm,Lx,Px,Um,Fl,Ka,Ol,Tx,Bl,Ix,rh,nh,Ks,wv,m_,qL,HL,WL,VL,Nv,_v,p_;class WB{constructor({container:e,color:t,elements:r,titleObj:n,modificationDate:i,contentsObj:o,richText:l,parent:c,rect:d,parentRect:u,open:h}){Q(this,Ks);Q(this,Bm,te(this,Ks,WL).bind(this));Q(this,O1,te(this,Ks,p_).bind(this));Q(this,B1,te(this,Ks,_v).bind(this));Q(this,$m,te(this,Ks,Nv).bind(this));Q(this,sh,null);Q(this,Nr,null);Q(this,Ml,null);Q(this,zm,null);Q(this,Lx,null);Q(this,Px,null);Q(this,Um,null);Q(this,Fl,!1);Q(this,Ka,null);Q(this,Ol,null);Q(this,Tx,null);Q(this,Bl,null);Q(this,Ix,null);Q(this,rh,null);Q(this,nh,!1);var m;F(this,Nr,e),F(this,Ix,n),F(this,Ml,o),F(this,Bl,l),F(this,Px,c),F(this,sh,t),F(this,Tx,d),F(this,Um,u),F(this,Lx,r),F(this,zm,vj.toDateObject(i)),this.trigger=r.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",f(this,$m)),p.addEventListener("mouseenter",f(this,B1)),p.addEventListener("mouseleave",f(this,O1)),p.classList.add("popupTriggerArea");for(const p of r)(m=p.container)==null||m.addEventListener("keydown",f(this,Bm));f(this,Nr).hidden=!0,h&&te(this,Ks,Nv).call(this)}render(){if(f(this,Ka))return;const e=F(this,Ka,document.createElement("div"));if(e.className="popup",f(this,sh)){const i=e.style.outlineColor=Xt.makeHexColor(...f(this,sh));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`:e.style.backgroundColor=Xt.makeHexColor(...f(this,sh).map(l=>Math.floor(.7*(255-l)+l)))}const t=document.createElement("span");t.className="header";const r=document.createElement("h1");if(t.append(r),{dir:r.dir,str:r.textContent}=f(this,Ix),e.append(t),f(this,zm)){const i=document.createElement("span");i.classList.add("popupDate"),i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:f(this,zm).valueOf()})),t.append(i)}const n=f(this,Ks,wv);if(n)OL.render({xfaHtml:n,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(f(this,Ml));e.append(i)}f(this,Nr).append(e)}_formatContents({str:e,dir:t}){const r=document.createElement("p");r.classList.add("popupContent"),r.dir=t;const n=e.split(/(?:\r\n?|\n)/);for(let i=0,o=n.length;i<o;++i){const l=n[i];r.append(document.createTextNode(l)),i<o-1&&r.append(document.createElement("br"))}return r}updateEdited({rect:e,popupContent:t}){var r;f(this,rh)||F(this,rh,{contentsObj:f(this,Ml),richText:f(this,Bl)}),e&&F(this,Ol,null),t&&(F(this,Bl,te(this,Ks,HL).call(this,t)),F(this,Ml,null)),(r=f(this,Ka))==null||r.remove(),F(this,Ka,null)}resetEdited(){var e;f(this,rh)&&({contentsObj:Gn(this,Ml)._,richText:Gn(this,Bl)._}=f(this,rh),F(this,rh,null),(e=f(this,Ka))==null||e.remove(),F(this,Ka,null),F(this,Ol,null))}forceHide(){F(this,nh,this.isVisible),f(this,nh)&&(f(this,Nr).hidden=!0)}maybeShow(){f(this,nh)&&(f(this,Ka)||te(this,Ks,_v).call(this),F(this,nh,!1),f(this,Nr).hidden=!1)}get isVisible(){return f(this,Nr).hidden===!1}}Bm=new WeakMap,O1=new WeakMap,B1=new WeakMap,$m=new WeakMap,sh=new WeakMap,Nr=new WeakMap,Ml=new WeakMap,zm=new WeakMap,Lx=new WeakMap,Px=new WeakMap,Um=new WeakMap,Fl=new WeakMap,Ka=new WeakMap,Ol=new WeakMap,Tx=new WeakMap,Bl=new WeakMap,Ix=new WeakMap,rh=new WeakMap,nh=new WeakMap,Ks=new WeakSet,wv=function(){const e=f(this,Bl),t=f(this,Ml);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&f(this,Bl).html||null},m_=function(){var e,t,r;return((r=(t=(e=f(this,Ks,wv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.fontSize)||0},qL=function(){var e,t,r;return((r=(t=(e=f(this,Ks,wv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.color)||null},HL=function(e){const t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},n={style:{color:f(this,Ks,qL),fontSize:f(this,Ks,m_)?`calc(${f(this,Ks,m_)}px * var(--scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:n});return r},WL=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&f(this,Fl))&&te(this,Ks,Nv).call(this)},VL=function(){if(f(this,Ol)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:n,pageY:i}}}=f(this,Px);let o=!!f(this,Um),l=o?f(this,Um):f(this,Tx);for(const x of f(this,Lx))if(!l||Xt.intersect(x.data.rect,l)!==null){l=x.data.rect,o=!0;break}const c=Xt.normalizeRect([l[0],e[3]-l[1]+e[1],l[2],e[3]-l[3]+e[1]]),u=o?l[2]-l[0]+5:0,h=c[0]+u,m=c[1];F(this,Ol,[100*(h-n)/t,100*(m-i)/r]);const{style:p}=f(this,Nr);p.left=`${f(this,Ol)[0]}%`,p.top=`${f(this,Ol)[1]}%`},Nv=function(){F(this,Fl,!f(this,Fl)),f(this,Fl)?(te(this,Ks,_v).call(this),f(this,Nr).addEventListener("click",f(this,$m)),f(this,Nr).addEventListener("keydown",f(this,Bm))):(te(this,Ks,p_).call(this),f(this,Nr).removeEventListener("click",f(this,$m)),f(this,Nr).removeEventListener("keydown",f(this,Bm)))},_v=function(){f(this,Ka)||this.render(),this.isVisible?f(this,Fl)&&f(this,Nr).classList.add("focused"):(te(this,Ks,VL).call(this),f(this,Nr).hidden=!1,f(this,Nr).style.zIndex=parseInt(f(this,Nr).style.zIndex)+1e3)},p_=function(){f(this,Nr).classList.remove("focused"),!(f(this,Fl)||!this.isVisible)&&(f(this,Nr).hidden=!0,f(this,Nr).style.zIndex=parseInt(f(this,Nr).style.zIndex)-1e3)};class GL extends Rr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ys.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Rx;class VB extends Rr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Q(this,Rx,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:r,height:n}=Cd(t.rect),i=this.svgFactory.create(r,n,!0),o=F(this,Rx,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,Rx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rx=new WeakMap;var Dx;class GB extends Rr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Q(this,Dx,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:r,height:n}=Cd(t.rect),i=this.svgFactory.create(r,n,!0),o=t.borderStyle.width,l=F(this,Dx,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",r-o),l.setAttribute("height",n-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,Dx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dx=new WeakMap;var Mx;class YB extends Rr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Q(this,Mx,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:r,height:n}=Cd(t.rect),i=this.svgFactory.create(r,n,!0),o=t.borderStyle.width,l=F(this,Mx,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",r/2),l.setAttribute("cy",n/2),l.setAttribute("rx",r/2-o/2),l.setAttribute("ry",n/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,Mx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mx=new WeakMap;var Fx;class YL extends Rr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Q(this,Fx,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:r,borderStyle:n,popupRef:i}}=this;if(!r)return this.container;const{width:o,height:l}=Cd(t),c=this.svgFactory.create(o,l,!0);let d=[];for(let h=0,m=r.length;h<m;h+=2){const p=r[h]-t[0],x=t[3]-r[h+1];d.push(`${p},${x}`)}d=d.join(" ");const u=F(this,Fx,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",d),u.setAttribute("stroke-width",n.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),c.append(u),this.container.append(c),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return f(this,Fx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fx=new WeakMap;class KB extends YL{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class XB extends Rr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Ox,ih,Bx,g_;class jj extends Rr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});Q(this,Bx);Q(this,Ox,null);Q(this,ih,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ys.HIGHLIGHT:ys.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:r,inkLists:n,borderStyle:i,popupRef:o}}=this,{transform:l,width:c,height:d}=te(this,Bx,g_).call(this,r,t),u=this.svgFactory.create(c,d,!0),h=F(this,Ox,this.svgFactory.createElement("svg:g"));u.append(h),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",l);for(let m=0,p=n.length;m<p;m++){const x=this.svgFactory.createElement(this.svgElementName);f(this,ih).push(x),x.setAttribute("points",n[m].join(",")),h.append(x)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:r,points:n,rect:i}=t,o=f(this,Ox);if(r>=0&&o.setAttribute("stroke-width",r||1),n)for(let l=0,c=f(this,ih).length;l<c;l++)f(this,ih)[l].setAttribute("points",n[l].join(","));if(i){const{transform:l,width:c,height:d}=te(this,Bx,g_).call(this,this.data.rotation,i);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${d}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return f(this,ih)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ox=new WeakMap,ih=new WeakMap,Bx=new WeakSet,g_=function(t,r){switch(t){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class KL extends Rr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ys.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class JB extends Rr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class QB extends Rr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ZB extends Rr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class XL extends Rr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ys.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var $x,zx,x_;class e9 extends Rr{constructor(t){var n;super(t,{isRenderable:!0});Q(this,zx);Q(this,$x,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(n=this.linkService.eventBus)==null||n.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:r}=this;let n;r.hasAppearance||r.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),n.addEventListener("dblclick",te(this,zx,x_).bind(this)),F(this,$x,n);const{isMac:i}=ni.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(i?o.metaKey:o.ctrlKey)&&te(this,zx,x_).call(this)}),!r.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return f(this,$x)}addHighlightArea(){this.container.classList.add("highlightArea")}}$x=new WeakMap,zx=new WeakSet,x_=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Ux,ah,oh,qx,zh,JL,b_;class t9{constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:n,page:i,viewport:o,structTreeLayer:l}){Q(this,zh);Q(this,Ux,null);Q(this,ah,null);Q(this,oh,new Map);Q(this,qx,null);this.div=e,F(this,Ux,t),F(this,ah,r),F(this,qx,l||null),this.page=i,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=n}hasEditableAnnotations(){return f(this,oh).size>0}async render(e){var o;const{annotations:t}=e,r=this.div;Oh(r,this.viewport);const n=new Map,i={data:null,layer:r,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Sj,annotationStorage:e.annotationStorage||new Nj,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const c=l.annotationType===Hr.POPUP;if(c){const h=n.get(l.id);if(!h)continue;i.elements=h}else{const{width:h,height:m}=Cd(l.rect);if(h<=0||m<=0)continue}i.data=l;const d=OB.create(i);if(!d.isRenderable)continue;if(!c&&l.popupRef){const h=n.get(l.popupRef);h?h.push(d):n.set(l.popupRef,[d])}const u=d.render();l.hidden&&(u.style.visibility="hidden"),await te(this,zh,JL).call(this,u,l.id),d._isEditable&&(f(this,oh).set(d.data.id,d),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(d))}te(this,zh,b_).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Oh(t,{rotation:e.rotation}),te(this,zh,b_).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(f(this,oh).values())}getEditableAnnotation(e){return f(this,oh).get(e)}}Ux=new WeakMap,ah=new WeakMap,oh=new WeakMap,qx=new WeakMap,zh=new WeakSet,JL=async function(e,t){var o,l;const r=e.firstChild||e,n=r.id=`${xj}${t}`,i=await((o=f(this,qx))==null?void 0:o.getAriaAttributes(n));if(i)for(const[c,d]of i)r.setAttribute(c,d);this.div.append(e),(l=f(this,Ux))==null||l.moveElementInDOM(this.div,e,r,!1)},b_=function(){if(!f(this,ah))return;const e=this.div;for(const[t,r]of f(this,ah)){const n=e.querySelector(`[data-annotation-id="${t}"]`);if(!n)continue;r.className="annotationContent";const{firstChild:i}=n;i?i.nodeName==="CANVAS"?i.replaceWith(r):i.classList.contains("annotationContent")?i.after(r):i.before(r):n.append(r)}f(this,ah).clear()};const Iy=/\r\n?|\n/g;var Xa,Oi,Hx,lh,Bi,Ur,QL,ZL,eP,Sv,Ql,jv,Av,tP,v_,sP;const rr=class rr extends xr{constructor(t){super({...t,name:"freeTextEditor"});Q(this,Ur);Q(this,Xa);Q(this,Oi,"");Q(this,Hx,`${this.id}-editor`);Q(this,lh,null);Q(this,Bi);F(this,Xa,t.color||rr._defaultColor||xr._defaultLineColor),F(this,Bi,t.fontSize||rr._defaultFontSize)}static get _keyboardManager(){const t=rr.prototype,r=o=>o.isEmpty(),n=Bh.TRANSLATE_SMALL,i=Bh.TRANSLATE_BIG;return js(this,"_keyboardManager",new vb([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:r}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:r}]]))}static initialize(t,r){xr.initialize(t,r);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,r){switch(t){case Es.FREETEXT_SIZE:rr._defaultFontSize=r;break;case Es.FREETEXT_COLOR:rr._defaultColor=r;break}}updateParams(t,r){switch(t){case Es.FREETEXT_SIZE:te(this,Ur,QL).call(this,r);break;case Es.FREETEXT_COLOR:te(this,Ur,ZL).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[Es.FREETEXT_SIZE,rr._defaultFontSize],[Es.FREETEXT_COLOR,rr._defaultColor||xr._defaultLineColor]]}get propertiesToUpdate(){return[[Es.FREETEXT_SIZE,f(this,Bi)],[Es.FREETEXT_COLOR,f(this,Xa)]]}_translateEmpty(t,r){this._uiManager.translateSelectedEditors(t,r,!0)}getInitialTranslation(){const t=this.parentScale;return[-rr._internalPadding*t,-(rr._internalPadding+f(this,Bi))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ys.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),F(this,lh,new AbortController);const t=this._uiManager.combinedSignal(f(this,lh));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",f(this,Hx)),this._isDraggable=!0,(t=f(this,lh))==null||t.abort(),F(this,lh,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var r;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=f(this,Oi),r=F(this,Oi,te(this,Ur,eP).call(this).trimEnd());if(t===r)return;const n=i=>{if(F(this,Oi,i),!i){this.remove();return}te(this,Ur,Av).call(this),this._uiManager.rebuild(this),te(this,Ur,Sv).call(this)};this.addCommands({cmd:()=>{n(r)},undo:()=>{n(t)},mustExec:!1}),te(this,Ur,Sv).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){rr._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,r;this.width&&(t=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",f(this,Hx)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${f(this,Bi)}px * var(--scale-factor))`,n.color=f(this,Xa),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),x1(this,this.div,["dblclick","keydown"]),this.width){const[i,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,d]=this.getInitialTranslation();[c,d]=this.pageTranslationToScreen(c,d);const[u,h]=this.pageDimensions,[m,p]=this.pageTranslation;let x,w;switch(this.rotation){case 0:x=t+(l[0]-m)/u,w=r+this.height-(l[1]-p)/h;break;case 90:x=t+(l[0]-m)/u,w=r-(l[1]-p)/h,[c,d]=[d,-c];break;case 180:x=t-this.width+(l[0]-m)/u,w=r-(l[1]-p)/h,[c,d]=[-c,-d];break;case 270:x=t+(l[0]-m-this.height*h)/u,w=r+(l[1]-p-this.width*u)/h,[c,d]=[-d,c];break}this.setAt(x*i,w*o,c,d)}else this.setAt(t*i,r*o,this.width*i,this.height*o);te(this,Ur,Av).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var x,w,S;const r=t.clipboardData||window.clipboardData,{types:n}=r;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const i=te(x=rr,Ql,v_).call(x,r.getData("text")||"").replaceAll(Iy,`
`);if(!i)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!i.includes(`
`)){l.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:d}=l,u=[],h=[];if(c.nodeType===Node.TEXT_NODE){const b=c.parentElement;if(h.push(c.nodeValue.slice(d).replaceAll(Iy,"")),b!==this.editorDiv){let v=u;for(const N of this.editorDiv.childNodes){if(N===b){v=h;continue}v.push(te(w=rr,Ql,jv).call(w,N))}}u.push(c.nodeValue.slice(0,d).replaceAll(Iy,""))}else if(c===this.editorDiv){let b=u,v=0;for(const N of this.editorDiv.childNodes)v++===d&&(b=h),b.push(te(S=rr,Ql,jv).call(S,N))}F(this,Oi,`${u.join(`
`)}${i}${h.join(`
`)}`),te(this,Ur,Av).call(this);const m=new Range;let p=u.reduce((b,v)=>b+v.length,0);for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const v=b.nodeValue.length;if(p<=v){m.setStart(b,p),m.setEnd(b,p);break}p-=v}o.removeAllRanges(),o.addRange(m)}get contentDiv(){return this.editorDiv}static async deserialize(t,r,n){var l;let i=null;if(t instanceof GL){const{data:{defaultAppearanceData:{fontSize:c,fontColor:d},rect:u,rotation:h,id:m,popupRef:p},textContent:x,textPosition:w,parent:{page:{pageNumber:S}}}=t;if(!x||x.length===0)return null;i=t={annotationType:ys.FREETEXT,color:Array.from(d),fontSize:c,value:x.join(`
`),position:w,pageIndex:S-1,rect:u.slice(0),rotation:h,id:m,deleted:!1,popupRef:p}}const o=await super.deserialize(t,r,n);return F(o,Bi,t.fontSize),F(o,Xa,Xt.makeHexColor(...t.color)),F(o,Oi,te(l=rr,Ql,v_).call(l,t.value)),o.annotationElementId=t.id||null,o._initialData=i,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=rr._internalPadding*this.parentScale,n=this.getRect(r,r),i=xr._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:f(this,Xa)),o={annotationType:ys.FREETEXT,color:i,fontSize:f(this,Bi),value:te(this,Ur,tP).call(this),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?o:this.annotationElementId&&!te(this,Ur,sP).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(t){const r=super.renderAnnotationElement(t);if(this.deleted)return r;const{style:n}=r;n.fontSize=`calc(${f(this,Bi)}px * var(--scale-factor))`,n.color=f(this,Xa),r.replaceChildren();for(const o of f(this,Oi).split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),r.append(l)}const i=rr._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:f(this,Oi)}),r}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Xa=new WeakMap,Oi=new WeakMap,Hx=new WeakMap,lh=new WeakMap,Bi=new WeakMap,Ur=new WeakSet,QL=function(t){const r=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--scale-factor))`,this.translate(0,-(i-f(this,Bi))*this.parentScale),F(this,Bi,i),te(this,Ur,Sv).call(this)},n=f(this,Bi);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Es.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ZL=function(t){const r=i=>{F(this,Xa,this.editorDiv.style.color=i)},n=f(this,Xa);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Es.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},eP=function(){var n;const t=[];this.editorDiv.normalize();let r=null;for(const i of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(te(n=rr,Ql,jv).call(n,i)),r=i);return t.join(`
`)},Sv=function(){const[t,r]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:i,div:o}=this,l=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",i.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/r):(this.width=n.height/t,this.height=n.width/r),this.fixAndSetPosition()},Ql=new WeakSet,jv=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Iy,"")},Av=function(){if(this.editorDiv.replaceChildren(),!!f(this,Oi))for(const t of f(this,Oi).split(`
`)){const r=document.createElement("div");r.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(r)}},tP=function(){return f(this,Oi).replaceAll(" "," ")},v_=function(t){return t.replaceAll(" "," ")},sP=function(t){const{value:r,fontSize:n,color:i,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==r||t.fontSize!==n||t.color.some((l,c)=>l!==i[c])||t.pageIndex!==o},Q(rr,Ql),ss(rr,"_freeTextDefaultContent",""),ss(rr,"_internalPadding",0),ss(rr,"_defaultColor",null),ss(rr,"_defaultFontSize",10),ss(rr,"_type","freetext"),ss(rr,"_editorType",ys.FREETEXT);let y_=rr;class qt{toSVGPath(){Qs("Abstract method `toSVGPath` must be implemented.")}get box(){Qs("Abstract getter `box` must be implemented.")}serialize(e,t){Qs("Abstract method `serialize` must be implemented.")}static _rescale(e,t,r,n,i,o){o||(o=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)o[l]=t+e[l]*n,o[l+1]=r+e[l+1]*i;return o}static _rescaleAndSwap(e,t,r,n,i,o){o||(o=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)o[l]=t+e[l+1]*n,o[l+1]=r+e[l]*i;return o}static _translate(e,t,r,n){n||(n=new Float32Array(e.length));for(let i=0,o=e.length;i<o;i+=2)n[i]=t+e[i],n[i+1]=r+e[i+1];return n}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,r,n,i){switch(i){case 90:return[1-t/r,e/n];case 180:return[1-e/r,1-t/n];case 270:return[t/r,1-e/n];default:return[e/r,t/n]}}static _normalizePagePoint(e,t,r){switch(r){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,r,n,i,o){return[(e+5*r)/6,(t+5*n)/6,(5*r+i)/6,(5*n+o)/6,(r+i)/2,(n+o)/2]}}ss(qt,"PRECISION",1e-4);var $i,Ja,qm,Hm,Bo,Ns,ch,dh,Wx,Vx,Wm,Vm,id,Gx,$1,z1,Zr,F0,rP,nP,iP,aP,oP,lP;const vl=class vl{constructor({x:e,y:t},r,n,i,o,l=0){Q(this,Zr);Q(this,$i);Q(this,Ja,[]);Q(this,qm);Q(this,Hm);Q(this,Bo,[]);Q(this,Ns,new Float32Array(18));Q(this,ch);Q(this,dh);Q(this,Wx);Q(this,Vx);Q(this,Wm);Q(this,Vm);Q(this,id,[]);F(this,$i,r),F(this,Vm,i*n),F(this,Hm,o),f(this,Ns).set([NaN,NaN,NaN,NaN,e,t],6),F(this,qm,l),F(this,Vx,f(vl,Gx)*n),F(this,Wx,f(vl,z1)*n),F(this,Wm,n),f(this,id).push(e,t)}isEmpty(){return isNaN(f(this,Ns)[8])}add({x:e,y:t}){var B;F(this,ch,e),F(this,dh,t);const[r,n,i,o]=f(this,$i);let[l,c,d,u]=f(this,Ns).subarray(8,12);const h=e-d,m=t-u,p=Math.hypot(h,m);if(p<f(this,Wx))return!1;const x=p-f(this,Vx),w=x/p,S=w*h,b=w*m;let v=l,N=c;l=d,c=u,d+=S,u+=b,(B=f(this,id))==null||B.push(e,t);const j=-b/x,E=S/x,A=j*f(this,Vm),L=E*f(this,Vm);return f(this,Ns).set(f(this,Ns).subarray(2,8),0),f(this,Ns).set([d+A,u+L],4),f(this,Ns).set(f(this,Ns).subarray(14,18),12),f(this,Ns).set([d-A,u-L],16),isNaN(f(this,Ns)[6])?(f(this,Bo).length===0&&(f(this,Ns).set([l+A,c+L],2),f(this,Bo).push(NaN,NaN,NaN,NaN,(l+A-r)/i,(c+L-n)/o),f(this,Ns).set([l-A,c-L],14),f(this,Ja).push(NaN,NaN,NaN,NaN,(l-A-r)/i,(c-L-n)/o)),f(this,Ns).set([v,N,l,c,d,u],6),!this.isEmpty()):(f(this,Ns).set([v,N,l,c,d,u],6),Math.abs(Math.atan2(N-c,v-l)-Math.atan2(b,S))<Math.PI/2?([l,c,d,u]=f(this,Ns).subarray(2,6),f(this,Bo).push(NaN,NaN,NaN,NaN,((l+d)/2-r)/i,((c+u)/2-n)/o),[l,c,v,N]=f(this,Ns).subarray(14,18),f(this,Ja).push(NaN,NaN,NaN,NaN,((v+l)/2-r)/i,((N+c)/2-n)/o),!0):([v,N,l,c,d,u]=f(this,Ns).subarray(0,6),f(this,Bo).push(((v+5*l)/6-r)/i,((N+5*c)/6-n)/o,((5*l+d)/6-r)/i,((5*c+u)/6-n)/o,((l+d)/2-r)/i,((c+u)/2-n)/o),[d,u,l,c,v,N]=f(this,Ns).subarray(12,18),f(this,Ja).push(((v+5*l)/6-r)/i,((N+5*c)/6-n)/o,((5*l+d)/6-r)/i,((5*c+u)/6-n)/o,((l+d)/2-r)/i,((c+u)/2-n)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=f(this,Bo),t=f(this,Ja);if(isNaN(f(this,Ns)[6])&&!this.isEmpty())return te(this,Zr,rP).call(this);const r=[];r.push(`M${e[4]} ${e[5]}`);for(let n=6;n<e.length;n+=6)isNaN(e[n])?r.push(`L${e[n+4]} ${e[n+5]}`):r.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);te(this,Zr,iP).call(this,r);for(let n=t.length-6;n>=6;n-=6)isNaN(t[n])?r.push(`L${t[n+4]} ${t[n+5]}`):r.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);return te(this,Zr,nP).call(this,r),r.join(" ")}newFreeDrawOutline(e,t,r,n,i,o){return new cP(e,t,r,n,i,o)}getOutlines(){var h;const e=f(this,Bo),t=f(this,Ja),r=f(this,Ns),[n,i,o,l]=f(this,$i),c=new Float32Array((((h=f(this,id))==null?void 0:h.length)??0)+2);for(let m=0,p=c.length-2;m<p;m+=2)c[m]=(f(this,id)[m]-n)/o,c[m+1]=(f(this,id)[m+1]-i)/l;if(c[c.length-2]=(f(this,ch)-n)/o,c[c.length-1]=(f(this,dh)-i)/l,isNaN(r[6])&&!this.isEmpty())return te(this,Zr,aP).call(this,c);const d=new Float32Array(f(this,Bo).length+24+f(this,Ja).length);let u=e.length;for(let m=0;m<u;m+=2){if(isNaN(e[m])){d[m]=d[m+1]=NaN;continue}d[m]=e[m],d[m+1]=e[m+1]}u=te(this,Zr,lP).call(this,d,u);for(let m=t.length-6;m>=6;m-=6)for(let p=0;p<6;p+=2){if(isNaN(t[m+p])){d[u]=d[u+1]=NaN,u+=2;continue}d[u]=t[m+p],d[u+1]=t[m+p+1],u+=2}return te(this,Zr,oP).call(this,d,u),this.newFreeDrawOutline(d,c,f(this,$i),f(this,Wm),f(this,qm),f(this,Hm))}};$i=new WeakMap,Ja=new WeakMap,qm=new WeakMap,Hm=new WeakMap,Bo=new WeakMap,Ns=new WeakMap,ch=new WeakMap,dh=new WeakMap,Wx=new WeakMap,Vx=new WeakMap,Wm=new WeakMap,Vm=new WeakMap,id=new WeakMap,Gx=new WeakMap,$1=new WeakMap,z1=new WeakMap,Zr=new WeakSet,F0=function(){const e=f(this,Ns).subarray(4,6),t=f(this,Ns).subarray(16,18),[r,n,i,o]=f(this,$i);return[(f(this,ch)+(e[0]-t[0])/2-r)/i,(f(this,dh)+(e[1]-t[1])/2-n)/o,(f(this,ch)+(t[0]-e[0])/2-r)/i,(f(this,dh)+(t[1]-e[1])/2-n)/o]},rP=function(){const[e,t,r,n]=f(this,$i),[i,o,l,c]=te(this,Zr,F0).call(this);return`M${(f(this,Ns)[2]-e)/r} ${(f(this,Ns)[3]-t)/n} L${(f(this,Ns)[4]-e)/r} ${(f(this,Ns)[5]-t)/n} L${i} ${o} L${l} ${c} L${(f(this,Ns)[16]-e)/r} ${(f(this,Ns)[17]-t)/n} L${(f(this,Ns)[14]-e)/r} ${(f(this,Ns)[15]-t)/n} Z`},nP=function(e){const t=f(this,Ja);e.push(`L${t[4]} ${t[5]} Z`)},iP=function(e){const[t,r,n,i]=f(this,$i),o=f(this,Ns).subarray(4,6),l=f(this,Ns).subarray(16,18),[c,d,u,h]=te(this,Zr,F0).call(this);e.push(`L${(o[0]-t)/n} ${(o[1]-r)/i} L${c} ${d} L${u} ${h} L${(l[0]-t)/n} ${(l[1]-r)/i}`)},aP=function(e){const t=f(this,Ns),[r,n,i,o]=f(this,$i),[l,c,d,u]=te(this,Zr,F0).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-r)/i,(t[3]-n)/o,NaN,NaN,NaN,NaN,(t[4]-r)/i,(t[5]-n)/o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,d,u,NaN,NaN,NaN,NaN,(t[16]-r)/i,(t[17]-n)/o,NaN,NaN,NaN,NaN,(t[14]-r)/i,(t[15]-n)/o],0),this.newFreeDrawOutline(h,e,f(this,$i),f(this,Wm),f(this,qm),f(this,Hm))},oP=function(e,t){const r=f(this,Ja);return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6},lP=function(e,t){const r=f(this,Ns).subarray(4,6),n=f(this,Ns).subarray(16,18),[i,o,l,c]=f(this,$i),[d,u,h,m]=te(this,Zr,F0).call(this);return e.set([NaN,NaN,NaN,NaN,(r[0]-i)/l,(r[1]-o)/c,NaN,NaN,NaN,NaN,d,u,NaN,NaN,NaN,NaN,h,m,NaN,NaN,NaN,NaN,(n[0]-i)/l,(n[1]-o)/c],t),t+=24},Q(vl,Gx,8),Q(vl,$1,2),Q(vl,z1,f(vl,Gx)+f(vl,$1));let v1=vl;var Gm,uh,$l,Yx,zi,Kx,Cr,U1,dP;class cP extends qt{constructor(t,r,n,i,o,l){super();Q(this,U1);Q(this,Gm);Q(this,uh,new Float32Array(4));Q(this,$l);Q(this,Yx);Q(this,zi);Q(this,Kx);Q(this,Cr);F(this,Cr,t),F(this,zi,r),F(this,Gm,n),F(this,Kx,i),F(this,$l,o),F(this,Yx,l),this.lastPoint=[NaN,NaN],te(this,U1,dP).call(this,l);const[c,d,u,h]=f(this,uh);for(let m=0,p=t.length;m<p;m+=2)t[m]=(t[m]-c)/u,t[m+1]=(t[m+1]-d)/h;for(let m=0,p=r.length;m<p;m+=2)r[m]=(r[m]-c)/u,r[m+1]=(r[m+1]-d)/h}toSVGPath(){const t=[`M${f(this,Cr)[4]} ${f(this,Cr)[5]}`];for(let r=6,n=f(this,Cr).length;r<n;r+=6){if(isNaN(f(this,Cr)[r])){t.push(`L${f(this,Cr)[r+4]} ${f(this,Cr)[r+5]}`);continue}t.push(`C${f(this,Cr)[r]} ${f(this,Cr)[r+1]} ${f(this,Cr)[r+2]} ${f(this,Cr)[r+3]} ${f(this,Cr)[r+4]} ${f(this,Cr)[r+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,r,n,i],o){const l=n-t,c=i-r;let d,u;switch(o){case 0:d=qt._rescale(f(this,Cr),t,i,l,-c),u=qt._rescale(f(this,zi),t,i,l,-c);break;case 90:d=qt._rescaleAndSwap(f(this,Cr),t,r,l,c),u=qt._rescaleAndSwap(f(this,zi),t,r,l,c);break;case 180:d=qt._rescale(f(this,Cr),n,r,-l,c),u=qt._rescale(f(this,zi),n,r,-l,c);break;case 270:d=qt._rescaleAndSwap(f(this,Cr),n,i,-l,-c),u=qt._rescaleAndSwap(f(this,zi),n,i,-l,-c);break}return{outline:Array.from(d),points:[Array.from(u)]}}get box(){return f(this,uh)}newOutliner(t,r,n,i,o,l=0){return new v1(t,r,n,i,o,l)}getNewOutline(t,r){const[n,i,o,l]=f(this,uh),[c,d,u,h]=f(this,Gm),m=o*u,p=l*h,x=n*u+c,w=i*h+d,S=this.newOutliner({x:f(this,zi)[0]*m+x,y:f(this,zi)[1]*p+w},f(this,Gm),f(this,Kx),t,f(this,Yx),r??f(this,$l));for(let b=2;b<f(this,zi).length;b+=2)S.add({x:f(this,zi)[b]*m+x,y:f(this,zi)[b+1]*p+w});return S.getOutlines()}}Gm=new WeakMap,uh=new WeakMap,$l=new WeakMap,Yx=new WeakMap,zi=new WeakMap,Kx=new WeakMap,Cr=new WeakMap,U1=new WeakSet,dP=function(t){const r=f(this,Cr);let n=r[4],i=r[5],o=n,l=i,c=n,d=i,u=n,h=i;const m=t?Math.max:Math.min;for(let x=6,w=r.length;x<w;x+=6){if(isNaN(r[x]))o=Math.min(o,r[x+4]),l=Math.min(l,r[x+5]),c=Math.max(c,r[x+4]),d=Math.max(d,r[x+5]),h<r[x+5]?(u=r[x+4],h=r[x+5]):h===r[x+5]&&(u=m(u,r[x+4]));else{const S=Xt.bezierBoundingBox(n,i,...r.slice(x,x+6));o=Math.min(o,S[0]),l=Math.min(l,S[1]),c=Math.max(c,S[2]),d=Math.max(d,S[3]),h<S[3]?(u=S[2],h=S[3]):h===S[3]&&(u=m(u,S[2]))}n=r[x+4],i=r[x+5]}const p=f(this,uh);p[0]=o-f(this,$l),p[1]=l-f(this,$l),p[2]=c-o+2*f(this,$l),p[3]=d-l+2*f(this,$l),this.lastPoint=[u,h]};var Xx,Jx,ad,Qa,ai,uP,kv,hP,fP,N_;class w_{constructor(e,t=0,r=0,n=!0){Q(this,ai);Q(this,Xx);Q(this,Jx);Q(this,ad,[]);Q(this,Qa,[]);let i=1/0,o=-1/0,l=1/0,c=-1/0;const u=10**-4;for(const{x:b,y:v,width:N,height:j}of e){const E=Math.floor((b-t)/u)*u,A=Math.ceil((b+N+t)/u)*u,L=Math.floor((v-t)/u)*u,C=Math.ceil((v+j+t)/u)*u,B=[E,L,C,!0],U=[A,L,C,!1];f(this,ad).push(B,U),i=Math.min(i,E),o=Math.max(o,A),l=Math.min(l,L),c=Math.max(c,C)}const h=o-i+2*r,m=c-l+2*r,p=i-r,x=l-r,w=f(this,ad).at(n?-1:-2),S=[w[0],w[2]];for(const b of f(this,ad)){const[v,N,j]=b;b[0]=(v-p)/h,b[1]=(N-x)/m,b[2]=(j-x)/m}F(this,Xx,new Float32Array([p,x,h,m])),F(this,Jx,S)}getOutlines(){f(this,ad).sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);const e=[];for(const t of f(this,ad))t[3]?(e.push(...te(this,ai,N_).call(this,t)),te(this,ai,hP).call(this,t)):(te(this,ai,fP).call(this,t),e.push(...te(this,ai,N_).call(this,t)));return te(this,ai,uP).call(this,e)}}Xx=new WeakMap,Jx=new WeakMap,ad=new WeakMap,Qa=new WeakMap,ai=new WeakSet,uP=function(e){const t=[],r=new Set;for(const o of e){const[l,c,d]=o;t.push([l,c,o],[l,d,o])}t.sort((o,l)=>o[1]-l[1]||o[0]-l[0]);for(let o=0,l=t.length;o<l;o+=2){const c=t[o][2],d=t[o+1][2];c.push(d),d.push(c),r.add(c),r.add(d)}const n=[];let i;for(;r.size>0;){const o=r.values().next().value;let[l,c,d,u,h]=o;r.delete(o);let m=l,p=c;for(i=[l,d],n.push(i);;){let x;if(r.has(u))x=u;else if(r.has(h))x=h;else break;r.delete(x),[l,c,d,u,h]=x,m!==l&&(i.push(m,p,l,p===c?c:d),m=l),p=p===c?d:c}i.push(m,p)}return new s9(n,f(this,Xx),f(this,Jx))},kv=function(e){const t=f(this,Qa);let r=0,n=t.length-1;for(;r<=n;){const i=r+n>>1,o=t[i][0];if(o===e)return i;o<e?r=i+1:n=i-1}return n+1},hP=function([,e,t]){const r=te(this,ai,kv).call(this,e);f(this,Qa).splice(r,0,[e,t])},fP=function([,e,t]){const r=te(this,ai,kv).call(this,e);for(let n=r;n<f(this,Qa).length;n++){const[i,o]=f(this,Qa)[n];if(i!==e)break;if(i===e&&o===t){f(this,Qa).splice(n,1);return}}for(let n=r-1;n>=0;n--){const[i,o]=f(this,Qa)[n];if(i!==e)break;if(i===e&&o===t){f(this,Qa).splice(n,1);return}}},N_=function(e){const[t,r,n]=e,i=[[t,r,n]],o=te(this,ai,kv).call(this,n);for(let l=0;l<o;l++){const[c,d]=f(this,Qa)[l];for(let u=0,h=i.length;u<h;u++){const[,m,p]=i[u];if(!(d<=m||p<=c)){if(m>=c){if(p>d)i[u][1]=d;else{if(h===1)return[];i.splice(u,1),u--,h--}continue}i[u][2]=c,p>d&&i.push([t,d,p])}}}return i};var Qx,Ym;class s9 extends qt{constructor(t,r,n){super();Q(this,Qx);Q(this,Ym);F(this,Ym,t),F(this,Qx,r),this.lastPoint=n}toSVGPath(){const t=[];for(const r of f(this,Ym)){let[n,i]=r;t.push(`M${n} ${i}`);for(let o=2;o<r.length;o+=2){const l=r[o],c=r[o+1];l===n?(t.push(`V${c}`),i=c):c===i&&(t.push(`H${l}`),n=l)}t.push("Z")}return t.join(" ")}serialize([t,r,n,i],o){const l=[],c=n-t,d=i-r;for(const u of f(this,Ym)){const h=new Array(u.length);for(let m=0;m<u.length;m+=2)h[m]=t+u[m]*c,h[m+1]=i-u[m+1]*d;l.push(h)}return l}get box(){return f(this,Qx)}get classNamesForOutlining(){return["highlightOutline"]}}Qx=new WeakMap,Ym=new WeakMap;class __ extends v1{newFreeDrawOutline(e,t,r,n,i,o){return new r9(e,t,r,n,i,o)}}class r9 extends cP{newOutliner(e,t,r,n,i,o=0){return new __(e,t,r,n,i,o)}}var Za,hh,Km,Yr,Zx,Xm,eb,tb,od,eo,Jm,sb,Ys,S_,j_,A_,du,mP,Cc;const gi=class gi{constructor({editor:e=null,uiManager:t=null}){Q(this,Ys);Q(this,Za,null);Q(this,hh,null);Q(this,Km);Q(this,Yr,null);Q(this,Zx,!1);Q(this,Xm,!1);Q(this,eb,null);Q(this,tb);Q(this,od,null);Q(this,eo,null);Q(this,Jm);var r;e?(F(this,Xm,!1),F(this,Jm,Es.HIGHLIGHT_COLOR),F(this,eb,e)):(F(this,Xm,!0),F(this,Jm,Es.HIGHLIGHT_DEFAULT_COLOR)),F(this,eo,(e==null?void 0:e._uiManager)||t),F(this,tb,f(this,eo)._eventBus),F(this,Km,(e==null?void 0:e.color)||((r=f(this,eo))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),f(gi,sb)||F(gi,sb,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return js(this,"_keyboardManager",new vb([[["Escape","mac+Escape"],gi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],gi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],gi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],gi.prototype._moveToPrevious],[["Home","mac+Home"],gi.prototype._moveToBeginning],[["End","mac+End"],gi.prototype._moveToEnd]]))}renderButton(){const e=F(this,Za,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=f(this,eo)._signal;e.addEventListener("click",te(this,Ys,du).bind(this),{signal:t}),e.addEventListener("keydown",te(this,Ys,A_).bind(this),{signal:t});const r=F(this,hh,document.createElement("span"));return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=f(this,Km),e.append(r),e}renderMainDropdown(){const e=F(this,Yr,te(this,Ys,S_).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===f(this,Za)){te(this,Ys,du).call(this,e);return}const t=e.target.getAttribute("data-color");t&&te(this,Ys,j_).call(this,t,e)}_moveToNext(e){var t,r;if(!f(this,Ys,Cc)){te(this,Ys,du).call(this,e);return}if(e.target===f(this,Za)){(t=f(this,Yr).firstChild)==null||t.focus();return}(r=e.target.nextSibling)==null||r.focus()}_moveToPrevious(e){var t,r;if(e.target===((t=f(this,Yr))==null?void 0:t.firstChild)||e.target===f(this,Za)){f(this,Ys,Cc)&&this._hideDropdownFromKeyboard();return}f(this,Ys,Cc)||te(this,Ys,du).call(this,e),(r=e.target.previousSibling)==null||r.focus()}_moveToBeginning(e){var t;if(!f(this,Ys,Cc)){te(this,Ys,du).call(this,e);return}(t=f(this,Yr).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!f(this,Ys,Cc)){te(this,Ys,du).call(this,e);return}(t=f(this,Yr).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=f(this,Yr))==null||e.classList.add("hidden"),(t=f(this,od))==null||t.abort(),F(this,od,null)}_hideDropdownFromKeyboard(){var e;if(!f(this,Xm)){if(!f(this,Ys,Cc)){(e=f(this,eb))==null||e.unselect();return}this.hideDropdown(),f(this,Za).focus({preventScroll:!0,focusVisible:f(this,Zx)})}}updateColor(e){if(f(this,hh)&&(f(this,hh).style.backgroundColor=e),!f(this,Yr))return;const t=f(this,eo).highlightColors.values();for(const r of f(this,Yr).children)r.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=f(this,Za))==null||e.remove(),F(this,Za,null),F(this,hh,null),(t=f(this,Yr))==null||t.remove(),F(this,Yr,null)}};Za=new WeakMap,hh=new WeakMap,Km=new WeakMap,Yr=new WeakMap,Zx=new WeakMap,Xm=new WeakMap,eb=new WeakMap,tb=new WeakMap,od=new WeakMap,eo=new WeakMap,Jm=new WeakMap,sb=new WeakMap,Ys=new WeakSet,S_=function(){const e=document.createElement("div"),t=f(this,eo)._signal;e.addEventListener("contextmenu",ho,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[r,n]of f(this,eo).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",n),i.title=r,i.setAttribute("data-l10n-id",f(gi,sb)[r]);const o=document.createElement("span");i.append(o),o.className="swatch",o.style.backgroundColor=n,i.setAttribute("aria-selected",n===f(this,Km)),i.addEventListener("click",te(this,Ys,j_).bind(this,n),{signal:t}),e.append(i)}return e.addEventListener("keydown",te(this,Ys,A_).bind(this),{signal:t}),e},j_=function(e,t){t.stopPropagation(),f(this,tb).dispatch("switchannotationeditorparams",{source:this,type:f(this,Jm),value:e})},A_=function(e){gi._keyboardManager.exec(this,e)},du=function(e){if(f(this,Ys,Cc)){this.hideDropdown();return}if(F(this,Zx,e.detail===0),f(this,od)||(F(this,od,new AbortController),window.addEventListener("pointerdown",te(this,Ys,mP).bind(this),{signal:f(this,eo).combinedSignal(f(this,od))})),f(this,Yr)){f(this,Yr).classList.remove("hidden");return}const t=F(this,Yr,te(this,Ys,S_).call(this));f(this,Za).append(t)},mP=function(e){var t;(t=f(this,Yr))!=null&&t.contains(e.target)||this.hideDropdown()},Cc=function(){return f(this,Yr)&&!f(this,Yr).classList.contains("hidden")},Q(gi,sb,null);let w1=gi;var Qm,rb,zl,fh,Zm,yi,nb,ib,mh,ga,Ui,gn,ep,Ul,Mn,tp,xa,ab,bs,k_,Cv,pP,gP,xP,C_,uu,Sa,Rf,bP,Ev,O0,yP,vP,wP,NP,_P;const $s=class $s extends xr{constructor(t){super({...t,name:"highlightEditor"});Q(this,bs);Q(this,Qm,null);Q(this,rb,0);Q(this,zl);Q(this,fh,null);Q(this,Zm,null);Q(this,yi,null);Q(this,nb,null);Q(this,ib,0);Q(this,mh,null);Q(this,ga,null);Q(this,Ui,null);Q(this,gn,!1);Q(this,ep,null);Q(this,Ul);Q(this,Mn,null);Q(this,tp,"");Q(this,xa);Q(this,ab,"");this.color=t.color||$s._defaultColor,F(this,xa,t.thickness||$s._defaultThickness),F(this,Ul,t.opacity||$s._defaultOpacity),F(this,zl,t.boxes||null),F(this,ab,t.methodOfCreation||""),F(this,tp,t.text||""),this._isDraggable=!1,t.highlightId>-1?(F(this,gn,!0),te(this,bs,Cv).call(this,t),te(this,bs,uu).call(this)):f(this,zl)&&(F(this,Qm,t.anchorNode),F(this,rb,t.anchorOffset),F(this,nb,t.focusNode),F(this,ib,t.focusOffset),te(this,bs,k_).call(this),te(this,bs,uu).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=$s.prototype;return js(this,"_keyboardManager",new vb([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:f(this,gn)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:f(this,xa),methodOfCreation:f(this,ab)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,r){var n;xr.initialize(t,r),$s._defaultColor||($s._defaultColor=((n=r.highlightColors)==null?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(t,r){switch(t){case Es.HIGHLIGHT_DEFAULT_COLOR:$s._defaultColor=r;break;case Es.HIGHLIGHT_THICKNESS:$s._defaultThickness=r;break}}translateInPage(t,r){}get toolbarPosition(){return f(this,ep)}updateParams(t,r){switch(t){case Es.HIGHLIGHT_COLOR:te(this,bs,pP).call(this,r);break;case Es.HIGHLIGHT_THICKNESS:te(this,bs,gP).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[Es.HIGHLIGHT_DEFAULT_COLOR,$s._defaultColor],[Es.HIGHLIGHT_THICKNESS,$s._defaultThickness]]}get propertiesToUpdate(){return[[Es.HIGHLIGHT_COLOR,this.color||$s._defaultColor],[Es.HIGHLIGHT_THICKNESS,f(this,xa)||$s._defaultThickness],[Es.HIGHLIGHT_FREE,f(this,gn)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(F(this,Zm,new w1({editor:this})),t.addColorPicker(f(this,Zm))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(te(this,bs,O0).call(this))}getBaseTranslation(){return[0,0]}getRect(t,r){return super.getRect(t,r,te(this,bs,O0).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){te(this,bs,C_).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(te(this,bs,uu).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var n;let r=!1;this.parent&&!t?te(this,bs,C_).call(this):t&&(te(this,bs,uu).call(this,t),r=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),r&&this.select()}rotate(t){var i,o,l;const{drawLayer:r}=this.parent;let n;f(this,gn)?(t=(t-this.rotation+360)%360,n=te(i=$s,Sa,Rf).call(i,f(this,ga).box,t)):n=te(o=$s,Sa,Rf).call(o,[this.x,this.y,this.width,this.height],t),r.updateProperties(f(this,Ui),{bbox:n,root:{"data-main-rotation":t}}),r.updateProperties(f(this,Mn),{bbox:te(l=$s,Sa,Rf).call(l,f(this,yi).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();f(this,tp)&&(t.setAttribute("aria-label",f(this,tp)),t.setAttribute("role","mark")),f(this,gn)?t.classList.add("free"):this.div.addEventListener("keydown",te(this,bs,bP).bind(this),{signal:this._uiManager._signal});const r=F(this,mh,document.createElement("div"));t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=f(this,fh);const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),x1(this,f(this,mh),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(f(this,Mn),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(f(this,Mn),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:te(this,bs,Ev).call(this,!0);break;case 1:case 3:te(this,bs,Ev).call(this,!1);break}}select(){var t;super.select(),f(this,Mn)&&((t=this.parent)==null||t.drawLayer.updateProperties(f(this,Mn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),f(this,Mn)&&((t=this.parent)==null||t.drawLayer.updateProperties(f(this,Mn),{rootClass:{selected:!1}}),f(this,gn)||te(this,bs,Ev).call(this,!1))}get _mustFixPosition(){return!f(this,gn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(f(this,Ui),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(f(this,Mn),{rootClass:{hidden:!t}}))}static startHighlighting(t,r,{target:n,x:i,y:o}){const{x:l,y:c,width:d,height:u}=n.getBoundingClientRect(),h=new AbortController,m=t.combinedSignal(h),p=x=>{h.abort(),te(this,Sa,NP).call(this,t,x)};window.addEventListener("blur",p,{signal:m}),window.addEventListener("pointerup",p,{signal:m}),window.addEventListener("pointerdown",Xi,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",ho,{signal:m}),n.addEventListener("pointermove",te(this,Sa,wP).bind(this,t),{signal:m}),this._freeHighlight=new __({x:i,y:o},[l,c,d,u],t.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,r,n){var w,S,b,v;let i=null;if(t instanceof KL){const{data:{quadPoints:N,rect:j,rotation:E,id:A,color:L,opacity:C,popupRef:B},parent:{page:{pageNumber:U}}}=t;i=t={annotationType:ys.HIGHLIGHT,color:Array.from(L),opacity:C,quadPoints:N,boxes:null,pageIndex:U-1,rect:j.slice(0),rotation:E,id:A,deleted:!1,popupRef:B}}else if(t instanceof jj){const{data:{inkLists:N,rect:j,rotation:E,id:A,color:L,borderStyle:{rawWidth:C},popupRef:B},parent:{page:{pageNumber:U}}}=t;i=t={annotationType:ys.HIGHLIGHT,color:Array.from(L),thickness:C,inkLists:N,boxes:null,pageIndex:U-1,rect:j.slice(0),rotation:E,id:A,deleted:!1,popupRef:B}}const{color:o,quadPoints:l,inkLists:c,opacity:d}=t,u=await super.deserialize(t,r,n);u.color=Xt.makeHexColor(...o),F(u,Ul,d||1),c&&F(u,xa,t.thickness),u.annotationElementId=t.id||null,u._initialData=i;const[h,m]=u.pageDimensions,[p,x]=u.pageTranslation;if(l){const N=F(u,zl,[]);for(let j=0;j<l.length;j+=8)N.push({x:(l[j]-p)/h,y:1-(l[j+1]-x)/m,width:(l[j+2]-l[j])/h,height:(l[j+1]-l[j+5])/m});te(w=u,bs,k_).call(w),te(S=u,bs,uu).call(S),u.rotate(u.rotation)}else if(c){F(u,gn,!0);const N=c[0],j={x:N[0]-p,y:m-(N[1]-x)},E=new __(j,[0,0,h,m],1,f(u,xa)/2,!0,.001);for(let C=0,B=N.length;C<B;C+=2)j.x=N[C]-p,j.y=m-(N[C+1]-x),E.add(j);const{id:A,clipPathId:L}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);te(b=u,bs,Cv).call(b,{highlightOutlines:E.getOutlines(),highlightId:A,clipPathId:L}),te(v=u,bs,uu).call(v)}return u}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const r=this.getRect(0,0),n=xr._colorManager.convert(this.color),i={annotationType:ys.HIGHLIGHT,color:n,opacity:f(this,Ul),thickness:f(this,xa),quadPoints:te(this,bs,yP).call(this),outlines:te(this,bs,vP).call(this,r),pageIndex:this.pageIndex,rect:r,rotation:te(this,bs,O0).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!te(this,bs,_P).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Qm=new WeakMap,rb=new WeakMap,zl=new WeakMap,fh=new WeakMap,Zm=new WeakMap,yi=new WeakMap,nb=new WeakMap,ib=new WeakMap,mh=new WeakMap,ga=new WeakMap,Ui=new WeakMap,gn=new WeakMap,ep=new WeakMap,Ul=new WeakMap,Mn=new WeakMap,tp=new WeakMap,xa=new WeakMap,ab=new WeakMap,bs=new WeakSet,k_=function(){const t=new w_(f(this,zl),.001);F(this,ga,t.getOutlines()),[this.x,this.y,this.width,this.height]=f(this,ga).box;const r=new w_(f(this,zl),.0025,.001,this._uiManager.direction==="ltr");F(this,yi,r.getOutlines());const{lastPoint:n}=f(this,yi);F(this,ep,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])},Cv=function({highlightOutlines:t,highlightId:r,clipPathId:n}){var h,m;if(F(this,ga,t),F(this,yi,t.getNewOutline(f(this,xa)/2+1.5,.0025)),r>=0)F(this,Ui,r),F(this,fh,n),this.parent.drawLayer.finalizeDraw(r,{bbox:t.box,path:{d:t.toSVGPath()}}),F(this,Mn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:f(this,yi).box,path:{d:f(this,yi).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(f(this,Ui),{bbox:te(h=$s,Sa,Rf).call(h,f(this,ga).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(f(this,Mn),{bbox:te(m=$s,Sa,Rf).call(m,f(this,yi).box,p),path:{d:f(this,yi).toSVGPath()}})}const[o,l,c,d]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=c,this.height=d;break;case 90:{const[p,x]=this.parentDimensions;this.x=l,this.y=1-o,this.width=c*x/p,this.height=d*p/x;break}case 180:this.x=1-o,this.y=1-l,this.width=c,this.height=d;break;case 270:{const[p,x]=this.parentDimensions;this.x=1-l,this.y=o,this.width=c*x/p,this.height=d*p/x;break}}const{lastPoint:u}=f(this,yi);F(this,ep,[(u[0]-o)/c,(u[1]-l)/d])},pP=function(t){const r=(o,l)=>{var c,d;this.color=o,F(this,Ul,l),(c=this.parent)==null||c.drawLayer.updateProperties(f(this,Ui),{root:{fill:o,"fill-opacity":l}}),(d=f(this,Zm))==null||d.updateColor(o)},n=this.color,i=f(this,Ul);this.addCommands({cmd:r.bind(this,t,$s._defaultOpacity),undo:r.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Es.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},gP=function(t){const r=f(this,xa),n=i=>{F(this,xa,i),te(this,bs,xP).call(this,i)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Es.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},xP=function(t){if(!f(this,gn))return;te(this,bs,Cv).call(this,{highlightOutlines:f(this,ga).getNewOutline(t/2)}),this.fixAndSetPosition();const[r,n]=this.parentDimensions;this.setDims(this.width*r,this.height*n)},C_=function(){f(this,Ui)===null||!this.parent||(this.parent.drawLayer.remove(f(this,Ui)),F(this,Ui,null),this.parent.drawLayer.remove(f(this,Mn)),F(this,Mn,null))},uu=function(t=this.parent){f(this,Ui)===null&&({id:Gn(this,Ui)._,clipPathId:Gn(this,fh)._}=t.drawLayer.draw({bbox:f(this,ga).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":f(this,Ul)},rootClass:{highlight:!0,free:f(this,gn)},path:{d:f(this,ga).toSVGPath()}},!1,!0),F(this,Mn,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:f(this,gn)},bbox:f(this,yi).box,path:{d:f(this,yi).toSVGPath()}},f(this,gn))),f(this,mh)&&(f(this,mh).style.clipPath=f(this,fh)))},Sa=new WeakSet,Rf=function([t,r,n,i],o){switch(o){case 90:return[1-r-i,t,i,n];case 180:return[1-t-n,1-r-i,n,i];case 270:return[r,1-t-n,i,n]}return[t,r,n,i]},bP=function(t){$s._keyboardManager.exec(this,t)},Ev=function(t){if(!f(this,Qm))return;const r=window.getSelection();t?r.setPosition(f(this,Qm),f(this,rb)):r.setPosition(f(this,nb),f(this,ib))},O0=function(){return f(this,gn)?this.rotation:0},yP=function(){if(f(this,gn))return null;const[t,r]=this.pageDimensions,[n,i]=this.pageTranslation,o=f(this,zl),l=new Float32Array(o.length*8);let c=0;for(const{x:d,y:u,width:h,height:m}of o){const p=d*t+n,x=(1-u)*r+i;l[c]=l[c+4]=p,l[c+1]=l[c+3]=x,l[c+2]=l[c+6]=p+h*t,l[c+5]=l[c+7]=x-m*r,c+=8}return l},vP=function(t){return f(this,ga).serialize(t,te(this,bs,O0).call(this))},wP=function(t,r){this._freeHighlight.add(r)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},NP=function(t,r){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},_P=function(t){const{color:r}=this._initialData;return t.color.some((n,i)=>n!==r[i])},Q($s,Sa),ss($s,"_defaultColor",null),ss($s,"_defaultOpacity",1),ss($s,"_defaultThickness",12),ss($s,"_type","highlight"),ss($s,"_editorType",ys.HIGHLIGHT),ss($s,"_freeHighlightId",-1),ss($s,"_freeHighlight",null),ss($s,"_freeHighlightClipId","");let N1=$s;var ph;class n9{constructor(){Q(this,ph,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,r]of Object.entries(e))this.updateProperty(t,r)}updateSVGProperty(e,t){f(this,ph)[e]=t}toSVGProperties(){const e=f(this,ph);return F(this,ph,Object.create(null)),{root:e}}reset(){F(this,ph,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Qs("Not implemented")}}ph=new WeakMap;var qi,sp,on,gh,xh,ld,cd,dd,bh,Ds,L_,P_,T_,B0,SP,Lv,$0,Df;const Wt=class Wt extends xr{constructor(t){super(t);Q(this,Ds);Q(this,qi,null);Q(this,sp);ss(this,"_drawId",null);F(this,sp,t.mustBeCommitted||!1),t.drawOutlines&&(te(this,Ds,L_).call(this,t),te(this,Ds,B0).call(this))}static _mergeSVGProperties(t,r){const n=new Set(Object.keys(t));for(const[i,o]of Object.entries(r))n.has(i)?Object.assign(t[i],o):t[i]=o;return t}static getDefaultDrawingOptions(t){Qs("Not implemented")}static get typesMap(){Qs("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,r){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,r),this._currentParent&&(f(Wt,on).updateProperty(n,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,r){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,r)}static get defaultPropertiesToUpdate(){const t=[],r=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)t.push([n,r[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:r}=this;for(const[n,i]of this.constructor.typesMap)t.push([n,r[i]]);return t}_updateProperty(t,r,n){const i=this._drawingOptions,o=i[r],l=c=>{var u;i.updateProperty(r,c);const d=f(this,qi).updateProperty(r,c);d&&te(this,Ds,$0).call(this,d),(u=this.parent)==null||u.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties(f(this,qi).getPathResizingSVGProperties(te(this,Ds,Lv).call(this)),{bbox:te(this,Ds,Df).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties(f(this,qi).getPathResizedSVGProperties(te(this,Ds,Lv).call(this)),{bbox:te(this,Ds,Df).call(this)}))}_onTranslating(t,r){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,{bbox:te(this,Ds,Df).call(this,t,r)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties(f(this,qi).getPathTranslatedSVGProperties(te(this,Ds,Lv).call(this),this.parentDimensions),{bbox:te(this,Ds,Df).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,f(this,sp)&&(F(this,sp,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){te(this,Ds,T_).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(te(this,Ds,B0).call(this),te(this,Ds,$0).call(this,f(this,qi).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var n;let r=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),te(this,Ds,T_).call(this)):t&&(this._uiManager.addShouldRescale(this),te(this,Ds,B0).call(this,t),r=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(t),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties({bbox:te(this,Ds,Df).call(this)},f(this,qi).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&te(this,Ds,$0).call(this,f(this,qi).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const r=document.createElement("div");t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,r,n,i,o){Qs("Not implemented")}static startDrawing(t,r,n,i){var S;const{target:o,offsetX:l,offsetY:c,pointerId:d,pointerType:u}=i;if(f(Wt,cd)&&f(Wt,cd)!==u)return;const{viewport:{rotation:h}}=t,{width:m,height:p}=o.getBoundingClientRect(),x=F(Wt,gh,new AbortController),w=t.combinedSignal(x);if(f(Wt,ld)||F(Wt,ld,d),f(Wt,cd)??F(Wt,cd,u),window.addEventListener("pointerup",b=>{var v;f(Wt,ld)===b.pointerId?this._endDraw(b):(v=f(Wt,dd))==null||v.delete(b.pointerId)},{signal:w}),window.addEventListener("pointercancel",b=>{var v;f(Wt,ld)===b.pointerId?this._currentParent.endDrawingSession():(v=f(Wt,dd))==null||v.delete(b.pointerId)},{signal:w}),window.addEventListener("pointerdown",b=>{f(Wt,cd)===b.pointerType&&((f(Wt,dd)||F(Wt,dd,new Set)).add(b.pointerId),f(Wt,on).isCancellable()&&(f(Wt,on).removeLastElement(),f(Wt,on).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",ho,{signal:w}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),o.addEventListener("touchmove",b=>{b.timeStamp===f(Wt,bh)&&Xi(b)},{signal:w}),t.toggleDrawing(),(S=r._editorUndoBar)==null||S.hide(),f(Wt,on)){t.drawLayer.updateProperties(this._currentDrawId,f(Wt,on).startNew(l,c,m,p,h));return}r.updateUIForDefaultProperties(this),F(Wt,on,this.createDrawerInstance(l,c,m,p,h)),F(Wt,xh,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(f(Wt,xh).toSVGProperties(),f(Wt,on).defaultSVGProperties),!0,!1)}static _drawMove(t){var o;if(F(Wt,bh,-1),!f(Wt,on))return;const{offsetX:r,offsetY:n,pointerId:i}=t;if(f(Wt,ld)===i){if(((o=f(Wt,dd))==null?void 0:o.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,f(Wt,on).add(r,n)),F(Wt,bh,t.timeStamp),Xi(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,F(Wt,on,null),F(Wt,xh,null),F(Wt,cd,null),F(Wt,bh,NaN)),f(Wt,gh)&&(f(Wt,gh).abort(),F(Wt,gh,null),F(Wt,ld,NaN),F(Wt,dd,null))}static _endDraw(t){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),t&&r.drawLayer.updateProperties(this._currentDrawId,f(Wt,on).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=f(Wt,on),i=this._currentDrawId,o=n.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(i,n.setLastElement(o))},undo:()=>{r.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:Es.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(Es.DRAW_STEP),!f(Wt,on).isEmpty()){const{pageDimensions:[n,i],scale:o}=r,l=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:f(Wt,on).getOutlines(n*o,i*o,o,this._INNER_MARGIN),drawingOptions:f(Wt,xh),mustBeCommitted:!t});return this._cleanup(!0),l}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,r,n,i,o,l){Qs("Not implemented")}static async deserialize(t,r,n){var h,m;const{rawDims:{pageWidth:i,pageHeight:o,pageX:l,pageY:c}}=r.viewport,d=this.deserializeDraw(l,c,i,o,this._INNER_MARGIN,t),u=await super.deserialize(t,r,n);return u.createDrawingOptions(t),te(h=u,Ds,L_).call(h,{drawOutlines:d}),te(m=u,Ds,B0).call(m),u.onScaleChanging(),u.rotate(),u}serializeDraw(t){const[r,n]=this.pageTranslation,[i,o]=this.pageDimensions;return f(this,qi).serialize([r,n,i,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};qi=new WeakMap,sp=new WeakMap,on=new WeakMap,gh=new WeakMap,xh=new WeakMap,ld=new WeakMap,cd=new WeakMap,dd=new WeakMap,bh=new WeakMap,Ds=new WeakSet,L_=function({drawOutlines:t,drawId:r,drawingOptions:n}){F(this,qi,t),this._drawingOptions||(this._drawingOptions=n),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,t.defaultProperties)):this._drawId=te(this,Ds,P_).call(this,t,this.parent),te(this,Ds,$0).call(this,t.box)},P_=function(t,r){const{id:n}=r.drawLayer.draw(Wt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n},T_=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},B0=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=te(this,Ds,P_).call(this,f(this,qi),t)}},SP=function([t,r,n,i]){const{parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[r,1-t,n*(l/o),i*(o/l)];case 180:return[1-t,1-r,n,i];case 270:return[1-r,t,n*(l/o),i*(o/l)];default:return[t,r,n,i]}},Lv=function(){const{x:t,y:r,width:n,height:i,parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[1-r,t,n*(o/l),i*(l/o)];case 180:return[1-t,1-r,n,i];case 270:return[r,1-t,n*(o/l),i*(l/o)];default:return[t,r,n,i]}},$0=function(t){if([this.x,this.y,this.width,this.height]=te(this,Ds,SP).call(this,t),this.div){this.fixAndSetPosition();const[r,n]=this.parentDimensions;this.setDims(this.width*r,this.height*n)}this._onResized()},Df=function(){const{x:t,y:r,width:n,height:i,rotation:o,parentRotation:l,parentDimensions:[c,d]}=this;switch((o*4+l)/90){case 1:return[1-r-i,t,i,n];case 2:return[1-t-n,1-r-i,n,i];case 3:return[r,1-t-n,i,n];case 4:return[t,r-n*(c/d),i*(d/c),n*(c/d)];case 5:return[1-r,t,n*(c/d),i*(d/c)];case 6:return[1-t-i*(d/c),1-r,i*(d/c),n*(c/d)];case 7:return[r-n*(c/d),1-t-i*(d/c),n*(c/d),i*(d/c)];case 8:return[t-n,r-i,n,i];case 9:return[1-r,t-n,i,n];case 10:return[1-t,1-r,n,i];case 11:return[r-i,1-t,i,n];case 12:return[t-i*(d/c),r,i*(d/c),n*(c/d)];case 13:return[1-r-n*(c/d),t-i*(d/c),n*(c/d),i*(d/c)];case 14:return[1-t,1-r-n*(c/d),i*(d/c),n*(c/d)];case 15:return[r,1-t,n*(c/d),i*(d/c)];default:return[t,r,n,i]}},ss(Wt,"_currentDrawId",-1),ss(Wt,"_currentParent",null),Q(Wt,on,null),Q(Wt,gh,null),Q(Wt,xh,null),Q(Wt,ld,NaN),Q(Wt,cd,null),Q(Wt,dd,null),Q(Wt,bh,NaN),ss(Wt,"_INNER_MARGIN",3);let E_=Wt;var $o,ln,cn,yh,rp,Qn,xn,ba,vh,wh,Nh,np,Pv;class i9{constructor(e,t,r,n,i,o){Q(this,np);Q(this,$o,new Float64Array(6));Q(this,ln);Q(this,cn);Q(this,yh);Q(this,rp);Q(this,Qn);Q(this,xn,"");Q(this,ba,0);Q(this,vh,new _1);Q(this,wh);Q(this,Nh);F(this,wh,r),F(this,Nh,n),F(this,yh,i),F(this,rp,o),[e,t]=te(this,np,Pv).call(this,e,t);const l=F(this,ln,[NaN,NaN,NaN,NaN,e,t]);F(this,Qn,[e,t]),F(this,cn,[{line:l,points:f(this,Qn)}]),f(this,$o).set(l,0)}updateProperty(e,t){e==="stroke-width"&&F(this,rp,t)}isEmpty(){return!f(this,cn)||f(this,cn).length===0}isCancellable(){return f(this,Qn).length<=10}add(e,t){[e,t]=te(this,np,Pv).call(this,e,t);const[r,n,i,o]=f(this,$o).subarray(2,6),l=e-i,c=t-o;return Math.hypot(f(this,wh)*l,f(this,Nh)*c)<=2?null:(f(this,Qn).push(e,t),isNaN(r)?(f(this,$o).set([i,o,e,t],2),f(this,ln).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(f(this,$o)[0])&&f(this,ln).splice(6,6),f(this,$o).set([r,n,i,o,e,t],0),f(this,ln).push(...qt.createBezierPoints(r,n,i,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const r=this.add(e,t);return r||(f(this,Qn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,r,n,i){F(this,wh,r),F(this,Nh,n),F(this,yh,i),[e,t]=te(this,np,Pv).call(this,e,t);const o=F(this,ln,[NaN,NaN,NaN,NaN,e,t]);F(this,Qn,[e,t]);const l=f(this,cn).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),f(this,cn).push({line:o,points:f(this,Qn)}),f(this,$o).set(o,0),F(this,ba,0),this.toSVGPath(),null}getLastElement(){return f(this,cn).at(-1)}setLastElement(e){return f(this,cn)?(f(this,cn).push(e),F(this,ln,e.line),F(this,Qn,e.points),F(this,ba,0),{path:{d:this.toSVGPath()}}):f(this,vh).setLastElement(e)}removeLastElement(){if(!f(this,cn))return f(this,vh).removeLastElement();f(this,cn).pop(),F(this,xn,"");for(let e=0,t=f(this,cn).length;e<t;e++){const{line:r,points:n}=f(this,cn)[e];F(this,ln,r),F(this,Qn,n),F(this,ba,0),this.toSVGPath()}return{path:{d:f(this,xn)}}}toSVGPath(){const e=qt.svgRound(f(this,ln)[4]),t=qt.svgRound(f(this,ln)[5]);if(f(this,Qn).length===2)return F(this,xn,`${f(this,xn)} M ${e} ${t} Z`),f(this,xn);if(f(this,Qn).length<=6){const n=f(this,xn).lastIndexOf("M");F(this,xn,`${f(this,xn).slice(0,n)} M ${e} ${t}`),F(this,ba,6)}if(f(this,Qn).length===4){const n=qt.svgRound(f(this,ln)[10]),i=qt.svgRound(f(this,ln)[11]);return F(this,xn,`${f(this,xn)} L ${n} ${i}`),F(this,ba,12),f(this,xn)}const r=[];f(this,ba)===0&&(r.push(`M ${e} ${t}`),F(this,ba,6));for(let n=f(this,ba),i=f(this,ln).length;n<i;n+=6){const[o,l,c,d,u,h]=f(this,ln).slice(n,n+6).map(qt.svgRound);r.push(`C${o} ${l} ${c} ${d} ${u} ${h}`)}return F(this,xn,f(this,xn)+r.join(" ")),F(this,ba,f(this,ln).length),f(this,xn)}getOutlines(e,t,r,n){const i=f(this,cn).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),f(this,vh).build(f(this,cn),e,t,r,f(this,yh),f(this,rp),n),F(this,$o,null),F(this,ln,null),F(this,cn,null),F(this,xn,null),f(this,vh)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}$o=new WeakMap,ln=new WeakMap,cn=new WeakMap,yh=new WeakMap,rp=new WeakMap,Qn=new WeakMap,xn=new WeakMap,ba=new WeakMap,vh=new WeakMap,wh=new WeakMap,Nh=new WeakMap,np=new WeakSet,Pv=function(e,t){return qt._normalizePoint(e,t,f(this,wh),f(this,Nh),f(this,yh))};var Zn,ob,lb,Hi,zo,Uo,ip,ap,op,vn,gl,jP,AP,kP;const Ij=class Ij extends qt{constructor(){super(...arguments);Q(this,vn);Q(this,Zn);Q(this,ob,0);Q(this,lb);Q(this,Hi);Q(this,zo);Q(this,Uo);Q(this,ip);Q(this,ap);Q(this,op)}build(t,r,n,i,o,l,c){F(this,zo,r),F(this,Uo,n),F(this,ip,i),F(this,ap,o),F(this,op,l),F(this,lb,c??0),F(this,Hi,t),te(this,vn,AP).call(this)}setLastElement(t){return f(this,Hi).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return f(this,Hi).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:r}of f(this,Hi)){if(t.push(`M${qt.svgRound(r[4])} ${qt.svgRound(r[5])}`),r.length===6){t.push("Z");continue}if(r.length===12){t.push(`L${qt.svgRound(r[10])} ${qt.svgRound(r[11])}`);continue}for(let n=6,i=r.length;n<i;n+=6){const[o,l,c,d,u,h]=r.subarray(n,n+6).map(qt.svgRound);t.push(`C${o} ${l} ${c} ${d} ${u} ${h}`)}}return t.join("")}serialize([t,r,n,i],o){const l=[],c=[],[d,u,h,m]=te(this,vn,jP).call(this);let p,x,w,S,b,v,N,j,E;switch(f(this,ap)){case 0:E=qt._rescale,p=t,x=r+i,w=n,S=-i,b=t+d*n,v=r+(1-u-m)*i,N=t+(d+h)*n,j=r+(1-u)*i;break;case 90:E=qt._rescaleAndSwap,p=t,x=r,w=n,S=i,b=t+u*n,v=r+d*i,N=t+(u+m)*n,j=r+(d+h)*i;break;case 180:E=qt._rescale,p=t+n,x=r,w=-n,S=i,b=t+(1-d-h)*n,v=r+u*i,N=t+(1-d)*n,j=r+(u+m)*i;break;case 270:E=qt._rescaleAndSwap,p=t+n,x=r+i,w=-n,S=-i,b=t+(1-u-m)*n,v=r+(1-d-h)*i,N=t+(1-u)*n,j=r+(1-d)*i;break}for(const{line:A,points:L}of f(this,Hi))l.push(E(A,p,x,w,S,o?new Array(A.length):null)),c.push(E(L,p,x,w,S,o?new Array(L.length):null));return{lines:l,points:c,rect:[b,v,N,j]}}static deserialize(t,r,n,i,o,{paths:{lines:l,points:c},rotation:d,thickness:u}){const h=[];let m,p,x,w,S;switch(d){case 0:S=qt._rescale,m=-t/n,p=r/i+1,x=1/n,w=-1/i;break;case 90:S=qt._rescaleAndSwap,m=-r/i,p=-t/n,x=1/i,w=1/n;break;case 180:S=qt._rescale,m=t/n+1,p=-r/i,x=-1/n,w=1/i;break;case 270:S=qt._rescaleAndSwap,m=r/i+1,p=t/n+1,x=-1/i,w=-1/n;break}if(!l){l=[];for(const v of c){const N=v.length;if(N===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1]]));continue}if(N===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1],NaN,NaN,NaN,NaN,v[2],v[3]]));continue}const j=new Float32Array(3*(N-2));l.push(j);let[E,A,L,C]=v.subarray(0,4);j.set([NaN,NaN,NaN,NaN,E,A],0);for(let B=4;B<N;B+=2){const U=v[B],P=v[B+1];j.set(qt.createBezierPoints(E,A,L,C,U,P),(B-2)*3),[E,A,L,C]=[L,C,U,P]}}}for(let v=0,N=l.length;v<N;v++)h.push({line:S(l[v].map(j=>j??NaN),m,p,x,w),points:S(c[v].map(j=>j??NaN),m,p,x,w)});const b=new Ij;return b.build(h,n,i,1,d,u,o),b}get box(){return f(this,Zn)}updateProperty(t,r){return t==="stroke-width"?te(this,vn,kP).call(this,r):null}updateParentDimensions([t,r],n){const[i,o]=te(this,vn,gl).call(this);F(this,zo,t),F(this,Uo,r),F(this,ip,n);const[l,c]=te(this,vn,gl).call(this),d=l-i,u=c-o,h=f(this,Zn);return h[0]-=d,h[1]-=u,h[2]+=2*d,h[3]+=2*u,h}updateRotation(t){return F(this,ob,t),{path:{transform:this.rotationTransform}}}get viewBox(){return f(this,Zn).map(qt.svgRound).join(" ")}get defaultProperties(){const[t,r]=f(this,Zn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${qt.svgRound(t)} ${qt.svgRound(r)}`}}}get rotationTransform(){const[,,t,r]=f(this,Zn);let n=0,i=0,o=0,l=0,c=0,d=0;switch(f(this,ob)){case 90:i=r/t,o=-t/r,c=t;break;case 180:n=-1,l=-1,c=t,d=r;break;case 270:i=-r/t,o=t/r,d=r;break;default:return""}return`matrix(${n} ${i} ${o} ${l} ${qt.svgRound(c)} ${qt.svgRound(d)})`}getPathResizingSVGProperties([t,r,n,i]){const[o,l]=te(this,vn,gl).call(this),[c,d,u,h]=f(this,Zn);if(Math.abs(u-o)<=qt.PRECISION||Math.abs(h-l)<=qt.PRECISION){const S=t+n/2-(c+u/2),b=r+i/2-(d+h/2);return{path:{"transform-origin":`${qt.svgRound(t)} ${qt.svgRound(r)}`,transform:`${this.rotationTransform} translate(${S} ${b})`}}}const m=(n-2*o)/(u-2*o),p=(i-2*l)/(h-2*l),x=u/n,w=h/i;return{path:{"transform-origin":`${qt.svgRound(c)} ${qt.svgRound(d)}`,transform:`${this.rotationTransform} scale(${x} ${w}) translate(${qt.svgRound(o)} ${qt.svgRound(l)}) scale(${m} ${p}) translate(${qt.svgRound(-o)} ${qt.svgRound(-l)})`}}}getPathResizedSVGProperties([t,r,n,i]){const[o,l]=te(this,vn,gl).call(this),c=f(this,Zn),[d,u,h,m]=c;if(c[0]=t,c[1]=r,c[2]=n,c[3]=i,Math.abs(h-o)<=qt.PRECISION||Math.abs(m-l)<=qt.PRECISION){const b=t+n/2-(d+h/2),v=r+i/2-(u+m/2);for(const{line:N,points:j}of f(this,Hi))qt._translate(N,b,v,N),qt._translate(j,b,v,j);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${qt.svgRound(t)} ${qt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(n-2*o)/(h-2*o),x=(i-2*l)/(m-2*l),w=-p*(d+o)+t+o,S=-x*(u+l)+r+l;if(p!==1||x!==1||w!==0||S!==0)for(const{line:b,points:v}of f(this,Hi))qt._rescale(b,w,S,p,x,b),qt._rescale(v,w,S,p,x,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${qt.svgRound(t)} ${qt.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,r],n){const[i,o]=n,l=f(this,Zn),c=t-l[0],d=r-l[1];if(f(this,zo)===i&&f(this,Uo)===o)for(const{line:u,points:h}of f(this,Hi))qt._translate(u,c,d,u),qt._translate(h,c,d,h);else{const u=f(this,zo)/i,h=f(this,Uo)/o;F(this,zo,i),F(this,Uo,o);for(const{line:m,points:p}of f(this,Hi))qt._rescale(m,c,d,u,h,m),qt._rescale(p,c,d,u,h,p);l[2]*=u,l[3]*=h}return l[0]=t,l[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${qt.svgRound(t)} ${qt.svgRound(r)}`}}}get defaultSVGProperties(){const t=f(this,Zn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${qt.svgRound(t[0])} ${qt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Zn=new WeakMap,ob=new WeakMap,lb=new WeakMap,Hi=new WeakMap,zo=new WeakMap,Uo=new WeakMap,ip=new WeakMap,ap=new WeakMap,op=new WeakMap,vn=new WeakSet,gl=function(t=f(this,op)){const r=f(this,lb)+t/2*f(this,ip);return f(this,ap)%180===0?[r/f(this,zo),r/f(this,Uo)]:[r/f(this,Uo),r/f(this,zo)]},jP=function(){const[t,r,n,i]=f(this,Zn),[o,l]=te(this,vn,gl).call(this,0);return[t+o,r+l,n-2*o,i-2*l]},AP=function(){const t=F(this,Zn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of f(this,Hi)){if(i.length<=12){for(let c=4,d=i.length;c<d;c+=6){const[u,h]=i.subarray(c,c+2);t[0]=Math.min(t[0],u),t[1]=Math.min(t[1],h),t[2]=Math.max(t[2],u),t[3]=Math.max(t[3],h)}continue}let o=i[4],l=i[5];for(let c=6,d=i.length;c<d;c+=6){const[u,h,m,p,x,w]=i.subarray(c,c+6);Xt.bezierBoundingBox(o,l,u,h,m,p,x,w,t),o=x,l=w}}const[r,n]=te(this,vn,gl).call(this);t[0]=Math.min(1,Math.max(0,t[0]-r)),t[1]=Math.min(1,Math.max(0,t[1]-n)),t[2]=Math.min(1,Math.max(0,t[2]+r)),t[3]=Math.min(1,Math.max(0,t[3]+n)),t[2]-=t[0],t[3]-=t[1]},kP=function(t){const[r,n]=te(this,vn,gl).call(this);F(this,op,t);const[i,o]=te(this,vn,gl).call(this),[l,c]=[i-r,o-n],d=f(this,Zn);return d[0]-=l,d[1]-=c,d[2]+=2*l,d[3]+=2*c,d};let _1=Ij;var lp;const Rj=class Rj extends n9{constructor(t){super();Q(this,lp);F(this,lp,t),super.updateProperties({fill:"none",stroke:xr._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,r){t==="stroke-width"&&(r??(r=this["stroke-width"]),r*=f(this,lp).realScale),super.updateSVGProperty(t,r)}clone(){const t=new Rj(f(this,lp));return t.updateAll(this),t}};lp=new WeakMap;let I_=Rj;var q1,CP;const Jf=class Jf extends E_{constructor(t){super({...t,name:"inkEditor"});Q(this,q1);this._willKeepAspectRatio=!0}static initialize(t,r){xr.initialize(t,r),this._defaultDrawingOptions=new I_(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return js(this,"typesMap",new Map([[Es.INK_THICKNESS,"stroke-width"],[Es.INK_COLOR,"stroke"],[Es.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,r,n,i,o){return new i9(t,r,n,i,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,r,n,i,o,l){return _1.deserialize(t,r,n,i,o,l)}static async deserialize(t,r,n){let i=null;if(t instanceof jj){const{data:{inkLists:l,rect:c,rotation:d,id:u,color:h,opacity:m,borderStyle:{rawWidth:p},popupRef:x},parent:{page:{pageNumber:w}}}=t;i=t={annotationType:ys.INK,color:Array.from(h),thickness:p,opacity:m,paths:{points:l},boxes:null,pageIndex:w-1,rect:c.slice(0),rotation:d,id:u,deleted:!1,popupRef:x}}const o=await super.deserialize(t,r,n);return o.annotationElementId=t.id||null,o._initialData=i,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:r,parent:n}=this;r.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:r,opacity:n}){this._drawingOptions=Jf.getDefaultDrawingOptions({stroke:Xt.makeHexColor(...t),"stroke-width":r,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:n,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":c}}=this,d={annotationType:ys.INK,color:xr._colorManager.convert(o),opacity:l,thickness:c,paths:{lines:r,points:n},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?d:this.annotationElementId&&!te(this,q1,CP).call(this,d)?null:(d.id=this.annotationElementId,d)}renderAnnotationElement(t){const{points:r,rect:n}=this.serializeDraw(!1);return t.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:r}),null}};q1=new WeakSet,CP=function(t){const{color:r,thickness:n,opacity:i,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((l,c)=>l!==r[c])||t.thickness!==n||t.opacity!==i||t.pageIndex!==o},ss(Jf,"_type","ink"),ss(Jf,"_editorType",ys.INK),ss(Jf,"_defaultDrawingOptions",null);let R_=Jf;var pr,bn,ud,ql,hd,cp,qo,Ho,Wi,dp,Ms,z0,U0,Tv,M_,Iv,F_,Rv,EP;const lg=class lg extends xr{constructor(t){super({...t,name:"stampEditor"});Q(this,Ms);Q(this,pr,null);Q(this,bn,null);Q(this,ud,null);Q(this,ql,null);Q(this,hd,null);Q(this,cp,"");Q(this,qo,null);Q(this,Ho,null);Q(this,Wi,!1);Q(this,dp,!1);F(this,ql,t.bitmapUrl),F(this,hd,t.bitmapFile)}static initialize(t,r){xr.initialize(t,r)}static get supportedTypes(){return js(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(r=>`image/${r}`))}static get supportedTypesStr(){return js(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,r){r.pasteEditor(ys.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const r=t.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(t=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:i,width:o,height:l,channels:i.length/(o*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const d=c.output;return await this.setGuessedAltText(d),r&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}remove(){var t;f(this,bn)&&(F(this,pr,null),this._uiManager.imageManager.deleteId(f(this,bn)),(t=f(this,qo))==null||t.remove(),F(this,qo,null),f(this,Ho)&&(clearTimeout(f(this,Ho)),F(this,Ho,null))),super.remove()}rebuild(){if(!this.parent){f(this,bn)&&te(this,Ms,Tv).call(this);return}super.rebuild(),this.div!==null&&(f(this,bn)&&f(this,qo)===null&&te(this,Ms,Tv).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(f(this,ud)||f(this,pr)||f(this,ql)||f(this,hd)||f(this,bn))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,r;if(this.width&&(t=this.x,r=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),f(this,pr)?te(this,Ms,M_).call(this):te(this,Ms,Tv).call(this),this.width&&!this.annotationElementId){const[n,i]=this.parentDimensions;this.setAt(t*n,r*i,this.width*n,this.height*i)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;f(this,Ho)!==null&&clearTimeout(f(this,Ho)),F(this,Ho,setTimeout(()=>{F(this,Ho,null),te(this,Ms,F_).call(this)},200))}copyCanvas(t,r,n=!1){var p;t||(t=224);const{width:i,height:o}=f(this,pr),l=new IN;let c=f(this,pr),d=i,u=o,h=null;if(r){if(i>r||o>r){const C=Math.min(r/i,r/o);d=Math.floor(i*C),u=Math.floor(o*C)}h=document.createElement("canvas");const x=h.width=Math.ceil(d*l.sx),w=h.height=Math.ceil(u*l.sy);f(this,Wi)||(c=te(this,Ms,Iv).call(this,x,w));const S=h.getContext("2d");S.filter=this._uiManager.hcmFilter;let b="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(b="#8f8f9d",v="#42414d");const N=15,j=N*l.sx,E=N*l.sy,A=new OffscreenCanvas(j*2,E*2),L=A.getContext("2d");L.fillStyle=b,L.fillRect(0,0,j*2,E*2),L.fillStyle=v,L.fillRect(0,0,j,E),L.fillRect(j,E,j,E),S.fillStyle=S.createPattern(A,"repeat"),S.fillRect(0,0,x,w),S.drawImage(c,0,0,c.width,c.height,0,0,x,w)}let m=null;if(n){let x,w;if(l.symmetric&&c.width<t&&c.height<t)x=c.width,w=c.height;else if(c=f(this,pr),i>t||o>t){const v=Math.min(t/i,t/o);x=Math.floor(i*v),w=Math.floor(o*v),f(this,Wi)||(c=te(this,Ms,Iv).call(this,x,w))}const b=new OffscreenCanvas(x,w).getContext("2d",{willReadFrequently:!0});b.drawImage(c,0,0,c.width,c.height,0,0,x,w),m={width:x,height:w,data:b.getImageData(0,0,x,w).data}}return{canvas:h,width:d,height:u,imageData:m}}getImageForAltText(){return f(this,qo)}static async deserialize(t,r,n){var w;let i=null;if(t instanceof XL){const{data:{rect:S,rotation:b,id:v,structParent:N,popupRef:j},container:E,parent:{page:{pageNumber:A}}}=t,L=E.querySelector("canvas"),C=n.imageManager.getFromCanvas(E.id,L);L.remove();const B=((w=await r._structTree.getAriaAttributes(`${xj}${v}`))==null?void 0:w.get("aria-label"))||"";i=t={annotationType:ys.STAMP,bitmapId:C.id,bitmap:C.bitmap,pageIndex:A-1,rect:S.slice(0),rotation:b,id:v,deleted:!1,accessibilityData:{decorative:!1,altText:B},isSvg:!1,structParent:N,popupRef:j}}const o=await super.deserialize(t,r,n),{rect:l,bitmap:c,bitmapUrl:d,bitmapId:u,isSvg:h,accessibilityData:m}=t;u&&n.imageManager.isValidId(u)?(F(o,bn,u),c&&F(o,pr,c)):F(o,ql,d),F(o,Wi,h);const[p,x]=o.pageDimensions;return o.width=(l[2]-l[0])/p,o.height=(l[3]-l[1])/x,o.annotationElementId=t.id||null,m&&(o.altTextData=m),o._initialData=i,F(o,dp,!!i),o}serialize(t=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:ys.STAMP,bitmapId:f(this,bn),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:f(this,Wi),structTreeParentId:this._structTreeParentId};if(t)return n.bitmapUrl=te(this,Ms,Rv).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n;const{decorative:i,altText:o}=this.serializeAltText(!1);if(!i&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=te(this,Ms,EP).call(this,n);if(c.isSame)return null;c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,r===null)return n;r.stamps||(r.stamps=new Map);const l=f(this,Wi)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!r.stamps.has(f(this,bn)))r.stamps.set(f(this,bn),{area:l,serialized:n}),n.bitmap=te(this,Ms,Rv).call(this,!1);else if(f(this,Wi)){const c=r.stamps.get(f(this,bn));l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=te(this,Ms,Rv).call(this,!1))}return n}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};pr=new WeakMap,bn=new WeakMap,ud=new WeakMap,ql=new WeakMap,hd=new WeakMap,cp=new WeakMap,qo=new WeakMap,Ho=new WeakMap,Wi=new WeakMap,dp=new WeakMap,Ms=new WeakSet,z0=function(t,r=!1){if(!t){this.remove();return}F(this,pr,t.bitmap),r||(F(this,bn,t.id),F(this,Wi,t.isSvg)),t.file&&F(this,cp,t.file.name),te(this,Ms,M_).call(this)},U0=function(){if(F(this,ud,null),this._uiManager.enableWaiting(!1),!!f(this,qo)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&f(this,pr)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&f(this,pr)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Tv=function(){if(f(this,bn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(f(this,bn)).then(n=>te(this,Ms,z0).call(this,n,!0)).finally(()=>te(this,Ms,U0).call(this));return}if(f(this,ql)){const n=f(this,ql);F(this,ql,null),this._uiManager.enableWaiting(!0),F(this,ud,this._uiManager.imageManager.getFromUrl(n).then(i=>te(this,Ms,z0).call(this,i)).finally(()=>te(this,Ms,U0).call(this)));return}if(f(this,hd)){const n=f(this,hd);F(this,hd,null),this._uiManager.enableWaiting(!0),F(this,ud,this._uiManager.imageManager.getFromFile(n).then(i=>te(this,Ms,z0).call(this,i)).finally(()=>te(this,Ms,U0).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=lg.supportedTypesStr;const r=this._uiManager._signal;F(this,ud,new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),te(this,Ms,z0).call(this,i)}n()},{signal:r}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:r})}).finally(()=>te(this,Ms,U0).call(this))),t.click()},M_=function(){var h;const{div:t}=this;let{width:r,height:n}=f(this,pr);const[i,o]=this.pageDimensions,l=.75;if(this.width)r=this.width*i,n=this.height*o;else if(r>l*i||n>l*o){const m=Math.min(l*i/r,l*o/n);r*=m,n*=m}const[c,d]=this.parentDimensions;this.setDims(r*c/i,n*d/o),this._uiManager.enableWaiting(!1);const u=F(this,qo,document.createElement("canvas"));u.setAttribute("role","img"),this.addContainer(u),this.width=r/i,this.height=n/o,(h=this._initialOptions)!=null&&h.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),te(this,Ms,F_).call(this),f(this,dp)||(this.parent.addUndoableEditor(this),F(this,dp,!0)),this._reportTelemetry({action:"inserted_image"}),f(this,cp)&&u.setAttribute("aria-label",f(this,cp))},Iv=function(t,r){const{width:n,height:i}=f(this,pr);let o=n,l=i,c=f(this,pr);for(;o>2*t||l>2*r;){const d=o,u=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*r&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const h=new OffscreenCanvas(o,l);h.getContext("2d").drawImage(c,0,0,d,u,0,0,o,l),c=h.transferToImageBitmap()}return c},F_=function(){const[t,r]=this.parentDimensions,{width:n,height:i}=this,o=new IN,l=Math.ceil(n*t*o.sx),c=Math.ceil(i*r*o.sy),d=f(this,qo);if(!d||d.width===l&&d.height===c)return;d.width=l,d.height=c;const u=f(this,Wi)?f(this,pr):te(this,Ms,Iv).call(this,l,c),h=d.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(u,0,0,u.width,u.height,0,0,l,c)},Rv=function(t){if(t){if(f(this,Wi)){const i=this._uiManager.imageManager.getSvgUrl(f(this,bn));if(i)return i}const r=document.createElement("canvas");return{width:r.width,height:r.height}=f(this,pr),r.getContext("2d").drawImage(f(this,pr),0,0),r.toDataURL()}if(f(this,Wi)){const[r,n]=this.pageDimensions,i=Math.round(this.width*r*Rd.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*Rd.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(i,o);return l.getContext("2d").drawImage(f(this,pr),0,0,f(this,pr).width,f(this,pr).height,0,0,i,o),l.transferToImageBitmap()}return structuredClone(f(this,pr))},EP=function(t){var l;const{pageIndex:r,accessibilityData:{altText:n}}=this._initialData,i=t.pageIndex===r,o=(((l=t.accessibilityData)==null?void 0:l.alt)||"")===n;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&o,isSameAltText:o}},ss(lg,"_type","stamp"),ss(lg,"_editorType",ys.STAMP);let D_=lg;var _h,up,Wo,fd,Hl,ya,md,hp,Sh,to,Wl,Fn,Vl,Kt,pd,ur,LP,So,B_,$_,Dv;const za=class za{constructor({uiManager:e,pageIndex:t,div:r,structTreeLayer:n,accessibilityManager:i,annotationLayer:o,drawLayer:l,textLayer:c,viewport:d,l10n:u}){Q(this,ur);Q(this,_h);Q(this,up,!1);Q(this,Wo,null);Q(this,fd,null);Q(this,Hl,null);Q(this,ya,new Map);Q(this,md,!1);Q(this,hp,!1);Q(this,Sh,!1);Q(this,to,null);Q(this,Wl,null);Q(this,Fn,null);Q(this,Vl,null);Q(this,Kt);const h=[...f(za,pd).values()];if(!za._initialized){za._initialized=!0;for(const m of h)m.initialize(u,e)}e.registerEditorTypes(h),F(this,Kt,e),this.pageIndex=t,this.div=r,F(this,_h,i),F(this,Wo,o),this.viewport=d,F(this,Fn,c),this.drawLayer=l,this._structTree=n,f(this,Kt).addLayer(this)}get isEmpty(){return f(this,ya).size===0}get isInvisible(){return this.isEmpty&&f(this,Kt).getMode()===ys.NONE}updateToolbar(e){f(this,Kt).updateToolbar(e)}updateMode(e=f(this,Kt).getMode()){switch(te(this,ur,Dv).call(this),e){case ys.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ys.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ys.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const r of f(za,pd).values())t.toggle(`${r._type}Editing`,e===r._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=f(this,Fn))==null?void 0:t.div)}setEditingState(e){f(this,Kt).setEditingState(e)}addCommands(e){f(this,Kt).addCommands(e)}cleanUndoStack(e){f(this,Kt).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=f(this,Wo))==null||t.div.classList.toggle("disabled",!e)}async enable(){F(this,Sh,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const r of f(this,ya).values())r.enableEditing(),r.show(!0),r.annotationElementId&&(f(this,Kt).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));if(!f(this,Wo)){F(this,Sh,!1);return}const t=f(this,Wo).getEditableAnnotations();for(const r of t){if(r.hide(),f(this,Kt).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const n=await this.deserialize(r);n&&(this.addOrRebuild(n),n.enableEditing())}F(this,Sh,!1)}disable(){var n;F(this,hp,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const i of f(this,ya).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);(n=this.getEditableAnnotation(i.annotationElementId))==null||n.show(),i.remove()}if(f(this,Wo)){const i=f(this,Wo).getEditableAnnotations();for(const o of i){const{id:l}=o.data;if(f(this,Kt).isDeletedAnnotationElement(l))continue;let c=t.get(l);if(c){c.resetAnnotationElement(o),c.show(!1),o.show();continue}c=e.get(l),c&&(f(this,Kt).addChangedExistingAnnotation(c),c.renderAnnotationElement(o)&&c.show(!1)),o.show()}}te(this,ur,Dv).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const i of f(za,pd).values())r.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),F(this,hp,!1)}getEditableAnnotation(e){var t;return((t=f(this,Wo))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){f(this,Kt).getActive()!==e&&f(this,Kt).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=f(this,Fn))!=null&&e.div&&!f(this,Vl)){F(this,Vl,new AbortController);const t=f(this,Kt).combinedSignal(f(this,Vl));f(this,Fn).div.addEventListener("pointerdown",te(this,ur,LP).bind(this),{signal:t}),f(this,Fn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=f(this,Fn))!=null&&e.div&&f(this,Vl)&&(f(this,Vl).abort(),F(this,Vl,null),f(this,Fn).div.classList.remove("highlighting"))}enableClick(){if(f(this,fd))return;F(this,fd,new AbortController);const e=f(this,Kt).combinedSignal(f(this,fd));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=f(this,fd))==null||e.abort(),F(this,fd,null)}attach(e){f(this,ya).set(e.id,e);const{annotationElementId:t}=e;t&&f(this,Kt).isDeletedAnnotationElement(t)&&f(this,Kt).removeDeletedAnnotationElement(e)}detach(e){var t;f(this,ya).delete(e.id),(t=f(this,_h))==null||t.removePointerInTextLayer(e.contentDiv),!f(this,hp)&&e.annotationElementId&&f(this,Kt).addDeletedAnnotationElement(e)}remove(e){this.detach(e),f(this,Kt).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(f(this,Kt).addDeletedAnnotationElement(e.annotationElementId),xr.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),f(this,Kt).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!f(this,Sh)),f(this,Kt).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var r;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!f(this,Hl)&&(e._focusEventsAllowed=!1,F(this,Hl,setTimeout(()=>{F(this,Hl,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:f(this,Kt)._signal}),t.focus())},0))),e._structTreeParentId=(r=f(this,_h))==null?void 0:r.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:t,undo:r,mustExec:!1})}getNextId(){return f(this,Kt).getId()}combinedSignal(e){return f(this,Kt).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=f(this,ur,So))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){f(this,Kt).updateToolbar(e),f(this,Kt).updateMode(e);const{offsetX:r,offsetY:n}=te(this,ur,$_).call(this),i=this.getNextId(),o=te(this,ur,B_).call(this,{parent:this,id:i,x:r,y:n,uiManager:f(this,Kt),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=f(za,pd).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,f(this,Kt)))||null}createAndAddNewEditor(e,t,r={}){const n=this.getNextId(),i=te(this,ur,B_).call(this,{parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:f(this,Kt),isCentered:t,...r});return i&&this.add(i),i}addNewEditor(){this.createAndAddNewEditor(te(this,ur,$_).call(this),!0)}setSelected(e){f(this,Kt).setSelected(e)}toggleSelected(e){f(this,Kt).toggleSelected(e)}unselect(e){f(this,Kt).unselect(e)}pointerup(e){var r;const{isMac:t}=ni.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&f(this,md)&&(F(this,md,!1),!((r=f(this,ur,So))!=null&&r.isDrawer&&f(this,ur,So).supportMultipleDrawings))){if(!f(this,up)){F(this,up,!0);return}if(f(this,Kt).getMode()===ys.STAMP){f(this,Kt).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var n;if(f(this,Kt).getMode()===ys.HIGHLIGHT&&this.enableTextSelection(),f(this,md)){F(this,md,!1);return}const{isMac:t}=ni.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(F(this,md,!0),(n=f(this,ur,So))!=null&&n.isDrawer){this.startDrawingSession(e);return}const r=f(this,Kt).getActive();F(this,up,!r||r.isEmpty())}startDrawingSession(e){if(this.div.focus(),f(this,to)){f(this,ur,So).startDrawing(this,f(this,Kt),!1,e);return}f(this,Kt).setCurrentDrawingSession(this),F(this,to,new AbortController);const t=f(this,Kt).combinedSignal(f(this,to));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(F(this,Wl,null),this.commitOrRemove())},{signal:t}),f(this,ur,So).startDrawing(this,f(this,Kt),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&F(this,Wl,t);return}f(this,Wl)&&setTimeout(()=>{var t;(t=f(this,Wl))==null||t.focus(),F(this,Wl,null)},0)}endDrawingSession(e=!1){return f(this,to)?(f(this,Kt).setCurrentDrawingSession(null),f(this,to).abort(),F(this,to,null),F(this,Wl,null),f(this,ur,So).endDrawing(e)):null}findNewParent(e,t,r){const n=f(this,Kt).findParent(t,r);return n===null||n===this?!1:(n.changeParent(e),!0)}commitOrRemove(){return f(this,to)?(this.endDrawingSession(),!0):!1}onScaleChanging(){f(this,to)&&f(this,ur,So).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=f(this,Kt).getActive())==null?void 0:e.parent)===this&&(f(this,Kt).commitOrRemove(),f(this,Kt).setActiveEditor(null)),f(this,Hl)&&(clearTimeout(f(this,Hl)),F(this,Hl,null));for(const r of f(this,ya).values())(t=f(this,_h))==null||t.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,f(this,ya).clear(),f(this,Kt).removeLayer(this)}render({viewport:e}){this.viewport=e,Oh(this.div,e);for(const t of f(this,Kt).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){f(this,Kt).commitOrRemove(),te(this,ur,Dv).call(this);const t=this.viewport.rotation,r=e.rotation;if(this.viewport=e,Oh(this.div,{rotation:r}),t!==r)for(const n of f(this,ya).values())n.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return f(this,Kt).viewParameters.realScale}};_h=new WeakMap,up=new WeakMap,Wo=new WeakMap,fd=new WeakMap,Hl=new WeakMap,ya=new WeakMap,md=new WeakMap,hp=new WeakMap,Sh=new WeakMap,to=new WeakMap,Wl=new WeakMap,Fn=new WeakMap,Vl=new WeakMap,Kt=new WeakMap,pd=new WeakMap,ur=new WeakSet,LP=function(e){f(this,Kt).unselectAll();const{target:t}=e;if(t===f(this,Fn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&f(this,Fn).div.contains(t)){const{isMac:r}=ni.platform;if(e.button!==0||e.ctrlKey&&r)return;f(this,Kt).showAllEditors("highlight",!0,!0),f(this,Fn).div.classList.add("free"),this.toggleDrawing(),N1.startHighlighting(this,f(this,Kt).direction==="ltr",{target:f(this,Fn).div,x:e.x,y:e.y}),f(this,Fn).div.addEventListener("pointerup",()=>{f(this,Fn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:f(this,Kt)._signal}),e.preventDefault()}},So=function(){return f(za,pd).get(f(this,Kt).getMode())},B_=function(e){const t=f(this,ur,So);return t?new t.prototype.constructor(e):null},$_=function(){const{x:e,y:t,width:r,height:n}=this.div.getBoundingClientRect(),i=Math.max(0,e),o=Math.max(0,t),l=Math.min(window.innerWidth,e+r),c=Math.min(window.innerHeight,t+n),d=(i+l)/2-e,u=(o+c)/2-t,[h,m]=this.viewport.rotation%180===0?[d,u]:[u,d];return{offsetX:h,offsetY:m}},Dv=function(){for(const e of f(this,ya).values())e.isEmpty()&&e.remove()},ss(za,"_initialized",!1),Q(za,pd,new Map([y_,R_,D_,N1].map(e=>[e._editorType,e])));let O_=za;var so,cb,ei,jh,H1,PP,Zo,U_,TP,q_;const In=class In{constructor({pageIndex:e}){Q(this,Zo);Q(this,so,null);Q(this,cb,0);Q(this,ei,new Map);Q(this,jh,new Map);this.pageIndex=e}setParent(e){if(!f(this,so)){F(this,so,e);return}if(f(this,so)!==e){if(f(this,ei).size>0)for(const t of f(this,ei).values())t.remove(),e.append(t);F(this,so,e)}}static get _svgFactory(){return js(this,"_svgFactory",new Sj)}draw(e,t=!1,r=!1){const n=Gn(this,cb)._++,i=te(this,Zo,U_).call(this),o=In._svgFactory.createElement("defs");i.append(o);const l=In._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),t&&f(this,jh).set(n,l);const d=r?te(this,Zo,TP).call(this,o,c):null,u=In._svgFactory.createElement("use");return i.append(u),u.setAttribute("href",`#${c}`),this.updateProperties(i,e),f(this,ei).set(n,i),{id:n,clipPathId:`url(#${d})`}}drawOutline(e,t){const r=Gn(this,cb)._++,n=te(this,Zo,U_).call(this),i=In._svgFactory.createElement("defs");n.append(i);const o=In._svgFactory.createElement("path");i.append(o);const l=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const h=In._svgFactory.createElement("mask");i.append(h),c=`mask_p${this.pageIndex}_${r}`,h.setAttribute("id",c),h.setAttribute("maskUnits","objectBoundingBox");const m=In._svgFactory.createElement("rect");h.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const p=In._svgFactory.createElement("use");h.append(p),p.setAttribute("href",`#${l}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const d=In._svgFactory.createElement("use");n.append(d),d.setAttribute("href",`#${l}`),c&&d.setAttribute("mask",`url(#${c})`);const u=d.cloneNode();return n.append(u),d.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(n,e),f(this,ei).set(r,n),r}finalizeDraw(e,t){f(this,jh).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:r,bbox:n,rootClass:i,path:o}=t,l=typeof e=="number"?f(this,ei).get(e):e;if(l){if(r&&te(this,Zo,q_).call(this,l,r),n&&te(c=In,H1,PP).call(c,l,n),i){const{classList:d}=l;for(const[u,h]of Object.entries(i))d.toggle(u,h)}if(o){const u=l.firstChild.firstChild;te(this,Zo,q_).call(this,u,o)}}}updateParent(e,t){if(t===this)return;const r=f(this,ei).get(e);r&&(f(t,so).append(r),f(this,ei).delete(e),f(t,ei).set(e,r))}remove(e){f(this,jh).delete(e),f(this,so)!==null&&(f(this,ei).get(e).remove(),f(this,ei).delete(e))}destroy(){F(this,so,null);for(const e of f(this,ei).values())e.remove();f(this,ei).clear(),f(this,jh).clear()}};so=new WeakMap,cb=new WeakMap,ei=new WeakMap,jh=new WeakMap,H1=new WeakSet,PP=function(e,[t,r,n,i]){const{style:o}=e;o.top=`${100*r}%`,o.left=`${100*t}%`,o.width=`${100*n}%`,o.height=`${100*i}%`},Zo=new WeakSet,U_=function(){const e=In._svgFactory.create(1,1,!0);return f(this,so).append(e),e.setAttribute("aria-hidden",!0),e},TP=function(e,t){const r=In._svgFactory.createElement("clipPath");e.append(r);const n=`clip_${t}`;r.setAttribute("id",n),r.setAttribute("clipPathUnits","objectBoundingBox");const i=In._svgFactory.createElement("use");return r.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),n},q_=function(e,t){for(const[r,n]of Object.entries(t))n===null?e.removeAttribute(r):e.setAttribute(r,n)},Q(In,H1);let z_=In;globalThis.pdfjsTestingUtils={HighlightOutliner:w_};ls.AbortException;ls.AnnotationEditorLayer;ls.AnnotationEditorParamsType;ls.AnnotationEditorType;ls.AnnotationEditorUIManager;ls.AnnotationLayer;ls.AnnotationMode;ls.ColorPicker;ls.DOMSVGFactory;ls.DrawLayer;ls.FeatureTest;var a9=ls.GlobalWorkerOptions;ls.ImageKind;ls.InvalidPDFException;ls.MissingPDFException;ls.OPS;ls.OutputScale;ls.PDFDataRangeTransport;ls.PDFDateString;ls.PDFWorker;ls.PasswordResponses;ls.PermissionFlag;ls.PixelsPerInch;ls.RenderingCancelledException;ls.TextLayer;ls.TouchManager;ls.UnexpectedResponseException;ls.Util;ls.VerbosityLevel;ls.XfaLayer;ls.build;ls.createValidAbsoluteUrl;ls.fetchData;var o9=ls.getDocument;ls.getFilenameFromUrl;ls.getPdfFilenameFromUrl;ls.getXfaPageViewport;ls.isDataScheme;ls.isPdfFile;ls.noContextMenu;ls.normalizeUnicode;ls.setLayerDimensions;ls.shadow;ls.stopEvent;ls.version;const l9="/assets/pdf.worker.min-yatZIOMy.mjs";a9.workerSrc=l9;const A3="/.netlify/functions/extractor",c9=async s=>{try{const e=await s.arrayBuffer(),t=await o9({data:e}).promise;let r="";for(let i=1;i<=t.numPages;i++){const c=(await(await t.getPage(i)).getTextContent()).items.map(d=>d.str).join(" ");r+=c+" "}const n=d9(r);return await u9(n,s),n}catch(e){throw console.error("PDF extraction error:",e),new Error("Failed to extract data from PDF")}},d9=s=>{const t=s.replace(/\*start\*[\s\S]*?\*end\*/gi," ").replace(/\s+/g," ").trim(),r={businessName:[/business\s+dba\s+name[:\s]+([^\n\r]+)/i,/(?:business\s+name|company\s+name|legal\s+name)[:\s]+([^\n\r]+)/i,/(?:dba|doing\s+business\s+as)[:\s]+([^\n\r]+)/i],ownerName:[/(?:owner\s+name|principal\s+name|applicant\s+name)[:\s]+([^\n\r]+)/i,/(?:first\s+name\s+last\s+name|full\s+name)[:\s]+([^\n\r]+)/i],email:[/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g,/(?:email|e-mail)[:\s]+([^\s\n\r]+)/i],phone:[/(?:phone|telephone|cell|mobile)[:\s]*(\(?[0-9]{3}\)?[-.\s]?[0-9]{3}[-.\s]?[0-9]{4})/i],address:[/address\s+cty\s+state\s+zip[:\s]+([^\n\r]+(?:\s+[^\n\r]+)*)/i,/(?:business\s+address|address)[:\s]+([^\n\r]+(?:\s+[^\n\r]+)*)/i,/(?:street|address\s+line)[:\s]+([^\n\r]+)/i],ein:[/federal\s+tax\s+id\s*#[:\s]*(\d{2}-?\d{7})/i,/(?:federal\s+tax\s+id|tax\s+id\s*#)[:\s]*(\d{2}-?\d{7})/i,/(?:ein|tax\s+id|federal\s+id)[:\s]*(\d{2}-?\d{7})/i],businessType:[/(?:business\s+type|entity\s+type|legal\s+structure)[:\s]+([^,\n]+)/i,/(?:llc|corporation|partnership|sole\s+proprietorship|s-corp|c-corp)/i],industry:[/(?:industry|business\s+type|nature\s+of\s+business)[:\s]+([^,\n]+)/i,/(?:retail|restaurant|healthcare|construction|professional\s+services|transportation|manufacturing|technology|real\s+estate)/i],yearsInBusiness:[/(?:years\s+in\s+business|time\s+in\s+business)[:\s]*(\d+(?:\.\d+)?)/i,/(?:established|started)[:\s]*(\d{4})/i],numberOfEmployees:[/(?:number\s+of\s+employees|employees|staff\s+size)[:\s]*(\d+)/i,/(\d+)\s+employees/i],annualRevenue:[/(?:annual\s+revenue|yearly\s+revenue|annual\s+sales)[:\s]*\$?([0-9,]+)/i,/(?:gross\s+revenue)[:\s]*\$?([0-9,]+)/i],averageMonthlyRevenue:[/(?:monthly\s+revenue|average\s+monthly\s+sales)[:\s]*\$?([0-9,]+)/i,/(?:monthly\s+gross)[:\s]*\$?([0-9,]+)/i],averageMonthlyDeposits:[/(?:monthly\s+deposits|average\s+monthly\s+deposits)[:\s]*\$?([0-9,]+)/i,/(?:bank\s+deposits)[:\s]*\$?([0-9,]+)/i],existingDebt:[/(?:existing\s+debt|current\s+debt|outstanding\s+debt)[:\s]*\$?([0-9,]+)/i,/(?:debt\s+balance)[:\s]*\$?([0-9,]+)/i],creditScore:[/(?:credit\s+score|fico\s+score|personal\s+credit)[:\s]*(\d{3})/i,/(?:score)[:\s]*(\d{3})/i],requestedAmount:[/amount\s+requested[:\s]*\$?([0-9,]+)/i,/(?:requested\s+amount|loan\s+amount|funding\s+amount)[:\s]*\$?([0-9,]+)/i,/(?:amount\s+needed|capital\s+needed)[:\s]*\$?([0-9,]+)/i]},n={businessName:"",ownerName:"",email:"",phone:"",address:"",ein:"",businessType:"",industry:"",yearsInBusiness:"",numberOfEmployees:"",annualRevenue:"",averageMonthlyRevenue:"",averageMonthlyDeposits:"",existingDebt:"",creditScore:"",requestedAmount:""};if(Object.keys(r).forEach(i=>{const o=r[i];for(const l of o){const c=t.match(l);if(c&&c[1]){let d=c[1].trim().replace(/\s+/g," ");(i.includes("Revenue")||i.includes("Amount")||i.includes("Debt")||i.includes("Deposits"))&&(d=d.replace(/[,$]/g,"")),i==="phone"&&(d=d.replace(/[^\d]/g,""),d.length===10&&(d=`(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6)}`)),i==="ein"&&d.length===9&&(d=`${d.slice(0,2)}-${d.slice(2)}`),i==="address"&&(d=d.replace(/\s+/g," ").trim()),n[i]=d;break}}}),console.log("PDF Extraction Results:",n),!n.businessType&&t.toLowerCase().includes("llc")&&(n.businessType="LLC"),!n.yearsInBusiness&&n.businessName){const i=new Date().getFullYear(),o=t.match(/(?:established|started|founded)[:\s]*(\d{4})/i);o&&(n.yearsInBusiness=(i-parseInt(o[1])).toString())}if(!n.averageMonthlyRevenue&&n.annualRevenue){const i=parseInt(n.annualRevenue.replace(/[,$]/g,""));isNaN(i)||(n.averageMonthlyRevenue=Math.round(i/12).toString())}return n},u9=async(s,e)=>{try{console.log("Sending PDF file and extracted data to server:",A3);const t=new FormData;t.append("file",e),t.append("data",JSON.stringify({fileName:e.name,extractedAt:new Date().toISOString(),extractedData:s}));const r=await fetch(A3,{method:"POST",body:t});if(!r.ok)throw new Error(`Extracted data submit error: ${r.status} ${r.statusText}`);const n=await r.json();console.log("Extracted data response:",n);try{window.postMessage({type:"webhook-response",payload:n},window.location.origin),console.log("Dispatched window message: extracted-response")}catch(i){console.warn("Failed to dispatch webhook-response message:",i)}}catch(t){console.error("Failed to send extracted data to server:",t)}},IP=({onSubmit:s,initialStep:e="upload",reviewMode:t=!1,reviewInitial:r=null,onReviewSubmit:n,onReadyForForm:i,reviewDocName:o,onReplaceDocument:l})=>{const{user:c}=Wd(),[d,u]=ne.useState(e),[h,m]=ne.useState(!1),[p,x]=ne.useState(0),[w,S]=ne.useState(null),[b,v]=ne.useState(null),[N,j]=ne.useState(!1),E=ne.useRef(0),[A,L]=ne.useState({businessName:"",ownerName:"",email:"",phone:"",dateOfBirth:"",address:"",ein:"",businessType:"",industry:"",yearsInBusiness:"",numberOfEmployees:"",annualRevenue:"",averageMonthlyRevenue:"",averageMonthlyDeposits:"",existingDebt:"",creditScore:"",requestedAmount:"",documents:[]});ne.useEffect(()=>{var Te,oe,et,pe,xe,he,we,Ae,Ze,$e,Qe,lt,At;if(!t||!r)return;L(Nt=>{var Lt,Dt,yt,os,me,Ce,dt,O,_e,at,St,Tt,Pt;return{...Nt,businessName:r.businessName??Nt.businessName,ownerName:((Lt=r.contactInfo)==null?void 0:Lt.ownerName)??Nt.ownerName,email:((Dt=r.contactInfo)==null?void 0:Dt.email)??Nt.email,phone:((yt=r.contactInfo)==null?void 0:yt.phone)??Nt.phone,dateOfBirth:((os=r==null?void 0:r.contactInfo)==null?void 0:os.dateOfBirth)??Nt.dateOfBirth,address:((me=r.contactInfo)==null?void 0:me.address)??Nt.address,ein:((Ce=r.businessInfo)==null?void 0:Ce.ein)??Nt.ein,businessType:((dt=r.businessInfo)==null?void 0:dt.businessType)??Nt.businessType,industry:r.industry??Nt.industry,yearsInBusiness:((O=r.businessInfo)==null?void 0:O.yearsInBusiness)!==void 0?String(r.businessInfo.yearsInBusiness):Nt.yearsInBusiness,numberOfEmployees:((_e=r.businessInfo)==null?void 0:_e.numberOfEmployees)!==void 0?String(r.businessInfo.numberOfEmployees):Nt.numberOfEmployees,annualRevenue:((at=r.financialInfo)==null?void 0:at.annualRevenue)!==void 0?String(r.financialInfo.annualRevenue):Nt.annualRevenue,averageMonthlyRevenue:((St=r.financialInfo)==null?void 0:St.averageMonthlyRevenue)!==void 0?String(r.financialInfo.averageMonthlyRevenue):Nt.averageMonthlyRevenue,averageMonthlyDeposits:((Tt=r.financialInfo)==null?void 0:Tt.averageMonthlyDeposits)!==void 0?String(r.financialInfo.averageMonthlyDeposits):Nt.averageMonthlyDeposits,existingDebt:((Pt=r.financialInfo)==null?void 0:Pt.existingDebt)!==void 0?String(r.financialInfo.existingDebt):Nt.existingDebt,creditScore:r.creditScore!==void 0?String(r.creditScore):Nt.creditScore,requestedAmount:r.requestedAmount!==void 0?String(r.requestedAmount):Nt.requestedAmount,documents:r.documents??Nt.documents}});const Be=[];r.businessName&&Be.push("businessName"),(Te=r.contactInfo)!=null&&Te.ownerName&&Be.push("ownerName"),(oe=r.contactInfo)!=null&&oe.email&&Be.push("email"),(et=r.contactInfo)!=null&&et.phone&&Be.push("phone"),(pe=r==null?void 0:r.contactInfo)!=null&&pe.dateOfBirth&&Be.push("dateOfBirth"),(xe=r.contactInfo)!=null&&xe.address&&Be.push("address"),(he=r.businessInfo)!=null&&he.ein&&Be.push("ein"),(we=r.businessInfo)!=null&&we.businessType&&Be.push("businessType"),r.industry&&Be.push("industry"),((Ae=r.businessInfo)==null?void 0:Ae.yearsInBusiness)!==void 0&&Be.push("yearsInBusiness"),((Ze=r.businessInfo)==null?void 0:Ze.numberOfEmployees)!==void 0&&Be.push("numberOfEmployees"),(($e=r.financialInfo)==null?void 0:$e.annualRevenue)!==void 0&&Be.push("annualRevenue"),((Qe=r.financialInfo)==null?void 0:Qe.averageMonthlyRevenue)!==void 0&&Be.push("averageMonthlyRevenue"),((lt=r.financialInfo)==null?void 0:lt.averageMonthlyDeposits)!==void 0&&Be.push("averageMonthlyDeposits"),((At=r.financialInfo)==null?void 0:At.existingDebt)!==void 0&&Be.push("existingDebt"),r.creditScore!==void 0&&Be.push("creditScore"),r.requestedAmount!==void 0&&Be.push("requestedAmount"),(r.documents??[]).length>0&&Be.push("documents"),Be.length>0&&q(Nt=>{const Lt={...Nt};return Be.forEach(Dt=>{Lt[Dt]=!0}),Lt}),u("form")},[t,r]),ne.useEffect(()=>{(e==="form"||e==="upload")&&u(e)},[e]);const[C,B]=ne.useState({}),[U,P]=ne.useState({}),[T,z]=ne.useState(null),[H,D]=ne.useState(null),[M]=ne.useState(!1),[$,q]=ne.useState({});ne.useEffect(()=>{t&&q({businessName:!0,industry:!0,businessType:!0,yearsInBusiness:!0,numberOfEmployees:!0,ownerName:!0,email:!0,phone:!0,dateOfBirth:!0,address:!0,ein:!0,annualRevenue:!0,averageMonthlyRevenue:!0,averageMonthlyDeposits:!0,existingDebt:!0,creditScore:!0,requestedAmount:!0})},[t]);const K=ne.useMemo(()=>M?new Set:new Set(Object.keys($)),[M,$]),de=ne.useMemo(()=>{const Be=new Set(["businessName","industry","businessType","ein","yearsInBusiness","numberOfEmployees","ownerName","email","phone","dateOfBirth","address","annualRevenue","creditScore","requestedAmount"]);let Te=0;return Be.forEach(oe=>{K.has(oe)&&Te++}),Te},[K]),Ne=ne.useRef(!1),R=ne.useMemo(()=>["Retail","Restaurant","Healthcare","Construction","Professional Services","Transportation","Manufacturing","Technology","Real Estate","Other"],[]),W=ne.useMemo(()=>["Sole Proprietorship","Partnership","LLC","Corporation","S-Corporation"],[]),Z=ne.useMemo(()=>{const Be=[...W];return A.businessType&&!Be.includes(A.businessType)&&Be.unshift(A.businessType),Be},[W,A.businessType]),ue=ne.useMemo(()=>{const Be=[...R];return A.industry&&!Be.includes(A.industry)&&Be.unshift(A.industry),Be},[R,A.industry]);ne.useEffect(()=>{if(M)return;const Be=async Te=>{var oe;try{const pe=new Set([window.location.origin]),xe=pe.has(Te.origin);if(xe||console.warn("Ignoring extracted message from unallowed origin:",Te.origin,"Allowed:",Array.from(pe)),xe&&((oe=Te.data)==null?void 0:oe.type)==="webhook-response"){const he=Te.data.payload,we=Array.isArray(he)?he[0]??null:he;if(v(we),console.log("Extracted data received:",JSON.stringify(we,null,2)),console.log("Extracted data type:",typeof we),console.log("Extracted data keys:",we?Object.keys(we):"No data"),we){const Ae={},Ze=we;console.log("Processing extracted data:",Ze);let $e=Ze;const Qe=["extractedData","data","fields","formData","values"];for(const me of Qe)if(Ze&&typeof Ze=="object"&&me in Ze&&Ze[me]&&typeof Ze[me]=="object"){console.log(`Found data in ${me} property`),$e=Ze[me];break}console.log("Final data to process:",$e);const lt={},At=(me,Ce="")=>{me&&typeof me=="object"&&!Array.isArray(me)&&Object.entries(me).forEach(([dt,O])=>{const _e=Ce?`${Ce}.${dt}`:dt;O&&typeof O=="object"&&!Array.isArray(O)?At(O,_e):(lt[_e]=O,lt[dt]=O)})};At(Ze),console.log("Flattened data:",lt),[$e,lt].forEach(me=>{Object.entries(me).forEach(([Ce,dt])=>{let O="";if(typeof dt=="string")O=dt;else if(typeof dt=="number"||typeof dt=="boolean")O=String(dt);else return;O.trim()!==""&&(Ae[Ce]=O,Ce==="Credit Score"||Ce==="Number of Employees"||Ce==="% of Ownership"||Ce==="SSN"?Ae[Ce]=O.replace(/[^0-9]/g,""):["Requested Amount","Annual Revenue","Average Monthly Revenue","Average Monthly Deposits","Existing Debt","Years in Business"].includes(Ce)&&(Ae[Ce]=O.replace(/[^0-9.]/g,"")))})}),console.log("Cleaned extracted keys available:",Object.keys(Ae));const Nt=me=>me.trim().replace(/:+$/,"").toLowerCase().replace(/[\s_]+/g,""),Lt=new Map;Object.entries(Ae).forEach(([me,Ce])=>{new Set([me,me.trim(),me.replace(/:+$/,"")]).forEach(O=>Lt.set(Nt(O),Ce))});const Dt=new Set,yt={};L(me=>{const Ce={...me},dt=_e=>{for(const St of _e){const Tt=Ae[St];if(typeof Tt=="string"&&Tt.trim()!=="")return Tt;const Pt=Ae[`${St}:`];if(typeof Pt=="string"&&Pt.trim()!=="")return Pt;const kt=Nt(St),jt=Lt.get(kt);if(typeof jt=="string"&&jt.trim()!=="")return jt}const at=_e.map(St=>Nt(St));for(const[St,Tt]of Lt.entries())if(!(typeof Tt!="string"||!Tt.trim())&&at.some(Pt=>St.includes(Pt)||Pt.includes(St)))return Tt},O=(_e,at,St)=>{let Tt=dt(at);if(!Tt){console.log(`Skipped empty: ${String(_e)}`);return}const Pt=String(Ce[_e]??""),kt=C[String(_e)];!Pt||Pt.trim()===""?(Ce[_e]=Tt,Dt.add(String(_e)),yt[String(_e)]=Tt,console.log(`Filled empty: ${String(_e)} ->`,Tt)):kt!==void 0&&Pt===kt?(Ce[_e]=Tt,Dt.add(String(_e)),yt[String(_e)]=Tt,console.log(`Updated auto-filled: ${String(_e)} ${Pt} -> ${Tt}`)):console.log(`Preserved user edit: ${String(_e)} (current: ${Pt})`)};return O("businessName",["Business Name","business_name","businessName","company","Company Name","company_name"]),O("ownerName",["Owner Name","owner_name","ownerName","name","Name","full_name","Full Name"]),O("email",["Email","email","email_address","emailAddress","contact_email"]),O("phone",["SSN","ssn","social_security","social_security_number"]),O("dateOfBirth",["Date of Birth","date_of_birth","dob","birthdate","birth_date"]),O("address",["Business Address","business_address","businessAddress","address","Address","location"]),O("ein",["EIN","ein","tax_id","taxId","employer_identification_number"]),O("businessType",["Business Type","business_type","businessType","company_type","entity_type"]),O("industry",["Industry","industry","business_industry","sector","business_sector"]),O("yearsInBusiness",["Years in Business","years_in_business","yearsInBusiness","business_age","company_age"]),O("numberOfEmployees",["% of Ownership","ownership","percent_ownership","ownership_percent"]),O("annualRevenue",["Annual Revenue","annual_revenue","annualRevenue","yearly_revenue","revenue"]),O("averageMonthlyRevenue",["Average Monthly Revenue","average_monthly_revenue","averageMonthlyRevenue","monthly_revenue"]),O("averageMonthlyDeposits",["Average Monthly Deposits","average_monthly_deposits","averageMonthlyDeposits","monthly_deposits"]),O("existingDebt",["Existing Debt","existing_debt","existingDebt","current_debt","debt"]),O("creditScore",["Credit Score","credit_score","creditScore","fico_score","credit_rating"]),O("requestedAmount",["Requested Amount","requested_amount","requestedAmount","loan_amount","funding_amount"]),Ce});const os=(()=>{const me=["Date of Birth","date_of_birth","dob","birthdate","birth_date"];for(const Ce of me){const dt=Ae[Ce]||Lt.get(Nt(Ce));if(typeof dt=="string"&&dt.trim()!=="")return dt}return""})();if(os&&L(me=>{var Ce;return(Ce=me.dateOfBirth)!=null&&Ce.trim()?me:{...me,dateOfBirth:os}}),Object.keys(yt).length>0&&B(me=>({...me,...yt})),!M&&Dt.size>0&&q(me=>{const Ce={...me};return Dt.forEach(dt=>{Ce[dt]=!0}),Ce}),d==="upload"&&!t)if(i){const me=_e=>{for(const at of _e){const St=Lt.get(Nt(at));if(St!=null&&`${St}`.trim()!=="")return`${St}`}},Ce=_e=>{if(!_e)return;const at=_e.replace(/[^0-9.]/g,""),St=at.split("."),Tt=St.length>2?`${St[0]}.${St.slice(1).join("")}`:at,Pt=Number(Tt);return Number.isNaN(Pt)?void 0:Pt},dt=(()=>{const _e=A.documents||[],St=[...T!=null&&T.name?[T.name]:[],..._e].filter(Boolean);return St.length>0?St:[]})(),O={businessName:me(["Business Name","business_name","businessName","company","Company Name","company_name"])||"",creditScore:Ce(me(["Credit Score","credit_score","creditScore","fico_score","credit_rating"])),industry:me(["Industry","industry","business_industry","sector","business_sector"])||"",requestedAmount:Ce(me(["Requested Amount","requested_amount","requestedAmount","loan_amount","funding_amount"])),contactInfo:{ownerName:me(["Owner Name","owner_name","ownerName","name","Name","full_name","Full Name"])||"",email:me(["Email","email","email_address","emailAddress","contact_email"])||"",phone:me(["SSN","ssn","social_security","social_security_number"])||"",dateOfBirth:me(["Date of Birth","date_of_birth","dob","birthdate","birth_date"])||"",address:me(["Business Address","business_address","businessAddress","address","Address","location"])||""},businessInfo:{ein:me(["EIN","ein","tax_id","taxId","employer_identification_number"])||"",businessType:me(["Business Type","business_type","businessType","company_type","entity_type"])||"",yearsInBusiness:Ce(me(["Years in Business","years_in_business","yearsInBusiness","business_age","company_age"])),numberOfEmployees:Ce(me(["% of Ownership","ownership","percent_ownership","ownership_percent"]))},financialInfo:{annualRevenue:Ce(me(["Annual Revenue","annual_revenue","annualRevenue","yearly_revenue","revenue"])),averageMonthlyRevenue:Ce(me(["Average Monthly Revenue","average_monthly_revenue","averageMonthlyRevenue","monthly_revenue"])),averageMonthlyDeposits:Ce(me(["Average Monthly Deposits","average_monthly_deposits","averageMonthlyDeposits","monthly_deposits"])),existingDebt:Ce(me(["Existing Debt","existing_debt","existingDebt","current_debt","debt"]))},documents:dt};i(O),Ne.current=!0}else u("form")}}}catch(et){console.error("Error processing extracted response:",et),console.warn("Failed to process extracted data. Please fill the form manually.")}};return window.addEventListener("message",Be),()=>{window.removeEventListener("message",Be)}},[d,C,R,W,M,t,A,i,T==null?void 0:T.name]);const ce=async Be=>{m(!0),x(0);const Te=setInterval(()=>{x(oe=>oe>=90?oe:oe+Math.random()*15)},200);try{const oe=await c9(Be);S(oe);const et=Object.fromEntries(Object.entries(oe).filter(([xe])=>xe!=="businessName"&&xe!=="address"));L(xe=>({...xe,...et}));const pe={...A,...et};if(M||q(xe=>{const he={...xe};return Object.keys(et).forEach(we=>{he[we]=!0}),he}),!t)if(i){const xe={businessName:pe.businessName,creditScore:Number(pe.creditScore)||void 0,industry:pe.industry,requestedAmount:Number(pe.requestedAmount)||void 0,contactInfo:{ownerName:pe.ownerName,email:pe.email,phone:pe.phone,address:pe.address},businessInfo:{ein:pe.ein,businessType:pe.businessType,yearsInBusiness:pe.yearsInBusiness?Number(pe.yearsInBusiness):void 0,numberOfEmployees:pe.numberOfEmployees?Number(pe.numberOfEmployees):void 0},financialInfo:{annualRevenue:pe.annualRevenue?Number(pe.annualRevenue):void 0,averageMonthlyRevenue:pe.averageMonthlyRevenue?Number(pe.averageMonthlyRevenue):void 0,averageMonthlyDeposits:pe.averageMonthlyDeposits?Number(pe.averageMonthlyDeposits):void 0,existingDebt:pe.existingDebt?Number(pe.existingDebt):void 0},documents:pe.documents};setTimeout(()=>{if(!Ne.current){const he=(()=>{const Ae=A.documents||[],$e=[...T!=null&&T.name?[T.name]:[],...Ae].filter(Boolean);return $e.length>0?$e:[]})(),we={...xe,documents:he};i(we)}},1200)}else u("form")}catch(oe){console.error("Error extracting data from PDF:",oe),alert("Error extracting data from PDF. Please fill the form manually."),t||u("form")}finally{clearInterval(Te),x(100),setTimeout(()=>{m(!1),x(0)},500)}},ye=async Be=>{var oe;const Te=(oe=Be.target.files)==null?void 0:oe[0];Te&&(z(Te),ce(Te),(async()=>{try{const{publicUrl:et}=await jN(Te,{applicationId:null,userId:(c==null?void 0:c.id)||null}),pe=await SN({user_id:(c==null?void 0:c.id)||null,file_name:Te.name,file_size:Te.size,file_type:Te.type||"application/octet-stream",file_url:et||null});console.log("[ApplicationForm] Inserted application_form row",{id:pe.id,user_id:pe.user_id,file_name:pe.file_name}),D(pe.id||null)}catch(et){console.warn("Failed to persist application form before extraction:",et)}})())},Se=Be=>{Be.preventDefault(),Be.stopPropagation(),E.current+=1,j(!0)},Ee=Be=>{Be.preventDefault(),Be.stopPropagation(),Be.dataTransfer.dropEffect="copy",N||j(!0)},De=Be=>{Be.preventDefault(),Be.stopPropagation(),E.current=Math.max(0,E.current-1),E.current===0&&j(!1)},We=async Be=>{var pe;Be.preventDefault(),Be.stopPropagation(),j(!1),E.current=0;const Te=(pe=Be.dataTransfer.files)==null?void 0:pe[0];if(!Te)return;const oe=Te.name.toLowerCase();(oe.endsWith(".pdf")||oe.endsWith(".doc")||oe.endsWith(".docx")||Te.type==="application/pdf")&&(z(Te),ce(Te),(async()=>{try{const{publicUrl:xe}=await jN(Te,{applicationId:null,userId:null}),he=await SN({user_id:(c==null?void 0:c.id)||null,file_name:Te.name,file_size:Te.size,file_type:Te.type||"application/octet-stream",file_url:xe||null});console.log("[ApplicationForm] Inserted application_form row (drop)",{id:he.id,user_id:he.user_id,file_name:he.file_name}),D(he.id||null)}catch(xe){console.warn("Failed to persist application form on drop:",xe)}})())},Je=()=>{const Be={};A.businessName||(Be.businessName="Business name is required"),A.ownerName||(Be.ownerName="Owner name is required"),A.industry||(Be.industry="Please select an industry"),A.businessType||(Be.businessType="Please select a business type"),A.yearsInBusiness?Number(A.yearsInBusiness)<0&&(Be.yearsInBusiness="Years in business must be a positive number"):Be.yearsInBusiness="Years in business is required",P(Be);const Te=Object.keys(Be).length===0;if(!Te){const et=["businessName","ownerName","email","phone","industry","businessType","yearsInBusiness","numberOfEmployees"].find(pe=>Be[pe]);if(et){const pe=document.getElementById(et);pe&&(pe.scrollIntoView({behavior:"smooth",block:"center"}),window.setTimeout(()=>{typeof pe.focus=="function"&&pe.focus({preventScroll:!0})},250))}}return Te},it=Be=>{if(Be.preventDefault(),!Je())return;(async()=>{try{if(t){const Ze={id:(r==null?void 0:r.id)||"",businessName:A.businessName,monthlyRevenue:Number(A.averageMonthlyRevenue),timeInBusiness:Number(A.yearsInBusiness),creditScore:Number(A.creditScore),industry:A.industry,requestedAmount:Number(A.requestedAmount),status:"submitted",contactInfo:{ownerName:A.ownerName,email:A.email,phone:A.phone,dateOfBirth:A.dateOfBirth,address:A.address},businessInfo:{ein:A.ein,businessType:A.businessType,yearsInBusiness:Number(A.yearsInBusiness),numberOfEmployees:Number(A.numberOfEmployees)},financialInfo:{annualRevenue:Number(A.annualRevenue),averageMonthlyRevenue:Number(A.averageMonthlyRevenue)||0,averageMonthlyDeposits:Number(A.averageMonthlyDeposits)||0,existingDebt:Number(A.existingDebt)||0},documents:A.documents};n&&n(Ze);return}const oe={business_name:A.businessName,owner_name:A.ownerName,email:A.email,phone:A.phone,dateBirth:A.dateOfBirth,address:A.address,ein:A.ein,business_type:A.businessType,industry:A.industry,years_in_business:Number(A.yearsInBusiness),number_of_employees:Number(A.numberOfEmployees),annual_revenue:Number(A.annualRevenue),monthly_revenue:Number(A.averageMonthlyRevenue)||0,monthly_deposits:Number(A.averageMonthlyDeposits)||0,existing_debt:Number(A.existingDebt)||0,credit_score:Number(A.creditScore)||0,requested_amount:Number(A.requestedAmount)||0,status:"submitted",documents:A.documents,user_id:c==null?void 0:c.id},et=await g2(oe);if(!et.dateBirth&&A.dateOfBirth)try{await Cp(et.id,{dateBirth:A.dateOfBirth}),et.dateBirth=A.dateOfBirth}catch(Ze){console.warn("Failed to backfill dateBirth via update:",Ze)}let pe=null,xe=null,he=null;try{if(console.log("[ApplicationForm] Linking application_form -> application",{appFormRowId:H,userId:(c==null?void 0:c.id)||null,applicationId:et.id}),H){const Ze=await m1(H,{application_id:et.id});console.log("[ApplicationForm] Linked via appFormRowId",{id:Ze.id,application_id:Ze.application_id}),pe=Ze.id||H,xe=Ze.file_name??null,he=Ze.file_url??null}else if(c!=null&&c.id){const Ze=await uj(c.id);if(console.log("[ApplicationForm] Latest pending application_form for user",{userId:c.id,found:!!Ze,id:Ze==null?void 0:Ze.id}),Ze!=null&&Ze.id){const $e=await m1(Ze.id,{application_id:et.id});console.log("[ApplicationForm] Linked via latest pending",{id:$e.id,application_id:$e.application_id}),pe=$e.id||Ze.id,xe=$e.file_name??Ze.file_name??null,he=$e.file_url??Ze.file_url??null}}}catch(Ze){console.warn("Failed to update application_form with application_id:",Ze)}try{const Ze={applicationId:et.id,applicationFormId:pe,userId:(c==null?void 0:c.id)||null,file_name:xe,file_url:he};let $e=null;try{$e=await fetch("/.netlify/functions/forward-application-id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ze)})}catch(Qe){console.warn("[Webhook] Netlify function request error, will fallback to direct:",Qe)}if($e){let Qe="";try{Qe=await $e.text()}catch{Qe=""}console.log("[Webhook] Netlify function response",{status:$e.status,ok:$e.ok,body:Qe})}if(!$e||!$e.ok||$e.status===404)try{const Qe=await fetch("https://primary-production-c8d0.up.railway.app/webhook/application-id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ze)});let lt="";try{lt=await Qe.text()}catch{lt=""}console.log("[Webhook] Direct response",{status:Qe.status,ok:Qe.ok,body:lt})}catch(Qe){console.warn("[Webhook] Direct webhook request failed:",Qe)}}catch(Ze){console.warn("Failed to send applicationId webhook (unexpected):",Ze)}const we={id:et.id,businessName:et.business_name,monthlyRevenue:et.monthly_revenue,timeInBusiness:et.years_in_business,creditScore:et.credit_score,industry:et.industry,requestedAmount:et.requested_amount,status:et.status,contactInfo:{ownerName:et.owner_name,email:et.email,phone:et.phone||"",dateOfBirth:et.dateBirth||"",address:et.address||""},businessInfo:{ein:et.ein||"",businessType:et.business_type||"",yearsInBusiness:et.years_in_business,numberOfEmployees:et.number_of_employees},financialInfo:{annualRevenue:et.annual_revenue,averageMonthlyRevenue:et.monthly_revenue??0,averageMonthlyDeposits:et.monthly_deposits??0,existingDebt:et.existing_debt??0},documents:et.documents},Ae=T&&(T.type==="application/pdf"||T.name.toLowerCase().endsWith(".pdf"))?{pdfFile:T}:null;s(we,Ae)}catch(oe){console.error("Error saving application:",oe),alert("Error saving application. Please try again.")}})()};return d==="upload"?a.jsxs("div",{className:"bg-white rounded-xl shadow-lg",children:[a.jsxs("div",{className:"px-8 py-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Upload Application Document"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Upload your completed MCA application form to auto-populate the submission"})]}),a.jsxs("div",{className:"p-8",children:[h?a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"p-4 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-2xl mb-6 shadow-sm",children:a.jsx(rv,{className:"w-8 h-8 text-blue-600 animate-spin"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Processing Your Document"}),a.jsx("p",{className:"text-gray-600 mb-6 max-w-md leading-relaxed",children:"We're extracting information from your application document..."}),a.jsxs("div",{className:"max-w-md mx-auto w-full",children:[a.jsx("div",{className:"bg-gray-200 rounded-full h-3 overflow-hidden",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 h-3 rounded-full transition-all duration-500 ease-out",style:{width:`${Math.min(p,100)}%`}})}),a.jsx("p",{className:"text-sm text-gray-500 mt-3 font-medium",children:p<100?"This usually takes 30-60 seconds":"Almost done..."})]})]}):a.jsx("div",{className:`relative p-10 border-2 border-dashed rounded-3xl text-center transition-all duration-300 bg-gradient-to-br from-gray-50/50 via-white to-blue-50/30 hover:border-blue-400 hover:bg-gradient-to-br hover:from-blue-50/50 hover:to-indigo-50/50 hover:shadow-lg hover:scale-[1.01] ${N?"border-blue-500 ring-4 ring-blue-400/30":"border-gray-300"}`,onDragEnter:Se,onDragOver:Ee,onDragLeave:De,onDrop:We,"aria-label":"Drop your application document here",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"p-4 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-2xl w-fit mx-auto mb-6 shadow-sm",children:a.jsx(zw,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Upload Application Document"}),a.jsx("p",{className:"text-sm text-gray-600 mb-8 max-w-md mx-auto leading-relaxed",children:"We'll automatically extract your business information from PDF, DOC, or DOCX files."}),a.jsxs("label",{className:"cursor-pointer inline-flex items-center gap-3 px-8 py-4 rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-4 focus:ring-blue-500/40 transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-105",children:[a.jsx(zw,{className:"w-5 h-5"}),"Choose Application File",a.jsx("input",{id:"document-upload",name:"document-upload",type:"file",className:"sr-only",accept:".pdf,.doc,.docx",onChange:ye})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-4 font-medium",children:"PDF, DOC, DOCX files only, max 10MB"})]})}),a.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:a.jsx("button",{onClick:()=>{u("form"),S(null),v(null),z(null),q({})},className:"text-blue-600 hover:text-blue-700 font-medium",children:"Skip and fill form manually →"})})]})]}):a.jsx("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[a.jsxs("div",{className:"px-8 py-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Merchant Cash Advance Application"}),a.jsx("p",{className:"text-gray-600 mt-1",children:w||b?"Review and confirm the extracted information":"Please fill out all required information to get matched with qualified lenders"})]}),(T||t)&&a.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:a.jsxs("div",{className:"flex items-center w-full",children:[a.jsx(zw,{className:"w-4 h-4 text-blue-600 mr-2"}),(()=>{const Be=t?o??"":(T==null?void 0:T.name)??"";return a.jsx("span",{className:"text-sm text-blue-800 font-medium truncate",title:Be||void 0,children:Be?`Source Document: ${Be}`:"No source document detected"})})(),a.jsx("button",{onClick:()=>{t?l&&l():(u("upload"),z(null),S(null),L({businessName:"",ownerName:"",email:"",phone:"",dateOfBirth:"",address:"",ein:"",businessType:"",industry:"",yearsInBusiness:"",numberOfEmployees:"",annualRevenue:"",averageMonthlyRevenue:"",averageMonthlyDeposits:"",existingDebt:"",creditScore:"",requestedAmount:"",documents:[]}))},className:"ml-auto text-blue-600 hover:text-blue-800 text-sm",children:"Upload Different Document"})]})}),a.jsxs("form",{onSubmit:it,className:"p-8",children:[de>0&&a.jsxs("div",{className:"mb-8 relative overflow-hidden rounded-2xl border border-emerald-200 bg-gradient-to-br from-emerald-50 via-green-50 to-teal-50 p-6 shadow-lg",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-100/20 to-teal-100/20 opacity-50"}),a.jsxs("div",{className:"relative flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0 p-3 bg-gradient-to-br from-emerald-100 to-green-100 rounded-2xl shadow-sm border border-emerald-200",children:a.jsx(_s,{className:"w-6 h-6 text-emerald-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-lg font-bold text-emerald-900 mb-2",children:"Data Extraction Complete"}),a.jsxs("p",{className:"text-emerald-800 font-medium mb-2",children:[de," fields automatically populated from your documents"]}),a.jsx("p",{className:"text-sm text-emerald-700 leading-relaxed",children:"Review the highlighted fields below. All information can be edited if needed."})]}),a.jsx("div",{className:"flex-shrink-0",children:a.jsxs("span",{className:"inline-flex items-center px-4 py-2 rounded-full text-sm font-bold bg-gradient-to-r from-emerald-100 to-green-100 text-emerald-800 border border-emerald-200 shadow-sm",children:[de," Fields"]})})]})]}),a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-xl shadow-sm border border-blue-200",children:a.jsx(Br,{className:"w-5 h-5 text-blue-700"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Business Information"})]}),a.jsx("p",{className:"text-sm text-gray-600 ml-12",children:"Basic details about your business"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"businessName",children:"Business Name"}),a.jsx("input",{type:"text",id:"businessName",value:A.businessName,onChange:Be=>L({...A,businessName:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("businessName")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`}),K.has("businessName")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]})]}),U.businessName&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:U.businessName})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"industry",children:"Industry*"}),a.jsxs("select",{id:"industry",value:A.industry,onChange:Be=>L({...A,industry:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("industry")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":U.industry?"border-red-300 bg-white focus:border-red-500 focus:ring-2 focus:ring-red-500/20 shadow-sm":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`,children:[a.jsx("option",{value:"",children:"Select Industry"}),ue.map(Be=>a.jsx("option",{value:Be,children:Be},Be))]}),K.has("industry")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]}),U.industry&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:U.industry})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"businessType",children:"Business Type*"}),a.jsxs("select",{id:"businessType",value:A.businessType,onChange:Be=>L({...A,businessType:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("businessType")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":U.businessType?"border-red-300 bg-white focus:border-red-500 focus:ring-2 focus:ring-red-500/20 shadow-sm":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`,children:[a.jsx("option",{value:"",children:"Select Business Type"}),Z.map(Be=>a.jsx("option",{value:Be,children:Be},Be))]}),K.has("businessType")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]}),U.businessType&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:U.businessType})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"ein",children:"EIN"}),a.jsx("input",{type:"text",id:"ein",value:A.ein,onChange:Be=>L({...A,ein:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("ein")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`}),K.has("ein")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"yearsInBusiness",children:"Years in Business*"}),a.jsx("input",{type:"number",id:"yearsInBusiness",value:A.yearsInBusiness,onChange:Be=>L({...A,yearsInBusiness:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("yearsInBusiness")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":U.yearsInBusiness?"border-red-300 bg-white focus:border-red-500 focus:ring-2 focus:ring-red-500/20 shadow-sm":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`}),K.has("yearsInBusiness")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]}),U.yearsInBusiness&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:U.yearsInBusiness})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"numberOfEmployees",children:"Ownership*"}),a.jsx("input",{type:"number",id:"numberOfEmployees",value:A.numberOfEmployees,onChange:Be=>L({...A,numberOfEmployees:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("numberOfEmployees")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`}),K.has("numberOfEmployees")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]})]})]})]}),a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-purple-100 to-violet-100 rounded-xl shadow-sm border border-purple-200",children:a.jsx(kd,{className:"w-5 h-5 text-purple-700"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Contact Information"})]}),a.jsx("p",{className:"text-sm text-gray-600 ml-12",children:"Owner and business contact details"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"ownerName",children:"Owner Name"}),a.jsx("input",{type:"text",id:"ownerName",value:A.ownerName,onChange:Be=>L({...A,ownerName:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("ownerName")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`}),K.has("ownerName")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]})]}),U.ownerName&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:U.ownerName})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"email",children:"Email*"}),a.jsx("input",{type:"email",id:"email",value:A.email,onChange:Be=>L({...A,email:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("email")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":U.email?"border-red-300 bg-white focus:border-red-500 focus:ring-2 focus:ring-red-500/20 shadow-sm":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`}),K.has("email")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]}),U.email&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:U.email})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"phone",children:"SSN*"}),a.jsx("input",{type:"text",id:"phone",value:A.phone,onChange:Be=>L({...A,phone:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("phone")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":U.phone?"border-red-300 bg-white focus:border-red-500 focus:ring-2 focus:ring-red-500/20 shadow-sm":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`,placeholder:"Enter SSN"}),K.has("phone")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]}),U.phone&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:U.phone})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"dateOfBirth",children:"Date of Birth"}),a.jsx("input",{type:"text",id:"dateOfBirth",value:A.dateOfBirth,onChange:Be=>L({...A,dateOfBirth:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("dateOfBirth")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`,placeholder:"MM/DD/YYYY"}),K.has("dateOfBirth")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"address",children:"Business Address"}),a.jsx("input",{type:"text",id:"address",value:A.address,onChange:Be=>L({...A,address:Be.target.value}),className:`w-full rounded-xl border-2 px-4 py-3 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("address")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`}),K.has("address")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]})]})]})]}),a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-green-100 to-emerald-100 rounded-xl shadow-sm border border-green-200",children:a.jsx(Lg,{className:"w-5 h-5 text-green-700"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Financial Information"})]}),a.jsx("p",{className:"text-sm text-gray-600 ml-12",children:"Annual revenue and financial metrics"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{children:a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"annualRevenue",children:"Annual Revenue"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:a.jsx("span",{className:"text-gray-500 font-medium",children:"$"})}),a.jsx("input",{type:"number",id:"annualRevenue",value:A.annualRevenue,onChange:Be=>L({...A,annualRevenue:Be.target.value}),className:`w-full pl-8 pr-4 py-3 rounded-xl border-2 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("annualRevenue")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`})]}),K.has("annualRevenue")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]})]})}),a.jsx("div",{children:a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"requestedAmount",children:"Requested Amount"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:a.jsx("span",{className:"text-gray-500 font-medium",children:"$"})}),a.jsx("input",{type:"number",id:"requestedAmount",value:A.requestedAmount,onChange:Be=>L({...A,requestedAmount:Be.target.value}),className:`w-full pl-8 pr-4 py-3 rounded-xl border-2 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("requestedAmount")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`})]}),K.has("requestedAmount")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]})]})}),a.jsx("div",{children:a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-bold text-gray-800 mb-2",htmlFor:"creditScore",children:"Credit Score"}),a.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",id:"creditScore",value:A.creditScore,onChange:Be=>L({...A,creditScore:Be.target.value.replace(/[^0-9]/g,"")}),className:`w-full px-4 py-3 rounded-xl border-2 text-gray-900 font-medium transition-all duration-200 focus:outline-none ${K.has("creditScore")?"border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 ring-2 ring-emerald-200/50 shadow-sm focus:border-emerald-400 focus:ring-emerald-300/50":"border-gray-200 bg-white hover:border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 shadow-sm hover:shadow-sm"}`}),K.has("creditScore")&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-emerald-700 text-xs font-medium",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),a.jsx("span",{children:"Extracted from documents"})]})]})})]})]}),a.jsx("div",{className:"flex justify-end pt-8 mt-8 border-t border-gray-100",children:a.jsxs("button",{type:"submit",className:"inline-flex items-center gap-3 px-8 py-4 rounded-2xl font-bold text-lg shadow-lg transition-all duration-200 focus:outline-none focus:ring-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl hover:scale-105 focus:ring-blue-500/40",children:[t&&r&&typeof r.id=="string"&&r.id?"Update Application":"Submit Application",a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})]})]})})},h9=({onContinue:s,application:e,onReplaceDocument:t})=>{const{user:r}=Wd(),n=(()=>{const o=e!=null&&e.documents&&e.documents.length>0?e.documents[0]:"";if(!o)return"";const l=o.split(/[/\\]/);return l[l.length-1]})(),i=async o=>{var c,d,u,h,m,p,x,w,S,b,v,N,j;let l=null;try{const E={business_name:o.businessName,owner_name:((c=o.contactInfo)==null?void 0:c.ownerName)??"",email:((d=o.contactInfo)==null?void 0:d.email)??"",phone:((u=o.contactInfo)==null?void 0:u.phone)??"",dateBirth:((h=o.contactInfo)==null?void 0:h.dateOfBirth)??"",address:((m=o.contactInfo)==null?void 0:m.address)??"",ein:((p=o.businessInfo)==null?void 0:p.ein)??"",business_type:((x=o.businessInfo)==null?void 0:x.businessType)??"",industry:o.industry,years_in_business:Number(((w=o.businessInfo)==null?void 0:w.yearsInBusiness)??o.timeInBusiness??0)||0,number_of_employees:Number(((S=o.businessInfo)==null?void 0:S.numberOfEmployees)??0)||0,annual_revenue:Number(((b=o.financialInfo)==null?void 0:b.annualRevenue)??0)||0,monthly_revenue:Number(((v=o.financialInfo)==null?void 0:v.averageMonthlyRevenue)??o.monthlyRevenue??0)||0,monthly_deposits:Number(((N=o.financialInfo)==null?void 0:N.averageMonthlyDeposits)??0)||0,existing_debt:Number(((j=o.financialInfo)==null?void 0:j.existingDebt)??0)||0,credit_score:Number(o.creditScore??0)||0,requested_amount:Number(o.requestedAmount??0)||0,status:o.status??"submitted",documents:Array.isArray(o.documents)?o.documents:[],user_id:r==null?void 0:r.id};if(o.id)console.log("[BankStatement] Updating application id",o.id,"with payload",E),await Cp(o.id,E);else{console.log("[BankStatement] Creating application with payload",E),console.log("[BankStatement] User ID being added:",r==null?void 0:r.id);const L=await g2(E);console.log("[BankStatement] Created application id",L.id),l=L.id}const A=o.id||l;if(A){let L=null,C=null,B=null;try{if(r!=null&&r.id){const U=await uj(r.id);if(console.log("[BankStatement] Pending application_form for user",{userId:r.id,id:U==null?void 0:U.id}),U!=null&&U.id){const P=await m1(U.id,{application_id:A});console.log("[BankStatement] Linked application_form via review submit",{id:P.id,application_id:P.application_id}),L=P.id||U.id,C=P.file_name??U.file_name??null,B=P.file_url??U.file_url??null}}}catch(U){console.warn("[BankStatement] Failed to link application_form:",U)}try{const U={applicationId:A,applicationFormId:L,userId:(r==null?void 0:r.id)||null,file_name:C,file_url:B};let P=null;try{P=await fetch("/.netlify/functions/forward-application-id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)})}catch(T){console.warn("[Webhook][BankStatement] Function request error, fallback to direct:",T)}if(P){let T="";try{T=await P.text()}catch{T=""}console.log("[Webhook][BankStatement] Function response",{status:P.status,ok:P.ok,body:T})}if(!P||!P.ok||P.status===404)try{const T=await fetch("https://primary-production-c8d0.up.railway.app/webhook/application-id",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});let z="";try{z=await T.text()}catch{z=""}console.log("[Webhook][BankStatement] Direct response",{status:T.status,ok:T.ok,body:z})}catch(T){console.warn("[Webhook][BankStatement] Direct request failed:",T)}}catch(U){console.warn("[Webhook][BankStatement] Unexpected error sending webhook:",U)}}}catch(E){console.error("[BankStatement] Failed to persist application on review submit:",E)}finally{const E={...o,id:(o==null?void 0:o.id)||l||""};s(E)}};return a.jsx(IP,{initialStep:"form",reviewMode:!0,reviewInitial:e,reviewDocName:n,onReplaceDocument:t,onReviewSubmit:i,onSubmit:()=>{}},JSON.stringify(e))};let _f=null,s5=0;const f9=5*60*1e3,m9=({application:s,matches:e,onLenderSelect:t,onBack:r,lockedLenderIds:n=[]})=>{console.log("[LenderMatches] Received application values:",{monthlyRevenue:s==null?void 0:s.monthlyRevenue,creditScore:s==null?void 0:s.creditScore,requestedAmount:s==null?void 0:s.requestedAmount});const[i,o]=ne.useState([]),[l,c]=ne.useState([]),[d,u]=ne.useState(!0),[h,m]=ne.useState(!1),p=ne.useMemo(()=>new Set(n),[n]);ne.useEffect(()=>{(async()=>{if(!s)return;const N=["draft","submitted","under-review","approved","funded","declined"].includes(s.status)?s.status:"draft",j={id:"",business_name:s.businessName||"",owner_name:s.ownerName||"",email:s.email||"",phone:s.phone||"",address:s.address||"",ein:s.ein||"",business_type:s.businessType||"",industry:s.industry||"",years_in_business:s.yearsInBusiness||0,number_of_employees:s.numberOfEmployees||0,annual_revenue:s.annualRevenue||0,monthly_revenue:s.monthlyRevenue||0,monthly_deposits:s.monthlyDeposits||0,existing_debt:s.existingDebt||0,credit_score:s.creditScore||0,requested_amount:s.requestedAmount||0,status:N,documents:s.documents||[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()},E=Date.now(),A=_f&&E-s5<f9,L=C=>{const B=pj(C||[],j);if(Array.isArray(e)&&e.length>0){const U=new Map(B.map(T=>[T.id,T])),P=[];for(const T of e){const z=U.get(T.lender_id);z&&P.push({...z,match_score:T.match_score})}o(P)}else o(B);n&&n.length>0&&c(U=>Array.from(new Set([...n,...U])))};try{if(A){u(!1),L(_f),Ig().then(B=>{_f=B||[],s5=Date.now(),L(_f)}).catch(()=>{});return}u(!0),_f=await Ig()||[],s5=Date.now(),L(_f)}catch(C){console.error("Error loading lenders:",C)}finally{u(!1)}})()},[s,e,n]);const x=b=>{p.has(b)||c(v=>v.includes(b)?v.filter(N=>N!==b):[...v,b])},w=ne.useMemo(()=>l.filter(b=>!p.has(b)),[l,p]),S=()=>{if(!(w.length===0||h)){m(!0);try{t(w)}finally{m(!1)}}};return s?a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-full text-emerald-700 text-sm font-medium mb-4",children:[a.jsx(_s,{className:"w-4 h-4 mr-2"}),i.length," Qualified Lenders Found"]}),a.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Qualified Lenders"}),a.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"We've analyzed your business profile and found the best lending partners for your needs"}),d&&a.jsxs("div",{className:"mt-4 flex items-center justify-center text-sm text-gray-500",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-emerald-600 mr-2"}),"Updating matches..."]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-12",children:[a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg ring-1 ring-gray-100 hover:shadow-xl transition-shadow h-full",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center shadow-inner",children:a.jsx(Lg,{className:"w-5 h-5 text-blue-600"})}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Requested Amount"})]}),a.jsxs("div",{className:"mt-3 text-3xl font-bold text-slate-800",children:["$",typeof s.requestedAmount=="number"?s.requestedAmount.toLocaleString():"0"]})]}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg ring-1 ring-gray-100 hover:shadow-xl transition-shadow h-full",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-50 flex items-center justify-center shadow-inner",children:a.jsx(Pg,{className:"w-5 h-5 text-green-600"})}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Average Revenue"})]}),a.jsxs("div",{className:"mt-3 text-3xl font-bold text-slate-800",children:["$",typeof s.monthlyRevenue=="number"?s.monthlyRevenue.toLocaleString():"0"]})]}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg ring-1 ring-gray-100 hover:shadow-xl transition-shadow h-full",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center shadow-inner",children:a.jsx(c1,{className:"w-5 h-5 text-purple-600"})}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Credit Score"})]}),a.jsx("div",{className:"mt-3 text-3xl font-bold text-slate-800",children:typeof s.creditScore=="number"?s.creditScore:"N/A"})]}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg ring-1 ring-gray-100 hover:shadow-xl transition-shadow h-full",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-orange-100 flex items-center justify-center shadow-inner",children:a.jsx(Br,{className:"w-5 h-5 text-orange-600"})}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Industry"})]}),a.jsx("div",{className:"mt-3 text-3xl font-bold text-slate-800",children:s.industry||"N/A"})]})]}),a.jsx("div",{className:"space-y-6",children:i.map(b=>{const v=p.has(b.id),N=l.includes(b.id);return a.jsx("div",{className:`group relative bg-white rounded-2xl border-2 transition-all duration-200 ${v?"border-gray-200 opacity-60 filter cursor-not-allowed":N?"border-emerald-400 bg-gradient-to-r from-emerald-50 to-green-50 shadow-lg shadow-emerald-100/50 cursor-pointer":"border-gray-200 hover:border-blue-300 hover:shadow-xl hover:shadow-blue-100/50 cursor-pointer"}`,onClick:v?void 0:()=>x(b.id),children:a.jsxs("div",{className:"p-8",children:[a.jsxs("div",{className:"flex items-start justify-between mb-6",children:[a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:`w-20 h-20 rounded-2xl flex items-center justify-center mr-6 shadow-sm ${N?"bg-gradient-to-br from-emerald-100 to-emerald-200 border-2 border-emerald-300":"bg-gradient-to-br from-blue-100 to-blue-200 border-2 border-blue-200"}`,children:a.jsx(Br,{className:`w-10 h-10 ${N?"text-emerald-700":"text-blue-700"}`})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h3",{className:`text-2xl font-bold ${v?"text-gray-700":"text-gray-900"}`,children:b.name}),v&&a.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-700 border border-orange-200",children:[a.jsx(uN,{className:"w-3 h-3 mr-1"}),"Already Submitted"]})]}),a.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Mc,{className:"w-5 h-5 text-yellow-400 fill-current mr-1"}),a.jsx("span",{className:"text-lg font-semibold text-gray-900",children:b.rating}),a.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"/5.0"})]}),a.jsx("div",{className:"h-4 w-px bg-gray-300"}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),a.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[b.approval_rate,"% approval rate"]})]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:`text-2xl font-bold ${v?"text-gray-500":N?"text-emerald-600":"text-blue-600"}`,children:(()=>{const j=b.match_score;if(typeof j=="number")return`${j<=1?Math.round(j*100):Math.round(j)}%`;const E=b.matchScore;return typeof E=="number"?`${Math.round(E)}%`:"95%"})()}),a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Match Score"})]}),!v&&a.jsx("div",{className:`w-8 h-8 rounded-full border-3 flex items-center justify-center transition-all ${N?"bg-emerald-500 border-emerald-500 text-white shadow-lg":"border-gray-300 text-gray-400 group-hover:border-blue-400 group-hover:text-blue-400"}`,children:N&&a.jsx(_s,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100/50 border border-blue-200 p-4 rounded-xl",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Lg,{className:"w-4 h-4 text-blue-600 mr-2"}),a.jsx("div",{className:"text-sm font-semibold text-blue-700",children:"Amount Range"})]}),a.jsxs("div",{className:"text-lg font-bold text-blue-900",children:["$",b.min_amount.toLocaleString()," - $",b.max_amount.toLocaleString()]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100/50 border border-green-200 p-4 rounded-xl",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Pg,{className:"w-4 h-4 text-green-600 mr-2"}),a.jsx("div",{className:"text-sm font-semibold text-green-700",children:"Factor Rate"})]}),a.jsx("div",{className:"text-lg font-bold text-green-900",children:b.factor_rate})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100/50 border border-purple-200 p-4 rounded-xl",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(Dc,{className:"w-4 h-4 text-purple-600 mr-2"}),a.jsx("div",{className:"text-sm font-semibold text-purple-700",children:"Payback Term"})]}),a.jsx("div",{className:"text-lg font-bold text-purple-900",children:b.payback_term})]}),a.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100/50 border border-orange-200 p-4 rounded-xl",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(c1,{className:"w-4 h-4 text-orange-600 mr-2"}),a.jsx("div",{className:"text-sm font-semibold text-orange-700",children:"Approval Time"})]}),a.jsx("div",{className:"text-lg font-bold text-orange-900",children:b.approval_time})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Key Features"}),a.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl p-5 shadow-sm",children:b.features&&b.features.length>0?a.jsxs("div",{className:"flex flex-wrap gap-2.5",children:[b.features.slice(0,8).map((j,E)=>a.jsxs("span",{className:"inline-flex items-center gap-2 px-3.5 py-2 rounded-lg text-sm font-medium border bg-emerald-50 border-emerald-200 text-emerald-800",children:[a.jsx(_s,{className:"w-4 h-4 text-emerald-600"}),j]},E)),b.features.length>8&&a.jsxs("span",{className:"inline-flex items-center px-3.5 py-2 rounded-lg text-sm font-medium bg-gray-50 text-gray-600 border border-gray-200",children:["+",b.features.length-8," more"]})]}):a.jsx("div",{className:"text-sm text-gray-500",children:"No feature information provided"})})]})]})},b.id)})}),a.jsx("div",{className:"bg-white border-t border-gray-200 pt-8 mt-12",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[a.jsx("button",{onClick:r,className:"w-full sm:w-auto px-6 py-3 border-2 border-gray-300 rounded-xl font-medium text-gray-700 hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"Back to Application"}),a.jsxs("div",{className:"flex items-center gap-4",children:[w.length>0&&a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-semibold text-emerald-600",children:w.length})," lender",w.length!==1?"s":""," selected"]}),a.jsxs("button",{onClick:S,disabled:w.length===0||h,className:`w-full sm:w-auto justify-center flex items-center px-8 py-4 rounded-xl font-semibold text-lg transition-all duration-200 ${w.length>0&&!h?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white hover:from-emerald-700 hover:to-emerald-800 shadow-lg shadow-emerald-200/50 hover:shadow-xl hover:shadow-emerald-300/50":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[h?"Submitting...":"Continue with Selected Lenders",a.jsx(AM,{className:"w-5 h-5 ml-2"})]})]})]})})]}):a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No application data available"})})},p9=({application:s,selectedLenderIds:e,onBack:t,onSubmit:r})=>{const[n,i]=ne.useState(!1),[o,l]=ne.useState(()=>{const me=localStorage.getItem("mcaPortalSmtpSettings"),Ce={smtpHost:"",smtpPort:"",smtpUser:"",smtpPassword:"",fromEmail:""};if(me)try{return{...JSON.parse(me),fromEmail:"",smtpUser:""}}catch(dt){return console.error("Error parsing saved SMTP settings:",dt),Ce}return Ce}),[c,d]=ne.useState(!1),[u,h]=ne.useState(!1),[m,p]=ne.useState(0),[x,w]=ne.useState(!1),[S,b]=ne.useState(null),[v,N]=ne.useState([]),[j,E]=ne.useState(800),[A,L]=ne.useState([]),[C,B]=ne.useState(!1),[U,P]=ne.useState([]),[T,z]=ne.useState(!1),[H,D]=ne.useState([]),[M,$]=ne.useState(!1),[q,K]=ne.useState(()=>new Set),[de,Ne]=ne.useState(!1),[R,W]=ne.useState({}),[Z,ue]=ne.useState(null),ce=!1,ye=me=>{me==="gmail_tls"?l(Ce=>({...Ce,smtpHost:"smtp.gmail.com",smtpPort:"587"})):me==="gmail_ssl"?l(Ce=>({...Ce,smtpHost:"smtp.gmail.com",smtpPort:"465"})):me==="outlook_tls"&&l(Ce=>({...Ce,smtpHost:"smtp.office365.com",smtpPort:"587"}))},Se=()=>{const me={};return o.smtpHost||(me.host="SMTP Host is required"),o.smtpPort||(me.port="SMTP Port is required"),o.smtpUser||(me.user="Username is required."),o.smtpPassword||(me.password="Password is required."),o.fromEmail||(me.fromEmail="From Email is required."),W(me),Object.keys(me).length===0};Yt.useEffect(()=>{(async()=>{try{const Ce=await Ig();if(s){const O=["draft","submitted","under-review","approved","funded","declined"].includes(s.status)?s.status:"draft",_e={id:s.id,business_name:s.businessName,owner_name:s.contactInfo.ownerName,email:o.fromEmail||"",phone:s.contactInfo.phone,address:s.contactInfo.address,ein:s.businessInfo.ein,business_type:s.businessInfo.businessType,industry:s.industry,years_in_business:s.timeInBusiness,number_of_employees:s.businessInfo.numberOfEmployees,annual_revenue:s.financialInfo.annualRevenue,monthly_revenue:s.monthlyRevenue,monthly_deposits:s.financialInfo.averageMonthlyDeposits,existing_debt:s.financialInfo.existingDebt,credit_score:s.creditScore,requested_amount:s.requestedAmount,status:O,documents:s.documents,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},at=pj(Ce,_e);N(at)}else N(Ce)}catch(Ce){console.error("Error loading lenders:",Ce)}})()},[s,o.fromEmail]),Yt.useEffect(()=>{(async()=>{if(!(s!=null&&s.id)){L([]);return}try{B(!0);const Ce=await Jo(s.id);L(Ce||[])}catch(Ce){console.warn("Failed to load application_documents for recap:",Ce),L([])}finally{B(!1)}})()},[s==null?void 0:s.id]),Yt.useEffect(()=>{(async()=>{if(!(s!=null&&s.id)){P([]);return}try{z(!0);const Ce=await Fh(s.id);P(Ce||[])}catch(Ce){console.warn("Failed to load application_additional for recap:",Ce),P([])}finally{z(!1)}})()},[s==null?void 0:s.id]),Yt.useEffect(()=>{const me=s!=null&&s.id?`recap_excluded_docs_${s.id}`:null;if(!me){K(new Set);return}try{const Ce=localStorage.getItem(me);if(Ce){const dt=JSON.parse(Ce);K(new Set(dt))}else K(new Set)}catch{K(new Set)}},[s==null?void 0:s.id]),Yt.useEffect(()=>{const me=s!=null&&s.id?`recap_excluded_docs_${s.id}`:null;if(me)try{localStorage.setItem(me,JSON.stringify(Array.from(q)))}catch{}},[q,s==null?void 0:s.id]);const Ee=me=>`inline:${me}`,De=me=>`app:${me.id}`,We=me=>`add:${me.id}`,Je=me=>`mtd:${me.id}`,it=me=>q.has(me),Be=me=>K(Ce=>new Set(Ce).add(me)),Te=me=>{K(Ce=>{const dt=new Set(Ce);return dt.delete(me),dt})};Yt.useEffect(()=>{(async()=>{if(!(s!=null&&s.id)){D([]);return}try{$(!0),console.log("Loading MTD docs for application ID:",s.id);const Ce=await co(s.id);console.log("MTD docs loaded:",Ce),console.log("MTD docs count:",(Ce==null?void 0:Ce.length)||0),D(Ce||[])}catch(Ce){console.error("Failed to load application_mtd for recap:",Ce),D([])}finally{$(!1)}})()},[s==null?void 0:s.id]);const oe=Yt.useMemo(()=>Array.isArray(s==null?void 0:s.documents)?s.documents:[],[s]),et=oe.filter(me=>!it(Ee(me))),pe=A.filter(me=>!it(De(me))),xe=U.filter(me=>!it(We(me))),he=H.filter(me=>!it(Je(me))),we=oe.filter(me=>it(Ee(me))),Ae=A.filter(me=>it(De(me))),Ze=U.filter(me=>it(We(me))),$e=H.filter(me=>it(Je(me))),Qe=v.filter(me=>e.includes(me.id));Yt.useEffect(()=>{console.log("Document counts:",{appDocs:(A==null?void 0:A.length)||0,additionalDocs:(U==null?void 0:U.length)||0,inlineDocs:(oe==null?void 0:oe.length)||0,mtdDocs:(H==null?void 0:H.length)||0,mtdDocsData:H})},[A,U,oe,H]);const lt=me=>{if(!s)return"";const Ce=localStorage.getItem("mcaPortalEmailTemplate");let _e=(Ot=>!!Ot&&Ot.includes('<div class="contact-info">')&&Ot.includes('<div class="documents">')&&Ot.includes("criteria-list"))(Ce)?Ce:`Subject: Merchant Cash Advance Application - {{businessName}}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merchant Cash Advance Application</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; margin: 0; padding: 0; background-color: #f8f9fa; }
        .container { max-width: 700px; margin: 0 auto; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 30px; text-align: center; }
        .header h1 { margin: 0; font-size: 28px; font-weight: 700; }
        .header p { margin: 10px 0 0; font-size: 16px; opacity: 0.9; }
        .content { padding: 40px; }
        .section { margin-bottom: 35px; }
        .section h2 { color: #10b981; font-size: 20px; margin-bottom: 20px; padding-bottom: 8px; border-bottom: 2px solid #e5e7eb; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 25px; }
        .info-card { background: #f8fafc; padding: 20px; border-radius: 8px; border-left: 4px solid #10b981; }
        .info-card h3 { margin: 0 0 10px; color: #374151; font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px; }
        .info-card p { margin: 0; font-size: 16px; font-weight: 600; color: #111827; }
        .highlight-box { background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); padding: 25px; border-radius: 10px; border: 1px solid #10b981; margin: 25px 0; }
        .highlight-box h3 { color: #065f46; margin: 0 0 15px; font-size: 18px; }
        .criteria-list { list-style: none; padding: 0; margin: 15px 0; }
        .criteria-list li { padding: 8px 0; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; }
        .criteria-list li:last-child { border-bottom: none; }
        .criteria-list .label { font-weight: 600; color: #374151; }
        .criteria-list .value { color: #10b981; font-weight: 700; }
        .documents { background: #fef3c7; padding: 20px; border-radius: 8px; border-left: 4px solid #f59e0b; }
        .documents h3 { color: #92400e; margin: 0 0 15px; }
        .doc-list { list-style: none; padding: 0; margin: 0; }
        .doc-list li { padding: 5px 0; color: #78350f; }
        .doc-list li:before { content: "📄"; margin-right: 8px; }
        .footer { background: #f9fafb; padding: 30px; text-align: center; border-top: 1px solid #e5e7eb; }
        .footer p { margin: 5px 0; color: #6b7280; }
        .contact-info { background: #eff6ff; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .contact-info h3 { color: #1e40af; margin: 0 0 15px; }
        .contact-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .contact-item { display: flex; align-items: center; }
        .contact-item .icon { margin-right: 10px; font-size: 16px; }
        .app-id { font-family: 'Courier New', monospace; background: #f3f4f6; padding: 8px 12px; border-radius: 6px; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Merchant Cash Advance Application</h1>
            <p>Professional Business Funding Request</p>
        </div>
        
        <div class="content">
            <p style="font-size: 16px; margin-bottom: 30px;">Dear <strong>{{lenderName}} Team</strong>,</p>
            
            <p style="margin-bottom: 30px;">I hope this email finds you well. I am writing to submit a merchant cash advance application for your review and consideration. Below you'll find comprehensive details about our business and funding requirements.</p>
            
            <div class="section">
                <h2>📊 Business Overview</h2>
                <div class="info-grid">
                    <div class="info-card">
                        <h3>Business Name</h3>
                        <p>{{businessName}}</p>
                    </div>
                    <div class="info-card">
                        <h3>Industry</h3>
                        <p>{{industry}}</p>
                    </div>
                    <div class="info-card">
                        <h3>Business Owner</h3>
                        <p>{{ownerName}}</p>
                    </div>
                    <div class="info-card">
                        <h3>Years in Business</h3>
                        <p>{{yearsInBusiness}} years</p>
                    </div>
                    <div class="info-card">
                        <h3>Business Type</h3>
                        <p>{{businessType}}</p>
                    </div>
                    <div class="info-card">
                        <h3>EIN</h3>
                        <p>{{ein}}</p>
                    </div>
                </div>
            </div>

            

            <div class="documents">
                <h3>📋 Attached Documents</h3>
                <ul class="doc-list">
                    <li>Business bank statements (last 6 months)</li>
                    <li>Tax returns</li>
                    <li>Completed application form</li>
                    <li>Voided business check</li>
                </ul>
            </div>

            <div class="highlight-box">
                <h3>🎯 Lending Criteria Alignment</h3>
                <p style="margin-bottom: 20px;">Based on your underwriting guidelines, I believe this application aligns well with your lending criteria:</p>
                <ul class="criteria-list">
                    <li>
                        <span class="label">Amount Range:</span>
                        <span class="value">$ {{lenderMinAmount}} - $ {{lenderMaxAmount}}</span>
                    </li>
                    <li>
                        <span class="label">Factor Rate:</span>
                        <span class="value">{{lenderFactorRate}}</span>
                    </li>
                    <li>
                        <span class="label">Payback Term:</span>
                        <span class="value">{{lenderPaybackTerm}}</span>
                    </li>
                    <li>
                        <span class="label">Approval Time:</span>
                        <span class="value">{{lenderApprovalTime}}</span>
                    </li>
                </ul>
            </div>

            <p style="margin: 30px 0;">I would appreciate the opportunity to discuss this application further and answer any questions you may have. Please let me know if you need any additional information or documentation.</p>
            
            <p style="margin-bottom: 30px;">Thank you for your time and consideration. I look forward to hearing from you soon.</p>
            
            <p style="margin-bottom: 10px;"><strong>Best regards,</strong></p>
            <p style="margin: 0;"><strong>{{ownerName}}</strong><br>
            {{businessName}}<br>
            {{email}} | {{phone}}</p>
        </div>
        
        <div class="footer">
            <p><strong>This application was submitted through MCAPortal Pro</strong></p>
            <p>Application ID: <span class="app-id">{{applicationId}}</span></p>
        </div>
    </div>
</body>
</html>`;const at=(Array.isArray(A)?A:[]).filter(Ot=>!it(De(Ot))),St=(Array.isArray(U)?U:[]).filter(Ot=>!it(We(Ot))),Tt=(Array.isArray(H)?H:[]).filter(Ot=>!it(Je(Ot))),Pt=(Array.isArray(oe)?oe:[]).filter(Ot=>!it(Ee(Ot))),kt=[...at.map(Ot=>Ot.file_name),...St.map(Ot=>Ot.file_name),...Tt.map(Ot=>Ot.file_name),...Pt],jt=new Set,Rt=kt.filter(Ot=>{const Ps=Ot.trim();return!Ps||jt.has(Ps.toLowerCase())?!1:(jt.add(Ps.toLowerCase()),!0)});if(Rt.length>0){const Ot=be=>be.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),Ps=Rt.map(be=>`<li>${Ot(be)}</li>`).join(`
`);_e=_e.replace(/<ul class="doc-list">[\s\S]*?<\/ul>/,`<ul class="doc-list">
${Ps}
</ul>`);const Os=`
<div class="download-zip" style="margin-top:16px; text-align:center;">
  <a href="${`${window.location.origin}/.netlify/functions/application-docs-zip?applicationId=${s.id}`}" style="display:inline-block; background:#10b981; color:#fff; padding:10px 16px; border-radius:8px; text-decoration:none; font-weight:600;">
    Download all documents (ZIP)
  </a>
</div>`;_e=_e.replace(/(<div class="documents">[\s\S]*?<\/div>)/,`$1${Os}`)}return _e=_e.replace(/\s*<br>\s*\{\{email\}\}\s*\|\s*\{\{phone\}\}\s*/g,""),_e.replace(/\{\{businessName\}\}/g,s.businessName).replace(/\{\{ownerName\}\}/g,s.contactInfo.ownerName).replace(/\{\{industry\}\}/g,s.industry).replace(/\{\{yearsInBusiness\}\}/g,s.timeInBusiness.toString()).replace(/\{\{businessType\}\}/g,s.businessInfo.businessType).replace(/\{\{ein\}\}/g,s.businessInfo.ein).replace(/\{\{requestedAmount\}\}/g,s.requestedAmount.toLocaleString()).replace(/\{\{monthlyRevenue\}\}/g,s.monthlyRevenue.toLocaleString()).replace(/\{\{annualRevenue\}\}/g,s.financialInfo.annualRevenue.toLocaleString()).replace(/\{\{creditScore\}\}/g,s.creditScore.toString()).replace(/\{\{existingDebt\}\}/g,s.financialInfo.existingDebt.toLocaleString()).replace(/\{\{email\}\}/g,o.fromEmail||"Not provided").replace(/\{\{phone\}\}/g,s.contactInfo.phone).replace(/\{\{address\}\}/g,s.contactInfo.address).replace(/\{\{lenderName\}\}/g,me.name).replace(/\{\{lenderMinAmount\}\}/g,me.min_amount.toLocaleString()).replace(/\{\{lenderMaxAmount\}\}/g,me.max_amount.toLocaleString()).replace(/\{\{lenderFactorRate\}\}/g,me.factor_rate).replace(/\{\{lenderPaybackTerm\}\}/g,me.payback_term).replace(/\{\{lenderApprovalTime\}\}/g,me.approval_time).replace(/\{\{applicationId\}\}/g,s.id)},At=me=>{const Ce=lt(me);let dt=`Merchant Cash Advance Application - ${(s==null?void 0:s.businessName)??""}`.trim(),O=Ce;const _e=Ce.match(/^Subject:\s*(.+)\s*\n([\s\S]*)$/i);return _e&&(dt=_e[1].trim(),O=_e[2].trim()),{subject:dt,body:O,from:o.fromEmail?o.fromEmail.trim():"",to:(me.contact_email||"").trim()}},Nt=async me=>{const Ce="/.netlify/functions/send-application";try{const dt=await fetch(Ce,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)});dt.ok||console.warn("send-application webhook non-OK status:",dt.status,await dt.text())}catch(dt){console.warn("Failed to post to send-application webhook:",dt)}},Lt=me=>{try{const Ce={smtpHost:me.smtpHost,smtpPort:me.smtpPort,smtpUser:"",smtpPassword:"",fromEmail:""};localStorage.setItem("mcaPortalSmtpSettings",JSON.stringify(Ce)),localStorage.removeItem("mcaPortalFromEmail")}catch(Ce){console.error("Error saving SMTP settings:",Ce)}},Dt=async(me,Ce)=>{var dt;if(!me)return null;try{const O=await fetch("/.netlify/functions/save-smtp-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({applicationId:me,smtp:{host:Ce.smtpHost,port:Ce.smtpPort,username:Ce.smtpUser||"",password:Ce.smtpPassword,fromEmail:Ce.fromEmail||""}})});if(!O.ok){const St=await O.text();return console.warn("Failed to save SMTP settings (backend):",O.status,St),null}const _e=await O.json().catch(()=>null);return((dt=_e==null?void 0:_e.data)==null?void 0:dt.id)??null}catch(O){return console.warn("Failed to reach SMTP settings backend:",O),null}},yt=async me=>{const Ce="/.netlify/functions/smtp",dt={applicationId:(s==null?void 0:s.id)??null,smtp:{host:me.smtpHost,port:me.smtpPort,user:me.smtpUser,password:me.smtpPassword,fromEmail:me.fromEmail||""},context:{businessName:(s==null?void 0:s.businessName)??null,applicantEmail:o.fromEmail||null},sentAt:new Date().toISOString()};try{const O=await fetch(Ce,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(dt)});O.ok||console.warn("SMTP webhook non-OK status:",O.status,O.statusText)}catch(O){console.warn("Failed to send SMTP settings to webhook:",O)}},os=async()=>{var O,_e,at,St,Tt;h(!0),p(0);const me=setInterval(()=>{p(Pt=>Pt>=90?Pt:Math.min(90,Pt+Math.random()*12))},200);Lt(o);let Ce=null;const dt=!!(o.smtpHost&&o.smtpPort&&o.smtpUser&&o.smtpPassword);s!=null&&s.id&&dt&&(Ce=await Dt(s.id,{...o,fromEmail:o.fromEmail}),Ce&&ue(Ce));try{s&&await hj(s.id,e);const Pt=se=>{if(!se)return[];const le=Ue=>Ue.split(/[;,]/).map(Ie=>Ie.trim()).filter(Ie=>Ie.length>0);return Array.isArray(se)?se.flatMap(Ue=>le(String(Ue))):typeof se=="string"?le(se):[]},kt=se=>Array.from(new Set(se.map(le=>le.toLowerCase()))).map(le=>se.find(Ue=>Ue.toLowerCase()===le)),jt=Qe.map(se=>(se.contact_email||"").trim()).filter(se=>se.length>0),Rt=Qe.flatMap(se=>{const le=se.cc_emails??null;return Pt(le)}),Ot=kt(jt),Ps=kt(Rt.filter(se=>!Ot.map(le=>le.toLowerCase()).includes(se.toLowerCase()))),Fs=kt([...Ot,...Ps]),Os=Array.from(new Set(Qe.map(se=>se.id))),be=Qe.flatMap(se=>{const le=[],Ue=(se.contact_email||"").trim();Ue&&le.push({id:se.id,email:Ue,role:"to"});const Ie=(()=>{const He=se.cc_emails??null;return Pt(He)})();for(const He of Ie)le.push({id:se.id,email:He,role:"cc"});return le}),ve=Qe[0]?At(Qe[0]):{subject:`Merchant Cash Advance Application - ${(s==null?void 0:s.businessName)??""}`.trim(),body:"",from:((O=s==null?void 0:s.contactInfo)==null?void 0:O.email)||""},Ve=se=>{const le=se.split(`

`);return le.length>1?le.slice(1).join(`

`):se};let ct=[];try{if(s!=null&&s.id){const se=await Jo(s.id),le=Ie=>Ie.toLowerCase().replace(/%20/g," ").replace(/\s+/g," ").replace(/\.pdf$/i,"").trim(),Ue={};(se||[]).forEach(Ie=>{Ie.file_name&&Ie.file_url&&(Ue[le(Ie.file_name)]=String(Ie.file_url))}),ct=(se||[]).filter(Ie=>!!Ie.file_url&&!it(De(Ie))).map(Ie=>({filename:Ie.file_name,url:Ie.file_url}));try{const He=(await Fh(s.id)||[]).filter(Me=>!!Me.file_url&&!it(We(Me))).map(Me=>({filename:Me.file_name||"Additional Document",url:String(Me.file_url)}));ct=[...ct,...He]}catch(Ie){console.warn("Failed to load application_additional documents for attachments:",Ie)}try{const He=(await lE(s.id)||[]).filter(Me=>!!Me.file_url).map(Me=>({filename:Me.file_name||"Application Form",url:String(Me.file_url)}));ct=[...ct,...He]}catch(Ie){console.warn("Failed to load application_form documents for attachments:",Ie)}try{const He=(await co(s.id)||[]).filter(st=>!it(Je(st))).map(st=>{let ut=st.file_url?String(st.file_url):"";if(!ut&&st.file_name){const wt=le(st.file_name);if(Ue[wt])ut=Ue[wt];else{const xt=(se||[]).find(X=>le(X.file_name).includes(wt)||wt.includes(le(X.file_name)));xt!=null&&xt.file_url&&(ut=String(xt.file_url))}}return{filename:st.file_name||"MTD File",url:ut}}).filter(st=>st.url);ct=[...ct,...He];const Me=new Set;ct=ct.filter(st=>{const ut=`${st.filename}::${st.url}`.toLowerCase();return Me.has(ut)?!1:(Me.add(ut),!0)})}catch(Ie){console.warn("Failed to load application_mtd documents for attachments:",Ie)}}}catch(se){console.warn("Failed to load application documents for attachments:",se)}const Y=ct;let je=(Qe[0]?Ve(lt(Qe[0])):"").replace(/<div class="contact-info"[^>]*>[\s\S]*?<\/div>/,"").replace(/<div class="documents"[^>]*>[\s\S]*?<\/div>/,"").replace(/<div class="download-zip"[^>]*>[\s\S]*?<\/div>/,"").replace(/<div class="highlight-box"[^>]*>[\s\S]*?<\/div>/,"").replace(/<div class="contact-item"[^>]*>[\s\S]*?<\/div>/g,"").replace(/<p[^>]*>\s*<strong>Best regards,[\s\S]*?<\/p>/,"").replace(/<p[^>]*>\s*<strong>[^<]+<\/strong>\s*<br[^>]*>[\s\S]*?<\/p>/,"").replace(/<p[^>]*>I would appreciate[\s\S]*?<\/p>/,"").replace(/<p[^>]*>Thank you for your time[\s\S]*?<\/p>/,"").replace(/<div class="section">[\s\S]*?<h2>[\s\S]*?Financial Information[\s\S]*?<\/h2>[\s\S]*?<\/div>/,"").replace(/<h2>[\s\S]*?Financial Information[\s\S]*?<\/h2>[\s\S]*?<div class="info-grid">[\s\S]*?<\/div>/,"").replace(/<p[^>]*>\s*Application ID:[\s\S]*?<\/p>/,"");try{const se=Ie=>Ie.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),le=se(((_e=s==null?void 0:s.contactInfo)==null?void 0:_e.phone)||""),Ue=se(((at=s==null?void 0:s.contactInfo)==null?void 0:at.address)||"");le&&(je=je.replace(new RegExp(le,"g"),"")),Ue&&(je=je.replace(new RegExp(Ue,"g"),""))}catch{}for(const se of Qe){const le=(se.contact_email||"").trim(),Ue=(()=>{const st=se.cc_emails??null,ut=wt=>wt.split(/[;,]/).map(xt=>xt.trim()).filter(xt=>xt.length>0);return Array.isArray(st)?st.flatMap(wt=>ut(String(wt))):typeof st=="string"?ut(st):[]})(),Ie=At(se);let He=Ve(lt(se)).replace(/<div class="contact-info"[^>]*>[\s\S]*?<\/div>/,"").replace(/<div class="documents"[^>]*>[\s\S]*?<\/div>/,"").replace(/<div class="download-zip"[^>]*>[\s\S]*?<\/div>/,"").replace(/<div class="highlight-box"[^>]*>[\s\S]*?<\/div>/,"").replace(/<div class="contact-item"[^>]*>[\s\S]*?<\/div>/g,"").replace(/<p[^>]*>\s*<strong>Best regards,[\s\S]*?<\/p>/,"").replace(/<p[^>]*>\s*<strong>[^<]+<\/strong>\s*<br[^>]*>[\s\S]*?<\/p>/,"").replace(/<p[^>]*>I would appreciate[\s\S]*?<\/p>/,"").replace(/<p[^>]*>Thank you for your time[\s\S]*?<\/p>/,"").replace(/<div class="section">[\s\S]*?<h2>[\s\S]*?Financial Information[\s\S]*?<\/h2>[\s\S]*?<\/div>/,"").replace(/<h2>[\s\S]*?Financial Information[\s\S]*?<\/h2>[\s\S]*?<div class="info-grid">[\s\S]*?<\/div>/,"").replace(/<p[^>]*>\s*Application ID:[\s\S]*?<\/p>/,"");try{const st=xt=>xt.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ut=st(((St=s==null?void 0:s.contactInfo)==null?void 0:St.phone)||""),wt=st(((Tt=s==null?void 0:s.contactInfo)==null?void 0:Tt.address)||"");ut&&(He=He.replace(new RegExp(ut,"g"),"")),wt&&(He=He.replace(new RegExp(wt,"g"),""))}catch{}const Me={applicationId:s==null?void 0:s.id,lenders:le?[le]:[],toEmails:le?[le]:[],ccEmails:Ue,lenderIds:[se.id],lendersDetailed:[...le?[{id:se.id,email:le,role:"to"}]:[],...Ue.map(st=>({id:se.id,email:st,role:"cc"}))],subject:Ie.subject,body:He,bodyHtml:He,attachments:Y,smtpSettingsId:Ce||Z||null,context:{businessName:s==null?void 0:s.businessName,applicantEmail:o.fromEmail||null,requestedAmount:s==null?void 0:s.requestedAmount,monthlyRevenue:s==null?void 0:s.monthlyRevenue,creditScore:s==null?void 0:s.creditScore,selectedLenderCount:1,lenderName:se.name},sentAt:new Date().toISOString()};Nt(Me)}if(Ce){const se=await fetch("/.netlify/functions/send-application-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({applicationId:s==null?void 0:s.id,lenders:Fs,toEmails:Ot,ccEmails:Ps,lenderIds:Os,lendersDetailed:be,subject:ve.subject,body:je,attachments:ct})});if(!se.ok){const le=await se.text();throw console.warn("Email server responded with error:",se.status,le),new Error("Email sending failed")}}w(!0),r()}catch(Pt){console.error("Error submitting application:",Pt),alert("Error submitting application. Please try again.")}finally{p(100),h(!1),clearInterval(me)}};return s?x?a.jsxs("div",{className:"relative min-h-screen bg-gradient-to-b from-emerald-50/30 via-white to-white",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden","aria-hidden":"true",children:[a.jsx("div",{className:"absolute -top-24 -right-24 w-96 h-96 rounded-full bg-emerald-100/40 blur-3xl"}),a.jsx("div",{className:"absolute -bottom-24 -left-24 w-96 h-96 rounded-full bg-blue-100/30 blur-3xl"})]}),a.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx(_s,{className:"w-16 h-16 text-green-600 mx-auto mb-6"}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Application Submitted Successfully!"}),a.jsxs("p",{className:"text-gray-600 mb-6",children:["Your application and business bank statements have been sent to ",Qe.length," selected lender",Qe.length>1?"s":"",". You should receive responses within 24-48 hours."]}),a.jsxs("div",{className:"bg-green-50 rounded-lg p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-green-800 mb-3",children:"Submitted to:"}),a.jsx("div",{className:"space-y-2",children:Qe.map(me=>a.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("img",{src:"https://images.pexels.com/photos/259027/pexels-photo-259027.jpeg?auto=compress&cs=tinysrgb&w=100&h=100",alt:me.name,className:"w-12 h-12 rounded-lg mr-4"}),a.jsx("span",{className:"font-medium text-green-900",children:me.name})]}),a.jsx("span",{className:"text-sm text-green-600",children:"✓ Sent"})]},me.id))})]}),a.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Submit Another Application"})]})})})]}):a.jsxs("div",{className:"relative min-h-screen bg-gradient-to-b from-emerald-50/30 via-white to-white",children:[a.jsxs("div",{className:"pointer-events-none absolute inset-0 overflow-hidden","aria-hidden":"true",children:[a.jsx("div",{className:"absolute -top-24 -right-24 w-96 h-96 rounded-full bg-emerald-100/40 blur-3xl"}),a.jsx("div",{className:"absolute -bottom-24 -left-24 w-96 h-96 rounded-full bg-blue-100/30 blur-3xl"})]}),a.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20 backdrop-blur-sm",children:a.jsx("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 p-8 border border-gray-100",children:a.jsxs("div",{className:"flex flex-col items-center text-center",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-emerald-100 to-emerald-200 flex items-center justify-center mb-6 shadow-inner",children:a.jsx(rv,{className:"w-8 h-8 text-emerald-600 animate-spin"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Sending Your Application"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"We're sending your application and attachments to selected lenders…"}),a.jsxs("div",{className:"w-full",children:[a.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden shadow-inner",children:a.jsx("div",{className:"h-3 bg-gradient-to-r from-emerald-500 to-emerald-600 rounded-full transition-all duration-300 shadow-sm",style:{width:`${Math.round(m)}%`}})}),a.jsx("div",{className:"text-sm text-gray-500 mt-3",children:"This can take 30–60 seconds"})]})]})})}),a.jsxs("div",{className:"text-center mb-12",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("button",{onClick:t,className:"flex items-center px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-xl transition-all duration-200",children:[a.jsx($4,{className:"w-5 h-5 mr-2"}),"Back to Lender Selection"]}),a.jsxs("div",{className:"text-sm text-gray-500 font-mono bg-gray-50 px-3 py-1 rounded-lg",children:["Application ID: ",s.id]})]}),a.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-emerald-50 border border-emerald-200 rounded-full text-emerald-700 text-sm font-medium mb-4",children:[a.jsx(_s,{className:"w-4 h-4 mr-2"}),"Ready to Submit to ",Qe.length," Lender",Qe.length>1?"s":""]}),a.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Submission Summary"}),a.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Review your application details before sending to selected lenders"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-12",children:[a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg ring-1 ring-gray-100 hover:shadow-xl transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center shadow-inner",children:a.jsx(Is,{className:"w-5 h-5 text-blue-600"})}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Business"})]}),a.jsx("div",{className:"text-2xl font-bold text-slate-800 mb-1",children:s.businessName}),a.jsx("div",{className:"text-sm text-gray-500",children:s.industry})]}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg ring-1 ring-gray-100 hover:shadow-xl transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center shadow-inner",children:a.jsx(U4,{className:"w-5 h-5 text-green-600"})}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Requested Amount"})]}),a.jsxs("div",{className:"text-2xl font-bold text-slate-800",children:["$",s.requestedAmount.toLocaleString()]})]}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg ring-1 ring-gray-100 hover:shadow-xl transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center shadow-inner",children:a.jsx($4,{className:"w-5 h-5 text-purple-600"})}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Monthly Revenue"})]}),a.jsxs("div",{className:"text-2xl font-bold text-slate-800",children:["$",s.monthlyRevenue.toLocaleString()]})]}),a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg ring-1 ring-gray-100 hover:shadow-xl transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-orange-100 flex items-center justify-center shadow-inner",children:a.jsx(_s,{className:"w-5 h-5 text-orange-600"})}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Credit Score"})]}),a.jsx("div",{className:"text-2xl font-bold text-slate-800",children:s.creditScore})]})]}),a.jsxs("div",{className:"mb-12",children:[a.jsxs("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:["Selected Lenders (",Qe.length,")"]}),a.jsx("div",{className:"space-y-4",children:Qe.map(me=>a.jsx("div",{className:"group bg-white rounded-2xl border-2 border-gray-200 hover:border-emerald-300 hover:shadow-xl hover:shadow-emerald-100/50 transition-all duration-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-emerald-100 to-emerald-200 flex items-center justify-center mr-4 shadow-sm border-2 border-emerald-300",children:a.jsx(Is,{className:"w-8 h-8 text-emerald-700"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-1",children:me.name}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[a.jsxs("span",{className:"font-medium",children:["Factor: ",me.factor_rate]}),a.jsx("span",{children:"•"}),a.jsxs("span",{className:"font-medium",children:["Term: ",me.payback_term]}),a.jsx("span",{children:"•"}),a.jsxs("span",{className:"font-medium",children:["Approval: ",me.approval_time]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-xl font-bold text-emerald-600",children:"95%"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Match Score"})]}),a.jsx("button",{onClick:()=>{b(me),i(!0)},className:"px-4 py-2 text-emerald-600 hover:text-emerald-700 hover:bg-emerald-50 rounded-xl transition-all duration-200 text-sm font-medium",children:"Preview Email"})]})]})},me.id))})]}),ce,a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg ring-1 ring-gray-100 p-6 mb-12",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Documents to be Included"}),a.jsx("div",{className:"text-xs text-gray-500",children:C||T||M?"Loading…":`${pe.length+xe.length+et.length+he.length} file${pe.length+xe.length+et.length+he.length===1?"":"s"}`})]}),C||T||M?a.jsxs("div",{className:"flex items-center gap-2 text-gray-600 text-sm",children:[a.jsx(rv,{className:"w-4 h-4 animate-spin"})," Fetching documents…"]}):pe.length+xe.length+et.length+he.length===0?a.jsx("div",{className:"text-sm text-gray-500",children:"No documents uploaded yet."}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[et.map((me,Ce)=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border bg-gradient-to-br from-gray-50 to-white hover:shadow-md transition-shadow border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-5 h-5 text-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:me}),a.jsx("div",{className:"text-xs text-gray-500",children:"Application Form"})]})]}),a.jsx("button",{onClick:()=>Be(Ee(me)),className:"px-2 py-1 text-xs rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-100",children:"Exclude"})]},`inline-${Ce}`)),pe.sort((me,Ce)=>{const dt=me.created_at?new Date(me.created_at).getTime():0;return(Ce.created_at?new Date(Ce.created_at).getTime():0)-dt}).map(me=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border bg-gradient-to-br from-gray-50 to-white hover:shadow-md transition-shadow border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-5 h-5 text-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:me.file_name}),a.jsx("div",{className:"text-xs text-gray-500",children:"Bank Statement"})]})]}),a.jsx("button",{onClick:()=>Be(De(me)),className:"px-2 py-1 text-xs rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-100",children:"Exclude"})]},me.id)),xe.sort((me,Ce)=>{const dt=me.created_at?new Date(me.created_at).getTime():0;return(Ce.created_at?new Date(Ce.created_at).getTime():0)-dt}).map(me=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border bg-gradient-to-br from-gray-50 to-white hover:shadow-md transition-shadow border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-5 h-5 text-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:me.file_name}),a.jsx("div",{className:"text-xs text-gray-500",children:"Additional Document"})]})]}),a.jsx("button",{onClick:()=>Be(We(me)),className:"px-2 py-1 text-xs rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-100",children:"Exclude"})]},me.id)),he.sort((me,Ce)=>{const dt=me.created_at?new Date(me.created_at).getTime():0;return(Ce.created_at?new Date(Ce.created_at).getTime():0)-dt}).map(me=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border bg-gradient-to-br from-gray-50 to-white hover:shadow-md transition-shadow border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-5 h-5 text-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:me.file_name}),a.jsx("div",{className:"text-xs text-gray-500",children:"Funder MTD"})]})]}),a.jsx("button",{onClick:()=>Be(Je(me)),className:"px-2 py-1 text-xs rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-100",children:"Exclude"})]},me.id))]})]}),we.length+Ae.length+Ze.length+$e.length>0&&a.jsxs("div",{className:"bg-white rounded-2xl shadow-inner ring-1 ring-red-100 p-6 mb-12",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-bold text-red-700",children:"Excluded from Submission"}),a.jsxs("div",{className:"text-xs text-red-600",children:[we.length+Ae.length+Ze.length+$e.length," file(s)"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[we.map((me,Ce)=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border bg-red-50 border-red-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-5 h-5 text-red-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-red-900",children:me}),a.jsx("div",{className:"text-xs text-red-700",children:"Application Form"})]})]}),a.jsx("button",{onClick:()=>Te(Ee(me)),className:"px-2 py-1 text-xs rounded-lg border border-red-300 text-red-700 hover:bg-red-100",children:"Include"})]},`x-inline-${Ce}`)),Ae.map(me=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border bg-red-50 border-red-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-5 h-5 text-red-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-red-900",children:me.file_name}),a.jsx("div",{className:"text-xs text-red-700",children:"Bank Statement"})]})]}),a.jsx("button",{onClick:()=>Te(De(me)),className:"px-2 py-1 text-xs rounded-lg border border-red-300 text-red-700 hover:bg-red-100",children:"Include"})]},`x-app-${me.id}`)),Ze.map(me=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border bg-red-50 border-red-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-5 h-5 text-red-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-red-900",children:me.file_name}),a.jsx("div",{className:"text-xs text-red-700",children:"Additional Document"})]})]}),a.jsx("button",{onClick:()=>Te(We(me)),className:"px-2 py-1 text-xs rounded-lg border border-red-300 text-red-700 hover:bg-red-100",children:"Include"})]},`x-add-${me.id}`)),$e.map(me=>a.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border bg-red-50 border-red-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-5 h-5 text-red-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-red-900",children:me.file_name}),a.jsx("div",{className:"text-xs text-red-700",children:"Funder MTD"})]})]}),a.jsx("button",{onClick:()=>Te(Je(me)),className:"px-2 py-1 text-xs rounded-lg border border-red-300 text-red-700 hover:bg-red-100",children:"Include"})]},`x-mtd-${me.id}`))]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["Ready to send your application to ",a.jsx("span",{className:"font-semibold text-emerald-600",children:Qe.length})," qualified lender",Qe.length!==1?"s":""]}),a.jsx("button",{onClick:os,disabled:u,className:`w-full sm:w-auto justify-center flex items-center px-8 py-4 rounded-xl font-semibold text-lg transition-all duration-200 ${u?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white hover:from-emerald-700 hover:to-emerald-800 shadow-lg shadow-emerald-200/50 hover:shadow-xl hover:shadow-emerald-300/50"}`,children:u?a.jsxs(a.Fragment,{children:[a.jsx(rv,{className:"w-5 h-5 mr-2 animate-spin"}),"Sending Applications..."]}):a.jsxs(a.Fragment,{children:[a.jsx(U4,{className:"w-5 h-5 mr-2"}),"Send to ",Qe.length," Lender",Qe.length>1?"s":""]})})]}),c&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",children:a.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"px-6 py-5 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-white",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2.5 rounded-xl bg-blue-100 border border-blue-200 shadow-sm",children:a.jsx(iv,{className:"w-5 h-5 text-blue-700"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Email Settings"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Configure your SMTP settings for sending applications"})]})]})}),a.jsxs("div",{className:"px-6 py-6",children:[a.jsxs("div",{className:"mb-5 flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-xs text-gray-600",children:"Quick presets:"}),a.jsx("button",{type:"button",onClick:()=>ye("gmail_tls"),className:"px-2.5 py-1.5 text-xs rounded-lg bg-emerald-50 text-emerald-700 border border-emerald-200 hover:bg-emerald-100",children:"Gmail TLS (587)"}),a.jsx("button",{type:"button",onClick:()=>ye("gmail_ssl"),className:"px-2.5 py-1.5 text-xs rounded-lg bg-blue-50 text-blue-700 border border-blue-200 hover:bg-blue-100",children:"Gmail SSL (465)"}),a.jsx("button",{type:"button",onClick:()=>ye("outlook_tls"),className:"px-2.5 py-1.5 text-xs rounded-lg bg-indigo-50 text-indigo-700 border border-indigo-200 hover:bg-indigo-100",children:"Outlook (587)"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[a.jsxs("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"SMTP Host"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:a.jsx($M,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",value:o.smtpHost,onChange:me=>l(Ce=>({...Ce,smtpHost:me.target.value})),className:`w-full pl-9 pr-3.5 py-2.5 rounded-lg border-2 ${R.host?"border-red-300 focus:border-red-500 focus:ring-red-500/20":"border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"} focus:ring-2 transition-shadow shadow-sm`,placeholder:"smtp.gmail.com"})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Examples: smtp.gmail.com, smtp.mailgun.org"}),R.host&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:R.host})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"SMTP Port"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:a.jsx(RM,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",inputMode:"numeric",value:o.smtpPort,onChange:me=>l(Ce=>({...Ce,smtpPort:me.target.value})),className:`w-full pl-9 pr-3.5 py-2.5 rounded-lg border-2 ${R.port?"border-red-300 focus:border-red-500 focus:ring-red-500/20":"border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"} focus:ring-2 transition-shadow shadow-sm`,placeholder:"587 (TLS) or 465 (SSL)"})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Common ports: 587 (TLS), 465 (SSL)"}),R.port&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:R.port})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"Username"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:a.jsx(z4,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",value:o.smtpUser,onChange:me=>l(Ce=>({...Ce,smtpUser:me.target.value})),className:`w-full pl-9 pr-3.5 py-2.5 rounded-lg border-2 ${R.user?"border-red-300 focus:border-red-500 focus:ring-red-500/20":"border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"} focus:ring-2 transition-shadow shadow-sm`,placeholder:"Enter your username"})]}),R.user&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:R.user})]}),a.jsxs("div",{className:"col-span-1",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:a.jsx(DM,{className:"w-4 h-4"})}),a.jsx("input",{type:de?"text":"password",value:o.smtpPassword,onChange:me=>l(Ce=>({...Ce,smtpPassword:me.target.value})),className:"w-full pl-9 pr-11 py-2.5 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-shadow shadow-sm",placeholder:"your-app-password"}),a.jsx("button",{type:"button",onClick:()=>Ne(me=>!me),className:"absolute right-2.5 top-1/2 -translate-y-1/2 p-1.5 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100","aria-label":de?"Hide password":"Show password",children:de?a.jsx(dN,{className:"w-4 h-4"}):a.jsx(rc,{className:"w-4 h-4"})})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Use an app-specific password if using Gmail."})]}),a.jsxs("div",{className:"col-span-1 md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-1.5",children:"From Email"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:a.jsx(z4,{className:"w-4 h-4"})}),a.jsx("input",{type:"email",value:o.fromEmail,onChange:me=>l(Ce=>({...Ce,fromEmail:me.target.value})),className:`w-full pl-9 pr-3.5 py-2.5 rounded-lg border-2 ${R.fromEmail?"border-red-300 focus:border-red-500 focus:ring-red-500/20":"border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"} focus:ring-2 transition-shadow shadow-sm`,placeholder:"Enter your email address"})]}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:'Enter the email address you want to appear in the "From" field'}),R.fromEmail&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:R.fromEmail})]})]}),a.jsxs("div",{className:"mt-6 p-3.5 rounded-xl bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 text-xs text-blue-800 flex items-center gap-2",children:[a.jsx(zM,{className:"w-4 h-4"}),a.jsx("span",{children:"Use a trusted SMTP provider. For Gmail, enable 2FA and create an App Password."})]})]}),a.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex flex-col-reverse sm:flex-row sm:items-center justify-between gap-3",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("button",{type:"button",onClick:()=>{Se()&&alert("SMTP settings look good.")},className:"px-3 py-2 rounded-lg border-2 border-gray-200 text-gray-700 hover:bg-gray-100 text-sm",children:"Test Settings"})}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 rounded-lg border-2 border-gray-200 text-gray-700 hover:bg-gray-100 font-medium",children:"Cancel"}),a.jsx("button",{onClick:async()=>{Se()&&(Lt(o),await yt({...o,fromEmail:o.fromEmail}),d(!1))},className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 font-semibold shadow-sm",children:"Save Settings"})]})]})]})}),n&&S&&a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Email Preview - ",S.name]}),a.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[a.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[a.jsx("strong",{children:"From:"})," ",o.fromEmail?o.fromEmail:a.jsx("span",{className:"text-amber-600 italic",children:"No from email specified"})]}),a.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[a.jsx("strong",{children:"To:"})," ",S.contact_email||"—"]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("strong",{children:"Format:"})," HTML Email"]})]}),a.jsx("div",{className:"bg-white border rounded-lg overflow-hidden",children:a.jsx("iframe",{title:"Email HTML Preview",style:{width:"100%",height:`${j}px`,border:"0",display:"block"},srcDoc:(()=>{const me=lt(S),Ce=me.split(/\r?\n\r?\n/);let O=(Ce.length>1?Ce.slice(1).join(`

`):me).replace(/<div class="contact-info">[\s\S]*?<\/div>/,"").replace(/<div class="documents">[\s\S]*?<\/div>/,"").replace(/<div class="download-zip">[\s\S]*?<\/div>/,"").replace(/<div class="highlight-box">[\s\S]*?<\/div>/,"").replace(/<p[^>]*>\s*<strong>Best regards,[\s\S]*?<\/p>/,"").replace(/<p[^>]*>\s*<strong>[^<]+<\/strong>\s*<br[^>]*>[\s\S]*?<\/p>/,"").replace(/<p[^>]*>I would appreciate[\s\S]*?<\/p>/,"").replace(/<p[^>]*>Thank you for your time[\s\S]*?<\/p>/,"").replace(/<div class="section">[\s\S]*?<h2>[\s\S]*?Financial Information[\s\S]*?<\/h2>[\s\S]*?<\/div>/,"").replace(/<h2>[\s\S]*?Financial Information[\s\S]*?<\/h2>[\s\S]*?<div class="info-grid">[\s\S]*?<\/div>/,"").replace(/<p[^>]*>\s*Application ID:[\s\S]*?<\/p>/,"");try{const _e=Tt=>Tt.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),at=_e(s.contactInfo.phone||""),St=_e(s.contactInfo.address||"");at&&(O=O.replace(new RegExp(at,"g"),"")),St&&(O=O.replace(new RegExp(St,"g"),""))}catch{}return O})(),onLoad:me=>{var Ce,dt,O;try{const _e=me.currentTarget,at=_e.contentDocument||((Ce=_e.contentWindow)==null?void 0:Ce.document),St=Math.max(((dt=at==null?void 0:at.body)==null?void 0:dt.scrollHeight)||0,((O=at==null?void 0:at.documentElement)==null?void 0:O.scrollHeight)||0,800);E(St+20)}catch{}}})}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[a.jsx("button",{onClick:()=>{const me=lt(S),Ce=me.split(/\r?\n\r?\n/);let dt=Ce.length>1?Ce.slice(1).join(`

`):me;dt=dt.replace(/<div class="contact-info">[\s\S]*?<\/div>/,"").replace(/<div class="documents">[\s\S]*?<\/div>/,"").replace(/<div class="download-zip">[\s\S]*?<\/div>/,"").replace(/<div class="highlight-box">[\s\S]*?<\/div>/,"").replace(/<p[^>]*>\s*<strong>Best regards,[\s\S]*?<\/p>/,"").replace(/<p[^>]*>\s*<strong>[^<]+<\/strong>\s*<br[^>]*>[\s\S]*?<\/p>/,"").replace(/<p[^>]*>I would appreciate[\s\S]*?<\/p>/,"").replace(/<p[^>]*>Thank you for your time[\s\S]*?<\/p>/,"").replace(/<div class="section">[\s\S]*?<h2>[\s\S]*?Financial Information[\s\S]*?<\/h2>[\s\S]*?<\/div>/,"").replace(/<h2>[\s\S]*?Financial Information[\s\S]*?<\/h2>[\s\S]*?<div class="info-grid">[\s\S]*?<\/div>/,"").replace(/<p[^>]*>\s*Application ID:[\s\S]*?<\/p>/,"");try{const _e=Tt=>Tt.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),at=_e(s.contactInfo.phone||""),St=_e(s.contactInfo.address||"");at&&(dt=dt.replace(new RegExp(at,"g"),"")),St&&(dt=dt.replace(new RegExp(St,"g"),""))}catch{}const O=window.open("","_blank");O&&(O.document.open(),O.document.write(dt),O.document.close())},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Open in new window"}),a.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Close Preview"})]})]})]})})]})]}):a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No application data available"})})};function Ws(s){"@babel/helpers - typeof";return Ws=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ws(s)}var Un=Uint8Array,Qi=Uint16Array,Aj=Int32Array,j2=new Un([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),A2=new Un([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),H_=new Un([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),RP=function(s,e){for(var t=new Qi(31),r=0;r<31;++r)t[r]=e+=1<<s[r-1];for(var n=new Aj(t[30]),r=1;r<30;++r)for(var i=t[r];i<t[r+1];++i)n[i]=i-t[r]<<5|r;return{b:t,r:n}},DP=RP(j2,2),MP=DP.b,W_=DP.r;MP[28]=258,W_[258]=28;var FP=RP(A2,0),g9=FP.b,k3=FP.r,V_=new Qi(32768);for(var or=0;or<32768;++or){var jc=(or&43690)>>1|(or&21845)<<1;jc=(jc&52428)>>2|(jc&13107)<<2,jc=(jc&61680)>>4|(jc&3855)<<4,V_[or]=((jc&65280)>>8|(jc&255)<<8)>>1}var Qo=function(s,e,t){for(var r=s.length,n=0,i=new Qi(e);n<r;++n)s[n]&&++i[s[n]-1];var o=new Qi(e);for(n=1;n<e;++n)o[n]=o[n-1]+i[n-1]<<1;var l;if(t){l=new Qi(1<<e);var c=15-e;for(n=0;n<r;++n)if(s[n])for(var d=n<<4|s[n],u=e-s[n],h=o[s[n]-1]++<<u,m=h|(1<<u)-1;h<=m;++h)l[V_[h]>>c]=d}else for(l=new Qi(r),n=0;n<r;++n)s[n]&&(l[n]=V_[o[s[n]-1]++]>>15-s[n]);return l},Dd=new Un(288);for(var or=0;or<144;++or)Dd[or]=8;for(var or=144;or<256;++or)Dd[or]=9;for(var or=256;or<280;++or)Dd[or]=7;for(var or=280;or<288;++or)Dd[or]=8;var Fg=new Un(32);for(var or=0;or<32;++or)Fg[or]=5;var x9=Qo(Dd,9,0),b9=Qo(Dd,9,1),y9=Qo(Fg,5,0),v9=Qo(Fg,5,1),r5=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},Oa=function(s,e,t){var r=e/8|0;return(s[r]|s[r+1]<<8)>>(e&7)&t},n5=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(e&7)},kj=function(s){return(s+7)/8|0},OP=function(s,e,t){return(t==null||t>s.length)&&(t=s.length),new Un(s.subarray(e,t))},w9=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ha=function(s,e,t){var r=new Error(e||w9[s]);if(r.code=s,Error.captureStackTrace&&Error.captureStackTrace(r,Ha),!t)throw r;return r},N9=function(s,e,t,r){var n=s.length,i=0;if(!n||e.f&&!e.l)return t||new Un(0);var o=!t,l=o||e.i!=2,c=e.i;o&&(t=new Un(n*3));var d=function(We){var Je=t.length;if(We>Je){var it=new Un(Math.max(Je*2,We));it.set(t),t=it}},u=e.f||0,h=e.p||0,m=e.b||0,p=e.l,x=e.d,w=e.m,S=e.n,b=n*8;do{if(!p){u=Oa(s,h,1);var v=Oa(s,h+1,3);if(h+=3,v)if(v==1)p=b9,x=v9,w=9,S=5;else if(v==2){var A=Oa(s,h,31)+257,L=Oa(s,h+10,15)+4,C=A+Oa(s,h+5,31)+1;h+=14;for(var B=new Un(C),U=new Un(19),P=0;P<L;++P)U[H_[P]]=Oa(s,h+P*3,7);h+=L*3;for(var T=r5(U),z=(1<<T)-1,H=Qo(U,T,1),P=0;P<C;){var D=H[Oa(s,h,z)];h+=D&15;var N=D>>4;if(N<16)B[P++]=N;else{var M=0,$=0;for(N==16?($=3+Oa(s,h,3),h+=2,M=B[P-1]):N==17?($=3+Oa(s,h,7),h+=3):N==18&&($=11+Oa(s,h,127),h+=7);$--;)B[P++]=M}}var q=B.subarray(0,A),K=B.subarray(A);w=r5(q),S=r5(K),p=Qo(q,w,1),x=Qo(K,S,1)}else Ha(1);else{var N=kj(h)+4,j=s[N-4]|s[N-3]<<8,E=N+j;if(E>n){c&&Ha(0);break}l&&d(m+j),t.set(s.subarray(N,E),m),e.b=m+=j,e.p=h=E*8,e.f=u;continue}if(h>b){c&&Ha(0);break}}l&&d(m+131072);for(var de=(1<<w)-1,Ne=(1<<S)-1,R=h;;R=h){var M=p[n5(s,h)&de],W=M>>4;if(h+=M&15,h>b){c&&Ha(0);break}if(M||Ha(2),W<256)t[m++]=W;else if(W==256){R=h,p=null;break}else{var Z=W-254;if(W>264){var P=W-257,ue=j2[P];Z=Oa(s,h,(1<<ue)-1)+MP[P],h+=ue}var ce=x[n5(s,h)&Ne],ye=ce>>4;ce||Ha(3),h+=ce&15;var K=g9[ye];if(ye>3){var ue=A2[ye];K+=n5(s,h)&(1<<ue)-1,h+=ue}if(h>b){c&&Ha(0);break}l&&d(m+131072);var Se=m+Z;if(m<K){var Ee=i-K,De=Math.min(K,Se);for(Ee+m<0&&Ha(3);m<De;++m)t[m]=r[Ee+m]}for(;m<Se;++m)t[m]=t[m-K]}}e.l=p,e.p=R,e.b=m,e.f=u,p&&(u=1,e.m=w,e.d=x,e.n=S)}while(!u);return m!=t.length&&o?OP(t,0,m):t.subarray(0,m)},ul=function(s,e,t){t<<=e&7;var r=e/8|0;s[r]|=t,s[r+1]|=t>>8},y0=function(s,e,t){t<<=e&7;var r=e/8|0;s[r]|=t,s[r+1]|=t>>8,s[r+2]|=t>>16},i5=function(s,e){for(var t=[],r=0;r<s.length;++r)s[r]&&t.push({s:r,f:s[r]});var n=t.length,i=t.slice();if(!n)return{t:$P,l:0};if(n==1){var o=new Un(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(E,A){return E.f-A.f}),t.push({s:-1,f:25001});var l=t[0],c=t[1],d=0,u=1,h=2;for(t[0]={s:-1,f:l.f+c.f,l,r:c};u!=n-1;)l=t[t[d].f<t[h].f?d++:h++],c=t[d!=u&&t[d].f<t[h].f?d++:h++],t[u++]={s:-1,f:l.f+c.f,l,r:c};for(var m=i[0].s,r=1;r<n;++r)i[r].s>m&&(m=i[r].s);var p=new Qi(m+1),x=G_(t[u-1],p,0);if(x>e){var r=0,w=0,S=x-e,b=1<<S;for(i.sort(function(A,L){return p[L.s]-p[A.s]||A.f-L.f});r<n;++r){var v=i[r].s;if(p[v]>e)w+=b-(1<<x-p[v]),p[v]=e;else break}for(w>>=S;w>0;){var N=i[r].s;p[N]<e?w-=1<<e-p[N]++-1:++r}for(;r>=0&&w;--r){var j=i[r].s;p[j]==e&&(--p[j],++w)}x=e}return{t:new Un(p),l:x}},G_=function(s,e,t){return s.s==-1?Math.max(G_(s.l,e,t+1),G_(s.r,e,t+1)):e[s.s]=t},C3=function(s){for(var e=s.length;e&&!s[--e];);for(var t=new Qi(++e),r=0,n=s[0],i=1,o=function(c){t[r++]=c},l=1;l<=e;++l)if(s[l]==n&&l!=e)++i;else{if(!n&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(n),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(n);i=1,n=s[l]}return{c:t.subarray(0,r),n:e}},v0=function(s,e){for(var t=0,r=0;r<e.length;++r)t+=s[r]*e[r];return t},BP=function(s,e,t){var r=t.length,n=kj(e+2);s[n]=r&255,s[n+1]=r>>8,s[n+2]=s[n]^255,s[n+3]=s[n+1]^255;for(var i=0;i<r;++i)s[n+i+4]=t[i];return(n+4+r)*8},E3=function(s,e,t,r,n,i,o,l,c,d,u){ul(e,u++,t),++n[256];for(var h=i5(n,15),m=h.t,p=h.l,x=i5(i,15),w=x.t,S=x.l,b=C3(m),v=b.c,N=b.n,j=C3(w),E=j.c,A=j.n,L=new Qi(19),C=0;C<v.length;++C)++L[v[C]&31];for(var C=0;C<E.length;++C)++L[E[C]&31];for(var B=i5(L,7),U=B.t,P=B.l,T=19;T>4&&!U[H_[T-1]];--T);var z=d+5<<3,H=v0(n,Dd)+v0(i,Fg)+o,D=v0(n,m)+v0(i,w)+o+14+3*T+v0(L,U)+2*L[16]+3*L[17]+7*L[18];if(c>=0&&z<=H&&z<=D)return BP(e,u,s.subarray(c,c+d));var M,$,q,K;if(ul(e,u,1+(D<H)),u+=2,D<H){M=Qo(m,p,0),$=m,q=Qo(w,S,0),K=w;var de=Qo(U,P,0);ul(e,u,N-257),ul(e,u+5,A-1),ul(e,u+10,T-4),u+=14;for(var C=0;C<T;++C)ul(e,u+3*C,U[H_[C]]);u+=3*T;for(var Ne=[v,E],R=0;R<2;++R)for(var W=Ne[R],C=0;C<W.length;++C){var Z=W[C]&31;ul(e,u,de[Z]),u+=U[Z],Z>15&&(ul(e,u,W[C]>>5&127),u+=W[C]>>12)}}else M=x9,$=Dd,q=y9,K=Fg;for(var C=0;C<l;++C){var ue=r[C];if(ue>255){var Z=ue>>18&31;y0(e,u,M[Z+257]),u+=$[Z+257],Z>7&&(ul(e,u,ue>>23&31),u+=j2[Z]);var ce=ue&31;y0(e,u,q[ce]),u+=K[ce],ce>3&&(y0(e,u,ue>>5&8191),u+=A2[ce])}else y0(e,u,M[ue]),u+=$[ue]}return y0(e,u,M[256]),u+$[256]},_9=new Aj([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),$P=new Un(0),S9=function(s,e,t,r,n,i){var o=i.z||s.length,l=new Un(r+o+5*(1+Math.ceil(o/7e3))+n),c=l.subarray(r,l.length-n),d=i.l,u=(i.r||0)&7;if(e){u&&(c[0]=i.r>>3);for(var h=_9[e-1],m=h>>13,p=h&8191,x=(1<<t)-1,w=i.p||new Qi(32768),S=i.h||new Qi(x+1),b=Math.ceil(t/3),v=2*b,N=function(Be){return(s[Be]^s[Be+1]<<b^s[Be+2]<<v)&x},j=new Aj(25e3),E=new Qi(288),A=new Qi(32),L=0,C=0,B=i.i||0,U=0,P=i.w||0,T=0;B+2<o;++B){var z=N(B),H=B&32767,D=S[z];if(w[H]=D,S[z]=H,P<=B){var M=o-B;if((L>7e3||U>24576)&&(M>423||!d)){u=E3(s,c,0,j,E,A,C,U,T,B-T,u),U=L=C=0,T=B;for(var $=0;$<286;++$)E[$]=0;for(var $=0;$<30;++$)A[$]=0}var q=2,K=0,de=p,Ne=H-D&32767;if(M>2&&z==N(B-Ne))for(var R=Math.min(m,M)-1,W=Math.min(32767,B),Z=Math.min(258,M);Ne<=W&&--de&&H!=D;){if(s[B+q]==s[B+q-Ne]){for(var ue=0;ue<Z&&s[B+ue]==s[B+ue-Ne];++ue);if(ue>q){if(q=ue,K=Ne,ue>R)break;for(var ce=Math.min(Ne,ue-2),ye=0,$=0;$<ce;++$){var Se=B-Ne+$&32767,Ee=w[Se],De=Se-Ee&32767;De>ye&&(ye=De,D=Se)}}}H=D,D=w[H],Ne+=H-D&32767}if(K){j[U++]=268435456|W_[q]<<18|k3[K];var We=W_[q]&31,Je=k3[K]&31;C+=j2[We]+A2[Je],++E[257+We],++A[Je],P=B+q,++L}else j[U++]=s[B],++E[s[B]]}}for(B=Math.max(B,P);B<o;++B)j[U++]=s[B],++E[s[B]];u=E3(s,c,d,j,E,A,C,U,T,B-T,u),d||(i.r=u&7|c[u/8|0]<<3,u-=7,i.h=S,i.p=w,i.i=B,i.w=P)}else{for(var B=i.w||0;B<o+d;B+=65535){var it=B+65535;it>=o&&(c[u/8|0]=d,it=o),u=BP(c,u+1,s.subarray(B,it))}i.i=o}return OP(l,0,r+kj(u)+n)},zP=function(){var s=1,e=0;return{p:function(t){for(var r=s,n=e,i=t.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)n+=r+=t[o];r=(r&65535)+15*(r>>16),n=(n&65535)+15*(n>>16)}s=r,e=n},d:function(){return s%=65521,e%=65521,(s&255)<<24|(s&65280)<<8|(e&255)<<8|e>>8}}},j9=function(s,e,t,r,n){if(!n&&(n={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),o=new Un(i.length+s.length);o.set(i),o.set(s,i.length),s=o,n.w=i.length}return S9(s,e.level==null?6:e.level,e.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(s.length)))*1.5):20:12+e.mem,t,r,n)},UP=function(s,e,t){for(;t;++e)s[e]=t,t>>>=8},A9=function(s,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;if(s[0]=120,s[1]=r<<6|(e.dictionary&&32),s[1]|=31-(s[0]<<8|s[1])%31,e.dictionary){var n=zP();n.p(e.dictionary),UP(s,2,n.d())}},k9=function(s,e){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&Ha(6,"invalid zlib data"),(s[1]>>5&1)==+!e&&Ha(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function Y_(s,e){e||(e={});var t=zP();t.p(s);var r=j9(s,e,e.dictionary?6:2,4);return A9(r,e),UP(r,r.length-4,t.d()),r}function C9(s,e){return N9(s.subarray(k9(s,e),-4),{i:2},e,e)}var E9=typeof TextDecoder<"u"&&new TextDecoder,L9=0;try{E9.decode($P,{stream:!0}),L9=1}catch{}var is=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function a5(){is.console&&typeof is.console.log=="function"&&is.console.log.apply(is.console,arguments)}var Js={log:a5,warn:function(s){is.console&&(typeof is.console.warn=="function"?is.console.warn.apply(is.console,arguments):a5.call(null,arguments))},error:function(s){is.console&&(typeof is.console.error=="function"?is.console.error.apply(is.console,arguments):a5(s))}};function o5(s,e,t){var r=new XMLHttpRequest;r.open("GET",s),r.responseType="blob",r.onload=function(){hu(r.response,e,t)},r.onerror=function(){Js.error("could not download file")},r.send()}function L3(s){var e=new XMLHttpRequest;e.open("HEAD",s,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Ry(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(e)}}var rg,K_,hu=is.saveAs||((typeof window>"u"?"undefined":Ws(window))!=="object"||window!==is?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(s,e,t){var r=is.URL||is.webkitURL,n=document.createElement("a");e=e||s.name||"download",n.download=e,n.rel="noopener",typeof s=="string"?(n.href=s,n.origin!==location.origin?L3(n.href)?o5(s,e,t):Ry(n,n.target="_blank"):Ry(n)):(n.href=r.createObjectURL(s),setTimeout(function(){r.revokeObjectURL(n.href)},4e4),setTimeout(function(){Ry(n)},0))}:"msSaveOrOpenBlob"in navigator?function(s,e,t){if(e=e||s.name||"download",typeof s=="string")if(L3(s))o5(s,e,t);else{var r=document.createElement("a");r.href=s,r.target="_blank",setTimeout(function(){Ry(r)})}else navigator.msSaveOrOpenBlob(function(n,i){return i===void 0?i={autoBom:!1}:Ws(i)!=="object"&&(Js.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(s,t),e)}:function(s,e,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof s=="string")return o5(s,e,t);var n=s.type==="application/octet-stream",i=/constructor/i.test(is.HTMLElement)||is.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&i)&&(typeof FileReader>"u"?"undefined":Ws(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=u:location=u,r=null},l.readAsDataURL(s)}else{var c=is.URL||is.webkitURL,d=c.createObjectURL(s);r?r.location=d:location.href=d,r=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function qP(s){var e;s=s||"",this.ok=!1,s.charAt(0)=="#"&&(s=s.substr(1,6)),s={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[s=(s=s.replace(/ /g,"")).toLowerCase()]||s;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],r=0;r<t.length;r++){var n=t[r].re,i=t[r].process,o=n.exec(s);o&&(e=i(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function l5(s,e){var t=s[0],r=s[1],n=s[2],i=s[3];t=kn(t,r,n,i,e[0],7,-680876936),i=kn(i,t,r,n,e[1],12,-389564586),n=kn(n,i,t,r,e[2],17,606105819),r=kn(r,n,i,t,e[3],22,-1044525330),t=kn(t,r,n,i,e[4],7,-176418897),i=kn(i,t,r,n,e[5],12,1200080426),n=kn(n,i,t,r,e[6],17,-1473231341),r=kn(r,n,i,t,e[7],22,-45705983),t=kn(t,r,n,i,e[8],7,1770035416),i=kn(i,t,r,n,e[9],12,-1958414417),n=kn(n,i,t,r,e[10],17,-42063),r=kn(r,n,i,t,e[11],22,-1990404162),t=kn(t,r,n,i,e[12],7,1804603682),i=kn(i,t,r,n,e[13],12,-40341101),n=kn(n,i,t,r,e[14],17,-1502002290),t=Cn(t,r=kn(r,n,i,t,e[15],22,1236535329),n,i,e[1],5,-165796510),i=Cn(i,t,r,n,e[6],9,-1069501632),n=Cn(n,i,t,r,e[11],14,643717713),r=Cn(r,n,i,t,e[0],20,-373897302),t=Cn(t,r,n,i,e[5],5,-701558691),i=Cn(i,t,r,n,e[10],9,38016083),n=Cn(n,i,t,r,e[15],14,-660478335),r=Cn(r,n,i,t,e[4],20,-405537848),t=Cn(t,r,n,i,e[9],5,568446438),i=Cn(i,t,r,n,e[14],9,-1019803690),n=Cn(n,i,t,r,e[3],14,-187363961),r=Cn(r,n,i,t,e[8],20,1163531501),t=Cn(t,r,n,i,e[13],5,-1444681467),i=Cn(i,t,r,n,e[2],9,-51403784),n=Cn(n,i,t,r,e[7],14,1735328473),t=En(t,r=Cn(r,n,i,t,e[12],20,-1926607734),n,i,e[5],4,-378558),i=En(i,t,r,n,e[8],11,-2022574463),n=En(n,i,t,r,e[11],16,1839030562),r=En(r,n,i,t,e[14],23,-35309556),t=En(t,r,n,i,e[1],4,-1530992060),i=En(i,t,r,n,e[4],11,1272893353),n=En(n,i,t,r,e[7],16,-155497632),r=En(r,n,i,t,e[10],23,-1094730640),t=En(t,r,n,i,e[13],4,681279174),i=En(i,t,r,n,e[0],11,-358537222),n=En(n,i,t,r,e[3],16,-722521979),r=En(r,n,i,t,e[6],23,76029189),t=En(t,r,n,i,e[9],4,-640364487),i=En(i,t,r,n,e[12],11,-421815835),n=En(n,i,t,r,e[15],16,530742520),t=Ln(t,r=En(r,n,i,t,e[2],23,-995338651),n,i,e[0],6,-198630844),i=Ln(i,t,r,n,e[7],10,1126891415),n=Ln(n,i,t,r,e[14],15,-1416354905),r=Ln(r,n,i,t,e[5],21,-57434055),t=Ln(t,r,n,i,e[12],6,1700485571),i=Ln(i,t,r,n,e[3],10,-1894986606),n=Ln(n,i,t,r,e[10],15,-1051523),r=Ln(r,n,i,t,e[1],21,-2054922799),t=Ln(t,r,n,i,e[8],6,1873313359),i=Ln(i,t,r,n,e[15],10,-30611744),n=Ln(n,i,t,r,e[6],15,-1560198380),r=Ln(r,n,i,t,e[13],21,1309151649),t=Ln(t,r,n,i,e[4],6,-145523070),i=Ln(i,t,r,n,e[11],10,-1120210379),n=Ln(n,i,t,r,e[2],15,718787259),r=Ln(r,n,i,t,e[9],21,-343485551),s[0]=bd(t,s[0]),s[1]=bd(r,s[1]),s[2]=bd(n,s[2]),s[3]=bd(i,s[3])}function k2(s,e,t,r,n,i){return e=bd(bd(e,s),bd(r,i)),bd(e<<n|e>>>32-n,t)}function kn(s,e,t,r,n,i,o){return k2(e&t|~e&r,s,e,n,i,o)}function Cn(s,e,t,r,n,i,o){return k2(e&r|t&~r,s,e,n,i,o)}function En(s,e,t,r,n,i,o){return k2(e^t^r,s,e,n,i,o)}function Ln(s,e,t,r,n,i,o){return k2(t^(e|~r),s,e,n,i,o)}function HP(s){var e,t=s.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=s.length;e+=64)l5(r,P9(s.substring(e-64,e)));s=s.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<s.length;e++)n[e>>2]|=s.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(l5(r,n),e=0;e<16;e++)n[e]=0;return n[14]=8*t,l5(r,n),r}function P9(s){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=s.charCodeAt(e)+(s.charCodeAt(e+1)<<8)+(s.charCodeAt(e+2)<<16)+(s.charCodeAt(e+3)<<24);return t}rg=is.atob.bind(is),K_=is.btoa.bind(is);var P3="0123456789abcdef".split("");function T9(s){for(var e="",t=0;t<4;t++)e+=P3[s>>8*t+4&15]+P3[s>>8*t&15];return e}function I9(s){return String.fromCharCode((255&s)>>0,(65280&s)>>8,(16711680&s)>>16,(4278190080&s)>>24)}function X_(s){return HP(s).map(I9).join("")}var R9=function(s){for(var e=0;e<s.length;e++)s[e]=T9(s[e]);return s.join("")}(HP("hello"))!="5d41402abc4b2a76b9719d911017c592";function bd(s,e){if(R9){var t=(65535&s)+(65535&e);return(s>>16)+(e>>16)+(t>>16)<<16|65535&t}return s+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function J_(s,e){var t,r,n,i;if(s!==t){for(var o=(n=s,i=1+(256/s.length>>0),new Array(i+1).join(n)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+o.charCodeAt(c))%256,l[c]=l[d],l[d]=u}t=s,r=l}else l=r;var h=e.length,m=0,p=0,x="";for(c=0;c<h;c++)p=(p+(u=l[m=(m+1)%256]))%256,l[m]=l[p],l[p]=u,o=l[(l[m]+l[p])%256],x+=String.fromCharCode(e.charCodeAt(c)^o);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var T3={print:4,modify:8,copy:16,"annot-forms":32};function Mf(s,e,t,r){this.v=1,this.r=2;var n=192;s.forEach(function(l){if(T3.perm!==void 0)throw new Error("Invalid permission: "+l);n+=T3[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(e+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^n)),this.encryptionKey=X_(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=J_(this.encryptionKey,this.padding)}function Ff(s){if(/[^\u0000-\u00ff]/.test(s))throw new Error("Invalid PDF Name Object: "+s+", Only accept ASCII characters.");for(var e="",t=s.length,r=0;r<t;r++){var n=s.charCodeAt(r);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?e+="#"+("0"+n.toString(16)).slice(-2):e+=s[r]}return e}function I3(s){if(Ws(s)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,r,n){if(n=n||!1,typeof t!="string"||typeof r!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var i=Math.random().toString(35);return e[t][i]=[r,!!n],i},this.unsubscribe=function(t){for(var r in e)if(e[r][t])return delete e[r][t],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),n=[];for(var i in e[t]){var o=e[t][i];try{o[0].apply(s,r)}catch(l){is.console&&Js.error("jsPDF PubSub Error",l.message,l)}o[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Og(s){if(!(this instanceof Og))return new Og(s);var e="opacity,stroke-opacity".split(",");for(var t in s)s.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=s[t]);this.id="",this.objectNumber=-1}function WP(s,e){this.gState=s,this.matrix=e,this.id="",this.objectNumber=-1}function Bc(s,e,t,r,n){if(!(this instanceof Bc))return new Bc(s,e,t,r,n);this.type=s==="axial"?2:3,this.coords=e,this.colors=t,WP.call(this,r,n)}function wu(s,e,t,r,n){if(!(this instanceof wu))return new wu(s,e,t,r,n);this.boundingBox=s,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,WP.call(this,r,n)}function es(s){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],n=arguments[2],i=arguments[3],o=[],l=1,c=16,d="S",u=null;Ws(s=s||{})==="object"&&(t=s.orientation,r=s.unit||r,n=s.format||n,i=s.compress||s.compressPdf||i,(u=s.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof s.userUnit=="number"?Math.abs(s.userUnit):1,s.precision!==void 0&&(e=s.precision),s.floatPrecision!==void 0&&(c=s.floatPrecision),d=s.defaultPathOperation||"S"),o=s.filters||(i===!0?["FlateEncode"]:o),r=r||"mm",t=(""+(t||"P")).toLowerCase();var h=s.putOnlyUsedFonts||!1,m={},p={internal:{},__private__:{}};p.__private__.PubSub=I3;var x="1.3",w=p.__private__.getPdfVersion=function(){return x};p.__private__.setPdfVersion=function(_){x=_};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return S};var b=p.__private__.getPageFormat=function(_){return S[_]};n=n||"a4";var v={COMPAT:"compat",ADVANCED:"advanced"},N=v.COMPAT;function j(){this.saveGraphicsState(),oe(new ve(yt,0,0,-yt,0,uc()*yt).toString()+" cm"),this.setFontSize(this.getFontSize()/yt),d="n",N=v.ADVANCED}function E(){this.restoreGraphicsState(),d="S",N=v.COMPAT}var A=p.__private__.combineFontStyleAndFontWeight=function(_,G){if(_=="bold"&&G=="normal"||_=="bold"&&G==400||_=="normal"&&G=="italic"||_=="bold"&&G=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return G&&(_=G==400||G==="normal"?_==="italic"?"italic":"normal":G!=700&&G!=="bold"||_!=="normal"?(G==700?"bold":G)+""+_:"bold"),_};p.advancedAPI=function(_){var G=N===v.COMPAT;return G&&j.call(this),typeof _!="function"||(_(this),G&&E.call(this)),this},p.compatAPI=function(_){var G=N===v.ADVANCED;return G&&E.call(this),typeof _!="function"||(_(this),G&&j.call(this)),this},p.isAdvancedAPI=function(){return N===v.ADVANCED};var L,C=function(_){if(N!==v.ADVANCED)throw new Error(_+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=p.roundToPrecision=p.__private__.roundToPrecision=function(_,G){var ge=e||G;if(isNaN(_)||isNaN(ge))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return _.toFixed(ge).replace(/0+$/,"")};L=p.hpf=p.__private__.hpf=typeof c=="number"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return B(_,c)}:c==="smart"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return B(_,_>-1&&_<1?16:5)}:function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return B(_,16)};var U=p.f2=p.__private__.f2=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f2");return B(_,2)},P=p.__private__.f3=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f3");return B(_,3)},T=p.scale=p.__private__.scale=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.scale");return N===v.COMPAT?_*yt:N===v.ADVANCED?_:void 0},z=function(_){return N===v.COMPAT?uc()-_:N===v.ADVANCED?_:void 0},H=function(_){return T(z(_))};p.__private__.setPrecision=p.setPrecision=function(_){typeof parseInt(_,10)=="number"&&(e=parseInt(_,10))};var D,M="00000000000000000000000000000000",$=p.__private__.getFileId=function(){return M},q=p.__private__.setFileId=function(_){return M=_!==void 0&&/^[a-fA-F0-9]{32}$/.test(_)?_.toUpperCase():M.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(_n=new Mf(u.userPermissions,u.userPassword,u.ownerPassword,M)),M};p.setFileId=function(_){return q(_),this},p.getFileId=function(){return $()};var K=p.__private__.convertDateToPDFDate=function(_){var G=_.getTimezoneOffset(),ge=G<0?"+":"-",ke=Math.floor(Math.abs(G/60)),qe=Math.abs(G%60),rt=[ge,Z(ke),"'",Z(qe),"'"].join("");return["D:",_.getFullYear(),Z(_.getMonth()+1),Z(_.getDate()),Z(_.getHours()),Z(_.getMinutes()),Z(_.getSeconds()),rt].join("")},de=p.__private__.convertPDFDateToDate=function(_){var G=parseInt(_.substr(2,4),10),ge=parseInt(_.substr(6,2),10)-1,ke=parseInt(_.substr(8,2),10),qe=parseInt(_.substr(10,2),10),rt=parseInt(_.substr(12,2),10),vt=parseInt(_.substr(14,2),10);return new Date(G,ge,ke,qe,rt,vt,0)},Ne=p.__private__.setCreationDate=function(_){var G;if(_===void 0&&(_=new Date),_ instanceof Date)G=K(_);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(_))throw new Error("Invalid argument passed to jsPDF.setCreationDate");G=_}return D=G},R=p.__private__.getCreationDate=function(_){var G=D;return _==="jsDate"&&(G=de(D)),G};p.setCreationDate=function(_){return Ne(_),this},p.getCreationDate=function(_){return R(_)};var W,Z=p.__private__.padd2=function(_){return("0"+parseInt(_)).slice(-2)},ue=p.__private__.padd2Hex=function(_){return("00"+(_=_.toString())).substr(_.length)},ce=0,ye=[],Se=[],Ee=0,De=[],We=[],Je=!1,it=Se,Be=function(){ce=0,Ee=0,Se=[],ye=[],De=[],Ue=je(),Ie=je()};p.__private__.setCustomOutputDestination=function(_){Je=!0,it=_};var Te=function(_){Je||(it=_)};p.__private__.resetCustomOutputDestination=function(){Je=!1,it=Se};var oe=p.__private__.out=function(_){return _=_.toString(),Ee+=_.length+1,it.push(_),it},et=p.__private__.write=function(_){return oe(arguments.length===1?_.toString():Array.prototype.join.call(arguments," "))},pe=p.__private__.getArrayBuffer=function(_){for(var G=_.length,ge=new ArrayBuffer(G),ke=new Uint8Array(ge);G--;)ke[G]=_.charCodeAt(G);return ge},xe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return xe};var he=s.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(_){return he=N===v.ADVANCED?_/yt:_,this};var we,Ae=p.__private__.getFontSize=p.getFontSize=function(){return N===v.COMPAT?he:he*yt},Ze=s.R2L||!1;p.__private__.setR2L=p.setR2L=function(_){return Ze=_,this},p.__private__.getR2L=p.getR2L=function(){return Ze};var $e,Qe=p.__private__.setZoomMode=function(_){var G=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(_))we=_;else if(isNaN(_)){if(G.indexOf(_)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+_+'" is not recognized.');we=_}else we=parseInt(_,10)};p.__private__.getZoomMode=function(){return we};var lt,At=p.__private__.setPageMode=function(_){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(_)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+_+'" is not recognized.');$e=_};p.__private__.getPageMode=function(){return $e};var Nt=p.__private__.setLayoutMode=function(_){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(_)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+_+'" is not recognized.');lt=_};p.__private__.getLayoutMode=function(){return lt},p.__private__.setDisplayMode=p.setDisplayMode=function(_,G,ge){return Qe(_),Nt(G),At(ge),this};var Lt={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(_){if(Object.keys(Lt).indexOf(_)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Lt[_]},p.__private__.getDocumentProperties=function(){return Lt},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(_){for(var G in Lt)Lt.hasOwnProperty(G)&&_[G]&&(Lt[G]=_[G]);return this},p.__private__.setDocumentProperty=function(_,G){if(Object.keys(Lt).indexOf(_)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Lt[_]=G};var Dt,yt,os,me,Ce,dt={},O={},_e=[],at={},St={},Tt={},Pt={},kt=null,jt=0,Rt=[],Ot=new I3(p),Ps=s.hotfixes||[],Fs={},Os={},be=[],ve=function _(G,ge,ke,qe,rt,vt){if(!(this instanceof _))return new _(G,ge,ke,qe,rt,vt);isNaN(G)&&(G=1),isNaN(ge)&&(ge=0),isNaN(ke)&&(ke=0),isNaN(qe)&&(qe=1),isNaN(rt)&&(rt=0),isNaN(vt)&&(vt=0),this._matrix=[G,ge,ke,qe,rt,vt]};Object.defineProperty(ve.prototype,"sx",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(ve.prototype,"shy",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(ve.prototype,"shx",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(ve.prototype,"sy",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(ve.prototype,"tx",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(ve.prototype,"ty",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(ve.prototype,"a",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(ve.prototype,"b",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(ve.prototype,"c",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(ve.prototype,"d",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(ve.prototype,"e",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(ve.prototype,"f",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(ve.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ve.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ve.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ve.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ve.prototype.join=function(_){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(L).join(_)},ve.prototype.multiply=function(_){var G=_.sx*this.sx+_.shy*this.shx,ge=_.sx*this.shy+_.shy*this.sy,ke=_.shx*this.sx+_.sy*this.shx,qe=_.shx*this.shy+_.sy*this.sy,rt=_.tx*this.sx+_.ty*this.shx+this.tx,vt=_.tx*this.shy+_.ty*this.sy+this.ty;return new ve(G,ge,ke,qe,rt,vt)},ve.prototype.decompose=function(){var _=this.sx,G=this.shy,ge=this.shx,ke=this.sy,qe=this.tx,rt=this.ty,vt=Math.sqrt(_*_+G*G),$t=(_/=vt)*ge+(G/=vt)*ke;ge-=_*$t,ke-=G*$t;var Qt=Math.sqrt(ge*ge+ke*ke);return $t/=Qt,_*(ke/=Qt)<G*(ge/=Qt)&&(_=-_,G=-G,$t=-$t,vt=-vt),{scale:new ve(vt,0,0,Qt,0,0),translate:new ve(1,0,0,1,qe,rt),rotate:new ve(_,G,-G,_,0,0),skew:new ve(1,0,$t,1,0,0)}},ve.prototype.toString=function(_){return this.join(" ")},ve.prototype.inversed=function(){var _=this.sx,G=this.shy,ge=this.shx,ke=this.sy,qe=this.tx,rt=this.ty,vt=1/(_*ke-G*ge),$t=ke*vt,Qt=-G*vt,ms=-ge*vt,us=_*vt;return new ve($t,Qt,ms,us,-$t*qe-ms*rt,-Qt*qe-us*rt)},ve.prototype.applyToPoint=function(_){var G=_.x*this.sx+_.y*this.shx+this.tx,ge=_.x*this.shy+_.y*this.sy+this.ty;return new ef(G,ge)},ve.prototype.applyToRectangle=function(_){var G=this.applyToPoint(_),ge=this.applyToPoint(new ef(_.x+_.w,_.y+_.h));return new Fp(G.x,G.y,ge.x-G.x,ge.y-G.y)},ve.prototype.clone=function(){var _=this.sx,G=this.shy,ge=this.shx,ke=this.sy,qe=this.tx,rt=this.ty;return new ve(_,G,ge,ke,qe,rt)},p.Matrix=ve;var Ve=p.matrixMult=function(_,G){return G.multiply(_)},ct=new ve(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=ct;var Y=function(_,G){if(!St[_]){var ge=(G instanceof Bc?"Sh":"P")+(Object.keys(at).length+1).toString(10);G.id=ge,St[_]=ge,at[ge]=G,Ot.publish("addPattern",G)}};p.ShadingPattern=Bc,p.TilingPattern=wu,p.addShadingPattern=function(_,G){return C("addShadingPattern()"),Y(_,G),this},p.beginTilingPattern=function(_){C("beginTilingPattern()"),Rb(_.boundingBox[0],_.boundingBox[1],_.boundingBox[2]-_.boundingBox[0],_.boundingBox[3]-_.boundingBox[1],_.matrix)},p.endTilingPattern=function(_,G){C("endTilingPattern()"),G.stream=We[W].join(`
`),Y(_,G),Ot.publish("endTilingPattern",G),be.pop().restore()};var ie=p.__private__.newObject=function(){var _=je();return se(_,!0),_},je=p.__private__.newObjectDeferred=function(){return ce++,ye[ce]=function(){return Ee},ce},se=function(_,G){return G=typeof G=="boolean"&&G,ye[_]=Ee,G&&oe(_+" 0 obj"),_},le=p.__private__.newAdditionalObject=function(){var _={objId:je(),content:""};return De.push(_),_},Ue=je(),Ie=je(),He=p.__private__.decodeColorString=function(_){var G=_.split(" ");if(G.length!==2||G[1]!=="g"&&G[1]!=="G")G.length===5&&(G[4]==="k"||G[4]==="K")&&(G=[(1-G[0])*(1-G[3]),(1-G[1])*(1-G[3]),(1-G[2])*(1-G[3]),"r"]);else{var ge=parseFloat(G[0]);G=[ge,ge,ge,"r"]}for(var ke="#",qe=0;qe<3;qe++)ke+=("0"+Math.floor(255*parseFloat(G[qe])).toString(16)).slice(-2);return ke},Me=p.__private__.encodeColorString=function(_){var G;typeof _=="string"&&(_={ch1:_});var ge=_.ch1,ke=_.ch2,qe=_.ch3,rt=_.ch4,vt=_.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ge=="string"&&ge.charAt(0)!=="#"){var $t=new qP(ge);if($t.ok)ge=$t.toHex();else if(!/^\d*\.?\d*$/.test(ge))throw new Error('Invalid color "'+ge+'" passed to jsPDF.encodeColorString.')}if(typeof ge=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ge)&&(ge="#"+ge[1]+ge[1]+ge[2]+ge[2]+ge[3]+ge[3]),typeof ge=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ge)){var Qt=parseInt(ge.substr(1),16);ge=Qt>>16&255,ke=Qt>>8&255,qe=255&Qt}if(ke===void 0||rt===void 0&&ge===ke&&ke===qe)if(typeof ge=="string")G=ge+" "+vt[0];else switch(_.precision){case 2:G=U(ge/255)+" "+vt[0];break;case 3:default:G=P(ge/255)+" "+vt[0]}else if(rt===void 0||Ws(rt)==="object"){if(rt&&!isNaN(rt.a)&&rt.a===0)return G=["1.","1.","1.",vt[1]].join(" ");if(typeof ge=="string")G=[ge,ke,qe,vt[1]].join(" ");else switch(_.precision){case 2:G=[U(ge/255),U(ke/255),U(qe/255),vt[1]].join(" ");break;default:case 3:G=[P(ge/255),P(ke/255),P(qe/255),vt[1]].join(" ")}}else if(typeof ge=="string")G=[ge,ke,qe,rt,vt[2]].join(" ");else switch(_.precision){case 2:G=[U(ge),U(ke),U(qe),U(rt),vt[2]].join(" ");break;case 3:default:G=[P(ge),P(ke),P(qe),P(rt),vt[2]].join(" ")}return G},st=p.__private__.getFilters=function(){return o},ut=p.__private__.putStream=function(_){var G=(_=_||{}).data||"",ge=_.filters||st(),ke=_.alreadyAppliedFilters||[],qe=_.addLength1||!1,rt=G.length,vt=_.objectId,$t=function(Sn){return Sn};if(u!==null&&vt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&($t=_n.encryptor(vt,0));var Qt={};ge===!0&&(ge=["FlateEncode"]);var ms=_.additionalKeyValues||[],us=(Qt=es.API.processDataByFilters!==void 0?es.API.processDataByFilters(G,ge):{data:G,reverseChain:[]}).reverseChain+(Array.isArray(ke)?ke.join(" "):ke.toString());if(Qt.data.length!==0&&(ms.push({key:"Length",value:Qt.data.length}),qe===!0&&ms.push({key:"Length1",value:rt})),us.length!=0)if(us.split("/").length-1==1)ms.push({key:"Filter",value:us});else{ms.push({key:"Filter",value:"["+us+"]"});for(var Ls=0;Ls<ms.length;Ls+=1)if(ms[Ls].key==="DecodeParms"){for(var fr=[],vr=0;vr<Qt.reverseChain.split("/").length-1;vr+=1)fr.push("null");fr.push(ms[Ls].value),ms[Ls].value="["+fr.join(" ")+"]"}}oe("<<");for(var Dr=0;Dr<ms.length;Dr++)oe("/"+ms[Dr].key+" "+ms[Dr].value);oe(">>"),Qt.data.length!==0&&(oe("stream"),oe($t(Qt.data)),oe("endstream"))},wt=p.__private__.putPage=function(_){var G=_.number,ge=_.data,ke=_.objId,qe=_.contentsObjId;se(ke,!0),oe("<</Type /Page"),oe("/Parent "+_.rootDictionaryObjId+" 0 R"),oe("/Resources "+_.resourceDictionaryObjId+" 0 R"),oe("/MediaBox ["+parseFloat(L(_.mediaBox.bottomLeftX))+" "+parseFloat(L(_.mediaBox.bottomLeftY))+" "+L(_.mediaBox.topRightX)+" "+L(_.mediaBox.topRightY)+"]"),_.cropBox!==null&&oe("/CropBox ["+L(_.cropBox.bottomLeftX)+" "+L(_.cropBox.bottomLeftY)+" "+L(_.cropBox.topRightX)+" "+L(_.cropBox.topRightY)+"]"),_.bleedBox!==null&&oe("/BleedBox ["+L(_.bleedBox.bottomLeftX)+" "+L(_.bleedBox.bottomLeftY)+" "+L(_.bleedBox.topRightX)+" "+L(_.bleedBox.topRightY)+"]"),_.trimBox!==null&&oe("/TrimBox ["+L(_.trimBox.bottomLeftX)+" "+L(_.trimBox.bottomLeftY)+" "+L(_.trimBox.topRightX)+" "+L(_.trimBox.topRightY)+"]"),_.artBox!==null&&oe("/ArtBox ["+L(_.artBox.bottomLeftX)+" "+L(_.artBox.bottomLeftY)+" "+L(_.artBox.topRightX)+" "+L(_.artBox.topRightY)+"]"),typeof _.userUnit=="number"&&_.userUnit!==1&&oe("/UserUnit "+_.userUnit),Ot.publish("putPage",{objId:ke,pageContext:Rt[G],pageNumber:G,page:ge}),oe("/Contents "+qe+" 0 R"),oe(">>"),oe("endobj");var rt=ge.join(`
`);return N===v.ADVANCED&&(rt+=`
Q`),se(qe,!0),ut({data:rt,filters:st(),objectId:qe}),oe("endobj"),ke},xt=p.__private__.putPages=function(){var _,G,ge=[];for(_=1;_<=jt;_++)Rt[_].objId=je(),Rt[_].contentsObjId=je();for(_=1;_<=jt;_++)ge.push(wt({number:_,data:We[_],objId:Rt[_].objId,contentsObjId:Rt[_].contentsObjId,mediaBox:Rt[_].mediaBox,cropBox:Rt[_].cropBox,bleedBox:Rt[_].bleedBox,trimBox:Rt[_].trimBox,artBox:Rt[_].artBox,userUnit:Rt[_].userUnit,rootDictionaryObjId:Ue,resourceDictionaryObjId:Ie}));se(Ue,!0),oe("<</Type /Pages");var ke="/Kids [";for(G=0;G<jt;G++)ke+=ge[G]+" 0 R ";oe(ke+"]"),oe("/Count "+jt),oe(">>"),oe("endobj"),Ot.publish("postPutPages")},X=function(_){Ot.publish("putFont",{font:_,out:oe,newObject:ie,putStream:ut}),_.isAlreadyPutted!==!0&&(_.objectNumber=ie(),oe("<<"),oe("/Type /Font"),oe("/BaseFont /"+Ff(_.postScriptName)),oe("/Subtype /Type1"),typeof _.encoding=="string"&&oe("/Encoding /"+_.encoding),oe("/FirstChar 32"),oe("/LastChar 255"),oe(">>"),oe("endobj"))},Ke=function(){for(var _ in dt)dt.hasOwnProperty(_)&&(h===!1||h===!0&&m.hasOwnProperty(_))&&X(dt[_])},Oe=function(_){_.objectNumber=ie();var G=[];G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Form"}),G.push({key:"BBox",value:"["+[L(_.x),L(_.y),L(_.x+_.width),L(_.y+_.height)].join(" ")+"]"}),G.push({key:"Matrix",value:"["+_.matrix.toString()+"]"});var ge=_.pages[1].join(`
`);ut({data:ge,additionalKeyValues:G,objectId:_.objectNumber}),oe("endobj")},Xe=function(){for(var _ in Fs)Fs.hasOwnProperty(_)&&Oe(Fs[_])},nt=function(_,G){var ge,ke=[],qe=1/(G-1);for(ge=0;ge<1;ge+=qe)ke.push(ge);if(ke.push(1),_[0].offset!=0){var rt={offset:0,color:_[0].color};_.unshift(rt)}if(_[_.length-1].offset!=1){var vt={offset:1,color:_[_.length-1].color};_.push(vt)}for(var $t="",Qt=0,ms=0;ms<ke.length;ms++){for(ge=ke[ms];ge>_[Qt+1].offset;)Qt++;var us=_[Qt].offset,Ls=(ge-us)/(_[Qt+1].offset-us),fr=_[Qt].color,vr=_[Qt+1].color;$t+=ue(Math.round((1-Ls)*fr[0]+Ls*vr[0]).toString(16))+ue(Math.round((1-Ls)*fr[1]+Ls*vr[1]).toString(16))+ue(Math.round((1-Ls)*fr[2]+Ls*vr[2]).toString(16))}return $t.trim()},Et=function(_,G){G||(G=21);var ge=ie(),ke=nt(_.colors,G),qe=[];qe.push({key:"FunctionType",value:"0"}),qe.push({key:"Domain",value:"[0.0 1.0]"}),qe.push({key:"Size",value:"["+G+"]"}),qe.push({key:"BitsPerSample",value:"8"}),qe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ut({data:ke,additionalKeyValues:qe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ge}),oe("endobj"),_.objectNumber=ie(),oe("<< /ShadingType "+_.type),oe("/ColorSpace /DeviceRGB");var rt="/Coords ["+L(parseFloat(_.coords[0]))+" "+L(parseFloat(_.coords[1]))+" ";_.type===2?rt+=L(parseFloat(_.coords[2]))+" "+L(parseFloat(_.coords[3])):rt+=L(parseFloat(_.coords[2]))+" "+L(parseFloat(_.coords[3]))+" "+L(parseFloat(_.coords[4]))+" "+L(parseFloat(_.coords[5])),oe(rt+="]"),_.matrix&&oe("/Matrix ["+_.matrix.toString()+"]"),oe("/Function "+ge+" 0 R"),oe("/Extend [true true]"),oe(">>"),oe("endobj")},ot=function(_,G){var ge=je(),ke=ie();G.push({resourcesOid:ge,objectOid:ke}),_.objectNumber=ke;var qe=[];qe.push({key:"Type",value:"/Pattern"}),qe.push({key:"PatternType",value:"1"}),qe.push({key:"PaintType",value:"1"}),qe.push({key:"TilingType",value:"1"}),qe.push({key:"BBox",value:"["+_.boundingBox.map(L).join(" ")+"]"}),qe.push({key:"XStep",value:L(_.xStep)}),qe.push({key:"YStep",value:L(_.yStep)}),qe.push({key:"Resources",value:ge+" 0 R"}),_.matrix&&qe.push({key:"Matrix",value:"["+_.matrix.toString()+"]"}),ut({data:_.stream,additionalKeyValues:qe,objectId:_.objectNumber}),oe("endobj")},gt=function(_){var G;for(G in at)at.hasOwnProperty(G)&&(at[G]instanceof Bc?Et(at[G]):at[G]instanceof wu&&ot(at[G],_))},Fe=function(_){for(var G in _.objectNumber=ie(),oe("<<"),_)switch(G){case"opacity":oe("/ca "+U(_[G]));break;case"stroke-opacity":oe("/CA "+U(_[G]))}oe(">>"),oe("endobj")},ns=function(){var _;for(_ in Tt)Tt.hasOwnProperty(_)&&Fe(Tt[_])},Gt=function(){for(var _ in oe("/XObject <<"),Fs)Fs.hasOwnProperty(_)&&Fs[_].objectNumber>=0&&oe("/"+_+" "+Fs[_].objectNumber+" 0 R");Ot.publish("putXobjectDict"),oe(">>")},mt=function(){_n.oid=ie(),oe("<<"),oe("/Filter /Standard"),oe("/V "+_n.v),oe("/R "+_n.r),oe("/U <"+_n.toHexString(_n.U)+">"),oe("/O <"+_n.toHexString(_n.O)+">"),oe("/P "+_n.P),oe(">>"),oe("endobj")},Jt=function(){for(var _ in oe("/Font <<"),dt)dt.hasOwnProperty(_)&&(h===!1||h===!0&&m.hasOwnProperty(_))&&oe("/"+_+" "+dt[_].objectNumber+" 0 R");oe(">>")},ds=function(){if(Object.keys(at).length>0){for(var _ in oe("/Shading <<"),at)at.hasOwnProperty(_)&&at[_]instanceof Bc&&at[_].objectNumber>=0&&oe("/"+_+" "+at[_].objectNumber+" 0 R");Ot.publish("putShadingPatternDict"),oe(">>")}},ts=function(_){if(Object.keys(at).length>0){for(var G in oe("/Pattern <<"),at)at.hasOwnProperty(G)&&at[G]instanceof p.TilingPattern&&at[G].objectNumber>=0&&at[G].objectNumber<_&&oe("/"+G+" "+at[G].objectNumber+" 0 R");Ot.publish("putTilingPatternDict"),oe(">>")}},It=function(){if(Object.keys(Tt).length>0){var _;for(_ in oe("/ExtGState <<"),Tt)Tt.hasOwnProperty(_)&&Tt[_].objectNumber>=0&&oe("/"+_+" "+Tt[_].objectNumber+" 0 R");Ot.publish("putGStateDict"),oe(">>")}},fs=function(_){se(_.resourcesOid,!0),oe("<<"),oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Jt(),ds(),ts(_.objectOid),It(),Gt(),oe(">>"),oe("endobj")},Zs=function(){var _=[];Ke(),ns(),Xe(),gt(_),Ot.publish("putResources"),_.forEach(fs),fs({resourcesOid:Ie,objectOid:Number.MAX_SAFE_INTEGER}),Ot.publish("postPutResources")},Pa=function(){Ot.publish("putAdditionalObjects");for(var _=0;_<De.length;_++){var G=De[_];se(G.objId,!0),oe(G.content),oe("endobj")}Ot.publish("postPutAdditionalObjects")},lc=function(_){O[_.fontName]=O[_.fontName]||{},O[_.fontName][_.fontStyle]=_.id},Ei=function(_,G,ge,ke,qe){var rt={id:"F"+(Object.keys(dt).length+1).toString(10),postScriptName:_,fontName:G,fontStyle:ge,encoding:ke,isStandardFont:qe||!1,metadata:{}};return Ot.publish("addFont",{font:rt,instance:this}),dt[rt.id]=rt,lc(rt),rt.id},na=function(_){for(var G=0,ge=xe.length;G<ge;G++){var ke=Ei.call(this,_[G][0],_[G][1],_[G][2],xe[G][3],!0);h===!1&&(m[ke]=!0);var qe=_[G][0].split("-");lc({id:ke,fontName:qe[0],fontStyle:qe[1]||""})}Ot.publish("addFonts",{fonts:dt,dictionary:O})},Ta=function(_){return _.foo=function(){try{return _.apply(this,arguments)}catch(ke){var G=ke.stack||"";~G.indexOf(" at ")&&(G=G.split(" at ")[1]);var ge="Error in function "+G.split(`
`)[0].split("<")[0]+": "+ke.message;if(!is.console)throw new Error(ge);is.console.error(ge,ke),is.alert&&alert(ge)}},_.foo.bar=_,_.foo},Yh=function(_,G){var ge,ke,qe,rt,vt,$t,Qt,ms,us;if(qe=(G=G||{}).sourceEncoding||"Unicode",vt=G.outputEncoding,(G.autoencode||vt)&&dt[Dt].metadata&&dt[Dt].metadata[qe]&&dt[Dt].metadata[qe].encoding&&(rt=dt[Dt].metadata[qe].encoding,!vt&&dt[Dt].encoding&&(vt=dt[Dt].encoding),!vt&&rt.codePages&&(vt=rt.codePages[0]),typeof vt=="string"&&(vt=rt[vt]),vt)){for(Qt=!1,$t=[],ge=0,ke=_.length;ge<ke;ge++)(ms=vt[_.charCodeAt(ge)])?$t.push(String.fromCharCode(ms)):$t.push(_[ge]),$t[ge].charCodeAt(0)>>8&&(Qt=!0);_=$t.join("")}for(ge=_.length;Qt===void 0&&ge!==0;)_.charCodeAt(ge-1)>>8&&(Qt=!0),ge--;if(!Qt)return _;for($t=G.noBOM?[]:[254,255],ge=0,ke=_.length;ge<ke;ge++){if((us=(ms=_.charCodeAt(ge))>>8)>>8)throw new Error("Character at position "+ge+" of string '"+_+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");$t.push(us),$t.push(ms-(us<<8))}return String.fromCharCode.apply(void 0,$t)},ci=p.__private__.pdfEscape=p.pdfEscape=function(_,G){return Yh(_,G).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ep=p.__private__.beginPage=function(_){We[++jt]=[],Rt[jt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(_[0]),topRightY:Number(_[1])}},_b(jt),Te(We[W])},Nb=function(_,G){var ge,ke,qe;switch(t=G||t,typeof _=="string"&&(ge=b(_.toLowerCase()),Array.isArray(ge)&&(ke=ge[0],qe=ge[1])),Array.isArray(_)&&(ke=_[0]*yt,qe=_[1]*yt),isNaN(ke)&&(ke=n[0],qe=n[1]),(ke>14400||qe>14400)&&(Js.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ke=Math.min(14400,ke),qe=Math.min(14400,qe)),n=[ke,qe],t.substr(0,1)){case"l":qe>ke&&(n=[qe,ke]);break;case"p":ke>qe&&(n=[qe,ke])}Ep(n),Eb(Ip),oe(Ia),Dp!==0&&oe(Dp+" J"),Mp!==0&&oe(Mp+" j"),Ot.publish("addPage",{pageNumber:jt})},C2=function(_){_>0&&_<=jt&&(We.splice(_,1),Rt.splice(_,1),jt--,W>jt&&(W=jt),this.setPage(W))},_b=function(_){_>0&&_<=jt&&(W=_)},E2=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return We.length-1},Sb=function(_,G,ge){var ke,qe=void 0;return ge=ge||{},_=_!==void 0?_:dt[Dt].fontName,G=G!==void 0?G:dt[Dt].fontStyle,ke=_.toLowerCase(),O[ke]!==void 0&&O[ke][G]!==void 0?qe=O[ke][G]:O[_]!==void 0&&O[_][G]!==void 0?qe=O[_][G]:ge.disableWarning===!1&&Js.warn("Unable to look up font label for font '"+_+"', '"+G+"'. Refer to getFontList() for available fonts."),qe||ge.noFallback||(qe=O.times[G])==null&&(qe=O.times.normal),qe},L2=p.__private__.putInfo=function(){var _=ie(),G=function(ke){return ke};for(var ge in u!==null&&(G=_n.encryptor(_,0)),oe("<<"),oe("/Producer ("+ci(G("jsPDF "+es.version))+")"),Lt)Lt.hasOwnProperty(ge)&&Lt[ge]&&oe("/"+ge.substr(0,1).toUpperCase()+ge.substr(1)+" ("+ci(G(Lt[ge]))+")");oe("/CreationDate ("+ci(G(D))+")"),oe(">>"),oe("endobj")},Lp=p.__private__.putCatalog=function(_){var G=(_=_||{}).rootDictionaryObjId||Ue;switch(ie(),oe("<<"),oe("/Type /Catalog"),oe("/Pages "+G+" 0 R"),we||(we="fullwidth"),we){case"fullwidth":oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":oe("/OpenAction [3 0 R /Fit]");break;case"original":oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ge=""+we;ge.substr(ge.length-1)==="%"&&(we=parseInt(we)/100),typeof we=="number"&&oe("/OpenAction [3 0 R /XYZ null null "+U(we)+"]")}switch(lt||(lt="continuous"),lt){case"continuous":oe("/PageLayout /OneColumn");break;case"single":oe("/PageLayout /SinglePage");break;case"two":case"twoleft":oe("/PageLayout /TwoColumnLeft");break;case"tworight":oe("/PageLayout /TwoColumnRight")}$e&&oe("/PageMode /"+$e),Ot.publish("putCatalog"),oe(">>"),oe("endobj")},P2=p.__private__.putTrailer=function(){oe("trailer"),oe("<<"),oe("/Size "+(ce+1)),oe("/Root "+ce+" 0 R"),oe("/Info "+(ce-1)+" 0 R"),u!==null&&oe("/Encrypt "+_n.oid+" 0 R"),oe("/ID [ <"+M+"> <"+M+"> ]"),oe(">>")},T2=p.__private__.putHeader=function(){oe("%PDF-"+x),oe("%ºß¬à")},I2=p.__private__.putXRef=function(){var _="0000000000";oe("xref"),oe("0 "+(ce+1)),oe("0000000000 65535 f ");for(var G=1;G<=ce;G++)typeof ye[G]=="function"?oe((_+ye[G]()).slice(-10)+" 00000 n "):ye[G]!==void 0?oe((_+ye[G]).slice(-10)+" 00000 n "):oe("0000000000 00000 n ")},sl=p.__private__.buildDocument=function(){Be(),Te(Se),Ot.publish("buildDocument"),T2(),xt(),Pa(),Zs(),u!==null&&mt(),L2(),Lp();var _=Ee;return I2(),P2(),oe("startxref"),oe(""+_),oe("%%EOF"),Te(We[W]),Se.join(`
`)},Kh=p.__private__.getBlob=function(_){return new Blob([pe(_)],{type:"application/pdf"})},Xh=p.output=p.__private__.output=Ta(function(_,G){switch(typeof(G=G||{})=="string"?G={filename:G}:G.filename=G.filename||"generated.pdf",_){case void 0:return sl();case"save":p.save(G.filename);break;case"arraybuffer":return pe(sl());case"blob":return Kh(sl());case"bloburi":case"bloburl":if(is.URL!==void 0&&typeof is.URL.createObjectURL=="function")return is.URL&&is.URL.createObjectURL(Kh(sl()))||void 0;Js.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ge="",ke=sl();try{ge=K_(ke)}catch{ge=K_(unescape(encodeURIComponent(ke)))}return"data:application/pdf;filename="+G.filename+";base64,"+ge;case"pdfobjectnewwindow":if(Object.prototype.toString.call(is)==="[object Window]"){var qe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",rt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';G.pdfObjectUrl&&(qe=G.pdfObjectUrl,rt="");var vt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+qe+'"'+rt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(G)+");<\/script></body></html>",$t=is.open();return $t!==null&&$t.document.write(vt),$t}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(is)==="[object Window]"){var Qt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(G.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+G.filename+'" width="500px" height="400px" /></body></html>',ms=is.open();if(ms!==null){ms.document.write(Qt);var us=this;ms.document.documentElement.querySelector("#pdfViewer").onload=function(){ms.document.title=G.filename,ms.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(us.output("bloburl"))}}return ms}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(is)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ls='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",G)+'"></iframe></body></html>',fr=is.open();if(fr!==null&&(fr.document.write(Ls),fr.document.title=G.filename),fr||typeof safari>"u")return fr;break;case"datauri":case"dataurl":return is.document.location.href=this.output("datauristring",G);default:return null}}),jb=function(_){return Array.isArray(Ps)===!0&&Ps.indexOf(_)>-1};switch(r){case"pt":yt=1;break;case"mm":yt=72/25.4;break;case"cm":yt=72/2.54;break;case"in":yt=72;break;case"px":yt=jb("px_scaling")==1?.75:96/72;break;case"pc":case"em":yt=12;break;case"ex":yt=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);yt=r}var _n=null;Ne(),q();var R2=function(_){return u!==null?_n.encryptor(_,0):function(G){return G}},Ab=p.__private__.getPageInfo=p.getPageInfo=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Rt[_].objId,pageNumber:_,pageContext:Rt[_]}},cs=p.__private__.getPageInfoByObjId=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var G in Rt)if(Rt[G].objId===_)break;return Ab(G)},D2=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Rt[W].objId,pageNumber:W,pageContext:Rt[W]}};p.addPage=function(){return Nb.apply(this,arguments),this},p.setPage=function(){return _b.apply(this,arguments),Te.call(this,We[W]),this},p.insertPage=function(_){return this.addPage(),this.movePage(W,_),this},p.movePage=function(_,G){var ge,ke;if(_>G){ge=We[_],ke=Rt[_];for(var qe=_;qe>G;qe--)We[qe]=We[qe-1],Rt[qe]=Rt[qe-1];We[G]=ge,Rt[G]=ke,this.setPage(G)}else if(_<G){ge=We[_],ke=Rt[_];for(var rt=_;rt<G;rt++)We[rt]=We[rt+1],Rt[rt]=Rt[rt+1];We[G]=ge,Rt[G]=ke,this.setPage(G)}return this},p.deletePage=function(){return C2.apply(this,arguments),this},p.__private__.text=p.text=function(_,G,ge,ke,qe){var rt,vt,$t,Qt,ms,us,Ls,fr,vr,Dr=(ke=ke||{}).scope||this;if(typeof _=="number"&&typeof G=="number"&&(typeof ge=="string"||Array.isArray(ge))){var Sn=ge;ge=G,G=_,_=Sn}if(arguments[3]instanceof ve?(C("The transform parameter of text() with a Matrix value"),vr=qe):($t=arguments[4],Qt=arguments[5],Ws(Ls=arguments[3])==="object"&&Ls!==null||(typeof $t=="string"&&(Qt=$t,$t=null),typeof Ls=="string"&&(Qt=Ls,Ls=null),typeof Ls=="number"&&($t=Ls,Ls=null),ke={flags:Ls,angle:$t,align:Qt})),isNaN(G)||isNaN(ge)||_==null)throw new Error("Invalid arguments passed to jsPDF.text");if(_.length===0)return Dr;var en="",Ra=!1,Li=typeof ke.lineHeightFactor=="number"?ke.lineHeightFactor:Gd,yo=Dr.internal.scaleFactor;function Db(er){return er=er.split("	").join(Array(ke.TabLen||9).join(" ")),ci(er,Ls)}function zp(er){for(var tr,Ar=er.concat(),qr=[],ol=Ar.length;ol--;)typeof(tr=Ar.shift())=="string"?qr.push(tr):Array.isArray(er)&&(tr.length===1||tr[1]===void 0&&tr[2]===void 0)?qr.push(tr[0]):qr.push([tr[0],tr[1],tr[2]]);return qr}function Up(er,tr){var Ar;if(typeof er=="string")Ar=tr(er)[0];else if(Array.isArray(er)){for(var qr,ol,Xp=er.concat(),hf=[],$b=Xp.length;$b--;)typeof(qr=Xp.shift())=="string"?hf.push(tr(qr)[0]):Array.isArray(qr)&&typeof qr[0]=="string"&&(ol=tr(qr[0],qr[1],qr[2]),hf.push([ol[0],ol[1],ol[2]]));Ar=hf}return Ar}var sf=!1,qp=!0;if(typeof _=="string")sf=!0;else if(Array.isArray(_)){var Hp=_.concat();vt=[];for(var rf,hn=Hp.length;hn--;)(typeof(rf=Hp.shift())!="string"||Array.isArray(rf)&&typeof rf[0]!="string")&&(qp=!1);sf=qp}if(sf===!1)throw new Error('Type of text must be string or Array. "'+_+'" is not recognized.');typeof _=="string"&&(_=_.match(/[\r?\n]/)?_.split(/\r\n|\r|\n/g):[_]);var nf=he/Dr.internal.scaleFactor,af=nf*(Li-1);switch(ke.baseline){case"bottom":ge-=af;break;case"top":ge+=nf-af;break;case"hanging":ge+=nf-2*af;break;case"middle":ge+=nf/2-af}if((us=ke.maxWidth||0)>0&&(typeof _=="string"?_=Dr.splitTextToSize(_,us):Object.prototype.toString.call(_)==="[object Array]"&&(_=_.reduce(function(er,tr){return er.concat(Dr.splitTextToSize(tr,us))},[]))),rt={text:_,x:G,y:ge,options:ke,mutex:{pdfEscape:ci,activeFontKey:Dt,fonts:dt,activeFontSize:he}},Ot.publish("preProcessText",rt),_=rt.text,$t=(ke=rt.options).angle,!(vr instanceof ve)&&$t&&typeof $t=="number"){$t*=Math.PI/180,ke.rotationDirection===0&&($t=-$t),N===v.ADVANCED&&($t=-$t);var of=Math.cos($t),Wp=Math.sin($t);vr=new ve(of,Wp,-Wp,of,0,0)}else $t&&$t instanceof ve&&(vr=$t);N!==v.ADVANCED||vr||(vr=ct),(ms=ke.charSpace||Zh)!==void 0&&(en+=L(T(ms))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(fr=ke.horizontalScale)!==void 0&&(en+=L(100*fr)+` Tz
`),ke.lang;var di=-1,W2=ke.renderingMode!==void 0?ke.renderingMode:ke.stroke,Vp=Dr.internal.getCurrentPageInfo().pageContext;switch(W2){case 0:case!1:case"fill":di=0;break;case 1:case!0:case"stroke":di=1;break;case 2:case"fillThenStroke":di=2;break;case 3:case"invisible":di=3;break;case 4:case"fillAndAddForClipping":di=4;break;case 5:case"strokeAndAddPathForClipping":di=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":di=6;break;case 7:case"addToPathForClipping":di=7}var Mb=Vp.usedRenderingMode!==void 0?Vp.usedRenderingMode:-1;di!==-1?en+=di+` Tr
`:Mb!==-1&&(en+=`0 Tr
`),di!==-1&&(Vp.usedRenderingMode=di),Qt=ke.align||"left";var ia,lf=he*Li,Fb=Dr.internal.pageSize.getWidth(),Ob=dt[Dt];ms=ke.charSpace||Zh,us=ke.maxWidth||0,Ls=Object.assign({autoencode:!0,noBOM:!0},ke.flags);var hc=[],Xd=function(er){return Dr.getStringUnitWidth(er,{font:Ob,charSpace:ms,fontSize:he,doKerning:!1})*he/yo};if(Object.prototype.toString.call(_)==="[object Array]"){var ui;vt=zp(_),Qt!=="left"&&(ia=vt.map(Xd));var Hn,fc=0;if(Qt==="right"){G-=ia[0],_=[],hn=vt.length;for(var nl=0;nl<hn;nl++)nl===0?(Hn=bo(G),ui=rl(ge)):(Hn=T(fc-ia[nl]),ui=-lf),_.push([vt[nl],Hn,ui]),fc=ia[nl]}else if(Qt==="center"){G-=ia[0]/2,_=[],hn=vt.length;for(var il=0;il<hn;il++)il===0?(Hn=bo(G),ui=rl(ge)):(Hn=T((fc-ia[il])/2),ui=-lf),_.push([vt[il],Hn,ui]),fc=ia[il]}else if(Qt==="left"){_=[],hn=vt.length;for(var cf=0;cf<hn;cf++)_.push(vt[cf])}else if(Qt==="justify"&&Ob.encoding==="Identity-H"){_=[],hn=vt.length,us=us!==0?us:Fb;for(var al=0,jr=0;jr<hn;jr++)if(ui=jr===0?rl(ge):-lf,Hn=jr===0?bo(G):al,jr<hn-1){var Gp=T((us-ia[jr])/(vt[jr].split(" ").length-1)),Wn=vt[jr].split(" ");_.push([Wn[0]+" ",Hn,ui]),al=0;for(var aa=1;aa<Wn.length;aa++){var df=(Xd(Wn[aa-1]+" "+Wn[aa])-Xd(Wn[aa]))*yo+Gp;aa==Wn.length-1?_.push([Wn[aa],df,0]):_.push([Wn[aa]+" ",df,0]),al-=df}}else _.push([vt[jr],Hn,ui]);_.push(["",al,0])}else{if(Qt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(_=[],hn=vt.length,us=us!==0?us:Fb,jr=0;jr<hn;jr++)ui=jr===0?rl(ge):-lf,Hn=jr===0?bo(G):0,jr<hn-1?hc.push(L(T((us-ia[jr])/(vt[jr].split(" ").length-1)))):hc.push(0),_.push([vt[jr],Hn,ui])}}var Bb=typeof ke.R2L=="boolean"?ke.R2L:Ze;Bb===!0&&(_=Up(_,function(er,tr,Ar){return[er.split("").reverse().join(""),tr,Ar]})),rt={text:_,x:G,y:ge,options:ke,mutex:{pdfEscape:ci,activeFontKey:Dt,fonts:dt,activeFontSize:he}},Ot.publish("postProcessText",rt),_=rt.text,Ra=rt.mutex.isHex||!1;var Yp=dt[Dt].encoding;Yp!=="WinAnsiEncoding"&&Yp!=="StandardEncoding"||(_=Up(_,function(er,tr,Ar){return[Db(er),tr,Ar]})),vt=zp(_),_=[];for(var Jd,Qd,mc,Zd=0,uf=1,eu=Array.isArray(vt[0])?uf:Zd,pc="",Kp=function(er,tr,Ar){var qr="";return Ar instanceof ve?(Ar=typeof ke.angle=="number"?Ve(Ar,new ve(1,0,0,1,er,tr)):Ve(new ve(1,0,0,1,er,tr),Ar),N===v.ADVANCED&&(Ar=Ve(new ve(1,0,0,-1,0,0),Ar)),qr=Ar.join(" ")+` Tm
`):qr=L(er)+" "+L(tr)+` Td
`,qr},oa=0;oa<vt.length;oa++){switch(pc="",eu){case uf:mc=(Ra?"<":"(")+vt[oa][0]+(Ra?">":")"),Jd=parseFloat(vt[oa][1]),Qd=parseFloat(vt[oa][2]);break;case Zd:mc=(Ra?"<":"(")+vt[oa]+(Ra?">":")"),Jd=bo(G),Qd=rl(ge)}hc!==void 0&&hc[oa]!==void 0&&(pc=hc[oa]+` Tw
`),oa===0?_.push(pc+Kp(Jd,Qd,vr)+mc):eu===Zd?_.push(pc+mc):eu===uf&&_.push(pc+Kp(Jd,Qd,vr)+mc)}_=eu===Zd?_.join(` Tj
T* `):_.join(` Tj
`),_+=` Tj
`;var la=`BT
/`;return la+=Dt+" "+he+` Tf
`,la+=L(he*Li)+` TL
`,la+=Yd+`
`,la+=en,la+=_,oe(la+="ET"),m[Dt]=!0,Dr};var M2=p.__private__.clip=p.clip=function(_){return oe(_==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return M2("evenodd")},p.__private__.discardPath=p.discardPath=function(){return oe("n"),this};var xo=p.__private__.isValidStyle=function(_){var G=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(_)!==-1&&(G=!0),G};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(_){return xo(_)&&(d=_),this};var kb=p.__private__.getStyle=p.getStyle=function(_){var G=d;switch(_){case"D":case"S":G="S";break;case"F":G="f";break;case"FD":case"DF":G="B";break;case"f":case"f*":case"B":case"B*":G=_}return G},Cb=p.close=function(){return oe("h"),this};p.stroke=function(){return oe("S"),this},p.fill=function(_){return Jh("f",_),this},p.fillEvenOdd=function(_){return Jh("f*",_),this},p.fillStroke=function(_){return Jh("B",_),this},p.fillStrokeEvenOdd=function(_){return Jh("B*",_),this};var Jh=function(_,G){Ws(G)==="object"?O2(G,_):oe(_)},Pp=function(_){_===null||N===v.ADVANCED&&_===void 0||(_=kb(_),oe(_))};function F2(_,G,ge,ke,qe){var rt=new wu(G||this.boundingBox,ge||this.xStep,ke||this.yStep,this.gState,qe||this.matrix);rt.stream=this.stream;var vt=_+"$$"+this.cloneIndex+++"$$";return Y(vt,rt),rt}var O2=function(_,G){var ge=St[_.key],ke=at[ge];if(ke instanceof Bc)oe("q"),oe(B2(G)),ke.gState&&p.setGState(ke.gState),oe(_.matrix.toString()+" cm"),oe("/"+ge+" sh"),oe("Q");else if(ke instanceof wu){var qe=new ve(1,0,0,-1,0,uc());_.matrix&&(qe=qe.multiply(_.matrix||ct),ge=F2.call(ke,_.key,_.boundingBox,_.xStep,_.yStep,qe).id),oe("q"),oe("/Pattern cs"),oe("/"+ge+" scn"),ke.gState&&p.setGState(ke.gState),oe(G),oe("Q")}},B2=function(_){switch(_){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Tp=p.moveTo=function(_,G){return oe(L(T(_))+" "+L(H(G))+" m"),this},Vd=p.lineTo=function(_,G){return oe(L(T(_))+" "+L(H(G))+" l"),this},cc=p.curveTo=function(_,G,ge,ke,qe,rt){return oe([L(T(_)),L(H(G)),L(T(ge)),L(H(ke)),L(T(qe)),L(H(rt)),"c"].join(" ")),this};p.__private__.line=p.line=function(_,G,ge,ke,qe){if(isNaN(_)||isNaN(G)||isNaN(ge)||isNaN(ke)||!xo(qe))throw new Error("Invalid arguments passed to jsPDF.line");return N===v.COMPAT?this.lines([[ge-_,ke-G]],_,G,[1,1],qe||"S"):this.lines([[ge-_,ke-G]],_,G,[1,1]).stroke()},p.__private__.lines=p.lines=function(_,G,ge,ke,qe,rt){var vt,$t,Qt,ms,us,Ls,fr,vr,Dr,Sn,en,Ra;if(typeof _=="number"&&(Ra=ge,ge=G,G=_,_=Ra),ke=ke||[1,1],rt=rt||!1,isNaN(G)||isNaN(ge)||!Array.isArray(_)||!Array.isArray(ke)||!xo(qe)||typeof rt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Tp(G,ge),vt=ke[0],$t=ke[1],ms=_.length,Sn=G,en=ge,Qt=0;Qt<ms;Qt++)(us=_[Qt]).length===2?(Sn=us[0]*vt+Sn,en=us[1]*$t+en,Vd(Sn,en)):(Ls=us[0]*vt+Sn,fr=us[1]*$t+en,vr=us[2]*vt+Sn,Dr=us[3]*$t+en,Sn=us[4]*vt+Sn,en=us[5]*$t+en,cc(Ls,fr,vr,Dr,Sn,en));return rt&&Cb(),Pp(qe),this},p.path=function(_){for(var G=0;G<_.length;G++){var ge=_[G],ke=ge.c;switch(ge.op){case"m":Tp(ke[0],ke[1]);break;case"l":Vd(ke[0],ke[1]);break;case"c":cc.apply(this,ke);break;case"h":Cb()}}return this},p.__private__.rect=p.rect=function(_,G,ge,ke,qe){if(isNaN(_)||isNaN(G)||isNaN(ge)||isNaN(ke)||!xo(qe))throw new Error("Invalid arguments passed to jsPDF.rect");return N===v.COMPAT&&(ke=-ke),oe([L(T(_)),L(H(G)),L(T(ge)),L(T(ke)),"re"].join(" ")),Pp(qe),this},p.__private__.triangle=p.triangle=function(_,G,ge,ke,qe,rt,vt){if(isNaN(_)||isNaN(G)||isNaN(ge)||isNaN(ke)||isNaN(qe)||isNaN(rt)||!xo(vt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ge-_,ke-G],[qe-ge,rt-ke],[_-qe,G-rt]],_,G,[1,1],vt,!0),this},p.__private__.roundedRect=p.roundedRect=function(_,G,ge,ke,qe,rt,vt){if(isNaN(_)||isNaN(G)||isNaN(ge)||isNaN(ke)||isNaN(qe)||isNaN(rt)||!xo(vt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var $t=4/3*(Math.SQRT2-1);return qe=Math.min(qe,.5*ge),rt=Math.min(rt,.5*ke),this.lines([[ge-2*qe,0],[qe*$t,0,qe,rt-rt*$t,qe,rt],[0,ke-2*rt],[0,rt*$t,-qe*$t,rt,-qe,rt],[2*qe-ge,0],[-qe*$t,0,-qe,-rt*$t,-qe,-rt],[0,2*rt-ke],[0,-rt*$t,qe*$t,-rt,qe,-rt]],_+qe,G,[1,1],vt,!0),this},p.__private__.ellipse=p.ellipse=function(_,G,ge,ke,qe){if(isNaN(_)||isNaN(G)||isNaN(ge)||isNaN(ke)||!xo(qe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var rt=4/3*(Math.SQRT2-1)*ge,vt=4/3*(Math.SQRT2-1)*ke;return Tp(_+ge,G),cc(_+ge,G-vt,_+rt,G-ke,_,G-ke),cc(_-rt,G-ke,_-ge,G-vt,_-ge,G),cc(_-ge,G+vt,_-rt,G+ke,_,G+ke),cc(_+rt,G+ke,_+ge,G+vt,_+ge,G),Pp(qe),this},p.__private__.circle=p.circle=function(_,G,ge,ke){if(isNaN(_)||isNaN(G)||isNaN(ge)||!xo(ke))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(_,G,ge,ge,ke)},p.setFont=function(_,G,ge){return ge&&(G=A(G,ge)),Dt=Sb(_,G,{disableWarning:!1}),this};var $2=p.__private__.getFont=p.getFont=function(){return dt[Sb.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var _,G,ge={};for(_ in O)if(O.hasOwnProperty(_))for(G in ge[_]=[],O[_])O[_].hasOwnProperty(G)&&ge[_].push(G);return ge},p.addFont=function(_,G,ge,ke,qe){var rt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&rt.indexOf(arguments[3])!==-1?qe=arguments[3]:arguments[3]&&rt.indexOf(arguments[3])==-1&&(ge=A(ge,ke)),qe=qe||"Identity-H",Ei.call(this,_,G,ge,qe)};var Gd,Ip=s.lineWidth||.200025,Qh=p.__private__.getLineWidth=p.getLineWidth=function(){return Ip},Eb=p.__private__.setLineWidth=p.setLineWidth=function(_){return Ip=_,oe(L(T(_))+" w"),this};p.__private__.setLineDash=es.API.setLineDash=es.API.setLineDashPattern=function(_,G){if(_=_||[],G=G||0,isNaN(G)||!Array.isArray(_))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return _=_.map(function(ge){return L(T(ge))}).join(" "),G=L(T(G)),oe("["+_+"] "+G+" d"),this};var Lb=p.__private__.getLineHeight=p.getLineHeight=function(){return he*Gd};p.__private__.getLineHeight=p.getLineHeight=function(){return he*Gd};var Pb=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(_){return typeof(_=_||1.15)=="number"&&(Gd=_),this},Tb=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Gd};Pb(s.lineHeight);var bo=p.__private__.getHorizontalCoordinate=function(_){return T(_)},rl=p.__private__.getVerticalCoordinate=function(_){return N===v.ADVANCED?_:Rt[W].mediaBox.topRightY-Rt[W].mediaBox.bottomLeftY-T(_)},z2=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(_){return L(bo(_))},dc=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(_){return L(rl(_))},Ia=s.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return He(Ia)},p.__private__.setStrokeColor=p.setDrawColor=function(_,G,ge,ke){return Ia=Me({ch1:_,ch2:G,ch3:ge,ch4:ke,pdfColorType:"draw",precision:2}),oe(Ia),this};var Rp=s.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return He(Rp)},p.__private__.setFillColor=p.setFillColor=function(_,G,ge,ke){return Rp=Me({ch1:_,ch2:G,ch3:ge,ch4:ke,pdfColorType:"fill",precision:2}),oe(Rp),this};var Yd=s.textColor||"0 g",U2=p.__private__.getTextColor=p.getTextColor=function(){return He(Yd)};p.__private__.setTextColor=p.setTextColor=function(_,G,ge,ke){return Yd=Me({ch1:_,ch2:G,ch3:ge,ch4:ke,pdfColorType:"text",precision:3}),this};var Zh=s.charSpace,q2=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Zh||0)};p.__private__.setCharSpace=p.setCharSpace=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Zh=_,this};var Dp=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(_){var G=p.CapJoinStyles[_];if(G===void 0)throw new Error("Line cap style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Dp=G,oe(G+" J"),this};var Mp=0;p.__private__.setLineJoin=p.setLineJoin=function(_){var G=p.CapJoinStyles[_];if(G===void 0)throw new Error("Line join style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Mp=G,oe(G+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(_){if(_=_||0,isNaN(_))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return oe(L(T(_))+" M"),this},p.GState=Og,p.setGState=function(_){(_=typeof _=="string"?Tt[Pt[_]]:Ib(null,_)).equals(kt)||(oe("/"+_.id+" gs"),kt=_)};var Ib=function(_,G){if(!_||!Pt[_]){var ge=!1;for(var ke in Tt)if(Tt.hasOwnProperty(ke)&&Tt[ke].equals(G)){ge=!0;break}if(ge)G=Tt[ke];else{var qe="GS"+(Object.keys(Tt).length+1).toString(10);Tt[qe]=G,G.id=qe}return _&&(Pt[_]=G.id),Ot.publish("addGState",G),G}};p.addGState=function(_,G){return Ib(_,G),this},p.saveGraphicsState=function(){return oe("q"),_e.push({key:Dt,size:he,color:Yd}),this},p.restoreGraphicsState=function(){oe("Q");var _=_e.pop();return Dt=_.key,he=_.size,Yd=_.color,kt=null,this},p.setCurrentTransformationMatrix=function(_){return oe(_.toString()+" cm"),this},p.comment=function(_){return oe("#"+_),this};var ef=function(_,G){var ge=_||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ge},set:function(rt){isNaN(rt)||(ge=parseFloat(rt))}});var ke=G||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ke},set:function(rt){isNaN(rt)||(ke=parseFloat(rt))}});var qe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return qe},set:function(rt){qe=rt.toString()}}),this},Fp=function(_,G,ge,ke){ef.call(this,_,G),this.type="rect";var qe=ge||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return qe},set:function(vt){isNaN(vt)||(qe=parseFloat(vt))}});var rt=ke||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return rt},set:function(vt){isNaN(vt)||(rt=parseFloat(vt))}}),this},Op=function(){this.page=jt,this.currentPage=W,this.pages=We.slice(0),this.pagesContext=Rt.slice(0),this.x=os,this.y=me,this.matrix=Ce,this.width=Kd(W),this.height=uc(W),this.outputDestination=it,this.id="",this.objectNumber=-1};Op.prototype.restore=function(){jt=this.page,W=this.currentPage,Rt=this.pagesContext,We=this.pages,os=this.x,me=this.y,Ce=this.matrix,Bp(W,this.width),$p(W,this.height),it=this.outputDestination};var Rb=function(_,G,ge,ke,qe){be.push(new Op),jt=W=0,We=[],os=_,me=G,Ce=qe,Ep([ge,ke])},H2=function(_){if(Os[_])be.pop().restore();else{var G=new Op,ge="Xo"+(Object.keys(Fs).length+1).toString(10);G.id=ge,Os[_]=ge,Fs[ge]=G,Ot.publish("addFormObject",G),be.pop().restore()}};for(var tf in p.beginFormObject=function(_,G,ge,ke,qe){return Rb(_,G,ge,ke,qe),this},p.endFormObject=function(_){return H2(_),this},p.doFormObject=function(_,G){var ge=Fs[Os[_]];return oe("q"),oe(G.toString()+" cm"),oe("/"+ge.id+" Do"),oe("Q"),this},p.getFormObject=function(_){var G=Fs[Os[_]];return{x:G.x,y:G.y,width:G.width,height:G.height,matrix:G.matrix}},p.save=function(_,G){return _=_||"generated.pdf",(G=G||{}).returnPromise=G.returnPromise||!1,G.returnPromise===!1?(hu(Kh(sl()),_),typeof hu.unload=="function"&&is.setTimeout&&setTimeout(hu.unload,911),this):new Promise(function(ge,ke){try{var qe=hu(Kh(sl()),_);typeof hu.unload=="function"&&is.setTimeout&&setTimeout(hu.unload,911),ge(qe)}catch(rt){ke(rt.message)}})},es.API)es.API.hasOwnProperty(tf)&&(tf==="events"&&es.API.events.length?function(_,G){var ge,ke,qe;for(qe=G.length-1;qe!==-1;qe--)ge=G[qe][0],ke=G[qe][1],_.subscribe.apply(_,[ge].concat(typeof ke=="function"?[ke]:ke))}(Ot,es.API.events):p[tf]=es.API[tf]);var Kd=p.getPageWidth=function(_){return(Rt[_=_||W].mediaBox.topRightX-Rt[_].mediaBox.bottomLeftX)/yt},Bp=p.setPageWidth=function(_,G){Rt[_].mediaBox.topRightX=G*yt+Rt[_].mediaBox.bottomLeftX},uc=p.getPageHeight=function(_){return(Rt[_=_||W].mediaBox.topRightY-Rt[_].mediaBox.bottomLeftY)/yt},$p=p.setPageHeight=function(_,G){Rt[_].mediaBox.topRightY=G*yt+Rt[_].mediaBox.bottomLeftY};return p.internal={pdfEscape:ci,getStyle:kb,getFont:$2,getFontSize:Ae,getCharSpace:q2,getTextColor:U2,getLineHeight:Lb,getLineHeightFactor:Tb,getLineWidth:Qh,write:et,getHorizontalCoordinate:bo,getVerticalCoordinate:rl,getCoordinateString:z2,getVerticalCoordinateString:dc,collections:{},newObject:ie,newAdditionalObject:le,newObjectDeferred:je,newObjectDeferredBegin:se,getFilters:st,putStream:ut,events:Ot,scaleFactor:yt,pageSize:{getWidth:function(){return Kd(W)},setWidth:function(_){Bp(W,_)},getHeight:function(){return uc(W)},setHeight:function(_){$p(W,_)}},encryptionOptions:u,encryption:_n,getEncryptor:R2,output:Xh,getNumberOfPages:E2,pages:We,out:oe,f2:U,f3:P,getPageInfo:Ab,getPageInfoByObjId:cs,getCurrentPageInfo:D2,getPDFVersion:w,Point:ef,Rectangle:Fp,Matrix:ve,hasHotfix:jb},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return Kd(W)},set:function(_){Bp(W,_)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return uc(W)},set:function(_){$p(W,_)},enumerable:!0,configurable:!0}),na.call(p,xe),Dt="F1",Nb(n,t),Ot.publish("initialized"),p}Mf.prototype.lsbFirstWord=function(s){return String.fromCharCode(s>>0&255,s>>8&255,s>>16&255,s>>24&255)},Mf.prototype.toHexString=function(s){return s.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Mf.prototype.hexToBytes=function(s){for(var e=[],t=0;t<s.length;t+=2)e.push(String.fromCharCode(parseInt(s.substr(t,2),16)));return e.join("")},Mf.prototype.processOwnerPassword=function(s,e){return J_(X_(e).substr(0,5),s)},Mf.prototype.encryptor=function(s,e){var t=X_(this.encryptionKey+String.fromCharCode(255&s,s>>8&255,s>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return J_(t,r)}},Og.prototype.equals=function(s){var e,t="id,objectNumber,equals";if(!s||Ws(s)!==Ws(this))return!1;var r=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!s.hasOwnProperty(e)||this[e]!==s[e])return!1;r++}for(e in s)s.hasOwnProperty(e)&&t.indexOf(e)<0&&r--;return r===0},es.API={events:[]},es.version="2.5.2";var _r=es.API,Cj=1,Gh=function(s){return s.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Sf=function(s){return s.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},hs=function(s){return s.toFixed(2)},Ac=function(s){return s.toFixed(5)};_r.__acroform__={};var Ci=function(s,e){s.prototype=Object.create(e.prototype),s.prototype.constructor=s},R3=function(s){return s*Cj},jo=function(s){var e=new GP,t=Vt.internal.getHeight(s)||0,r=Vt.internal.getWidth(s)||0;return e.BBox=[0,0,Number(hs(r)),Number(hs(t))],e},D9=_r.__acroform__.setBit=function(s,e){if(s=s||0,e=e||0,isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return s|=1<<e},M9=_r.__acroform__.clearBit=function(s,e){if(s=s||0,e=e||0,isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return s&=~(1<<e)},F9=_r.__acroform__.getBit=function(s,e){if(isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return s&1<<e?1:0},Lr=_r.__acroform__.getBitForPdf=function(s,e){if(isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return F9(s,e-1)},Pr=_r.__acroform__.setBitForPdf=function(s,e){if(isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return D9(s,e-1)},Tr=_r.__acroform__.clearBitForPdf=function(s,e){if(isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return M9(s,e-1)},O9=_r.__acroform__.calculateCoordinates=function(s,e){var t=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,n=s[0],i=s[1],o=s[2],l=s[3],c={};return c.lowerLeft_X=t(n)||0,c.lowerLeft_Y=r(i+l)||0,c.upperRight_X=t(n+o)||0,c.upperRight_Y=r(i)||0,[Number(hs(c.lowerLeft_X)),Number(hs(c.lowerLeft_Y)),Number(hs(c.upperRight_X)),Number(hs(c.upperRight_Y))]},B9=function(s){if(s.appearanceStreamContent)return s.appearanceStreamContent;if(s.V||s.DV){var e=[],t=s._V||s.DV,r=Q_(s,t),n=s.scope.internal.getFont(s.fontName,s.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(s.scope.__private__.encodeColorString(s.color)),e.push("/"+n+" "+hs(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=jo(s);return i.scope=s.scope,i.stream=e.join(`
`),i}},Q_=function(s,e){var t=s.fontSize===0?s.maxFontSize:s.fontSize,r={text:"",fontSize:""},n=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");n=s.multiline?n.map(function(P){return P.split(`
`)}):n.map(function(P){return[P]});var i=t,o=Vt.internal.getHeight(s)||0;o=o<0?-o:o;var l=Vt.internal.getWidth(s)||0;l=l<0?-l:l;var c=function(P,T,z){if(P+1<n.length){var H=T+" "+n[P+1][0];return Dy(H,s,z).width<=l-4}return!1};i++;e:for(;i>0;){e="",i--;var d,u,h=Dy("3",s,i).height,m=s.multiline?o-i:(o-h)/2,p=m+=2,x=0,w=0,S=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+Dy(e,s,i=12).width+", FieldWidth:"+l+`
`;break}for(var b="",v=0,N=0;N<n.length;N++)if(n.hasOwnProperty(N)){var j=!1;if(n[N].length!==1&&S!==n[N].length-1){if((h+2)*(v+2)+2>o)continue e;b+=n[N][S],j=!0,w=N,N--}else{b=(b+=n[N][S]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var E=parseInt(N),A=c(E,b,i),L=N>=n.length-1;if(A&&!L){b+=" ",S=0;continue}if(A||L){if(L)w=E;else if(s.multiline&&(h+2)*(v+2)+2>o)continue e}else{if(!s.multiline||(h+2)*(v+2)+2>o)continue e;w=E}}for(var C="",B=x;B<=w;B++){var U=n[B];if(s.multiline){if(B===w){C+=U[S]+" ",S=(S+1)%U.length;continue}if(B===x){C+=U[U.length-1]+" ";continue}}C+=U[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,u=Dy(C,s,i).width,s.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;case"left":default:d=2}e+=hs(d)+" "+hs(p)+` Td
`,e+="("+Gh(C)+`) Tj
`,e+=-hs(d)+` 0 Td
`,p=-(i+2),u=0,x=j?w:w+1,v++,b=""}break}return r.text=e,r.fontSize=i,r},Dy=function(s,e,t){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),n=e.scope.getStringUnitWidth(s,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:n}},$9={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},z9=function(s,e){var t={type:"reference",object:s};e.internal.getPageInfo(s.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&e.internal.getPageInfo(s.page).pageContext.annotations.push(t)},U9=function(s,e){for(var t in s)if(s.hasOwnProperty(t)){var r=t,n=s[t];e.internal.newObjectDeferredBegin(n.objId,!0),Ws(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete s[r]}},q9=function(s,e){if(e.scope=s,s.internal!==void 0&&(s.internal.acroformPlugin===void 0||s.internal.acroformPlugin.isInitialized===!1)){if(po.FieldNum=0,s.internal.acroformPlugin=JSON.parse(JSON.stringify($9)),s.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Cj=s.internal.scaleFactor,s.internal.acroformPlugin.acroFormDictionaryRoot=new YP,s.internal.acroformPlugin.acroFormDictionaryRoot.scope=s,s.internal.acroformPlugin.acroFormDictionaryRoot._eventID=s.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(s)}),s.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in r)if(r.hasOwnProperty(n)){var i=r[n];i.objId=void 0,i.hasAnnotation&&z9(i,t)}})(s)}),s.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(s)}),s.internal.events.subscribe("postPutPages",function(t){(function(r,n){var i=!r;for(var o in r||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(o)){var l=r[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=O9(l.Rect,n)),n.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Vt.createDefaultAppearanceStream(l),Ws(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=B9(l);c.push({key:"AP",value:"<</N "+u+">>"}),n.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var h="";for(var m in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(m)){var p=l.appearanceStreamContent[m];if(h+="/"+m+" ",h+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var x=p[o];typeof x=="function"&&(x=x.call(n,l)),h+="/"+o+" "+x+" ",n.internal.acroformPlugin.xForms.indexOf(x)>=0||n.internal.acroformPlugin.xForms.push(x)}}else typeof(x=p)=="function"&&(x=x.call(n,l)),h+="/"+o+" "+x,n.internal.acroformPlugin.xForms.indexOf(x)>=0||n.internal.acroformPlugin.xForms.push(x);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}n.internal.putStream({additionalKeyValues:c,objectId:l.objId}),n.internal.out("endobj")}i&&U9(n.internal.acroformPlugin.xForms,n)})(t,s)}),s.internal.acroformPlugin.isInitialized=!0}},VP=_r.__acroform__.arrayToPdfArray=function(s,e,t){var r=function(o){return o};if(Array.isArray(s)){for(var n="[",i=0;i<s.length;i++)switch(i!==0&&(n+=" "),Ws(s[i])){case"boolean":case"number":case"object":n+=s[i].toString();break;case"string":s[i].substr(0,1)!=="/"?(e!==void 0&&t&&(r=t.internal.getEncryptor(e)),n+="("+Gh(r(s[i].toString()))+")"):n+=s[i].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},c5=function(s,e,t){var r=function(n){return n};return e!==void 0&&t&&(r=t.internal.getEncryptor(e)),(s=s||"").toString(),s="("+Gh(r(s))+")"},Go=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(s){this._objId=s}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Go.prototype.toString=function(){return this.objId+" 0 R"},Go.prototype.putStream=function(){var s=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:s,objectId:this.objId}),this.scope.internal.out("endobj")},Go.prototype.getKeyValueListForStream=function(){var s=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var r=e[t],n=this[r];n&&(Array.isArray(n)?s.push({key:r,value:VP(n,this.objId,this.scope)}):n instanceof Go?(n.scope=this.scope,s.push({key:r,value:n.objId+" 0 R"})):typeof n!="function"&&s.push({key:r,value:n}))}return s};var GP=function(){Go.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var s,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){s=t.trim()},get:function(){return s||null}})};Ci(GP,Go);var YP=function(){Go.call(this);var s,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(s){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Gh(t(s))+")"}},set:function(t){s=t}})};Ci(YP,Go);var po=function s(){Go.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');e=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Lr(e,3)},set:function(b){b?this.F=Pr(e,3):this.F=Tr(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');t=b}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(b){r=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(b){r[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(b){r[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(b){r[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(b){r[3]=b}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof S1)return;i="FieldObject"+s.FieldNum++}var b=function(v){return v};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Gh(b(i))+")"},set:function(b){i=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(b){i=b}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/Cj:d},set:function(b){d=b}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(b){u=b}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof S1||this instanceof Ed))return c5(h,this.objId,this.scope)},set:function(b){b=b.toString(),h=b}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Jr?m:c5(m,this.objId,this.scope)},set:function(b){b=b.toString(),m=this instanceof Jr?b:b.substr(0,1)==="("?Sf(b.substr(1,b.length-2)):Sf(b)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Jr?Sf(m.substr(1,m.length-1)):m},set:function(b){b=b.toString(),m=this instanceof Jr?"/"+b:b}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Jr?p:c5(p,this.objId,this.scope)},set:function(b){b=b.toString(),p=this instanceof Jr?b:b.substr(0,1)==="("?Sf(b.substr(1,b.length-2)):Sf(b)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Jr?Sf(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof Jr?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,w=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return w},set:function(b){b=!!b,w=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(b){x=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,1)},set:function(b){b?this.Ff=Pr(this.Ff,1):this.Ff=Tr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,2)},set:function(b){b?this.Ff=Pr(this.Ff,2):this.Ff=Tr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,3)},set:function(b){b?this.Ff=Pr(this.Ff,3):this.Ff=Tr(this.Ff,3)}});var S=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(S!==null)return S},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');S=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(S){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:S=2;break;case"center":case 1:S=1;break;case"left":case 0:default:S=0}}})};Ci(po,Go);var Ch=function(){po.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var s=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return s},set:function(t){s=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return s},set:function(t){s=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return VP(e,this.objId,this.scope)},set:function(t){var r,n;n=[],typeof(r=t)=="string"&&(n=function(i,o,l){l||(l=1);for(var c,d=[];c=o.exec(i);)d.push(c[l]);return d}(r,/\((.*?)\)/g)),e=n}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,18)},set:function(t){t?this.Ff=Pr(this.Ff,18):this.Ff=Tr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Pr(this.Ff,19):this.Ff=Tr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,20)},set:function(t){t?(this.Ff=Pr(this.Ff,20),e.sort()):this.Ff=Tr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,22)},set:function(t){t?this.Ff=Pr(this.Ff,22):this.Ff=Tr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,23)},set:function(t){t?this.Ff=Pr(this.Ff,23):this.Ff=Tr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,27)},set:function(t){t?this.Ff=Pr(this.Ff,27):this.Ff=Tr(this.Ff,27)}}),this.hasAppearanceStream=!1};Ci(Ch,po);var Eh=function(){Ch.call(this),this.fontName="helvetica",this.combo=!1};Ci(Eh,Ch);var Lh=function(){Eh.call(this),this.combo=!0};Ci(Lh,Eh);var ng=function(){Lh.call(this),this.edit=!0};Ci(ng,Lh);var Jr=function(){po.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,15)},set:function(t){t?this.Ff=Pr(this.Ff,15):this.Ff=Tr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,16)},set:function(t){t?this.Ff=Pr(this.Ff,16):this.Ff=Tr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,17)},set:function(t){t?this.Ff=Pr(this.Ff,17):this.Ff=Tr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,26)},set:function(t){t?this.Ff=Pr(this.Ff,26):this.Ff=Tr(this.Ff,26)}});var s,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(i){return i};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,n=[];for(r in n.push("<<"),e)n.push("/"+r+" ("+Gh(t(e[r]))+")");return n.push(">>"),n.join(`
`)}},set:function(t){Ws(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return s},set:function(t){s=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return s.substr(1,s.length-1)},set:function(t){s="/"+t}})};Ci(Jr,po);var ig=function(){Jr.call(this),this.pushButton=!0};Ci(ig,Jr);var Ph=function(){Jr.call(this),this.radio=!0,this.pushButton=!1;var s=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return s},set:function(e){s=e!==void 0?e:[]}})};Ci(Ph,Jr);var S1=function(){var s,e;po.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return s},set:function(n){s=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(n){e=n}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(l){return l};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),r)o.push("/"+i+" ("+Gh(n(r[i]))+")");return o.push(">>"),o.join(`
`)},set:function(n){Ws(n)==="object"&&(r=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(n){typeof n=="string"&&(r.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(n){t="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Vt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ci(S1,po),Ph.prototype.setAppearance=function(s){if(!("createAppearanceStream"in s)||!("getCA"in s))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=s.createAppearanceStream(t.optionName),t.caption=s.getCA()}},Ph.prototype.createOption=function(s){var e=new S1;return e.Parent=this,e.optionName=s,this.Kids.push(e),H9.call(this.scope,e),e};var ag=function(){Jr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Vt.CheckBox.createAppearanceStream()};Ci(ag,Jr);var Ed=function(){po.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,13)},set:function(e){e?this.Ff=Pr(this.Ff,13):this.Ff=Tr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,21)},set:function(e){e?this.Ff=Pr(this.Ff,21):this.Ff=Tr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,23)},set:function(e){e?this.Ff=Pr(this.Ff,23):this.Ff=Tr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,24)},set:function(e){e?this.Ff=Pr(this.Ff,24):this.Ff=Tr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,25)},set:function(e){e?this.Ff=Pr(this.Ff,25):this.Ff=Tr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,26)},set:function(e){e?this.Ff=Pr(this.Ff,26):this.Ff=Tr(this.Ff,26)}});var s=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return s},set:function(e){s=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return s},set:function(e){Number.isInteger(e)&&(s=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ci(Ed,po);var og=function(){Ed.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Lr(this.Ff,14)},set:function(s){s?this.Ff=Pr(this.Ff,14):this.Ff=Tr(this.Ff,14)}}),this.password=!0};Ci(og,Ed);var Vt={CheckBox:{createAppearanceStream:function(){return{N:{On:Vt.CheckBox.YesNormal},D:{On:Vt.CheckBox.YesPushDown,Off:Vt.CheckBox.OffPushDown}}},YesPushDown:function(s){var e=jo(s);e.scope=s.scope;var t=[],r=s.scope.internal.getFont(s.fontName,s.fontStyle).id,n=s.scope.__private__.encodeColorString(s.color),i=Q_(s,s.caption);return t.push("0.749023 g"),t.push("0 0 "+hs(Vt.internal.getWidth(s))+" "+hs(Vt.internal.getHeight(s))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+hs(i.fontSize)+" Tf "+n),t.push("BT"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(s){var e=jo(s);e.scope=s.scope;var t=s.scope.internal.getFont(s.fontName,s.fontStyle).id,r=s.scope.__private__.encodeColorString(s.color),n=[],i=Vt.internal.getHeight(s),o=Vt.internal.getWidth(s),l=Q_(s,s.caption);return n.push("1 g"),n.push("0 0 "+hs(o)+" "+hs(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+hs(o-1)+" "+hs(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+t+" "+hs(l.fontSize)+" Tf "+r),n.push(l.text),n.push("ET"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(s){var e=jo(s);e.scope=s.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+hs(Vt.internal.getWidth(s))+" "+hs(Vt.internal.getHeight(s))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(s){var e={D:{Off:Vt.RadioButton.Circle.OffPushDown},N:{}};return e.N[s]=Vt.RadioButton.Circle.YesNormal,e.D[s]=Vt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(s){var e=jo(s);e.scope=s.scope;var t=[],r=Vt.internal.getWidth(s)<=Vt.internal.getHeight(s)?Vt.internal.getWidth(s)/4:Vt.internal.getHeight(s)/4;r=Number((.9*r).toFixed(5));var n=Vt.internal.Bezier_C,i=Number((r*n).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Ac(Vt.internal.getWidth(s)/2)+" "+Ac(Vt.internal.getHeight(s)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),t.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),t.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),t.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(s){var e=jo(s);e.scope=s.scope;var t=[],r=Vt.internal.getWidth(s)<=Vt.internal.getHeight(s)?Vt.internal.getWidth(s)/4:Vt.internal.getHeight(s)/4;r=Number((.9*r).toFixed(5));var n=Number((2*r).toFixed(5)),i=Number((n*Vt.internal.Bezier_C).toFixed(5)),o=Number((r*Vt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Ac(Vt.internal.getWidth(s)/2)+" "+Ac(Vt.internal.getHeight(s)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Ac(Vt.internal.getWidth(s)/2)+" "+Ac(Vt.internal.getHeight(s)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+o+" "+o+" "+r+" 0 "+r+" c"),t.push("-"+o+" "+r+" -"+r+" "+o+" -"+r+" 0 c"),t.push("-"+r+" -"+o+" -"+o+" -"+r+" 0 -"+r+" c"),t.push(o+" -"+r+" "+r+" -"+o+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(s){var e=jo(s);e.scope=s.scope;var t=[],r=Vt.internal.getWidth(s)<=Vt.internal.getHeight(s)?Vt.internal.getWidth(s)/4:Vt.internal.getHeight(s)/4;r=Number((.9*r).toFixed(5));var n=Number((2*r).toFixed(5)),i=Number((n*Vt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Ac(Vt.internal.getWidth(s)/2)+" "+Ac(Vt.internal.getHeight(s)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(s){var e={D:{Off:Vt.RadioButton.Cross.OffPushDown},N:{}};return e.N[s]=Vt.RadioButton.Cross.YesNormal,e.D[s]=Vt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(s){var e=jo(s);e.scope=s.scope;var t=[],r=Vt.internal.calculateCross(s);return t.push("q"),t.push("1 1 "+hs(Vt.internal.getWidth(s)-2)+" "+hs(Vt.internal.getHeight(s)-2)+" re"),t.push("W"),t.push("n"),t.push(hs(r.x1.x)+" "+hs(r.x1.y)+" m"),t.push(hs(r.x2.x)+" "+hs(r.x2.y)+" l"),t.push(hs(r.x4.x)+" "+hs(r.x4.y)+" m"),t.push(hs(r.x3.x)+" "+hs(r.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(s){var e=jo(s);e.scope=s.scope;var t=Vt.internal.calculateCross(s),r=[];return r.push("0.749023 g"),r.push("0 0 "+hs(Vt.internal.getWidth(s))+" "+hs(Vt.internal.getHeight(s))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+hs(Vt.internal.getWidth(s)-2)+" "+hs(Vt.internal.getHeight(s)-2)+" re"),r.push("W"),r.push("n"),r.push(hs(t.x1.x)+" "+hs(t.x1.y)+" m"),r.push(hs(t.x2.x)+" "+hs(t.x2.y)+" l"),r.push(hs(t.x4.x)+" "+hs(t.x4.y)+" m"),r.push(hs(t.x3.x)+" "+hs(t.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(s){var e=jo(s);e.scope=s.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+hs(Vt.internal.getWidth(s))+" "+hs(Vt.internal.getHeight(s))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(s){var e=s.scope.internal.getFont(s.fontName,s.fontStyle).id,t=s.scope.__private__.encodeColorString(s.color);return"/"+e+" "+s.fontSize+" Tf "+t}};Vt.internal={Bezier_C:.551915024494,calculateCross:function(s){var e=Vt.internal.getWidth(s),t=Vt.internal.getHeight(s),r=Math.min(e,t);return{x1:{x:(e-r)/2,y:(t-r)/2+r},x2:{x:(e-r)/2+r,y:(t-r)/2},x3:{x:(e-r)/2,y:(t-r)/2},x4:{x:(e-r)/2+r,y:(t-r)/2+r}}}},Vt.internal.getWidth=function(s){var e=0;return Ws(s)==="object"&&(e=R3(s.Rect[2])),e},Vt.internal.getHeight=function(s){var e=0;return Ws(s)==="object"&&(e=R3(s.Rect[3])),e};var H9=_r.addField=function(s){if(q9(this,s),!(s instanceof po))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=s).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),s.page=s.scope.internal.getCurrentPageInfo().pageNumber,this};_r.AcroFormChoiceField=Ch,_r.AcroFormListBox=Eh,_r.AcroFormComboBox=Lh,_r.AcroFormEditBox=ng,_r.AcroFormButton=Jr,_r.AcroFormPushButton=ig,_r.AcroFormRadioButton=Ph,_r.AcroFormCheckBox=ag,_r.AcroFormTextField=Ed,_r.AcroFormPasswordField=og,_r.AcroFormAppearance=Vt,_r.AcroForm={ChoiceField:Ch,ListBox:Eh,ComboBox:Lh,EditBox:ng,Button:Jr,PushButton:ig,RadioButton:Ph,CheckBox:ag,TextField:Ed,PasswordField:og,Appearance:Vt},es.AcroForm={ChoiceField:Ch,ListBox:Eh,ComboBox:Lh,EditBox:ng,Button:Jr,PushButton:ig,RadioButton:Ph,CheckBox:ag,TextField:Ed,PasswordField:og,Appearance:Vt};var W9=es.AcroForm;function KP(s){return s.reduce(function(e,t,r){return e[t]=r,e},{})}(function(s){s.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=s.__addimage__.getImageFileTypeByImageData=function(P,T){var z,H,D,M,$,q=e;if((T=T||e)==="RGBA"||P.data!==void 0&&P.data instanceof Uint8ClampedArray&&"height"in P&&"width"in P)return"RGBA";if(A(P))for($ in t)for(D=t[$],z=0;z<D.length;z+=1){for(M=!0,H=0;H<D[z].length;H+=1)if(D[z][H]!==void 0&&D[z][H]!==P[H]){M=!1;break}if(M===!0){q=$;break}}else for($ in t)for(D=t[$],z=0;z<D.length;z+=1){for(M=!0,H=0;H<D[z].length;H+=1)if(D[z][H]!==void 0&&D[z][H]!==P.charCodeAt(H)){M=!1;break}if(M===!0){q=$;break}}return q===e&&T!==e&&(q=T),q},n=function P(T){for(var z=this.internal.write,H=this.internal.putStream,D=(0,this.internal.getFilters)();D.indexOf("FlateEncode")!==-1;)D.splice(D.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var M=[];if(M.push({key:"Type",value:"/XObject"}),M.push({key:"Subtype",value:"/Image"}),M.push({key:"Width",value:T.width}),M.push({key:"Height",value:T.height}),T.colorSpace===S.INDEXED?M.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(M.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===S.DEVICE_CMYK&&M.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),M.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&M.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)){for(var $="",q=0,K=T.transparency.length;q<K;q++)$+=T.transparency[q]+" "+T.transparency[q]+" ";M.push({key:"Mask",value:"["+$+"]"})}T.sMask!==void 0&&M.push({key:"SMask",value:T.objectId+1+" 0 R"});var de=T.filter!==void 0?["/"+T.filter]:void 0;if(H({data:T.data,additionalKeyValues:M,alreadyAppliedFilters:de,objectId:T.objectId}),z("endobj"),"sMask"in T&&T.sMask!==void 0){var Ne="/Predictor "+T.predictor+" /Colors 1 /BitsPerComponent "+T.bitsPerComponent+" /Columns "+T.width,R={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:T.bitsPerComponent,decodeParameters:Ne,data:T.sMask};"filter"in T&&(R.filter=T.filter),P.call(this,R)}if(T.colorSpace===S.INDEXED){var W=this.internal.newObject();H({data:C(new Uint8Array(T.palette)),objectId:W}),z("endobj")}},i=function(){var P=this.internal.collections.addImage_images;for(var T in P)n.call(this,P[T])},o=function(){var P,T=this.internal.collections.addImage_images,z=this.internal.write;for(var H in T)z("/I"+(P=T[H]).index,P.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var P=this.internal.collections.addImage_images;return l.call(this),P},d=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(P){return typeof s["process"+P.toUpperCase()]=="function"},h=function(P){return Ws(P)==="object"&&P.nodeType===1},m=function(P,T){if(P.nodeName==="IMG"&&P.hasAttribute("src")){var z=""+P.getAttribute("src");if(z.indexOf("data:image/")===0)return rg(unescape(z).split("base64,").pop());var H=s.loadFile(z,!0);if(H!==void 0)return H}if(P.nodeName==="CANVAS"){if(P.width===0||P.height===0)throw new Error("Given canvas must have data. Canvas width: "+P.width+", height: "+P.height);var D;switch(T){case"PNG":D="image/png";break;case"WEBP":D="image/webp";break;case"JPEG":case"JPG":default:D="image/jpeg"}return rg(P.toDataURL(D,1).split("base64,").pop())}},p=function(P){var T=this.internal.collections.addImage_images;if(T){for(var z in T)if(P===T[z].alias)return T[z]}},x=function(P,T,z){return P||T||(P=-96,T=-96),P<0&&(P=-1*z.width*72/P/this.internal.scaleFactor),T<0&&(T=-1*z.height*72/T/this.internal.scaleFactor),P===0&&(P=T*z.width/z.height),T===0&&(T=P*z.height/z.width),[P,T]},w=function(P,T,z,H,D,M){var $=x.call(this,z,H,D),q=this.internal.getCoordinateString,K=this.internal.getVerticalCoordinateString,de=c.call(this);if(z=$[0],H=$[1],de[D.index]=D,M){M*=Math.PI/180;var Ne=Math.cos(M),R=Math.sin(M),W=function(ue){return ue.toFixed(4)},Z=[W(Ne),W(R),W(-1*R),W(Ne),0,0,"cm"]}this.internal.write("q"),M?(this.internal.write([1,"0","0",1,q(P),K(T+H),"cm"].join(" ")),this.internal.write(Z.join(" ")),this.internal.write([q(z),"0","0",q(H),"0","0","cm"].join(" "))):this.internal.write([q(z),"0","0",q(H),q(P),K(T+H),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+D.index+" Do"),this.internal.write("Q")},S=s.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};s.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=s.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=s.__addimage__.sHashCode=function(P){var T,z,H=0;if(typeof P=="string")for(z=P.length,T=0;T<z;T++)H=(H<<5)-H+P.charCodeAt(T),H|=0;else if(A(P))for(z=P.byteLength/2,T=0;T<z;T++)H=(H<<5)-H+P[T],H|=0;return H},N=s.__addimage__.validateStringAsBase64=function(P){(P=P||"").toString().trim();var T=!0;return P.length===0&&(T=!1),P.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(P.substr(0,P.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(P.substr(-2))===!1&&(T=!1),T},j=s.__addimage__.extractImageFromDataUrl=function(P){var T=(P=P||"").split("base64,"),z=null;if(T.length===2){var H=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(T[0]);Array.isArray(H)&&(z={mimeType:H[1],charset:H[2],data:T[1]})}return z},E=s.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};s.__addimage__.isArrayBuffer=function(P){return E()&&P instanceof ArrayBuffer};var A=s.__addimage__.isArrayBufferView=function(P){return E()&&typeof Uint32Array<"u"&&(P instanceof Int8Array||P instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&P instanceof Uint8ClampedArray||P instanceof Int16Array||P instanceof Uint16Array||P instanceof Int32Array||P instanceof Uint32Array||P instanceof Float32Array||P instanceof Float64Array)},L=s.__addimage__.binaryStringToUint8Array=function(P){for(var T=P.length,z=new Uint8Array(T),H=0;H<T;H++)z[H]=P.charCodeAt(H);return z},C=s.__addimage__.arrayBufferToBinaryString=function(P){for(var T="",z=A(P)?P:new Uint8Array(P),H=0;H<z.length;H+=8192)T+=String.fromCharCode.apply(null,z.subarray(H,H+8192));return T};s.addImage=function(){var P,T,z,H,D,M,$,q,K;if(typeof arguments[1]=="number"?(T=e,z=arguments[1],H=arguments[2],D=arguments[3],M=arguments[4],$=arguments[5],q=arguments[6],K=arguments[7]):(T=arguments[1],z=arguments[2],H=arguments[3],D=arguments[4],M=arguments[5],$=arguments[6],q=arguments[7],K=arguments[8]),Ws(P=arguments[0])==="object"&&!h(P)&&"imageData"in P){var de=P;P=de.imageData,T=de.format||T||e,z=de.x||z||0,H=de.y||H||0,D=de.w||de.width||D,M=de.h||de.height||M,$=de.alias||$,q=de.compression||q,K=de.rotation||de.angle||K}var Ne=this.internal.getFilters();if(q===void 0&&Ne.indexOf("FlateEncode")!==-1&&(q="SLOW"),isNaN(z)||isNaN(H))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var R=B.call(this,P,T,$,q);return w.call(this,z,H,D,M,R,K),this};var B=function(P,T,z,H){var D,M,$;if(typeof P=="string"&&r(P)===e){P=unescape(P);var q=U(P,!1);(q!==""||(q=s.loadFile(P,!0))!==void 0)&&(P=q)}if(h(P)&&(P=m(P,T)),T=r(P,T),!u(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if((($=z)==null||$.length===0)&&(z=function(K){return typeof K=="string"||A(K)?v(K):A(K.data)?v(K.data):null}(P)),(D=p.call(this,z))||(E()&&(P instanceof Uint8Array||T==="RGBA"||(M=P,P=L(P))),D=this["process"+T.toUpperCase()](P,d.call(this),z,function(K){return K&&typeof K=="string"&&(K=K.toUpperCase()),K in s.image_compression?K:b.NONE}(H),M)),!D)throw new Error("An unknown error occurred whilst processing the image.");return D},U=s.__addimage__.convertBase64ToBinaryString=function(P,T){var z;T=typeof T!="boolean"||T;var H,D="";if(typeof P=="string"){H=(z=j(P))!==null?z.data:P;try{D=rg(H)}catch(M){if(T)throw N(H)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+M.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return D};s.getImageProperties=function(P){var T,z,H="";if(h(P)&&(P=m(P)),typeof P=="string"&&r(P)===e&&((H=U(P,!1))===""&&(H=s.loadFile(P)||""),P=H),z=r(P),!u(z))throw new Error("addImage does not support files of type '"+z+"', please ensure that a plugin for '"+z+"' support is added.");if(!E()||P instanceof Uint8Array||(P=L(P)),!(T=this["process"+z.toUpperCase()](P)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=z,T}})(es.API),function(s){var e=function(t){if(t!==void 0&&t!="")return!0};es.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),s.events.push(["putPage",function(t){for(var r,n,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(t.objId),d=t.pageContext.annotations,u=!1,h=0;h<d.length&&!u;h++)switch((r=d[h]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var m=0;m<d.length;m++){r=d[m];var p=this.internal.pdfEscape,x=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var w=this.internal.newAdditionalObject(),S=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(w.objId),v=r.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y)+"] ")+"/Contents ("+p(b(r.contents))+")",i+=" /Popup "+S.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+p(b(v))+") >>",w.content=i;var N=w.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(r.bounds.x+30)+" "+l(r.bounds.y+r.bounds.h)+" "+o(r.bounds.x+r.bounds.w+30)+" "+l(r.bounds.y)+"] ")+" /Parent "+N,r.open&&(i+=" /Open true"),i+=" >>",S.content=i,this.internal.write(w.objId,"0 R",S.objId,"0 R");break;case"freetext":n="/Rect ["+o(r.bounds.x)+" "+l(r.bounds.y)+" "+o(r.bounds.x+r.bounds.w)+" "+l(r.bounds.y+r.bounds.h)+"] ";var j=r.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+p(x(r.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(r.options.name){var E=this.annotations._nameMap[r.options.name];r.options.pageNumber=E.page,r.options.top=E.y}else r.options.top||(r.options.top=0);if(n="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",i="",r.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+p(x(r.options.url))+") >>";else if(r.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,i+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var A=l(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),i+=" /XYZ "+r.options.left+" "+A+" "+r.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),s.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},s.link=function(t,r,n,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(t),y:d(r),w:c(t+n),h:d(r+i)},options:o,type:"link"})},s.textWithLink=function(t,r,n,i){var o,l,c=this.getTextWidth(t),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var u=this.splitTextToSize(t,l).length;o=Math.ceil(d*u)}else l=c,o=d;return this.text(t,r,n,i),n+=.2*d,i.align==="center"&&(r-=c/2),i.align==="right"&&(r-=c),this.link(r,n-d,l,o,i),c},s.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}}(es.API),function(s){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];s.__arabicParser__={};var i=s.__arabicParser__.isInArabicSubstitutionA=function(w){return e[w.charCodeAt(0)]!==void 0},o=s.__arabicParser__.isArabicLetter=function(w){return typeof w=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(w)},l=s.__arabicParser__.isArabicEndLetter=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length<=2},c=s.__arabicParser__.isArabicAlfLetter=function(w){return o(w)&&n.indexOf(w.charCodeAt(0))>=0};s.__arabicParser__.arabicLetterHasIsolatedForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length>=1};var d=s.__arabicParser__.arabicLetterHasFinalForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length>=2};s.__arabicParser__.arabicLetterHasInitialForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length>=3};var u=s.__arabicParser__.arabicLetterHasMedialForm=function(w){return o(w)&&i(w)&&e[w.charCodeAt(0)].length==4},h=s.__arabicParser__.resolveLigatures=function(w){var S=0,b=t,v="",N=0;for(S=0;S<w.length;S+=1)b[w.charCodeAt(S)]!==void 0?(N++,typeof(b=b[w.charCodeAt(S)])=="number"&&(v+=String.fromCharCode(b),b=t,N=0),S===w.length-1&&(b=t,v+=w.charAt(S-(N-1)),S-=N-1,N=0)):(b=t,v+=w.charAt(S-N),S-=N,N=0);return v};s.__arabicParser__.isArabicDiacritic=function(w){return w!==void 0&&r[w.charCodeAt(0)]!==void 0};var m=s.__arabicParser__.getCorrectForm=function(w,S,b){return o(w)?i(w)===!1?-1:!d(w)||!o(S)&&!o(b)||!o(b)&&l(S)||l(w)&&!o(S)||l(w)&&c(S)||l(w)&&l(S)?0:u(w)&&o(S)&&!l(S)&&o(b)&&d(b)?3:l(w)||!o(b)?1:2:-1},p=function(w){var S=0,b=0,v=0,N="",j="",E="",A=(w=w||"").split("\\s+"),L=[];for(S=0;S<A.length;S+=1){for(L.push(""),b=0;b<A[S].length;b+=1)N=A[S][b],j=A[S][b-1],E=A[S][b+1],o(N)?(v=m(N,j,E),L[S]+=v!==-1?String.fromCharCode(e[N.charCodeAt(0)][v]):N):L[S]+=N;L[S]=h(L[S])}return L.join(" ")},x=s.__arabicParser__.processArabic=s.processArabic=function(){var w,S=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(S)){var v=0;for(b=[],v=0;v<S.length;v+=1)Array.isArray(S[v])?b.push([p(S[v][0]),S[v][1],S[v][2]]):b.push([p(S[v])]);w=b}else w=p(S);return typeof arguments[0]=="string"?w:(arguments[0].text=w,arguments[0])};s.events.push(["preProcessText",x])}(es.API),es.API.autoPrint=function(s){var e;switch((s=s||{}).variant=s.variant||"non-conform",s.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(s){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(l){t=l}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(l){r=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,r){var n;if((t=t||"2d")!=="2d")return null;for(n in r)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=r[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},s.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(es.API),function(s){var e={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(w){c=w}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(w){d=w}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(w){u=w}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(w){h=w}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(w){m=w}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(w){p=w}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(w){x=w}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},s.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},s.getTextDimensions=function(c,d){r.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),h=d.font||this.getFont(),m=d.scaleFactor||this.internal.scaleFactor,p=0,x=0,w=0,S=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=d.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(N,j){return N.concat(S.splitTextToSize(j,b))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)p<(w=this.getStringUnitWidth(c[v],{font:h})*u)&&(p=w);return p!==0&&(x=c.length),{w:p/=m,h:Math.max((x*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/m,0)}},s.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=s.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,h=this.internal.__cell__.margins||e,m=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,p&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,t===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};s.table=function(c,d,u,h,m){if(r.call(this),!u)throw new Error("No data for PDF table.");var p,x,w,S,b=[],v=[],N=[],j={},E={},A=[],L=[],C=(m=m||{}).autoSize||!1,B=m.printHeaders!==!1,U=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,P=m.margins||Object.assign({width:this.getPageWidth()},e),T=typeof m.padding=="number"?m.padding:3,z=m.headerBackgroundColor||"#c8c8c8",H=m.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=B,this.internal.__cell__.margins=P,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=z,this.internal.__cell__.headerTextColor=H,this.setFontSize(U),h==null)v=b=Object.keys(u[0]),N=b.map(function(){return"left"});else if(Array.isArray(h)&&Ws(h[0])==="object")for(b=h.map(function(de){return de.name}),v=h.map(function(de){return de.prompt||de.name||""}),N=h.map(function(de){return de.align||"left"}),p=0;p<h.length;p+=1)E[h[p].name]=h[p].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(v=b=h,N=b.map(function(){return"left"}));if(C||Array.isArray(h)&&typeof h[0]=="string")for(p=0;p<b.length;p+=1){for(j[S=b[p]]=u.map(function(de){return de[S]}),this.setFont(void 0,"bold"),A.push(this.getTextDimensions(v[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=j[S],this.setFont(void 0,"normal"),w=0;w<x.length;w+=1)A.push(this.getTextDimensions(x[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);E[S]=Math.max.apply(null,A)+T+T,A=[]}if(B){var D={};for(p=0;p<b.length;p+=1)D[b[p]]={},D[b[p]].text=v[p],D[b[p]].align=N[p];var M=l.call(this,D,E);L=b.map(function(de){return new i(c,d,E[de],M,D[de].text,void 0,D[de].align)}),this.setTableHeaderRow(L),this.printHeaderRow(1,!1)}var $=h.reduce(function(de,Ne){return de[Ne.name]=Ne.align,de},{});for(p=0;p<u.length;p+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:p,data:u[p]},this);var q=l.call(this,u[p],E);for(w=0;w<b.length;w+=1){var K=u[p][b[w]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:p,col:w,data:K},this),o.call(this,new i(c,d,E[b[w]],q,K,p+2,$[b[w]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(p){var x=c[p];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,d[p]-u-u)},this).map(function(p){return this.getLineHeightFactor()*p.length*h/m+u+u},this).reduce(function(p,x){return Math.max(p,x)},0)};s.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},s.printHeaderRow=function(c,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){u=this.internal.__cell__.tableHeaderRow[p].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,m.push(u)),u.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(x)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),t=!1}}(es.API);var XP={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},JP=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Z_=KP(JP),QP=[100,200,300,400,500,600,700,800,900],V9=KP(QP);function eS(s){var e=s.family.replace(/"|'/g,"").toLowerCase(),t=function(i){return XP[i=i||"normal"]?i:"normal"}(s.style),r=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(s.weight),n=function(i){return typeof Z_[i=i||"normal"]=="number"?i:"normal"}(s.stretch);return{family:e,style:t,weight:r,stretch:n,src:s.src||[],ref:s.ref||{name:e,style:[n,t,r].join(" ")}}}function D3(s,e,t,r){var n;for(n=t;n>=0&&n<e.length;n+=r)if(s[e[n]])return s[e[n]];for(n=t;n>=0&&n<e.length;n-=r)if(s[e[n]])return s[e[n]]}var G9={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},M3={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function F3(s){return[s.stretch,s.style,s.weight,s.family].join(" ")}function Y9(s,e,t){for(var r=(t=t||{}).defaultFontFamily||"times",n=Object.assign({},G9,t.genericFontFamilies||{}),i=null,o=null,l=0;l<e.length;++l)if(n[(i=eS(e[l])).family]&&(i.family=n[i.family]),s.hasOwnProperty(i.family)){o=s[i.family];break}if(!(o=o||s[r]))throw new Error("Could not find a font-family for the rule '"+F3(i)+"' and default family '"+r+"'.");if(o=function(c,d){if(d[c])return d[c];var u=Z_[c],h=u<=Z_.normal?-1:1,m=D3(d,JP,u,h);if(!m)throw new Error("Could not find a matching font-stretch value for "+c);return m}(i.stretch,o),o=function(c,d){if(d[c])return d[c];for(var u=XP[c],h=0;h<u.length;++h)if(d[u[h]])return d[u[h]];throw new Error("Could not find a matching font-style for "+c)}(i.style,o),!(o=function(c,d){if(d[c])return d[c];if(c===400&&d[500])return d[500];if(c===500&&d[400])return d[400];var u=V9[c],h=D3(d,QP,u,c<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+c);return h}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+F3(i)+"'.");return o}function O3(s){return s.trimLeft()}function K9(s,e){for(var t=0;t<s.length;){if(s.charAt(t)===e)return[s.substring(0,t),s.substring(t+1)];t+=1}return null}function X9(s){var e=s.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],s.substring(e[0].length)]}var My,B3,$3,d5=["times"];(function(s){var e,t,r,n,i,o,l,c,d,u=function(R){return R=R||{},this.isStrokeTransparent=R.isStrokeTransparent||!1,this.strokeOpacity=R.strokeOpacity||1,this.strokeStyle=R.strokeStyle||"#000000",this.fillStyle=R.fillStyle||"#000000",this.isFillTransparent=R.isFillTransparent||!1,this.fillOpacity=R.fillOpacity||1,this.font=R.font||"10px sans-serif",this.textBaseline=R.textBaseline||"alphabetic",this.textAlign=R.textAlign||"left",this.lineWidth=R.lineWidth||1,this.lineJoin=R.lineJoin||"miter",this.lineCap=R.lineCap||"butt",this.path=R.path||[],this.transform=R.transform!==void 0?R.transform.clone():new c,this.globalCompositeOperation=R.globalCompositeOperation||"normal",this.globalAlpha=R.globalAlpha||1,this.clip_path=R.clip_path||[],this.currentPoint=R.currentPoint||new o,this.miterLimit=R.miterLimit||10,this.lastPoint=R.lastPoint||new o,this.lineDashOffset=R.lineDashOffset||0,this.lineDash=R.lineDash||[],this.margin=R.margin||[0,0,0,0],this.prevPageLastElemOffset=R.prevPageLastElemOffset||0,this.ignoreClearRect=typeof R.ignoreClearRect!="boolean"||R.ignoreClearRect,this};s.events.push(["initialized",function(){this.context2d=new h(this),e=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var h=function(R){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var W=R;Object.defineProperty(this,"pdf",{get:function(){return W}});var Z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Z},set:function(Te){Z=!!Te}});var ue=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ue},set:function(Te){ue=!!Te}});var ce=0;Object.defineProperty(this,"posX",{get:function(){return ce},set:function(Te){isNaN(Te)||(ce=Te)}});var ye=0;Object.defineProperty(this,"posY",{get:function(){return ye},set:function(Te){isNaN(Te)||(ye=Te)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Te){var oe;typeof Te=="number"?oe=[Te,Te,Te,Te]:((oe=new Array(4))[0]=Te[0],oe[1]=Te.length>=2?Te[1]:oe[0],oe[2]=Te.length>=3?Te[2]:oe[0],oe[3]=Te.length>=4?Te[3]:oe[1]),d.margin=oe}});var Se=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Se},set:function(Te){Se=Te}});var Ee=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ee},set:function(Te){Ee=Te}});var De=[];Object.defineProperty(this,"pageBreaks",{get:function(){return De},set:function(Te){De=Te}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Te){Te instanceof u&&(d=Te)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Te){d.path=Te}});var We=[];Object.defineProperty(this,"ctxStack",{get:function(){return We},set:function(Te){We=Te}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Te){var oe;oe=m(Te),this.ctx.fillStyle=oe.style,this.ctx.isFillTransparent=oe.a===0,this.ctx.fillOpacity=oe.a,this.pdf.setFillColor(oe.r,oe.g,oe.b,{a:oe.a}),this.pdf.setTextColor(oe.r,oe.g,oe.b,{a:oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Te){var oe=m(Te);this.ctx.strokeStyle=oe.style,this.ctx.isStrokeTransparent=oe.a===0,this.ctx.strokeOpacity=oe.a,oe.a===0?this.pdf.setDrawColor(255,255,255):(oe.a,this.pdf.setDrawColor(oe.r,oe.g,oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Te){["butt","round","square"].indexOf(Te)!==-1&&(this.ctx.lineCap=Te,this.pdf.setLineCap(Te))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Te){isNaN(Te)||(this.ctx.lineWidth=Te,this.pdf.setLineWidth(Te))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Te){["bevel","round","miter"].indexOf(Te)!==-1&&(this.ctx.lineJoin=Te,this.pdf.setLineJoin(Te))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Te){isNaN(Te)||(this.ctx.miterLimit=Te,this.pdf.setMiterLimit(Te))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Te){this.ctx.textBaseline=Te}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Te){["right","end","center","left","start"].indexOf(Te)!==-1&&(this.ctx.textAlign=Te)}});var Je=null;function it(Te,oe){if(Je===null){var et=function(pe){var xe=[];return Object.keys(pe).forEach(function(he){pe[he].forEach(function(we){var Ae=null;switch(we){case"bold":Ae={family:he,weight:"bold"};break;case"italic":Ae={family:he,style:"italic"};break;case"bolditalic":Ae={family:he,weight:"bold",style:"italic"};break;case"":case"normal":Ae={family:he}}Ae!==null&&(Ae.ref={name:he,style:we},xe.push(Ae))})}),xe}(Te.getFontList());Je=function(pe){for(var xe={},he=0;he<pe.length;++he){var we=eS(pe[he]),Ae=we.family,Ze=we.stretch,$e=we.style,Qe=we.weight;xe[Ae]=xe[Ae]||{},xe[Ae][Ze]=xe[Ae][Ze]||{},xe[Ae][Ze][$e]=xe[Ae][Ze][$e]||{},xe[Ae][Ze][$e][Qe]=we}return xe}(et.concat(oe))}return Je}var Be=null;Object.defineProperty(this,"fontFaces",{get:function(){return Be},set:function(Te){Je=null,Be=Te}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Te){var oe;if(this.ctx.font=Te,(oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Te))!==null){var et=oe[1],pe=(oe[2],oe[3]),xe=oe[4],he=(oe[5],oe[6]),we=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(xe)[2];xe=Math.floor(we==="px"?parseFloat(xe)*this.pdf.internal.scaleFactor:we==="em"?parseFloat(xe)*this.pdf.getFontSize():parseFloat(xe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(xe);var Ae=function(Lt){var Dt,yt,os=[],me=Lt.trim();if(me==="")return d5;if(me in M3)return[M3[me]];for(;me!=="";){switch(yt=null,Dt=(me=O3(me)).charAt(0)){case'"':case"'":yt=K9(me.substring(1),Dt);break;default:yt=X9(me)}if(yt===null||(os.push(yt[0]),(me=O3(yt[1]))!==""&&me.charAt(0)!==","))return d5;me=me.replace(/^,/,"")}return os}(he);if(this.fontFaces){var Ze=Y9(it(this.pdf,this.fontFaces),Ae.map(function(Lt){return{family:Lt,stretch:"normal",weight:pe,style:et}}));this.pdf.setFont(Ze.ref.name,Ze.ref.style)}else{var $e="";(pe==="bold"||parseInt(pe,10)>=700||et==="bold")&&($e="bold"),et==="italic"&&($e+="italic"),$e.length===0&&($e="normal");for(var Qe="",lt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},At=0;At<Ae.length;At++){if(this.pdf.internal.getFont(Ae[At],$e,{noFallback:!0,disableWarning:!0})!==void 0){Qe=Ae[At];break}if($e==="bolditalic"&&this.pdf.internal.getFont(Ae[At],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Qe=Ae[At],$e="bold";else if(this.pdf.internal.getFont(Ae[At],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Qe=Ae[At],$e="normal";break}}if(Qe===""){for(var Nt=0;Nt<Ae.length;Nt++)if(lt[Ae[Nt]]){Qe=lt[Ae[Nt]];break}}Qe=Qe===""?"Times":Qe,this.pdf.setFont(Qe,$e)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Te){this.ctx.globalCompositeOperation=Te}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Te){this.ctx.globalAlpha=Te}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Te){this.ctx.lineDashOffset=Te,Ne.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Te){this.ctx.lineDash=Te,Ne.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Te){this.ctx.ignoreClearRect=!!Te}})};h.prototype.setLineDash=function(R){this.lineDash=R},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){j.call(this,"fill",!1)},h.prototype.stroke=function(){j.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(R,W){if(isNaN(R)||isNaN(W))throw Js.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Z=this.ctx.transform.applyToPoint(new o(R,W));this.path.push({type:"mt",x:Z.x,y:Z.y}),this.ctx.lastPoint=new o(R,W)},h.prototype.closePath=function(){var R=new o(0,0),W=0;for(W=this.path.length-1;W!==-1;W--)if(this.path[W].type==="begin"&&Ws(this.path[W+1])==="object"&&typeof this.path[W+1].x=="number"){R=new o(this.path[W+1].x,this.path[W+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(R.x,R.y)},h.prototype.lineTo=function(R,W){if(isNaN(R)||isNaN(W))throw Js.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Z=this.ctx.transform.applyToPoint(new o(R,W));this.path.push({type:"lt",x:Z.x,y:Z.y}),this.ctx.lastPoint=new o(Z.x,Z.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},h.prototype.quadraticCurveTo=function(R,W,Z,ue){if(isNaN(Z)||isNaN(ue)||isNaN(R)||isNaN(W))throw Js.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ce=this.ctx.transform.applyToPoint(new o(Z,ue)),ye=this.ctx.transform.applyToPoint(new o(R,W));this.path.push({type:"qct",x1:ye.x,y1:ye.y,x:ce.x,y:ce.y}),this.ctx.lastPoint=new o(ce.x,ce.y)},h.prototype.bezierCurveTo=function(R,W,Z,ue,ce,ye){if(isNaN(ce)||isNaN(ye)||isNaN(R)||isNaN(W)||isNaN(Z)||isNaN(ue))throw Js.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Se=this.ctx.transform.applyToPoint(new o(ce,ye)),Ee=this.ctx.transform.applyToPoint(new o(R,W)),De=this.ctx.transform.applyToPoint(new o(Z,ue));this.path.push({type:"bct",x1:Ee.x,y1:Ee.y,x2:De.x,y2:De.y,x:Se.x,y:Se.y}),this.ctx.lastPoint=new o(Se.x,Se.y)},h.prototype.arc=function(R,W,Z,ue,ce,ye){if(isNaN(R)||isNaN(W)||isNaN(Z)||isNaN(ue)||isNaN(ce))throw Js.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ye=!!ye,!this.ctx.transform.isIdentity){var Se=this.ctx.transform.applyToPoint(new o(R,W));R=Se.x,W=Se.y;var Ee=this.ctx.transform.applyToPoint(new o(0,Z)),De=this.ctx.transform.applyToPoint(new o(0,0));Z=Math.sqrt(Math.pow(Ee.x-De.x,2)+Math.pow(Ee.y-De.y,2))}Math.abs(ce-ue)>=2*Math.PI&&(ue=0,ce=2*Math.PI),this.path.push({type:"arc",x:R,y:W,radius:Z,startAngle:ue,endAngle:ce,counterclockwise:ye})},h.prototype.arcTo=function(R,W,Z,ue,ce){throw new Error("arcTo not implemented.")},h.prototype.rect=function(R,W,Z,ue){if(isNaN(R)||isNaN(W)||isNaN(Z)||isNaN(ue))throw Js.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(R,W),this.lineTo(R+Z,W),this.lineTo(R+Z,W+ue),this.lineTo(R,W+ue),this.lineTo(R,W),this.lineTo(R+Z,W),this.lineTo(R,W)},h.prototype.fillRect=function(R,W,Z,ue){if(isNaN(R)||isNaN(W)||isNaN(Z)||isNaN(ue))throw Js.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var ce={};this.lineCap!=="butt"&&(ce.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ce.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(R,W,Z,ue),this.fill(),ce.hasOwnProperty("lineCap")&&(this.lineCap=ce.lineCap),ce.hasOwnProperty("lineJoin")&&(this.lineJoin=ce.lineJoin)}},h.prototype.strokeRect=function(R,W,Z,ue){if(isNaN(R)||isNaN(W)||isNaN(Z)||isNaN(ue))throw Js.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(R,W,Z,ue),this.stroke())},h.prototype.clearRect=function(R,W,Z,ue){if(isNaN(R)||isNaN(W)||isNaN(Z)||isNaN(ue))throw Js.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(R,W,Z,ue))},h.prototype.save=function(R){R=typeof R!="boolean"||R;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,Z=0;Z<this.pdf.internal.getNumberOfPages();Z++)this.pdf.setPage(Z+1),this.pdf.internal.out("q");if(this.pdf.setPage(W),R){this.ctx.fontSize=this.pdf.internal.getFontSize();var ue=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ue}},h.prototype.restore=function(R){R=typeof R!="boolean"||R;for(var W=this.pdf.internal.getCurrentPageInfo().pageNumber,Z=0;Z<this.pdf.internal.getNumberOfPages();Z++)this.pdf.setPage(Z+1),this.pdf.internal.out("Q");this.pdf.setPage(W),R&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(R){var W,Z,ue,ce;if(R.isCanvasGradient===!0&&(R=R.getColor()),!R)return{r:0,g:0,b:0,a:0,style:R};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(R))W=0,Z=0,ue=0,ce=0;else{var ye=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(R);if(ye!==null)W=parseInt(ye[1]),Z=parseInt(ye[2]),ue=parseInt(ye[3]),ce=1;else if((ye=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(R))!==null)W=parseInt(ye[1]),Z=parseInt(ye[2]),ue=parseInt(ye[3]),ce=parseFloat(ye[4]);else{if(ce=1,typeof R=="string"&&R.charAt(0)!=="#"){var Se=new qP(R);R=Se.ok?Se.toHex():"#000000"}R.length===4?(W=R.substring(1,2),W+=W,Z=R.substring(2,3),Z+=Z,ue=R.substring(3,4),ue+=ue):(W=R.substring(1,3),Z=R.substring(3,5),ue=R.substring(5,7)),W=parseInt(W,16),Z=parseInt(Z,16),ue=parseInt(ue,16)}}return{r:W,g:Z,b:ue,a:ce,style:R}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(R,W,Z,ue){if(isNaN(W)||isNaN(Z)||typeof R!="string")throw Js.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ue=isNaN(ue)?void 0:ue,!p.call(this)){var ce=q(this.ctx.transform.rotation),ye=this.ctx.transform.scaleX;T.call(this,{text:R,x:W,y:Z,scale:ye,angle:ce,align:this.textAlign,maxWidth:ue})}},h.prototype.strokeText=function(R,W,Z,ue){if(isNaN(W)||isNaN(Z)||typeof R!="string")throw Js.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){ue=isNaN(ue)?void 0:ue;var ce=q(this.ctx.transform.rotation),ye=this.ctx.transform.scaleX;T.call(this,{text:R,x:W,y:Z,scale:ye,renderingMode:"stroke",angle:ce,align:this.textAlign,maxWidth:ue})}},h.prototype.measureText=function(R){if(typeof R!="string")throw Js.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var W=this.pdf,Z=this.pdf.internal.scaleFactor,ue=W.internal.getFontSize(),ce=W.getStringUnitWidth(R)*ue/W.internal.scaleFactor,ye=function(Se){var Ee=(Se=Se||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Ee}}),this};return new ye({width:ce*=Math.round(96*Z/72*1e4)/1e4})},h.prototype.scale=function(R,W){if(isNaN(R)||isNaN(W))throw Js.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Z=new c(R,0,0,W,0,0);this.ctx.transform=this.ctx.transform.multiply(Z)},h.prototype.rotate=function(R){if(isNaN(R))throw Js.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var W=new c(Math.cos(R),Math.sin(R),-Math.sin(R),Math.cos(R),0,0);this.ctx.transform=this.ctx.transform.multiply(W)},h.prototype.translate=function(R,W){if(isNaN(R)||isNaN(W))throw Js.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Z=new c(1,0,0,1,R,W);this.ctx.transform=this.ctx.transform.multiply(Z)},h.prototype.transform=function(R,W,Z,ue,ce,ye){if(isNaN(R)||isNaN(W)||isNaN(Z)||isNaN(ue)||isNaN(ce)||isNaN(ye))throw Js.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Se=new c(R,W,Z,ue,ce,ye);this.ctx.transform=this.ctx.transform.multiply(Se)},h.prototype.setTransform=function(R,W,Z,ue,ce,ye){R=isNaN(R)?1:R,W=isNaN(W)?0:W,Z=isNaN(Z)?0:Z,ue=isNaN(ue)?1:ue,ce=isNaN(ce)?0:ce,ye=isNaN(ye)?0:ye,this.ctx.transform=new c(R,W,Z,ue,ce,ye)};var w=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(R,W,Z,ue,ce,ye,Se,Ee,De){var We=this.pdf.getImageProperties(R),Je=1,it=1,Be=1,Te=1;ue!==void 0&&Ee!==void 0&&(Be=Ee/ue,Te=De/ce,Je=We.width/ue*Ee/ue,it=We.height/ce*De/ce),ye===void 0&&(ye=W,Se=Z,W=0,Z=0),ue!==void 0&&Ee===void 0&&(Ee=ue,De=ce),ue===void 0&&Ee===void 0&&(Ee=We.width,De=We.height);for(var oe,et=this.ctx.transform.decompose(),pe=q(et.rotate.shx),xe=new c,he=(xe=(xe=(xe=xe.multiply(et.translate)).multiply(et.skew)).multiply(et.scale)).applyToRectangle(new l(ye-W*Be,Se-Z*Te,ue*Je,ce*it)),we=S.call(this,he),Ae=[],Ze=0;Ze<we.length;Ze+=1)Ae.indexOf(we[Ze])===-1&&Ae.push(we[Ze]);if(N(Ae),this.autoPaging)for(var $e=Ae[0],Qe=Ae[Ae.length-1],lt=$e;lt<Qe+1;lt++){this.pdf.setPage(lt);var At=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Nt=lt===1?this.posY+this.margin[0]:this.margin[0],Lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Dt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],yt=lt===1?0:Lt+(lt-2)*Dt;if(this.ctx.clip_path.length!==0){var os=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(oe,this.posX+this.margin[3],-yt+Nt+this.ctx.prevPageLastElemOffset),E.call(this,"fill",!0),this.path=os}var me=JSON.parse(JSON.stringify(he));me=v([me],this.posX+this.margin[3],-yt+Nt+this.ctx.prevPageLastElemOffset)[0];var Ce=(lt>$e||lt<Qe)&&w.call(this);Ce&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,Dt,null).clip().discardPath()),this.pdf.addImage(R,"JPEG",me.x,me.y,me.w,me.h,null,null,pe),Ce&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(R,"JPEG",he.x,he.y,he.w,he.h,null,null,pe)};var S=function(R,W,Z){var ue=[];W=W||this.pdf.internal.pageSize.width,Z=Z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ce=this.posY+this.ctx.prevPageLastElemOffset;switch(R.type){default:case"mt":case"lt":ue.push(Math.floor((R.y+ce)/Z)+1);break;case"arc":ue.push(Math.floor((R.y+ce-R.radius)/Z)+1),ue.push(Math.floor((R.y+ce+R.radius)/Z)+1);break;case"qct":var ye=K(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x,R.y);ue.push(Math.floor((ye.y+ce)/Z)+1),ue.push(Math.floor((ye.y+ye.h+ce)/Z)+1);break;case"bct":var Se=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x2,R.y2,R.x,R.y);ue.push(Math.floor((Se.y+ce)/Z)+1),ue.push(Math.floor((Se.y+Se.h+ce)/Z)+1);break;case"rect":ue.push(Math.floor((R.y+ce)/Z)+1),ue.push(Math.floor((R.y+R.h+ce)/Z)+1)}for(var Ee=0;Ee<ue.length;Ee+=1)for(;this.pdf.internal.getNumberOfPages()<ue[Ee];)b.call(this);return ue},b=function(){var R=this.fillStyle,W=this.strokeStyle,Z=this.font,ue=this.lineCap,ce=this.lineWidth,ye=this.lineJoin;this.pdf.addPage(),this.fillStyle=R,this.strokeStyle=W,this.font=Z,this.lineCap=ue,this.lineWidth=ce,this.lineJoin=ye},v=function(R,W,Z){for(var ue=0;ue<R.length;ue++)switch(R[ue].type){case"bct":R[ue].x2+=W,R[ue].y2+=Z;case"qct":R[ue].x1+=W,R[ue].y1+=Z;case"mt":case"lt":case"arc":default:R[ue].x+=W,R[ue].y+=Z}return R},N=function(R){return R.sort(function(W,Z){return W-Z})},j=function(R,W){for(var Z,ue,ce=this.fillStyle,ye=this.strokeStyle,Se=this.lineCap,Ee=this.lineWidth,De=Math.abs(Ee*this.ctx.transform.scaleX),We=this.lineJoin,Je=JSON.parse(JSON.stringify(this.path)),it=JSON.parse(JSON.stringify(this.path)),Be=[],Te=0;Te<it.length;Te++)if(it[Te].x!==void 0)for(var oe=S.call(this,it[Te]),et=0;et<oe.length;et+=1)Be.indexOf(oe[et])===-1&&Be.push(oe[et]);for(var pe=0;pe<Be.length;pe++)for(;this.pdf.internal.getNumberOfPages()<Be[pe];)b.call(this);if(N(Be),this.autoPaging)for(var xe=Be[0],he=Be[Be.length-1],we=xe;we<he+1;we++){this.pdf.setPage(we),this.fillStyle=ce,this.strokeStyle=ye,this.lineCap=Se,this.lineWidth=De,this.lineJoin=We;var Ae=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ze=we===1?this.posY+this.margin[0]:this.margin[0],$e=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],lt=we===1?0:$e+(we-2)*Qe;if(this.ctx.clip_path.length!==0){var At=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(Z,this.posX+this.margin[3],-lt+Ze+this.ctx.prevPageLastElemOffset),E.call(this,R,!0),this.path=At}if(ue=JSON.parse(JSON.stringify(Je)),this.path=v(ue,this.posX+this.margin[3],-lt+Ze+this.ctx.prevPageLastElemOffset),W===!1||we===0){var Nt=(we>xe||we<he)&&w.call(this);Nt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ae,Qe,null).clip().discardPath()),E.call(this,R,W),Nt&&this.pdf.restoreGraphicsState()}this.lineWidth=Ee}else this.lineWidth=De,E.call(this,R,W),this.lineWidth=Ee;this.path=Je},E=function(R,W){if((R!=="stroke"||W||!x.call(this))&&(R==="stroke"||W||!p.call(this))){for(var Z,ue,ce=[],ye=this.path,Se=0;Se<ye.length;Se++){var Ee=ye[Se];switch(Ee.type){case"begin":ce.push({begin:!0});break;case"close":ce.push({close:!0});break;case"mt":ce.push({start:Ee,deltas:[],abs:[]});break;case"lt":var De=ce.length;if(ye[Se-1]&&!isNaN(ye[Se-1].x)&&(Z=[Ee.x-ye[Se-1].x,Ee.y-ye[Se-1].y],De>0)){for(;De>=0;De--)if(ce[De-1].close!==!0&&ce[De-1].begin!==!0){ce[De-1].deltas.push(Z),ce[De-1].abs.push(Ee);break}}break;case"bct":Z=[Ee.x1-ye[Se-1].x,Ee.y1-ye[Se-1].y,Ee.x2-ye[Se-1].x,Ee.y2-ye[Se-1].y,Ee.x-ye[Se-1].x,Ee.y-ye[Se-1].y],ce[ce.length-1].deltas.push(Z);break;case"qct":var We=ye[Se-1].x+2/3*(Ee.x1-ye[Se-1].x),Je=ye[Se-1].y+2/3*(Ee.y1-ye[Se-1].y),it=Ee.x+2/3*(Ee.x1-Ee.x),Be=Ee.y+2/3*(Ee.y1-Ee.y),Te=Ee.x,oe=Ee.y;Z=[We-ye[Se-1].x,Je-ye[Se-1].y,it-ye[Se-1].x,Be-ye[Se-1].y,Te-ye[Se-1].x,oe-ye[Se-1].y],ce[ce.length-1].deltas.push(Z);break;case"arc":ce.push({deltas:[],abs:[],arc:!0}),Array.isArray(ce[ce.length-1].abs)&&ce[ce.length-1].abs.push(Ee)}}ue=W?null:R==="stroke"?"stroke":"fill";for(var et=!1,pe=0;pe<ce.length;pe++)if(ce[pe].arc)for(var xe=ce[pe].abs,he=0;he<xe.length;he++){var we=xe[he];we.type==="arc"?C.call(this,we.x,we.y,we.radius,we.startAngle,we.endAngle,we.counterclockwise,void 0,W,!et):z.call(this,we.x,we.y),et=!0}else if(ce[pe].close===!0)this.pdf.internal.out("h"),et=!1;else if(ce[pe].begin!==!0){var Ae=ce[pe].start.x,Ze=ce[pe].start.y;H.call(this,ce[pe].deltas,Ae,Ze),et=!0}ue&&B.call(this,ue),W&&U.call(this)}},A=function(R){var W=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Z=W*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return R-Z;case"top":return R+W-Z;case"hanging":return R+W-2*Z;case"middle":return R+W/2-Z;case"ideographic":return R;case"alphabetic":default:return R}},L=function(R){return R+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var R=function(){};return R.colorStops=[],R.addColorStop=function(W,Z){this.colorStops.push([W,Z])},R.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},R.isCanvasGradient=!0,R},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(R,W,Z,ue,ce,ye,Se,Ee,De){for(var We=M.call(this,Z,ue,ce,ye),Je=0;Je<We.length;Je++){var it=We[Je];Je===0&&(De?P.call(this,it.x1+R,it.y1+W):z.call(this,it.x1+R,it.y1+W)),D.call(this,R,W,it.x2,it.y2,it.x3,it.y3,it.x4,it.y4)}Ee?U.call(this):B.call(this,Se)},B=function(R){switch(R){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},P=function(R,W){this.pdf.internal.out(t(R)+" "+r(W)+" m")},T=function(R){var W;switch(R.align){case"right":case"end":W="right";break;case"center":W="center";break;case"left":case"start":default:W="left"}var Z=this.pdf.getTextDimensions(R.text),ue=A.call(this,R.y),ce=L.call(this,ue)-Z.h,ye=this.ctx.transform.applyToPoint(new o(R.x,ue)),Se=this.ctx.transform.decompose(),Ee=new c;Ee=(Ee=(Ee=Ee.multiply(Se.translate)).multiply(Se.skew)).multiply(Se.scale);for(var De,We,Je,it=this.ctx.transform.applyToRectangle(new l(R.x,ue,Z.w,Z.h)),Be=Ee.applyToRectangle(new l(R.x,ce,Z.w,Z.h)),Te=S.call(this,Be),oe=[],et=0;et<Te.length;et+=1)oe.indexOf(Te[et])===-1&&oe.push(Te[et]);if(N(oe),this.autoPaging)for(var pe=oe[0],xe=oe[oe.length-1],he=pe;he<xe+1;he++){this.pdf.setPage(he);var we=he===1?this.posY+this.margin[0]:this.margin[0],Ae=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ze=this.pdf.internal.pageSize.height-this.margin[2],$e=Ze-this.margin[0],Qe=this.pdf.internal.pageSize.width-this.margin[1],lt=Qe-this.margin[3],At=he===1?0:Ae+(he-2)*$e;if(this.ctx.clip_path.length!==0){var Nt=this.path;De=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(De,this.posX+this.margin[3],-1*At+we),E.call(this,"fill",!0),this.path=Nt}var Lt=v([JSON.parse(JSON.stringify(Be))],this.posX+this.margin[3],-At+we+this.ctx.prevPageLastElemOffset)[0];R.scale>=.01&&(We=this.pdf.internal.getFontSize(),this.pdf.setFontSize(We*R.scale),Je=this.lineWidth,this.lineWidth=Je*R.scale);var Dt=this.autoPaging!=="text";if(Dt||Lt.y+Lt.h<=Ze){if(Dt||Lt.y>=we&&Lt.x<=Qe){var yt=Dt?R.text:this.pdf.splitTextToSize(R.text,R.maxWidth||Qe-Lt.x)[0],os=v([JSON.parse(JSON.stringify(it))],this.posX+this.margin[3],-At+we+this.ctx.prevPageLastElemOffset)[0],me=Dt&&(he>pe||he<xe)&&w.call(this);me&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,$e,null).clip().discardPath()),this.pdf.text(yt,os.x,os.y,{angle:R.angle,align:W,renderingMode:R.renderingMode}),me&&this.pdf.restoreGraphicsState()}}else Lt.y<Ze&&(this.ctx.prevPageLastElemOffset+=Ze-Lt.y);R.scale>=.01&&(this.pdf.setFontSize(We),this.lineWidth=Je)}else R.scale>=.01&&(We=this.pdf.internal.getFontSize(),this.pdf.setFontSize(We*R.scale),Je=this.lineWidth,this.lineWidth=Je*R.scale),this.pdf.text(R.text,ye.x+this.posX,ye.y+this.posY,{angle:R.angle,align:W,renderingMode:R.renderingMode,maxWidth:R.maxWidth}),R.scale>=.01&&(this.pdf.setFontSize(We),this.lineWidth=Je)},z=function(R,W,Z,ue){Z=Z||0,ue=ue||0,this.pdf.internal.out(t(R+Z)+" "+r(W+ue)+" l")},H=function(R,W,Z){return this.pdf.lines(R,W,Z,null,null)},D=function(R,W,Z,ue,ce,ye,Se,Ee){this.pdf.internal.out([e(n(Z+R)),e(i(ue+W)),e(n(ce+R)),e(i(ye+W)),e(n(Se+R)),e(i(Ee+W)),"c"].join(" "))},M=function(R,W,Z,ue){for(var ce=2*Math.PI,ye=Math.PI/2;W>Z;)W-=ce;var Se=Math.abs(Z-W);Se<ce&&ue&&(Se=ce-Se);for(var Ee=[],De=ue?-1:1,We=W;Se>1e-5;){var Je=We+De*Math.min(Se,ye);Ee.push($.call(this,R,We,Je)),Se-=Math.abs(Je-We),We=Je}return Ee},$=function(R,W,Z){var ue=(Z-W)/2,ce=R*Math.cos(ue),ye=R*Math.sin(ue),Se=ce,Ee=-ye,De=Se*Se+Ee*Ee,We=De+Se*ce+Ee*ye,Je=4/3*(Math.sqrt(2*De*We)-We)/(Se*ye-Ee*ce),it=Se-Je*Ee,Be=Ee+Je*Se,Te=it,oe=-Be,et=ue+W,pe=Math.cos(et),xe=Math.sin(et);return{x1:R*Math.cos(W),y1:R*Math.sin(W),x2:it*pe-Be*xe,y2:it*xe+Be*pe,x3:Te*pe-oe*xe,y3:Te*xe+oe*pe,x4:R*Math.cos(Z),y4:R*Math.sin(Z)}},q=function(R){return 180*R/Math.PI},K=function(R,W,Z,ue,ce,ye){var Se=R+.5*(Z-R),Ee=W+.5*(ue-W),De=ce+.5*(Z-ce),We=ye+.5*(ue-ye),Je=Math.min(R,ce,Se,De),it=Math.max(R,ce,Se,De),Be=Math.min(W,ye,Ee,We),Te=Math.max(W,ye,Ee,We);return new l(Je,Be,it-Je,Te-Be)},de=function(R,W,Z,ue,ce,ye,Se,Ee){var De,We,Je,it,Be,Te,oe,et,pe,xe,he,we,Ae,Ze,$e=Z-R,Qe=ue-W,lt=ce-Z,At=ye-ue,Nt=Se-ce,Lt=Ee-ye;for(We=0;We<41;We++)pe=(oe=(Je=R+(De=We/40)*$e)+De*((Be=Z+De*lt)-Je))+De*(Be+De*(ce+De*Nt-Be)-oe),xe=(et=(it=W+De*Qe)+De*((Te=ue+De*At)-it))+De*(Te+De*(ye+De*Lt-Te)-et),We==0?(he=pe,we=xe,Ae=pe,Ze=xe):(he=Math.min(he,pe),we=Math.min(we,xe),Ae=Math.max(Ae,pe),Ze=Math.max(Ze,xe));return new l(Math.round(he),Math.round(we),Math.round(Ae-he),Math.round(Ze-we))},Ne=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var R,W,Z=(R=this.ctx.lineDash,W=this.ctx.lineDashOffset,JSON.stringify({lineDash:R,lineDashOffset:W}));this.prevLineDash!==Z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Z)}}})(es.API),function(s){var e=function(i){var o,l,c,d,u,h,m,p,x,w;for(l=[],c=0,d=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;d>c;c+=4)(u=(i.charCodeAt(c)<<24)+(i.charCodeAt(c+1)<<16)+(i.charCodeAt(c+2)<<8)+i.charCodeAt(c+3))!==0?(h=(u=((u=((u=((u=(u-(w=u%85))/85)-(x=u%85))/85)-(p=u%85))/85)-(m=u%85))/85)%85,l.push(h+33,m+33,p+33,x+33,w+33)):l.push(122);return function(S,b){for(var v=b;v>0;v--)S.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},t=function(i){var o,l,c,d,u,h=String,m="length",p=255,x="charCodeAt",w="slice",S="replace";for(i[w](-2),i=i[w](0,-2)[S](/\s/g,"")[S]("z","!!!!!"),c=[],d=0,u=(i+=o="uuuuu"[w](i[m]%5||5))[m];u>d;d+=5)l=52200625*(i[x](d)-33)+614125*(i[x](d+1)-33)+7225*(i[x](d+2)-33)+85*(i[x](d+3)-33)+(i[x](d+4)-33),c.push(p&l>>24,p&l>>16,p&l>>8,p&l);return function(b,v){for(var N=v;N>0;N--)b.pop()}(c,o[m]),h.fromCharCode.apply(h,c)},r=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",c=0;c<i.length;c+=2)l+=String.fromCharCode("0x"+(i[c]+i[c+1]));return l},n=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return i=(o=Y_(o)).reduce(function(c,d){return c+String.fromCharCode(d)},"")};s.processDataByFilters=function(i,o){var l=0,c=i||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=t(c),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=r(c),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=n(c),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:d.reverse().join(" ")}}}(es.API),function(s){s.loadFile=function(e,t,r){return function(n,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,u){var h=new XMLHttpRequest,m=0,p=function(x){var w=x.length,S=[],b=String.fromCharCode;for(m=0;m<w;m+=1)S.push(b(255&x.charCodeAt(m)));return S.join("")};if(h.open("GET",c,!d),h.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(h.onload=function(){h.status===200?u(p(this.responseText)):u(void 0)}),h.send(null),d&&h.status===200)return p(h.responseText)}(n,i,o)}catch{}return l}(e,t,r)},s.loadImageFile=s.loadFile}(es.API),function(s){function e(){return(is.html2canvas?Promise.resolve(is.html2canvas):nc(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function t(){return(is.DOMPurify?Promise.resolve(is.DOMPurify):nc(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var r=function(o){var l=Ws(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},n=function(o,l){var c=document.createElement(o);for(var d in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[d]=l.style[d];return c},i=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),c);return d=(d=d.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(r(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(t).then(function(c){return this.set({src:n("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(d,u){for(var h=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),m=d.firstChild;m;m=m.nextSibling)u!==!0&&m.nodeType===1&&m.nodeName==="SCRIPT"||h.appendChild(c(m,u));return d.nodeType===1&&(d.nodeName==="CANVAS"?(h.width=d.width,h.height=d.height,h.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(h.value=d.value),h.addEventListener("load",function(){h.scrollTop=d.scrollTop,h.scrollLeft=d.scrollLeft},!0)),h}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(l){var c=this.opt.jsPDF,d=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=d,d)for(var m=0;m<d.length;++m){var p=d[m],x=p.src.find(function(w){return w.format==="truetype"});x&&c.addFont(x.url,p.ref.name,p.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,c.context2d.save(!0),l(this.prop.container,h)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(r(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in i.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var c=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},i.prototype.setMargin=function(o){return this.then(function(){switch(r(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(c,d){return Math.floor(c*d/72*96)}return this.then(function(){(o=o||es.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,c,d){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,c,d){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,d?this.progress.stack.concat(d):null)},i.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(d,u){return c.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(h){return c.updateProgress(null,d),h}).then(d,u).then(function(h){return c.updateProgress(1),h})})},i.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then,o&&(o=o.bind(this)),l&&(l=l.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),u=c.call(d,o,l);return i.convert(u,this.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,es.getPageSize=function(o,l,c){if(Ws(o)==="object"){var d=o;o=d.orientation,l=d.unit||l,c=d.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var u,h=(""+c).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+l}var p,x=0,w=0;if(m.hasOwnProperty(h))x=m[h][1]/u,w=m[h][0]/u;else try{x=c[1],w=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",w>x&&(p=w,w=x,x=p);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",x>w&&(p=w,w=x,x=p)}return{width:w,height:x,unit:l,k:u,orientation:o}},s.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(eS):null;var c=new i(l);return l.worker?c:c.from(o).doCallback()}}(es.API),es.API.addJS=function(s){return $3=s,this.internal.events.subscribe("postPutResources",function(){My=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(My+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),B3=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+$3+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){My!==void 0&&B3!==void 0&&this.internal.out("/Names <</JavaScript "+My+" 0 R>>")}),this},function(s){var e;s.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=t.outline.render().split(/\r\n/),i=0;i<n.length;i++){var o=n[i],l=r.exec(o);if(l!=null){var c=l[1];t.internal.newObjectDeferredBegin(c,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(i=0;i<d;i++){var h=t.internal.newObject();u.push(h);var m=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<u.length;i++)t.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),s.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),s.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,n,i){var o={title:n,options:i,children:[]};return r==null&&(r=this.root),r.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var n=0;n<r.children.length;n++)this.genIds_r(r.children[n])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<r.children.length;i++){var o=r.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(r)),i>0&&this.line("/Prev "+this.makeRef(r.children[i-1])),i<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,n){for(var i=0;i<n.children.length;i++)r.count++,this.count_r(r,n.children[i]);return r.count}}])}(es.API),function(s){var e=[192,193,194,195,196,197,198,199];s.processJPEG=function(t,r,n,i,o,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(c=function(h){for(var m,p=256*h.charCodeAt(4)+h.charCodeAt(5),x=h.length,w={width:0,height:0,numcomponents:1},S=4;S<x;S+=2){if(S+=p,e.indexOf(h.charCodeAt(S+1))!==-1){m=256*h.charCodeAt(S+5)+h.charCodeAt(S+6),w={width:256*h.charCodeAt(S+7)+h.charCodeAt(S+8),height:m,numcomponents:h.charCodeAt(S+9)};break}p=256*h.charCodeAt(S+2)+h.charCodeAt(S+3)}return w}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:t,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:r,alias:n}}return u}}(es.API);var jf,Fy,z3,U3,q3,J9=function(){var s,e,t;function r(i){var o,l,c,d,u,h,m,p,x,w,S,b,v,N;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(o=this.readUInt32(),x=(function(){var j,E;for(E=[],j=0;j<4;++j)E.push(String.fromCharCode(this.data[this.pos++]));return E}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),d=this.readUInt16()||100,h.delay=1e3*u/d,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(x==="fdAT"&&(this.pos+=4,o-=4),i=(h!=null?h.data:void 0)||this.imgData,b=0;0<=o?b<o:b>o;0<=o?++b:--b)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((w=c-this.transparency.indexed.length)>0)for(v=0;0<=w?v<w:v>w;0<=w?++v:--v)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":m=(S=this.read(o)).indexOf(0),p=String.fromCharCode.apply(String,S.slice(0,m)),this.text[p]=String.fromCharCode.apply(String,S.slice(m+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(N=this.colorType)===4||N===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(i){var o,l;for(l=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)l.push(this.data[this.pos++]);return l},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*o),c=0,d=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function u(h,m,p,x){var w,S,b,v,N,j,E,A,L,C,B,U,P,T,z,H,D,M,$,q,K,de=Math.ceil((d.width-h)/p),Ne=Math.ceil((d.height-m)/x),R=d.width==de&&d.height==Ne;for(T=o*de,U=R?l:new Uint8Array(T*Ne),j=i.length,P=0,S=0;P<Ne&&c<j;){switch(i[c++]){case 0:for(v=D=0;D<T;v=D+=1)U[S++]=i[c++];break;case 1:for(v=M=0;M<T;v=M+=1)w=i[c++],N=v<o?0:U[S-o],U[S++]=(w+N)%256;break;case 2:for(v=$=0;$<T;v=$+=1)w=i[c++],b=(v-v%o)/o,z=P&&U[(P-1)*T+b*o+v%o],U[S++]=(z+w)%256;break;case 3:for(v=q=0;q<T;v=q+=1)w=i[c++],b=(v-v%o)/o,N=v<o?0:U[S-o],z=P&&U[(P-1)*T+b*o+v%o],U[S++]=(w+Math.floor((N+z)/2))%256;break;case 4:for(v=K=0;K<T;v=K+=1)w=i[c++],b=(v-v%o)/o,N=v<o?0:U[S-o],P===0?z=H=0:(z=U[(P-1)*T+b*o+v%o],H=b&&U[(P-1)*T+(b-1)*o+v%o]),E=N+z-H,A=Math.abs(E-N),C=Math.abs(E-z),B=Math.abs(E-H),L=A<=C&&A<=B?N:C<=B?z:H,U[S++]=(w+L)%256;break;default:throw new Error("Invalid filter algorithm: "+i[c-1])}if(!R){var W=((m+P*x)*d.width+h)*o,Z=P*T;for(v=0;v<de;v+=1){for(var ue=0;ue<o;ue+=1)l[W++]=U[Z++];W+=(p-1)*o}}P++}}return i=C9(i),d.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),l},r.prototype.decodePalette=function(){var i,o,l,c,d,u,h,m,p;for(l=this.palette,u=this.transparency.indexed||[],d=new Uint8Array((u.length||0)+l.length),c=0,i=0,o=h=0,m=l.length;h<m;o=h+=3)d[c++]=l[o],d[c++]=l[o+1],d[c++]=l[o+2],d[c++]=(p=u[i++])!=null?p:255;return d},r.prototype.copyToImageData=function(i,o){var l,c,d,u,h,m,p,x,w,S,b;if(c=this.colors,w=null,l=this.hasAlphaChannel,this.palette.length&&(w=(b=this._decodedPalette)!=null?b:this._decodedPalette=this.decodePalette(),c=4,l=!0),x=(d=i.data||i).length,h=w||o,u=m=0,c===1)for(;u<x;)p=w?4*o[u/4]:m,S=h[p++],d[u++]=S,d[u++]=S,d[u++]=S,d[u++]=l?h[p++]:255,m=p;else for(;u<x;)p=w?4*o[u/4]:m,d[u++]=h[p++],d[u++]=h[p++],d[u++]=h[p++],d[u++]=l?h[p++]:255,m=p},r.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var n=function(){if(Object.prototype.toString.call(is)==="[object Window]"){try{e=is.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return n(),s=function(i){var o;if(n()===!0)return t.width=i.width,t.height=i.height,t.clearRect(0,0,i.width,i.height),t.putImageData(i,0,0),(o=new Image).src=e.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(i){var o,l,c,d,u,h,m,p;if(this.animation){for(p=[],l=u=0,h=(m=this.animation.frames).length;u<h;l=++u)o=m[l],c=i.createImageData(o.width,o.height),d=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(c,d),o.imageData=c,p.push(o.image=s(c));return p}},r.prototype.renderFrame=function(i,o){var l,c,d;return l=(c=this.animation.frames)[o],d=c[o-1],o===0&&i.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?i.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&i.putImageData(d.imageData,d.xOffset,d.yOffset),l.blendOp===0&&i.clearRect(l.xOffset,l.yOffset,l.width,l.height),i.drawImage(l.image,l.xOffset,l.yOffset)},r.prototype.animate=function(i){var o,l,c,d,u,h,m=this;return l=0,h=this.animation,d=h.numFrames,c=h.frames,u=h.numPlays,(o=function(){var p,x;if(p=l++%d,x=c[p],m.renderFrame(i,p),d>1&&l/d<u)return m.animation._timeout=setTimeout(o,x.delay)})()},r.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},r.prototype.render=function(i){var o,l;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(l=o.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),o.putImageData(l,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Q9(s){var e=0;if(s[e++]!==71||s[e++]!==73||s[e++]!==70||s[e++]!==56||(s[e++]+1&253)!=56||s[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=s[e++]|s[e++]<<8,r=s[e++]|s[e++]<<8,n=s[e++],i=n>>7,o=1<<(7&n)+1;s[e++],s[e++];var l=null,c=null;i&&(l=e,c=o,e+=3*o);var d=!0,u=[],h=0,m=null,p=0,x=null;for(this.width=t,this.height=r;d&&e<s.length;)switch(s[e++]){case 33:switch(s[e++]){case 255:if(s[e]!==11||s[e+1]==78&&s[e+2]==69&&s[e+3]==84&&s[e+4]==83&&s[e+5]==67&&s[e+6]==65&&s[e+7]==80&&s[e+8]==69&&s[e+9]==50&&s[e+10]==46&&s[e+11]==48&&s[e+12]==3&&s[e+13]==1&&s[e+16]==0)e+=14,x=s[e++]|s[e++]<<8,e++;else for(e+=12;;){if(!((P=s[e++])>=0))throw Error("Invalid block size");if(P===0)break;e+=P}break;case 249:if(s[e++]!==4||s[e+4]!==0)throw new Error("Invalid graphics extension block.");var w=s[e++];h=s[e++]|s[e++]<<8,m=s[e++],!(1&w)&&(m=null),p=w>>2&7,e++;break;case 254:for(;;){if(!((P=s[e++])>=0))throw Error("Invalid block size");if(P===0)break;e+=P}break;default:throw new Error("Unknown graphic control label: 0x"+s[e-1].toString(16))}break;case 44:var S=s[e++]|s[e++]<<8,b=s[e++]|s[e++]<<8,v=s[e++]|s[e++]<<8,N=s[e++]|s[e++]<<8,j=s[e++],E=j>>6&1,A=1<<(7&j)+1,L=l,C=c,B=!1;j>>7&&(B=!0,L=e,C=A,e+=3*A);var U=e;for(e++;;){var P;if(!((P=s[e++])>=0))throw Error("Invalid block size");if(P===0)break;e+=P}u.push({x:S,y:b,width:v,height:N,has_local_palette:B,palette_offset:L,palette_size:C,data_offset:U,data_length:e-U,transparent_index:m,interlaced:!!E,delay:h,disposal:p});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+s[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return x},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,z){var H=this.frameInfo(T),D=H.width*H.height,M=new Uint8Array(D);H3(s,H.data_offset,M,D);var $=H.palette_offset,q=H.transparent_index;q===null&&(q=256);var K=H.width,de=t-K,Ne=K,R=4*(H.y*t+H.x),W=4*((H.y+H.height)*t+H.x),Z=R,ue=4*de;H.interlaced===!0&&(ue+=4*t*7);for(var ce=8,ye=0,Se=M.length;ye<Se;++ye){var Ee=M[ye];if(Ne===0&&(Ne=K,(Z+=ue)>=W&&(ue=4*de+4*t*(ce-1),Z=R+(K+de)*(ce<<1),ce>>=1)),Ee===q)Z+=4;else{var De=s[$+3*Ee],We=s[$+3*Ee+1],Je=s[$+3*Ee+2];z[Z++]=Je,z[Z++]=We,z[Z++]=De,z[Z++]=255}--Ne}},this.decodeAndBlitFrameRGBA=function(T,z){var H=this.frameInfo(T),D=H.width*H.height,M=new Uint8Array(D);H3(s,H.data_offset,M,D);var $=H.palette_offset,q=H.transparent_index;q===null&&(q=256);var K=H.width,de=t-K,Ne=K,R=4*(H.y*t+H.x),W=4*((H.y+H.height)*t+H.x),Z=R,ue=4*de;H.interlaced===!0&&(ue+=4*t*7);for(var ce=8,ye=0,Se=M.length;ye<Se;++ye){var Ee=M[ye];if(Ne===0&&(Ne=K,(Z+=ue)>=W&&(ue=4*de+4*t*(ce-1),Z=R+(K+de)*(ce<<1),ce>>=1)),Ee===q)Z+=4;else{var De=s[$+3*Ee],We=s[$+3*Ee+1],Je=s[$+3*Ee+2];z[Z++]=De,z[Z++]=We,z[Z++]=Je,z[Z++]=255}--Ne}}}function H3(s,e,t,r){for(var n=s[e++],i=1<<n,o=i+1,l=o+1,c=n+1,d=(1<<c)-1,u=0,h=0,m=0,p=s[e++],x=new Int32Array(4096),w=null;;){for(;u<16&&p!==0;)h|=s[e++]<<u,u+=8,p===1?p=s[e++]:--p;if(u<c)break;var S=h&d;if(h>>=c,u-=c,S!==i){if(S===o)break;for(var b=S<l?S:w,v=0,N=b;N>i;)N=x[N]>>8,++v;var j=N;if(m+v+(b!==S?1:0)>r)return void Js.log("Warning, gif stream longer than expected.");t[m++]=j;var E=m+=v;for(b!==S&&(t[m++]=j),N=b;v--;)N=x[N],t[--E]=255&N,N>>=8;w!==null&&l<4096&&(x[l++]=w<<8|j,l>=d+1&&c<12&&(++c,d=d<<1|1)),w=S}else l=o+1,d=(1<<(c=n+1))-1,w=null}return m!==r&&Js.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function u5(s){var e,t,r,n,i,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),h=new Array(65535),m=new Array(65535),p=new Array(64),x=new Array(64),w=[],S=0,b=7,v=new Array(64),N=new Array(64),j=new Array(64),E=new Array(256),A=new Array(2048),L=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],P=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],z=[0,1,2,3,4,5,6,7,8,9,10,11],H=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],D=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function M(R,W){for(var Z=0,ue=0,ce=new Array,ye=1;ye<=16;ye++){for(var Se=1;Se<=R[ye];Se++)ce[W[ue]]=[],ce[W[ue]][0]=Z,ce[W[ue]][1]=ye,ue++,Z++;Z*=2}return ce}function $(R){for(var W=R[0],Z=R[1]-1;Z>=0;)W&1<<Z&&(S|=1<<b),Z--,--b<0&&(S==255?(q(255),q(0)):q(S),b=7,S=0)}function q(R){w.push(R)}function K(R){q(R>>8&255),q(255&R)}function de(R,W,Z,ue,ce){for(var ye,Se=ce[0],Ee=ce[240],De=function(xe,he){var we,Ae,Ze,$e,Qe,lt,At,Nt,Lt,Dt,yt=0;for(Lt=0;Lt<8;++Lt){we=xe[yt],Ae=xe[yt+1],Ze=xe[yt+2],$e=xe[yt+3],Qe=xe[yt+4],lt=xe[yt+5],At=xe[yt+6];var os=we+(Nt=xe[yt+7]),me=we-Nt,Ce=Ae+At,dt=Ae-At,O=Ze+lt,_e=Ze-lt,at=$e+Qe,St=$e-Qe,Tt=os+at,Pt=os-at,kt=Ce+O,jt=Ce-O;xe[yt]=Tt+kt,xe[yt+4]=Tt-kt;var Rt=.707106781*(jt+Pt);xe[yt+2]=Pt+Rt,xe[yt+6]=Pt-Rt;var Ot=.382683433*((Tt=St+_e)-(jt=dt+me)),Ps=.5411961*Tt+Ot,Fs=1.306562965*jt+Ot,Os=.707106781*(kt=_e+dt),be=me+Os,ve=me-Os;xe[yt+5]=ve+Ps,xe[yt+3]=ve-Ps,xe[yt+1]=be+Fs,xe[yt+7]=be-Fs,yt+=8}for(yt=0,Lt=0;Lt<8;++Lt){we=xe[yt],Ae=xe[yt+8],Ze=xe[yt+16],$e=xe[yt+24],Qe=xe[yt+32],lt=xe[yt+40],At=xe[yt+48];var Ve=we+(Nt=xe[yt+56]),ct=we-Nt,Y=Ae+At,ie=Ae-At,je=Ze+lt,se=Ze-lt,le=$e+Qe,Ue=$e-Qe,Ie=Ve+le,He=Ve-le,Me=Y+je,st=Y-je;xe[yt]=Ie+Me,xe[yt+32]=Ie-Me;var ut=.707106781*(st+He);xe[yt+16]=He+ut,xe[yt+48]=He-ut;var wt=.382683433*((Ie=Ue+se)-(st=ie+ct)),xt=.5411961*Ie+wt,X=1.306562965*st+wt,Ke=.707106781*(Me=se+ie),Oe=ct+Ke,Xe=ct-Ke;xe[yt+40]=Xe+xt,xe[yt+24]=Xe-xt,xe[yt+8]=Oe+X,xe[yt+56]=Oe-X,yt++}for(Lt=0;Lt<64;++Lt)Dt=xe[Lt]*he[Lt],p[Lt]=Dt>0?Dt+.5|0:Dt-.5|0;return p}(R,W),We=0;We<64;++We)x[L[We]]=De[We];var Je=x[0]-Z;Z=x[0],Je==0?$(ue[0]):($(ue[m[ye=32767+Je]]),$(h[ye]));for(var it=63;it>0&&x[it]==0;)it--;if(it==0)return $(Se),Z;for(var Be,Te=1;Te<=it;){for(var oe=Te;x[Te]==0&&Te<=it;)++Te;var et=Te-oe;if(et>=16){Be=et>>4;for(var pe=1;pe<=Be;++pe)$(Ee);et&=15}ye=32767+x[Te],$(ce[(et<<4)+m[ye]]),$(h[ye]),Te++}return it!=63&&$(Se),Z}function Ne(R){R=Math.min(Math.max(R,1),100),i!=R&&(function(W){for(var Z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ue=0;ue<64;ue++){var ce=o((Z[ue]*W+50)/100);ce=Math.min(Math.max(ce,1),255),l[L[ue]]=ce}for(var ye=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Se=0;Se<64;Se++){var Ee=o((ye[Se]*W+50)/100);Ee=Math.min(Math.max(Ee,1),255),c[L[Se]]=Ee}for(var De=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],We=0,Je=0;Je<8;Je++)for(var it=0;it<8;it++)d[We]=1/(l[L[We]]*De[Je]*De[it]*8),u[We]=1/(c[L[We]]*De[Je]*De[it]*8),We++}(R<50?Math.floor(5e3/R):Math.floor(200-2*R)),i=R)}this.encode=function(R,W){W&&Ne(W),w=new Array,S=0,b=7,K(65496),K(65504),K(16),q(74),q(70),q(73),q(70),q(0),q(1),q(1),q(0),K(1),K(1),q(0),q(0),function(){K(65499),K(132),q(0);for(var Ae=0;Ae<64;Ae++)q(l[Ae]);q(1);for(var Ze=0;Ze<64;Ze++)q(c[Ze])}(),function(Ae,Ze){K(65472),K(17),q(8),K(Ze),K(Ae),q(3),q(1),q(17),q(0),q(2),q(17),q(1),q(3),q(17),q(1)}(R.width,R.height),function(){K(65476),K(418),q(0);for(var Ae=0;Ae<16;Ae++)q(C[Ae+1]);for(var Ze=0;Ze<=11;Ze++)q(B[Ze]);q(16);for(var $e=0;$e<16;$e++)q(U[$e+1]);for(var Qe=0;Qe<=161;Qe++)q(P[Qe]);q(1);for(var lt=0;lt<16;lt++)q(T[lt+1]);for(var At=0;At<=11;At++)q(z[At]);q(17);for(var Nt=0;Nt<16;Nt++)q(H[Nt+1]);for(var Lt=0;Lt<=161;Lt++)q(D[Lt])}(),K(65498),K(12),q(3),q(1),q(0),q(2),q(17),q(3),q(17),q(0),q(63),q(0);var Z=0,ue=0,ce=0;S=0,b=7,this.encode.displayName="_encode_";for(var ye,Se,Ee,De,We,Je,it,Be,Te,oe=R.data,et=R.width,pe=R.height,xe=4*et,he=0;he<pe;){for(ye=0;ye<xe;){for(We=xe*he+ye,it=-1,Be=0,Te=0;Te<64;Te++)Je=We+(Be=Te>>3)*xe+(it=4*(7&Te)),he+Be>=pe&&(Je-=xe*(he+1+Be-pe)),ye+it>=xe&&(Je-=ye+it-xe+4),Se=oe[Je++],Ee=oe[Je++],De=oe[Je++],v[Te]=(A[Se]+A[Ee+256>>0]+A[De+512>>0]>>16)-128,N[Te]=(A[Se+768>>0]+A[Ee+1024>>0]+A[De+1280>>0]>>16)-128,j[Te]=(A[Se+1280>>0]+A[Ee+1536>>0]+A[De+1792>>0]>>16)-128;Z=de(v,d,Z,e,r),ue=de(N,u,ue,t,n),ce=de(j,u,ce,t,n),ye+=32}he+=8}if(b>=0){var we=[];we[1]=b+1,we[0]=(1<<b+1)-1,$(we)}return K(65497),new Uint8Array(w)},s=s||50,function(){for(var R=String.fromCharCode,W=0;W<256;W++)E[W]=R(W)}(),e=M(C,B),t=M(T,z),r=M(U,P),n=M(H,D),function(){for(var R=1,W=2,Z=1;Z<=15;Z++){for(var ue=R;ue<W;ue++)m[32767+ue]=Z,h[32767+ue]=[],h[32767+ue][1]=Z,h[32767+ue][0]=ue;for(var ce=-(W-1);ce<=-R;ce++)m[32767+ce]=Z,h[32767+ce]=[],h[32767+ce][1]=Z,h[32767+ce][0]=W-1+ce;R<<=1,W<<=1}}(),function(){for(var R=0;R<256;R++)A[R]=19595*R,A[R+256>>0]=38470*R,A[R+512>>0]=7471*R+32768,A[R+768>>0]=-11059*R,A[R+1024>>0]=-21709*R,A[R+1280>>0]=32768*R+8421375,A[R+1536>>0]=-27439*R,A[R+1792>>0]=-5329*R}(),Ne(s)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ba(s,e){if(this.pos=0,this.buffer=s,this.datav=new DataView(s.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function W3(s){function e(C){if(!C)throw Error("assert :P")}function t(C,B,U){for(var P=0;4>P;P++)if(C[B+P]!=U.charCodeAt(P))return!0;return!1}function r(C,B,U,P,T){for(var z=0;z<T;z++)C[B+z]=U[P+z]}function n(C,B,U,P){for(var T=0;T<P;T++)C[B+T]=U}function i(C){return new Int32Array(C)}function o(C,B){for(var U=[],P=0;P<C;P++)U.push(new B);return U}function l(C,B){var U=[];return function P(T,z,H){for(var D=H[z],M=0;M<D&&(T.push(H.length>z+1?[]:new B),!(H.length<z+1));M++)P(T[M],z+1,H)}(U,0,C),U}var c=function(){var C=this;function B(g,y){for(var k=1<<y-1>>>0;g&k;)k>>>=1;return k?(g&k-1)+k:g}function U(g,y,k,I,V){e(!(I%k));do g[y+(I-=k)]=V;while(0<I)}function P(g,y,k,I,V){if(e(2328>=V),512>=V)var J=i(512);else if((J=i(V))==null)return 0;return function(ee,re,ae,fe,Le,Ge){var Ye,ze,pt=re,tt=1<<ae,Pe=i(16),Re=i(16);for(e(Le!=0),e(fe!=null),e(ee!=null),e(0<ae),ze=0;ze<Le;++ze){if(15<fe[ze])return 0;++Pe[fe[ze]]}if(Pe[0]==Le)return 0;for(Re[1]=0,Ye=1;15>Ye;++Ye){if(Pe[Ye]>1<<Ye)return 0;Re[Ye+1]=Re[Ye]+Pe[Ye]}for(ze=0;ze<Le;++ze)Ye=fe[ze],0<fe[ze]&&(Ge[Re[Ye]++]=ze);if(Re[15]==1)return(fe=new T).g=0,fe.value=Ge[0],U(ee,pt,1,tt,fe),tt;var ht,bt=-1,ft=tt-1,zt=0,Mt=1,Zt=1,Bt=1<<ae;for(ze=0,Ye=1,Le=2;Ye<=ae;++Ye,Le<<=1){if(Mt+=Zt<<=1,0>(Zt-=Pe[Ye]))return 0;for(;0<Pe[Ye];--Pe[Ye])(fe=new T).g=Ye,fe.value=Ge[ze++],U(ee,pt+zt,Le,Bt,fe),zt=B(zt,Ye)}for(Ye=ae+1,Le=2;15>=Ye;++Ye,Le<<=1){if(Mt+=Zt<<=1,0>(Zt-=Pe[Ye]))return 0;for(;0<Pe[Ye];--Pe[Ye]){if(fe=new T,(zt&ft)!=bt){for(pt+=Bt,ht=1<<(bt=Ye)-ae;15>bt&&!(0>=(ht-=Pe[bt]));)++bt,ht<<=1;tt+=Bt=1<<(ht=bt-ae),ee[re+(bt=zt&ft)].g=ht+ae,ee[re+bt].value=pt-re-bt}fe.g=Ye-ae,fe.value=Ge[ze++],U(ee,pt+(zt>>ae),Le,Bt,fe),zt=B(zt,Ye)}}return Mt!=2*Re[15]-1?0:tt}(g,y,k,I,V,J)}function T(){this.value=this.g=0}function z(){this.value=this.g=0}function H(){this.G=o(5,T),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(hn,z)}function D(g,y,k,I){e(g!=null),e(y!=null),e(2147483648>I),g.Ca=254,g.I=0,g.b=-8,g.Ka=0,g.oa=y,g.pa=k,g.Jd=y,g.Yc=k+I,g.Zc=4<=I?k+I-4+1:k,ye(g)}function M(g,y){for(var k=0;0<y--;)k|=Ee(g,128)<<y;return k}function $(g,y){var k=M(g,y);return Se(g)?-k:k}function q(g,y,k,I){var V,J=0;for(e(g!=null),e(y!=null),e(4294967288>I),g.Sb=I,g.Ra=0,g.u=0,g.h=0,4<I&&(I=4),V=0;V<I;++V)J+=y[k+V]<<8*V;g.Ra=J,g.bb=I,g.oa=y,g.pa=k}function K(g){for(;8<=g.u&&g.bb<g.Sb;)g.Ra>>>=8,g.Ra+=g.oa[g.pa+g.bb]<<of-8>>>0,++g.bb,g.u-=8;Z(g)&&(g.h=1,g.u=0)}function de(g,y){if(e(0<=y),!g.h&&y<=af){var k=W(g)&nf[y];return g.u+=y,K(g),k}return g.h=1,g.u=0}function Ne(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function R(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function W(g){return g.Ra>>>(g.u&of-1)>>>0}function Z(g){return e(g.bb<=g.Sb),g.h||g.bb==g.Sb&&g.u>of}function ue(g,y){g.u=y,g.h=Z(g)}function ce(g){g.u>=Wp&&(e(g.u>=Wp),K(g))}function ye(g){e(g!=null&&g.oa!=null),g.pa<g.Zc?(g.I=(g.oa[g.pa++]|g.I<<8)>>>0,g.b+=8):(e(g!=null&&g.oa!=null),g.pa<g.Yc?(g.b+=8,g.I=g.oa[g.pa++]|g.I<<8):g.Ka?g.b=0:(g.I<<=8,g.b+=8,g.Ka=1))}function Se(g){return M(g,1)}function Ee(g,y){var k=g.Ca;0>g.b&&ye(g);var I=g.b,V=k*y>>>8,J=(g.I>>>I>V)+0;for(J?(k-=V,g.I-=V+1<<I>>>0):k=V+1,I=k,V=0;256<=I;)V+=8,I>>=8;return I=7^V+di[I],g.b-=I,g.Ca=(k<<I)-1,J}function De(g,y,k){g[y+0]=k>>24&255,g[y+1]=k>>16&255,g[y+2]=k>>8&255,g[y+3]=k>>0&255}function We(g,y){return g[y+0]<<0|g[y+1]<<8}function Je(g,y){return We(g,y)|g[y+2]<<16}function it(g,y){return We(g,y)|We(g,y+2)<<16}function Be(g,y){var k=1<<y;return e(g!=null),e(0<y),g.X=i(k),g.X==null?0:(g.Mb=32-y,g.Xa=y,1)}function Te(g,y){e(g!=null),e(y!=null),e(g.Xa==y.Xa),r(y.X,0,g.X,0,1<<y.Xa)}function oe(){this.X=[],this.Xa=this.Mb=0}function et(g,y,k,I){e(k!=null),e(I!=null);var V=k[0],J=I[0];return V==0&&(V=(g*J+y/2)/y),J==0&&(J=(y*V+g/2)/g),0>=V||0>=J?0:(k[0]=V,I[0]=J,1)}function pe(g,y){return g+(1<<y)-1>>>y}function xe(g,y){return((4278255360&g)+(4278255360&y)>>>0&4278255360)+((16711935&g)+(16711935&y)>>>0&16711935)>>>0}function he(g,y){C[y]=function(k,I,V,J,ee,re,ae){var fe;for(fe=0;fe<ee;++fe){var Le=C[g](re[ae+fe-1],V,J+fe);re[ae+fe]=xe(k[I+fe],Le)}}}function we(){this.ud=this.hd=this.jd=0}function Ae(g,y){return((4278124286&(g^y))>>>1)+(g&y)>>>0}function Ze(g){return 0<=g&&256>g?g:0>g?0:255<g?255:void 0}function $e(g,y){return Ze(g+(g-y+.5>>1))}function Qe(g,y,k){return Math.abs(y-k)-Math.abs(g-k)}function lt(g,y,k,I,V,J,ee){for(I=J[ee-1],k=0;k<V;++k)J[ee+k]=I=xe(g[y+k],I)}function At(g,y,k,I,V){var J;for(J=0;J<k;++J){var ee=g[y+J],re=ee>>8&255,ae=16711935&(ae=(ae=16711935&ee)+((re<<16)+re));I[V+J]=(4278255360&ee)+ae>>>0}}function Nt(g,y){y.jd=g>>0&255,y.hd=g>>8&255,y.ud=g>>16&255}function Lt(g,y,k,I,V,J){var ee;for(ee=0;ee<I;++ee){var re=y[k+ee],ae=re>>>8,fe=re,Le=255&(Le=(Le=re>>>16)+((g.jd<<24>>24)*(ae<<24>>24)>>>5));fe=255&(fe=(fe=fe+((g.hd<<24>>24)*(ae<<24>>24)>>>5))+((g.ud<<24>>24)*(Le<<24>>24)>>>5)),V[J+ee]=(4278255360&re)+(Le<<16)+fe}}function Dt(g,y,k,I,V){C[y]=function(J,ee,re,ae,fe,Le,Ge,Ye,ze){for(ae=Ge;ae<Ye;++ae)for(Ge=0;Ge<ze;++Ge)fe[Le++]=V(re[I(J[ee++])])},C[g]=function(J,ee,re,ae,fe,Le,Ge){var Ye=8>>J.b,ze=J.Ea,pt=J.K[0],tt=J.w;if(8>Ye)for(J=(1<<J.b)-1,tt=(1<<Ye)-1;ee<re;++ee){var Pe,Re=0;for(Pe=0;Pe<ze;++Pe)Pe&J||(Re=I(ae[fe++])),Le[Ge++]=V(pt[Re&tt]),Re>>=Ye}else C["VP8LMapColor"+k](ae,fe,pt,tt,Le,Ge,ee,re,ze)}}function yt(g,y,k,I,V){for(k=y+k;y<k;){var J=g[y++];I[V++]=J>>16&255,I[V++]=J>>8&255,I[V++]=J>>0&255}}function os(g,y,k,I,V){for(k=y+k;y<k;){var J=g[y++];I[V++]=J>>16&255,I[V++]=J>>8&255,I[V++]=J>>0&255,I[V++]=J>>24&255}}function me(g,y,k,I,V){for(k=y+k;y<k;){var J=(ee=g[y++])>>16&240|ee>>12&15,ee=ee>>0&240|ee>>28&15;I[V++]=J,I[V++]=ee}}function Ce(g,y,k,I,V){for(k=y+k;y<k;){var J=(ee=g[y++])>>16&248|ee>>13&7,ee=ee>>5&224|ee>>3&31;I[V++]=J,I[V++]=ee}}function dt(g,y,k,I,V){for(k=y+k;y<k;){var J=g[y++];I[V++]=J>>0&255,I[V++]=J>>8&255,I[V++]=J>>16&255}}function O(g,y,k,I,V,J){if(J==0)for(k=y+k;y<k;)De(I,((J=g[y++])[0]>>24|J[1]>>8&65280|J[2]<<8&16711680|J[3]<<24)>>>0),V+=32;else r(I,V,g,y,k)}function _e(g,y){C[y][0]=C[g+"0"],C[y][1]=C[g+"1"],C[y][2]=C[g+"2"],C[y][3]=C[g+"3"],C[y][4]=C[g+"4"],C[y][5]=C[g+"5"],C[y][6]=C[g+"6"],C[y][7]=C[g+"7"],C[y][8]=C[g+"8"],C[y][9]=C[g+"9"],C[y][10]=C[g+"10"],C[y][11]=C[g+"11"],C[y][12]=C[g+"12"],C[y][13]=C[g+"13"],C[y][14]=C[g+"0"],C[y][15]=C[g+"0"]}function at(g){return g==Y2||g==K2||g==Vb||g==X2}function St(){this.eb=[],this.size=this.A=this.fb=0}function Tt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Pt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new St,this.f.kb=new Tt,this.sd=null}function kt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function jt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Rt(g){return alert("todo:WebPSamplerProcessPlane"),g.T}function Ot(g,y){var k=g.T,I=y.ba.f.RGBA,V=I.eb,J=I.fb+g.ka*I.A,ee=da[y.ba.S],re=g.y,ae=g.O,fe=g.f,Le=g.N,Ge=g.ea,Ye=g.W,ze=y.cc,pt=y.dc,tt=y.Mc,Pe=y.Nc,Re=g.ka,ht=g.ka+g.T,bt=g.U,ft=bt+1>>1;for(Re==0?ee(re,ae,null,null,fe,Le,Ge,Ye,fe,Le,Ge,Ye,V,J,null,null,bt):(ee(y.ec,y.fc,re,ae,ze,pt,tt,Pe,fe,Le,Ge,Ye,V,J-I.A,V,J,bt),++k);Re+2<ht;Re+=2)ze=fe,pt=Le,tt=Ge,Pe=Ye,Le+=g.Rc,Ye+=g.Rc,J+=2*I.A,ee(re,(ae+=2*g.fa)-g.fa,re,ae,ze,pt,tt,Pe,fe,Le,Ge,Ye,V,J-I.A,V,J,bt);return ae+=g.fa,g.j+ht<g.o?(r(y.ec,y.fc,re,ae,bt),r(y.cc,y.dc,fe,Le,ft),r(y.Mc,y.Nc,Ge,Ye,ft),k--):1&ht||ee(re,ae,null,null,fe,Le,Ge,Ye,fe,Le,Ge,Ye,V,J+I.A,null,null,bt),k}function Ps(g,y,k){var I=g.F,V=[g.J];if(I!=null){var J=g.U,ee=y.ba.S,re=ee==Wb||ee==Vb;y=y.ba.f.RGBA;var ae=[0],fe=g.ka;ae[0]=g.T,g.Kb&&(fe==0?--ae[0]:(--fe,V[0]-=g.width),g.j+g.ka+g.T==g.o&&(ae[0]=g.o-g.j-fe));var Le=y.eb;fe=y.fb+fe*y.A,g=tr(I,V[0],g.width,J,ae,Le,fe+(re?0:3),y.A),e(k==ae),g&&at(ee)&&la(Le,fe,re,J,ae,y.A)}return 0}function Fs(g){var y=g.ma,k=y.ba.S,I=11>k,V=k==qb||k==Hb||k==Wb||k==G2||k==12||at(k);if(y.memory=null,y.Ib=null,y.Jb=null,y.Nd=null,!qp(y.Oa,g,V?11:12))return 0;if(V&&at(k)&&vt(),g.da)alert("todo:use_scaling");else{if(I){if(y.Ib=Rt,g.Kb){if(k=g.U+1>>1,y.memory=i(g.U+2*k),y.memory==null)return 0;y.ec=y.memory,y.fc=0,y.cc=y.ec,y.dc=y.fc+g.U,y.Mc=y.cc,y.Nc=y.dc+k,y.Ib=Ot,vt()}}else alert("todo:EmitYUV");V&&(y.Jb=Ps,I&&qe())}if(I&&!Wj){for(g=0;256>g;++g)wT[g]=89858*(g-128)+Yb>>Gb,ST[g]=-22014*(g-128)+Yb,_T[g]=-45773*(g-128),NT[g]=113618*(g-128)+Yb>>Gb;for(g=Qp;g<Z2;++g)y=76283*(g-16)+Yb>>Gb,jT[g-Qp]=Li(y,255),AT[g-Qp]=Li(y+8>>4,15);Wj=1}return 1}function Os(g){var y=g.ma,k=g.U,I=g.T;return e(!(1&g.ka)),0>=k||0>=I?0:(k=y.Ib(g,y),y.Jb!=null&&y.Jb(g,y,k),y.Dc+=k,1)}function be(g){g.ma.memory=null}function ve(g,y,k,I){return de(g,8)!=47?0:(y[0]=de(g,14)+1,k[0]=de(g,14)+1,I[0]=de(g,1),de(g,3)!=0?0:!g.h)}function Ve(g,y){if(4>g)return g+1;var k=g-2>>1;return(2+(1&g)<<k)+de(y,k)+1}function ct(g,y){return 120<y?y-120:1<=(k=((k=oT[y-1])>>4)*g+(8-(15&k)))?k:1;var k}function Y(g,y,k){var I=W(k),V=g[y+=255&I].g-8;return 0<V&&(ue(k,k.u+8),I=W(k),y+=g[y].value,y+=I&(1<<V)-1),ue(k,k.u+g[y].g),g[y].value}function ie(g,y,k){return k.g+=g.g,k.value+=g.value<<y>>>0,e(8>=k.g),g.g}function je(g,y,k){var I=g.xc;return e((y=I==0?0:g.vc[g.md*(k>>I)+(y>>I)])<g.Wb),g.Ya[y]}function se(g,y,k,I){var V=g.ab,J=g.c*y,ee=g.C;y=ee+y;var re=k,ae=I;for(I=g.Ta,k=g.Ua;0<V--;){var fe=g.gc[V],Le=ee,Ge=y,Ye=re,ze=ae,pt=(ae=I,re=k,fe.Ea);switch(e(Le<Ge),e(Ge<=fe.nc),fe.hc){case 2:Mb(Ye,ze,(Ge-Le)*pt,ae,re);break;case 0:var tt=Le,Pe=Ge,Re=ae,ht=re,bt=(Bt=fe).Ea;tt==0&&(W2(Ye,ze,null,null,1,Re,ht),lt(Ye,ze+1,0,0,bt-1,Re,ht+1),ze+=bt,ht+=bt,++tt);for(var ft=1<<Bt.b,zt=ft-1,Mt=pe(bt,Bt.b),Zt=Bt.K,Bt=Bt.w+(tt>>Bt.b)*Mt;tt<Pe;){var Bs=Zt,zs=Bt,Ts=1;for(Vp(Ye,ze,Re,ht-bt,1,Re,ht);Ts<bt;){var Cs=(Ts&~zt)+ft;Cs>bt&&(Cs=bt),(0,hc[Bs[zs++]>>8&15])(Ye,ze+ +Ts,Re,ht+Ts-bt,Cs-Ts,Re,ht+Ts),Ts=Cs}ze+=bt,ht+=bt,++tt&zt||(Bt+=Mt)}Ge!=fe.nc&&r(ae,re-pt,ae,re+(Ge-Le-1)*pt,pt);break;case 1:for(pt=Ye,Pe=ze,bt=(Ye=fe.Ea)-(ht=Ye&~(Re=(ze=1<<fe.b)-1)),tt=pe(Ye,fe.b),ft=fe.K,fe=fe.w+(Le>>fe.b)*tt;Le<Ge;){for(zt=ft,Mt=fe,Zt=new we,Bt=Pe+ht,Bs=Pe+Ye;Pe<Bt;)Nt(zt[Mt++],Zt),Xd(Zt,pt,Pe,ze,ae,re),Pe+=ze,re+=ze;Pe<Bs&&(Nt(zt[Mt++],Zt),Xd(Zt,pt,Pe,bt,ae,re),Pe+=bt,re+=bt),++Le&Re||(fe+=tt)}break;case 3:if(Ye==ae&&ze==re&&0<fe.b){for(Pe=ae,Ye=pt=re+(Ge-Le)*pt-(ht=(Ge-Le)*pe(fe.Ea,fe.b)),ze=ae,Re=re,tt=[],ht=(bt=ht)-1;0<=ht;--ht)tt[ht]=ze[Re+ht];for(ht=bt-1;0<=ht;--ht)Pe[Ye+ht]=tt[ht];ia(fe,Le,Ge,ae,pt,ae,re)}else ia(fe,Le,Ge,Ye,ze,ae,re)}re=I,ae=k}ae!=k&&r(I,k,re,ae,J)}function le(g,y){var k=g.V,I=g.Ba+g.c*g.C,V=y-g.C;if(e(y<=g.l.o),e(16>=V),0<V){var J=g.l,ee=g.Ta,re=g.Ua,ae=J.width;if(se(g,V,k,I),V=re=[re],e((k=g.C)<(I=y)),e(J.v<J.va),I>J.o&&(I=J.o),k<J.j){var fe=J.j-k;k=J.j,V[0]+=fe*ae}if(k>=I?k=0:(V[0]+=4*J.v,J.ka=k-J.j,J.U=J.va-J.v,J.T=I-k,k=1),k){if(re=re[0],11>(k=g.ca).S){var Le=k.f.RGBA,Ge=(I=k.S,V=J.U,J=J.T,fe=Le.eb,Le.A),Ye=J;for(Le=Le.fb+g.Ma*Le.A;0<Ye--;){var ze=ee,pt=re,tt=V,Pe=fe,Re=Le;switch(I){case Ub:ui(ze,pt,tt,Pe,Re);break;case qb:Hn(ze,pt,tt,Pe,Re);break;case Y2:Hn(ze,pt,tt,Pe,Re),la(Pe,Re,0,tt,1,0);break;case Dj:il(ze,pt,tt,Pe,Re);break;case Hb:O(ze,pt,tt,Pe,Re,1);break;case K2:O(ze,pt,tt,Pe,Re,1),la(Pe,Re,0,tt,1,0);break;case Wb:O(ze,pt,tt,Pe,Re,0);break;case Vb:O(ze,pt,tt,Pe,Re,0),la(Pe,Re,1,tt,1,0);break;case G2:fc(ze,pt,tt,Pe,Re);break;case X2:fc(ze,pt,tt,Pe,Re),er(Pe,Re,tt,1,0);break;case Mj:nl(ze,pt,tt,Pe,Re);break;default:e(0)}re+=ae,Le+=Ge}g.Ma+=J}else alert("todo:EmitRescaledRowsYUVA");e(g.Ma<=k.height)}}g.C=y,e(g.C<=g.i)}function Ue(g){var y;if(0<g.ua)return 0;for(y=0;y<g.Wb;++y){var k=g.Ya[y].G,I=g.Ya[y].H;if(0<k[1][I[1]+0].g||0<k[2][I[2]+0].g||0<k[3][I[3]+0].g)return 0}return 1}function Ie(g,y,k,I,V,J){if(g.Z!=0){var ee=g.qd,re=g.rd;for(e(xc[g.Z]!=null);y<k;++y)xc[g.Z](ee,re,I,V,I,V,J),ee=I,re=V,V+=J;g.qd=ee,g.rd=re}}function He(g,y){var k=g.l.ma,I=k.Z==0||k.Z==1?g.l.j:g.C;if(I=g.C<I?I:g.C,e(y<=g.l.o),y>I){var V=g.l.width,J=k.ca,ee=k.tb+V*I,re=g.V,ae=g.Ba+g.c*I,fe=g.gc;e(g.ab==1),e(fe[0].hc==3),Fb(fe[0],I,y,re,ae,J,ee),Ie(k,I,y,J,ee,V)}g.C=g.Ma=y}function Me(g,y,k,I,V,J,ee){var re=g.$/I,ae=g.$%I,fe=g.m,Le=g.s,Ge=k+g.$,Ye=Ge;V=k+I*V;var ze=k+I*J,pt=280+Le.ua,tt=g.Pb?re:16777216,Pe=0<Le.ua?Le.Wa:null,Re=Le.wc,ht=Ge<ze?je(Le,ae,re):null;e(g.C<J),e(ze<=V);var bt=!1;e:for(;;){for(;bt||Ge<ze;){var ft=0;if(re>=tt){var zt=Ge-k;e((tt=g).Pb),tt.wd=tt.m,tt.xd=zt,0<tt.s.ua&&Te(tt.s.Wa,tt.s.vb),tt=re+cT}if(ae&Re||(ht=je(Le,ae,re)),e(ht!=null),ht.Qb&&(y[Ge]=ht.qb,bt=!0),!bt)if(ce(fe),ht.jc){ft=fe,zt=y;var Mt=Ge,Zt=ht.pd[W(ft)&hn-1];e(ht.jc),256>Zt.g?(ue(ft,ft.u+Zt.g),zt[Mt]=Zt.value,ft=0):(ue(ft,ft.u+Zt.g-256),e(256<=Zt.value),ft=Zt.value),ft==0&&(bt=!0)}else ft=Y(ht.G[0],ht.H[0],fe);if(fe.h)break;if(bt||256>ft){if(!bt)if(ht.nd)y[Ge]=(ht.qb|ft<<8)>>>0;else{if(ce(fe),bt=Y(ht.G[1],ht.H[1],fe),ce(fe),zt=Y(ht.G[2],ht.H[2],fe),Mt=Y(ht.G[3],ht.H[3],fe),fe.h)break;y[Ge]=(Mt<<24|bt<<16|ft<<8|zt)>>>0}if(bt=!1,++Ge,++ae>=I&&(ae=0,++re,ee!=null&&re<=J&&!(re%16)&&ee(g,re),Pe!=null))for(;Ye<Ge;)ft=y[Ye++],Pe.X[(506832829*ft&4294967295)>>>Pe.Mb]=ft}else if(280>ft){if(ft=Ve(ft-256,fe),zt=Y(ht.G[4],ht.H[4],fe),ce(fe),zt=ct(I,zt=Ve(zt,fe)),fe.h)break;if(Ge-k<zt||V-Ge<ft)break e;for(Mt=0;Mt<ft;++Mt)y[Ge+Mt]=y[Ge+Mt-zt];for(Ge+=ft,ae+=ft;ae>=I;)ae-=I,++re,ee!=null&&re<=J&&!(re%16)&&ee(g,re);if(e(Ge<=V),ae&Re&&(ht=je(Le,ae,re)),Pe!=null)for(;Ye<Ge;)ft=y[Ye++],Pe.X[(506832829*ft&4294967295)>>>Pe.Mb]=ft}else{if(!(ft<pt))break e;for(bt=ft-280,e(Pe!=null);Ye<Ge;)ft=y[Ye++],Pe.X[(506832829*ft&4294967295)>>>Pe.Mb]=ft;ft=Ge,e(!(bt>>>(zt=Pe).Xa)),y[ft]=zt.X[bt],bt=!0}bt||e(fe.h==Z(fe))}if(g.Pb&&fe.h&&Ge<V)e(g.m.h),g.a=5,g.m=g.wd,g.$=g.xd,0<g.s.ua&&Te(g.s.vb,g.s.Wa);else{if(fe.h)break e;ee!=null&&ee(g,re>J?J:re),g.a=0,g.$=Ge-k}return 1}return g.a=3,0}function st(g){e(g!=null),g.vc=null,g.yc=null,g.Ya=null;var y=g.Wa;y!=null&&(y.X=null),g.vb=null,e(g!=null)}function ut(){var g=new H2;return g==null?null:(g.a=0,g.xb=Bj,_e("Predictor","VP8LPredictors"),_e("Predictor","VP8LPredictors_C"),_e("PredictorAdd","VP8LPredictorsAdd"),_e("PredictorAdd","VP8LPredictorsAdd_C"),Mb=At,Xd=Lt,ui=yt,Hn=os,fc=me,nl=Ce,il=dt,C.VP8LMapColor32b=lf,C.VP8LMapColor8b=Ob,g)}function wt(g,y,k,I,V){var J=1,ee=[g],re=[y],ae=I.m,fe=I.s,Le=null,Ge=0;e:for(;;){if(k)for(;J&&de(ae,1);){var Ye=ee,ze=re,pt=I,tt=1,Pe=pt.m,Re=pt.gc[pt.ab],ht=de(Pe,2);if(pt.Oc&1<<ht)J=0;else{switch(pt.Oc|=1<<ht,Re.hc=ht,Re.Ea=Ye[0],Re.nc=ze[0],Re.K=[null],++pt.ab,e(4>=pt.ab),ht){case 0:case 1:Re.b=de(Pe,3)+2,tt=wt(pe(Re.Ea,Re.b),pe(Re.nc,Re.b),0,pt,Re.K),Re.K=Re.K[0];break;case 3:var bt,ft=de(Pe,8)+1,zt=16<ft?0:4<ft?1:2<ft?2:3;if(Ye[0]=pe(Re.Ea,zt),Re.b=zt,bt=tt=wt(ft,1,0,pt,Re.K)){var Mt,Zt=ft,Bt=Re,Bs=1<<(8>>Bt.b),zs=i(Bs);if(zs==null)bt=0;else{var Ts=Bt.K[0],Cs=Bt.w;for(zs[0]=Bt.K[0][0],Mt=1;Mt<1*Zt;++Mt)zs[Mt]=xe(Ts[Cs+Mt],zs[Mt-1]);for(;Mt<4*Bs;++Mt)zs[Mt]=0;Bt.K[0]=null,Bt.K[0]=zs,bt=1}}tt=bt;break;case 2:break;default:e(0)}J=tt}}if(ee=ee[0],re=re[0],J&&de(ae,1)&&!(J=1<=(Ge=de(ae,4))&&11>=Ge)){I.a=3;break e}var Xs;if(Xs=J)t:{var Gs,gs,Mr,hi=I,Fr=ee,fi=re,Us=Ge,Ti=k,Ii=hi.m,tn=hi.s,fn=[null],Vn=1,ua=0,vo=lT[Us];s:for(;;){if(Ti&&de(Ii,1)){var sn=de(Ii,3)+2,cl=pe(Fr,sn),tu=pe(fi,sn),ff=cl*tu;if(!wt(cl,tu,0,hi,fn))break s;for(fn=fn[0],tn.xc=sn,Gs=0;Gs<ff;++Gs){var bc=fn[Gs]>>8&65535;fn[Gs]=bc,bc>=Vn&&(Vn=bc+1)}}if(Ii.h)break s;for(gs=0;5>gs;++gs){var wr=Fj[gs];!gs&&0<Us&&(wr+=1<<Us),ua<wr&&(ua=wr)}var ew=o(Vn*vo,T),Yj=Vn,Kj=o(Yj,H);if(Kj==null)var Xb=null;else e(65536>=Yj),Xb=Kj;var Zp=i(ua);if(Xb==null||Zp==null||ew==null){hi.a=1;break s}var Jb=ew;for(Gs=Mr=0;Gs<Vn;++Gs){var Ma=Xb[Gs],mf=Ma.G,pf=Ma.H,Xj=0,Qb=1,Jj=0;for(gs=0;5>gs;++gs){wr=Fj[gs],mf[gs]=Jb,pf[gs]=Mr,!gs&&0<Us&&(wr+=1<<Us);n:{var Zb,tw=wr,ey=hi,e0=Zp,ET=Jb,LT=Mr,sw=0,yc=ey.m,PT=de(yc,1);if(n(e0,0,0,tw),PT){var TT=de(yc,1)+1,IT=de(yc,1),Qj=de(yc,IT==0?1:8);e0[Qj]=1,TT==2&&(e0[Qj=de(yc,8)]=1);var ty=1}else{var Zj=i(19),eA=de(yc,4)+4;if(19<eA){ey.a=3;var sy=0;break n}for(Zb=0;Zb<eA;++Zb)Zj[aT[Zb]]=de(yc,3);var rw=void 0,t0=void 0,tA=ey,RT=Zj,ry=tw,sA=e0,nw=0,vc=tA.m,rA=8,nA=o(128,T);r:for(;P(nA,0,7,RT,19);){if(de(vc,1)){var DT=2+2*de(vc,3);if((rw=2+de(vc,DT))>ry)break r}else rw=ry;for(t0=0;t0<ry&&rw--;){ce(vc);var iA=nA[0+(127&W(vc))];ue(vc,vc.u+iA.g);var gf=iA.value;if(16>gf)sA[t0++]=gf,gf!=0&&(rA=gf);else{var MT=gf==16,aA=gf-16,FT=nT[aA],oA=de(vc,rT[aA])+FT;if(t0+oA>ry)break r;for(var OT=MT?rA:0;0<oA--;)sA[t0++]=OT}}nw=1;break r}nw||(tA.a=3),ty=nw}(ty=ty&&!yc.h)&&(sw=P(ET,LT,8,e0,tw)),ty&&sw!=0?sy=sw:(ey.a=3,sy=0)}if(sy==0)break s;if(Qb&&iT[gs]==1&&(Qb=Jb[Mr].g==0),Xj+=Jb[Mr].g,Mr+=sy,3>=gs){var s0,iw=Zp[0];for(s0=1;s0<wr;++s0)Zp[s0]>iw&&(iw=Zp[s0]);Jj+=iw}}if(Ma.nd=Qb,Ma.Qb=0,Qb&&(Ma.qb=(mf[3][pf[3]+0].value<<24|mf[1][pf[1]+0].value<<16|mf[2][pf[2]+0].value)>>>0,Xj==0&&256>mf[0][pf[0]+0].value&&(Ma.Qb=1,Ma.qb+=mf[0][pf[0]+0].value<<8)),Ma.jc=!Ma.Qb&&6>Jj,Ma.jc){var ny,dl=Ma;for(ny=0;ny<hn;++ny){var wc=ny,Nc=dl.pd[wc],iy=dl.G[0][dl.H[0]+wc];256<=iy.value?(Nc.g=iy.g+256,Nc.value=iy.value):(Nc.g=0,Nc.value=0,wc>>=ie(iy,8,Nc),wc>>=ie(dl.G[1][dl.H[1]+wc],16,Nc),wc>>=ie(dl.G[2][dl.H[2]+wc],0,Nc),ie(dl.G[3][dl.H[3]+wc],24,Nc))}}}tn.vc=fn,tn.Wb=Vn,tn.Ya=Xb,tn.yc=ew,Xs=1;break t}Xs=0}if(!(J=Xs)){I.a=3;break e}if(0<Ge){if(fe.ua=1<<Ge,!Be(fe.Wa,Ge)){I.a=1,J=0;break e}}else fe.ua=0;var aw=I,lA=ee,BT=re,ow=aw.s,lw=ow.xc;if(aw.c=lA,aw.i=BT,ow.md=pe(lA,lw),ow.wc=lw==0?-1:(1<<lw)-1,k){I.xb=gT;break e}if((Le=i(ee*re))==null){I.a=1,J=0;break e}J=(J=Me(I,Le,0,ee,re,re,null))&&!ae.h;break e}return J?(V!=null?V[0]=Le:(e(Le==null),e(k)),I.$=0,k||st(fe)):st(fe),J}function xt(g,y){var k=g.c*g.i,I=k+y+16*y;return e(g.c<=y),g.V=i(I),g.V==null?(g.Ta=null,g.Ua=0,g.a=1,0):(g.Ta=g.V,g.Ua=g.Ba+k+y,1)}function X(g,y){var k=g.C,I=y-k,V=g.V,J=g.Ba+g.c*k;for(e(y<=g.l.o);0<I;){var ee=16<I?16:I,re=g.l.ma,ae=g.l.width,fe=ae*ee,Le=re.ca,Ge=re.tb+ae*k,Ye=g.Ta,ze=g.Ua;se(g,ee,V,J),Ar(Ye,ze,Le,Ge,fe),Ie(re,k,k+ee,Le,Ge,ae),I-=ee,V+=ee*g.c,k+=ee}e(k==y),g.C=g.Ma=y}function Ke(){this.ub=this.yd=this.td=this.Rb=0}function Oe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Xe(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function nt(){this.Yb=function(){var g=[];return function y(k,I,V){for(var J=V[I],ee=0;ee<J&&(k.push(V.length>I+1?[]:0),!(V.length<I+1));ee++)y(k[ee],I+1,V)}(g,0,[3,11]),g}()}function Et(){this.jb=i(3),this.Wc=l([4,8],nt),this.Xc=l([4,17],nt)}function ot(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function gt(){this.ld=this.La=this.dd=this.tc=0}function Fe(){this.Na=this.la=0}function ns(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Gt(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function mt(){this.uc=this.M=this.Nb=0,this.wa=Array(new gt),this.Y=0,this.ya=Array(new Gt),this.aa=0,this.l=new ts}function Jt(){this.y=i(16),this.f=i(8),this.ea=i(8)}function ds(){this.cb=this.a=0,this.sc="",this.m=new Ne,this.Od=new Ke,this.Kc=new Oe,this.ed=new ot,this.Qa=new Xe,this.Ic=this.$c=this.Aa=0,this.D=new mt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,Ne),this.ia=0,this.pb=o(4,ns),this.Pa=new Et,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Jt),this.Hd=0,this.rb=Array(new Fe),this.sb=0,this.wa=Array(new gt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Gt),this.L=this.aa=0,this.gd=l([4,2],gt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ts(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function It(){var g=new ds;return g!=null&&(g.a=0,g.sc="OK",g.cb=0,g.Xb=0,Jp||(Jp=lc)),g}function fs(g,y,k){return g.a==0&&(g.a=y,g.sc=k,g.cb=0),0}function Zs(g,y,k){return 3<=k&&g[y+0]==157&&g[y+1]==1&&g[y+2]==42}function Pa(g,y){if(g==null)return 0;if(g.a=0,g.sc="OK",y==null)return fs(g,2,"null VP8Io passed to VP8GetHeaders()");var k=y.data,I=y.w,V=y.ha;if(4>V)return fs(g,7,"Truncated header.");var J=k[I+0]|k[I+1]<<8|k[I+2]<<16,ee=g.Od;if(ee.Rb=!(1&J),ee.td=J>>1&7,ee.yd=J>>4&1,ee.ub=J>>5,3<ee.td)return fs(g,3,"Incorrect keyframe parameters.");if(!ee.yd)return fs(g,4,"Frame not displayable.");I+=3,V-=3;var re=g.Kc;if(ee.Rb){if(7>V)return fs(g,7,"cannot parse picture header");if(!Zs(k,I,V))return fs(g,3,"Bad code word");re.c=16383&(k[I+4]<<8|k[I+3]),re.Td=k[I+4]>>6,re.i=16383&(k[I+6]<<8|k[I+5]),re.Ud=k[I+6]>>6,I+=7,V-=7,g.za=re.c+15>>4,g.Ub=re.i+15>>4,y.width=re.c,y.height=re.i,y.Da=0,y.j=0,y.v=0,y.va=y.width,y.o=y.height,y.da=0,y.ib=y.width,y.hb=y.height,y.U=y.width,y.T=y.height,n((J=g.Pa).jb,0,255,J.jb.length),e((J=g.Qa)!=null),J.Cb=0,J.Bb=0,J.Fb=1,n(J.Zb,0,0,J.Zb.length),n(J.Lb,0,0,J.Lb)}if(ee.ub>V)return fs(g,7,"bad partition length");D(J=g.m,k,I,ee.ub),I+=ee.ub,V-=ee.ub,ee.Rb&&(re.Ld=Se(J),re.Kd=Se(J)),re=g.Qa;var ae,fe=g.Pa;if(e(J!=null),e(re!=null),re.Cb=Se(J),re.Cb){if(re.Bb=Se(J),Se(J)){for(re.Fb=Se(J),ae=0;4>ae;++ae)re.Zb[ae]=Se(J)?$(J,7):0;for(ae=0;4>ae;++ae)re.Lb[ae]=Se(J)?$(J,6):0}if(re.Bb)for(ae=0;3>ae;++ae)fe.jb[ae]=Se(J)?M(J,8):255}else re.Bb=0;if(J.Ka)return fs(g,3,"cannot parse segment header");if((re=g.ed).zd=Se(J),re.Tb=M(J,6),re.wb=M(J,3),re.Pc=Se(J),re.Pc&&Se(J)){for(fe=0;4>fe;++fe)Se(J)&&(re.vd[fe]=$(J,6));for(fe=0;4>fe;++fe)Se(J)&&(re.od[fe]=$(J,6))}if(g.L=re.Tb==0?0:re.zd?1:2,J.Ka)return fs(g,3,"cannot parse filter header");var Le=V;if(V=ae=I,I=ae+Le,re=Le,g.Xb=(1<<M(g.m,2))-1,Le<3*(fe=g.Xb))k=7;else{for(ae+=3*fe,re-=3*fe,Le=0;Le<fe;++Le){var Ge=k[V+0]|k[V+1]<<8|k[V+2]<<16;Ge>re&&(Ge=re),D(g.Jc[+Le],k,ae,Ge),ae+=Ge,re-=Ge,V+=3}D(g.Jc[+fe],k,ae,re),k=ae<I?0:5}if(k!=0)return fs(g,k,"cannot parse partitions");for(k=M(ae=g.m,7),V=Se(ae)?$(ae,4):0,I=Se(ae)?$(ae,4):0,re=Se(ae)?$(ae,4):0,fe=Se(ae)?$(ae,4):0,ae=Se(ae)?$(ae,4):0,Le=g.Qa,Ge=0;4>Ge;++Ge){if(Le.Cb){var Ye=Le.Zb[Ge];Le.Fb||(Ye+=k)}else{if(0<Ge){g.pb[Ge]=g.pb[0];continue}Ye=k}var ze=g.pb[Ge];ze.Sc[0]=J2[Li(Ye+V,127)],ze.Sc[1]=Q2[Li(Ye+0,127)],ze.Eb[0]=2*J2[Li(Ye+I,127)],ze.Eb[1]=101581*Q2[Li(Ye+re,127)]>>16,8>ze.Eb[1]&&(ze.Eb[1]=8),ze.Qc[0]=J2[Li(Ye+fe,117)],ze.Qc[1]=Q2[Li(Ye+ae,127)],ze.lc=Ye+ae}if(!ee.Rb)return fs(g,4,"Not a key frame.");for(Se(J),ee=g.Pa,k=0;4>k;++k){for(V=0;8>V;++V)for(I=0;3>I;++I)for(re=0;11>re;++re)fe=Ee(J,mT[k][V][I][re])?M(J,8):hT[k][V][I][re],ee.Wc[k][V].Yb[I][re]=fe;for(V=0;17>V;++V)ee.Xc[k][V]=ee.Wc[k][pT[V]]}return g.kc=Se(J),g.kc&&(g.Bd=M(J,8)),g.cb=1}function lc(g,y,k,I,V,J,ee){var re=y[V].Yb[k];for(k=0;16>V;++V){if(!Ee(g,re[k+0]))return V;for(;!Ee(g,re[k+1]);)if(re=y[++V].Yb[0],k=0,V==16)return 16;var ae=y[V+1].Yb;if(Ee(g,re[k+2])){var fe=g,Le=0;if(Ee(fe,(Ye=re)[(Ge=k)+3]))if(Ee(fe,Ye[Ge+6])){for(re=0,Ge=2*(Le=Ee(fe,Ye[Ge+8]))+(Ye=Ee(fe,Ye[Ge+9+Le])),Le=0,Ye=dT[Ge];Ye[re];++re)Le+=Le+Ee(fe,Ye[re]);Le+=3+(8<<Ge)}else Ee(fe,Ye[Ge+7])?(Le=7+2*Ee(fe,165),Le+=Ee(fe,145)):Le=5+Ee(fe,159);else Le=Ee(fe,Ye[Ge+4])?3+Ee(fe,Ye[Ge+5]):2;re=ae[2]}else Le=1,re=ae[1];ae=ee+uT[V],0>(fe=g).b&&ye(fe);var Ge,Ye=fe.b,ze=(Ge=fe.Ca>>1)-(fe.I>>Ye)>>31;--fe.b,fe.Ca+=ze,fe.Ca|=1,fe.I-=(Ge+1&ze)<<Ye,J[ae]=((Le^ze)-ze)*I[(0<V)+0]}return 16}function Ei(g){var y=g.rb[g.sb-1];y.la=0,y.Na=0,n(g.zc,0,0,g.zc.length),g.ja=0}function na(g,y){if(g==null)return 0;if(y==null)return fs(g,2,"NULL VP8Io parameter in VP8Decode().");if(!g.cb&&!Pa(g,y))return 0;if(e(g.cb),y.ac==null||y.ac(y)){y.ob&&(g.L=0);var k=Kb[g.L];if(g.L==2?(g.yb=0,g.zb=0):(g.yb=y.v-k>>4,g.zb=y.j-k>>4,0>g.yb&&(g.yb=0),0>g.zb&&(g.zb=0)),g.Va=y.o+15+k>>4,g.Hb=y.va+15+k>>4,g.Hb>g.za&&(g.Hb=g.za),g.Va>g.Ub&&(g.Va=g.Ub),0<g.L){var I=g.ed;for(k=0;4>k;++k){var V;if(g.Qa.Cb){var J=g.Qa.Lb[k];g.Qa.Fb||(J+=I.Tb)}else J=I.Tb;for(V=0;1>=V;++V){var ee=g.gd[k][V],re=J;if(I.Pc&&(re+=I.vd[0],V&&(re+=I.od[0])),0<(re=0>re?0:63<re?63:re)){var ae=re;0<I.wb&&(ae=4<I.wb?ae>>2:ae>>1)>9-I.wb&&(ae=9-I.wb),1>ae&&(ae=1),ee.dd=ae,ee.tc=2*re+ae,ee.ld=40<=re?2:15<=re?1:0}else ee.tc=0;ee.La=V}}}k=0}else fs(g,6,"Frame setup failed"),k=g.a;if(k=k==0){if(k){g.$c=0,0<g.Aa||(g.Ic=CT);e:{k=g.Ic,I=4*(ae=g.za);var fe=32*ae,Le=ae+1,Ge=0<g.L?ae*(0<g.Aa?2:1):0,Ye=(g.Aa==2?2:1)*ae;if((ee=I+832+(V=3*(16*k+Kb[g.L])/2*fe)+(J=g.Fa!=null&&0<g.Fa.length?g.Kc.c*g.Kc.i:0))!=ee)k=0;else{if(ee>g.Vb){if(g.Vb=0,g.Ec=i(ee),g.Fc=0,g.Ec==null){k=fs(g,1,"no memory during frame initialization.");break e}g.Vb=ee}ee=g.Ec,re=g.Fc,g.Ac=ee,g.Bc=re,re+=I,g.Gd=o(fe,Jt),g.Hd=0,g.rb=o(Le+1,Fe),g.sb=1,g.wa=Ge?o(Ge,gt):null,g.Y=0,g.D.Nb=0,g.D.wa=g.wa,g.D.Y=g.Y,0<g.Aa&&(g.D.Y+=ae),e(!0),g.oc=ee,g.pc=re,re+=832,g.ya=o(Ye,Gt),g.aa=0,g.D.ya=g.ya,g.D.aa=g.aa,g.Aa==2&&(g.D.aa+=ae),g.R=16*ae,g.B=8*ae,ae=(fe=Kb[g.L])*g.R,fe=fe/2*g.B,g.sa=ee,g.ta=re+ae,g.qa=g.sa,g.ra=g.ta+16*k*g.R+fe,g.Ha=g.qa,g.Ia=g.ra+8*k*g.B+fe,g.$c=0,re+=V,g.mb=J?ee:null,g.nb=J?re:null,e(re+J<=g.Fc+g.Vb),Ei(g),n(g.Ac,g.Bc,0,I),k=1}}if(k){if(y.ka=0,y.y=g.sa,y.O=g.ta,y.f=g.qa,y.N=g.ra,y.ea=g.Ha,y.Vd=g.Ia,y.fa=g.R,y.Rc=g.B,y.F=null,y.J=0,!$b){for(k=-255;255>=k;++k)qr[255+k]=0>k?-k:k;for(k=-1020;1020>=k;++k)ol[1020+k]=-128>k?-128:127<k?127:k;for(k=-112;112>=k;++k)Xp[112+k]=-16>k?-16:15<k?15:k;for(k=-255;510>=k;++k)hf[255+k]=0>k?0:255<k?255:k;$b=1}cf=L2,al=C2,Gp=_b,Wn=E2,aa=Sb,jr=Nb,df=Rp,Bb=Yd,Yp=q2,Jd=Dp,Qd=U2,mc=Zh,Zd=Mp,uf=Ib,eu=Tb,pc=bo,Kp=rl,oa=z2,Da[0]=xo,Da[1]=P2,Da[2]=D2,Da[3]=M2,Da[4]=kb,Da[5]=Jh,Da[6]=Cb,Da[7]=Pp,Da[8]=O2,Da[9]=F2,gc[0]=jb,gc[1]=I2,gc[2]=sl,gc[3]=Kh,gc[4]=_n,gc[5]=R2,gc[6]=Ab,ll[0]=cc,ll[1]=T2,ll[2]=B2,ll[3]=Tp,ll[4]=Gd,ll[5]=$2,ll[6]=Ip,k=1}else k=0}k&&(k=function(ze,pt){for(ze.M=0;ze.M<ze.Va;++ze.M){var tt,Pe=ze.Jc[ze.M&ze.Xb],Re=ze.m,ht=ze;for(tt=0;tt<ht.za;++tt){var bt=Re,ft=ht,zt=ft.Ac,Mt=ft.Bc+4*tt,Zt=ft.zc,Bt=ft.ya[ft.aa+tt];if(ft.Qa.Bb?Bt.$b=Ee(bt,ft.Pa.jb[0])?2+Ee(bt,ft.Pa.jb[2]):Ee(bt,ft.Pa.jb[1]):Bt.$b=0,ft.kc&&(Bt.Ad=Ee(bt,ft.Bd)),Bt.Za=!Ee(bt,145)+0,Bt.Za){var Bs=Bt.Ob,zs=0;for(ft=0;4>ft;++ft){var Ts,Cs=Zt[0+ft];for(Ts=0;4>Ts;++Ts){Cs=fT[zt[Mt+Ts]][Cs];for(var Xs=Oj[Ee(bt,Cs[0])];0<Xs;)Xs=Oj[2*Xs+Ee(bt,Cs[Xs])];Cs=-Xs,zt[Mt+Ts]=Cs}r(Bs,zs,zt,Mt,4),zs+=4,Zt[0+ft]=Cs}}else Cs=Ee(bt,156)?Ee(bt,128)?1:3:Ee(bt,163)?2:0,Bt.Ob[0]=Cs,n(zt,Mt,Cs,4),n(Zt,0,Cs,4);Bt.Dd=Ee(bt,142)?Ee(bt,114)?Ee(bt,183)?1:3:2:0}if(ht.m.Ka)return fs(ze,7,"Premature end-of-partition0 encountered.");for(;ze.ja<ze.za;++ze.ja){if(ht=Pe,bt=(Re=ze).rb[Re.sb-1],zt=Re.rb[Re.sb+Re.ja],tt=Re.ya[Re.aa+Re.ja],Mt=Re.kc?tt.Ad:0)bt.la=zt.la=0,tt.Za||(bt.Na=zt.Na=0),tt.Hc=0,tt.Gc=0,tt.ia=0;else{var Gs,gs;if(bt=zt,zt=ht,Mt=Re.Pa.Xc,Zt=Re.ya[Re.aa+Re.ja],Bt=Re.pb[Zt.$b],ft=Zt.ad,Bs=0,zs=Re.rb[Re.sb-1],Cs=Ts=0,n(ft,Bs,0,384),Zt.Za)var Mr=0,hi=Mt[3];else{Xs=i(16);var Fr=bt.Na+zs.Na;if(Fr=Jp(zt,Mt[1],Fr,Bt.Eb,0,Xs,0),bt.Na=zs.Na=(0<Fr)+0,1<Fr)cf(Xs,0,ft,Bs);else{var fi=Xs[0]+3>>3;for(Xs=0;256>Xs;Xs+=16)ft[Bs+Xs]=fi}Mr=1,hi=Mt[0]}var Us=15&bt.la,Ti=15&zs.la;for(Xs=0;4>Xs;++Xs){var Ii=1&Ti;for(fi=gs=0;4>fi;++fi)Us=Us>>1|(Ii=(Fr=Jp(zt,hi,Fr=Ii+(1&Us),Bt.Sc,Mr,ft,Bs))>Mr)<<7,gs=gs<<2|(3<Fr?3:1<Fr?2:ft[Bs+0]!=0),Bs+=16;Us>>=4,Ti=Ti>>1|Ii<<7,Ts=(Ts<<8|gs)>>>0}for(hi=Us,Mr=Ti>>4,Gs=0;4>Gs;Gs+=2){for(gs=0,Us=bt.la>>4+Gs,Ti=zs.la>>4+Gs,Xs=0;2>Xs;++Xs){for(Ii=1&Ti,fi=0;2>fi;++fi)Fr=Ii+(1&Us),Us=Us>>1|(Ii=0<(Fr=Jp(zt,Mt[2],Fr,Bt.Qc,0,ft,Bs)))<<3,gs=gs<<2|(3<Fr?3:1<Fr?2:ft[Bs+0]!=0),Bs+=16;Us>>=2,Ti=Ti>>1|Ii<<5}Cs|=gs<<4*Gs,hi|=Us<<4<<Gs,Mr|=(240&Ti)<<Gs}bt.la=hi,zs.la=Mr,Zt.Hc=Ts,Zt.Gc=Cs,Zt.ia=43690&Cs?0:Bt.ia,Mt=!(Ts|Cs)}if(0<Re.L&&(Re.wa[Re.Y+Re.ja]=Re.gd[tt.$b][tt.Za],Re.wa[Re.Y+Re.ja].La|=!Mt),ht.Ka)return fs(ze,7,"Premature end-of-file encountered.")}if(Ei(ze),Re=pt,ht=1,tt=(Pe=ze).D,bt=0<Pe.L&&Pe.M>=Pe.zb&&Pe.M<=Pe.Va,Pe.Aa==0)e:{if(tt.M=Pe.M,tt.uc=bt,Up(Pe,tt),ht=1,tt=(gs=Pe.D).Nb,bt=(Cs=Kb[Pe.L])*Pe.R,zt=Cs/2*Pe.B,Xs=16*tt*Pe.R,fi=8*tt*Pe.B,Mt=Pe.sa,Zt=Pe.ta-bt+Xs,Bt=Pe.qa,ft=Pe.ra-zt+fi,Bs=Pe.Ha,zs=Pe.Ia-zt+fi,Ti=(Us=gs.M)==0,Ts=Us>=Pe.Va-1,Pe.Aa==2&&Up(Pe,gs),gs.uc)for(Ii=(Fr=Pe).D.M,e(Fr.D.uc),gs=Fr.yb;gs<Fr.Hb;++gs){Mr=gs,hi=Ii;var tn=(fn=(wr=Fr).D).Nb;Gs=wr.R;var fn=fn.wa[fn.Y+Mr],Vn=wr.sa,ua=wr.ta+16*tn*Gs+16*Mr,vo=fn.dd,sn=fn.tc;if(sn!=0)if(e(3<=sn),wr.L==1)0<Mr&&pc(Vn,ua,Gs,sn+4),fn.La&&oa(Vn,ua,Gs,sn),0<hi&&eu(Vn,ua,Gs,sn+4),fn.La&&Kp(Vn,ua,Gs,sn);else{var cl=wr.B,tu=wr.qa,ff=wr.ra+8*tn*cl+8*Mr,bc=wr.Ha,wr=wr.Ia+8*tn*cl+8*Mr;tn=fn.ld,0<Mr&&(Bb(Vn,ua,Gs,sn+4,vo,tn),Jd(tu,ff,bc,wr,cl,sn+4,vo,tn)),fn.La&&(mc(Vn,ua,Gs,sn,vo,tn),uf(tu,ff,bc,wr,cl,sn,vo,tn)),0<hi&&(df(Vn,ua,Gs,sn+4,vo,tn),Yp(tu,ff,bc,wr,cl,sn+4,vo,tn)),fn.La&&(Qd(Vn,ua,Gs,sn,vo,tn),Zd(tu,ff,bc,wr,cl,sn,vo,tn))}}if(Pe.ia&&alert("todo:DitherRow"),Re.put!=null){if(gs=16*Us,Us=16*(Us+1),Ti?(Re.y=Pe.sa,Re.O=Pe.ta+Xs,Re.f=Pe.qa,Re.N=Pe.ra+fi,Re.ea=Pe.Ha,Re.W=Pe.Ia+fi):(gs-=Cs,Re.y=Mt,Re.O=Zt,Re.f=Bt,Re.N=ft,Re.ea=Bs,Re.W=zs),Ts||(Us-=Cs),Us>Re.o&&(Us=Re.o),Re.F=null,Re.J=null,Pe.Fa!=null&&0<Pe.Fa.length&&gs<Us&&(Re.J=$p(Pe,Re,gs,Us-gs),Re.F=Pe.mb,Re.F==null&&Re.F.length==0)){ht=fs(Pe,3,"Could not decode alpha data.");break e}gs<Re.j&&(Cs=Re.j-gs,gs=Re.j,e(!(1&Cs)),Re.O+=Pe.R*Cs,Re.N+=Pe.B*(Cs>>1),Re.W+=Pe.B*(Cs>>1),Re.F!=null&&(Re.J+=Re.width*Cs)),gs<Us&&(Re.O+=Re.v,Re.N+=Re.v>>1,Re.W+=Re.v>>1,Re.F!=null&&(Re.J+=Re.v),Re.ka=gs-Re.j,Re.U=Re.va-Re.v,Re.T=Us-gs,ht=Re.put(Re))}tt+1!=Pe.Ic||Ts||(r(Pe.sa,Pe.ta-bt,Mt,Zt+16*Pe.R,bt),r(Pe.qa,Pe.ra-zt,Bt,ft+8*Pe.B,zt),r(Pe.Ha,Pe.Ia-zt,Bs,zs+8*Pe.B,zt))}if(!ht)return fs(ze,6,"Output aborted.")}return 1}(g,y)),y.bc!=null&&y.bc(y),k&=1}return k?(g.cb=0,k):0}function Ta(g,y,k,I,V){V=g[y+k+32*I]+(V>>3),g[y+k+32*I]=-256&V?0>V?0:255:V}function Yh(g,y,k,I,V,J){Ta(g,y,0,k,I+V),Ta(g,y,1,k,I+J),Ta(g,y,2,k,I-J),Ta(g,y,3,k,I-V)}function ci(g){return(20091*g>>16)+g}function Ep(g,y,k,I){var V,J=0,ee=i(16);for(V=0;4>V;++V){var re=g[y+0]+g[y+8],ae=g[y+0]-g[y+8],fe=(35468*g[y+4]>>16)-ci(g[y+12]),Le=ci(g[y+4])+(35468*g[y+12]>>16);ee[J+0]=re+Le,ee[J+1]=ae+fe,ee[J+2]=ae-fe,ee[J+3]=re-Le,J+=4,y++}for(V=J=0;4>V;++V)re=(g=ee[J+0]+4)+ee[J+8],ae=g-ee[J+8],fe=(35468*ee[J+4]>>16)-ci(ee[J+12]),Ta(k,I,0,0,re+(Le=ci(ee[J+4])+(35468*ee[J+12]>>16))),Ta(k,I,1,0,ae+fe),Ta(k,I,2,0,ae-fe),Ta(k,I,3,0,re-Le),J++,I+=32}function Nb(g,y,k,I){var V=g[y+0]+4,J=35468*g[y+4]>>16,ee=ci(g[y+4]),re=35468*g[y+1]>>16;Yh(k,I,0,V+ee,g=ci(g[y+1]),re),Yh(k,I,1,V+J,g,re),Yh(k,I,2,V-J,g,re),Yh(k,I,3,V-ee,g,re)}function C2(g,y,k,I,V){Ep(g,y,k,I),V&&Ep(g,y+16,k,I+4)}function _b(g,y,k,I){al(g,y+0,k,I,1),al(g,y+32,k,I+128,1)}function E2(g,y,k,I){var V;for(g=g[y+0]+4,V=0;4>V;++V)for(y=0;4>y;++y)Ta(k,I,y,V,g)}function Sb(g,y,k,I){g[y+0]&&Wn(g,y+0,k,I),g[y+16]&&Wn(g,y+16,k,I+4),g[y+32]&&Wn(g,y+32,k,I+128),g[y+48]&&Wn(g,y+48,k,I+128+4)}function L2(g,y,k,I){var V,J=i(16);for(V=0;4>V;++V){var ee=g[y+0+V]+g[y+12+V],re=g[y+4+V]+g[y+8+V],ae=g[y+4+V]-g[y+8+V],fe=g[y+0+V]-g[y+12+V];J[0+V]=ee+re,J[8+V]=ee-re,J[4+V]=fe+ae,J[12+V]=fe-ae}for(V=0;4>V;++V)ee=(g=J[0+4*V]+3)+J[3+4*V],re=J[1+4*V]+J[2+4*V],ae=J[1+4*V]-J[2+4*V],fe=g-J[3+4*V],k[I+0]=ee+re>>3,k[I+16]=fe+ae>>3,k[I+32]=ee-re>>3,k[I+48]=fe-ae>>3,I+=64}function Lp(g,y,k){var I,V=y-32,J=Pi,ee=255-g[V-1];for(I=0;I<k;++I){var re,ae=J,fe=ee+g[y-1];for(re=0;re<k;++re)g[y+re]=ae[fe+g[V+re]];y+=32}}function P2(g,y){Lp(g,y,4)}function T2(g,y){Lp(g,y,8)}function I2(g,y){Lp(g,y,16)}function sl(g,y){var k;for(k=0;16>k;++k)r(g,y+32*k,g,y-32,16)}function Kh(g,y){var k;for(k=16;0<k;--k)n(g,y,g[y-1],16),y+=32}function Xh(g,y,k){var I;for(I=0;16>I;++I)n(y,k+32*I,g,16)}function jb(g,y){var k,I=16;for(k=0;16>k;++k)I+=g[y-1+32*k]+g[y+k-32];Xh(I>>5,g,y)}function _n(g,y){var k,I=8;for(k=0;16>k;++k)I+=g[y-1+32*k];Xh(I>>4,g,y)}function R2(g,y){var k,I=8;for(k=0;16>k;++k)I+=g[y+k-32];Xh(I>>4,g,y)}function Ab(g,y){Xh(128,g,y)}function cs(g,y,k){return g+2*y+k+2>>2}function D2(g,y){var k,I=y-32;for(I=new Uint8Array([cs(g[I-1],g[I+0],g[I+1]),cs(g[I+0],g[I+1],g[I+2]),cs(g[I+1],g[I+2],g[I+3]),cs(g[I+2],g[I+3],g[I+4])]),k=0;4>k;++k)r(g,y+32*k,I,0,I.length)}function M2(g,y){var k=g[y-1],I=g[y-1+32],V=g[y-1+64],J=g[y-1+96];De(g,y+0,16843009*cs(g[y-1-32],k,I)),De(g,y+32,16843009*cs(k,I,V)),De(g,y+64,16843009*cs(I,V,J)),De(g,y+96,16843009*cs(V,J,J))}function xo(g,y){var k,I=4;for(k=0;4>k;++k)I+=g[y+k-32]+g[y-1+32*k];for(I>>=3,k=0;4>k;++k)n(g,y+32*k,I,4)}function kb(g,y){var k=g[y-1+0],I=g[y-1+32],V=g[y-1+64],J=g[y-1-32],ee=g[y+0-32],re=g[y+1-32],ae=g[y+2-32],fe=g[y+3-32];g[y+0+96]=cs(I,V,g[y-1+96]),g[y+1+96]=g[y+0+64]=cs(k,I,V),g[y+2+96]=g[y+1+64]=g[y+0+32]=cs(J,k,I),g[y+3+96]=g[y+2+64]=g[y+1+32]=g[y+0+0]=cs(ee,J,k),g[y+3+64]=g[y+2+32]=g[y+1+0]=cs(re,ee,J),g[y+3+32]=g[y+2+0]=cs(ae,re,ee),g[y+3+0]=cs(fe,ae,re)}function Cb(g,y){var k=g[y+1-32],I=g[y+2-32],V=g[y+3-32],J=g[y+4-32],ee=g[y+5-32],re=g[y+6-32],ae=g[y+7-32];g[y+0+0]=cs(g[y+0-32],k,I),g[y+1+0]=g[y+0+32]=cs(k,I,V),g[y+2+0]=g[y+1+32]=g[y+0+64]=cs(I,V,J),g[y+3+0]=g[y+2+32]=g[y+1+64]=g[y+0+96]=cs(V,J,ee),g[y+3+32]=g[y+2+64]=g[y+1+96]=cs(J,ee,re),g[y+3+64]=g[y+2+96]=cs(ee,re,ae),g[y+3+96]=cs(re,ae,ae)}function Jh(g,y){var k=g[y-1+0],I=g[y-1+32],V=g[y-1+64],J=g[y-1-32],ee=g[y+0-32],re=g[y+1-32],ae=g[y+2-32],fe=g[y+3-32];g[y+0+0]=g[y+1+64]=J+ee+1>>1,g[y+1+0]=g[y+2+64]=ee+re+1>>1,g[y+2+0]=g[y+3+64]=re+ae+1>>1,g[y+3+0]=ae+fe+1>>1,g[y+0+96]=cs(V,I,k),g[y+0+64]=cs(I,k,J),g[y+0+32]=g[y+1+96]=cs(k,J,ee),g[y+1+32]=g[y+2+96]=cs(J,ee,re),g[y+2+32]=g[y+3+96]=cs(ee,re,ae),g[y+3+32]=cs(re,ae,fe)}function Pp(g,y){var k=g[y+0-32],I=g[y+1-32],V=g[y+2-32],J=g[y+3-32],ee=g[y+4-32],re=g[y+5-32],ae=g[y+6-32],fe=g[y+7-32];g[y+0+0]=k+I+1>>1,g[y+1+0]=g[y+0+64]=I+V+1>>1,g[y+2+0]=g[y+1+64]=V+J+1>>1,g[y+3+0]=g[y+2+64]=J+ee+1>>1,g[y+0+32]=cs(k,I,V),g[y+1+32]=g[y+0+96]=cs(I,V,J),g[y+2+32]=g[y+1+96]=cs(V,J,ee),g[y+3+32]=g[y+2+96]=cs(J,ee,re),g[y+3+64]=cs(ee,re,ae),g[y+3+96]=cs(re,ae,fe)}function F2(g,y){var k=g[y-1+0],I=g[y-1+32],V=g[y-1+64],J=g[y-1+96];g[y+0+0]=k+I+1>>1,g[y+2+0]=g[y+0+32]=I+V+1>>1,g[y+2+32]=g[y+0+64]=V+J+1>>1,g[y+1+0]=cs(k,I,V),g[y+3+0]=g[y+1+32]=cs(I,V,J),g[y+3+32]=g[y+1+64]=cs(V,J,J),g[y+3+64]=g[y+2+64]=g[y+0+96]=g[y+1+96]=g[y+2+96]=g[y+3+96]=J}function O2(g,y){var k=g[y-1+0],I=g[y-1+32],V=g[y-1+64],J=g[y-1+96],ee=g[y-1-32],re=g[y+0-32],ae=g[y+1-32],fe=g[y+2-32];g[y+0+0]=g[y+2+32]=k+ee+1>>1,g[y+0+32]=g[y+2+64]=I+k+1>>1,g[y+0+64]=g[y+2+96]=V+I+1>>1,g[y+0+96]=J+V+1>>1,g[y+3+0]=cs(re,ae,fe),g[y+2+0]=cs(ee,re,ae),g[y+1+0]=g[y+3+32]=cs(k,ee,re),g[y+1+32]=g[y+3+64]=cs(I,k,ee),g[y+1+64]=g[y+3+96]=cs(V,I,k),g[y+1+96]=cs(J,V,I)}function B2(g,y){var k;for(k=0;8>k;++k)r(g,y+32*k,g,y-32,8)}function Tp(g,y){var k;for(k=0;8>k;++k)n(g,y,g[y-1],8),y+=32}function Vd(g,y,k){var I;for(I=0;8>I;++I)n(y,k+32*I,g,8)}function cc(g,y){var k,I=8;for(k=0;8>k;++k)I+=g[y+k-32]+g[y-1+32*k];Vd(I>>4,g,y)}function $2(g,y){var k,I=4;for(k=0;8>k;++k)I+=g[y+k-32];Vd(I>>3,g,y)}function Gd(g,y){var k,I=4;for(k=0;8>k;++k)I+=g[y-1+32*k];Vd(I>>3,g,y)}function Ip(g,y){Vd(128,g,y)}function Qh(g,y,k){var I=g[y-k],V=g[y+0],J=3*(V-I)+V2[1020+g[y-2*k]-g[y+k]],ee=zb[112+(J+4>>3)];g[y-k]=Pi[255+I+zb[112+(J+3>>3)]],g[y+0]=Pi[255+V-ee]}function Eb(g,y,k,I){var V=g[y+0],J=g[y+k];return ca[255+g[y-2*k]-g[y-k]]>I||ca[255+J-V]>I}function Lb(g,y,k,I){return 4*ca[255+g[y-k]-g[y+0]]+ca[255+g[y-2*k]-g[y+k]]<=I}function Pb(g,y,k,I,V){var J=g[y-3*k],ee=g[y-2*k],re=g[y-k],ae=g[y+0],fe=g[y+k],Le=g[y+2*k],Ge=g[y+3*k];return 4*ca[255+re-ae]+ca[255+ee-fe]>I?0:ca[255+g[y-4*k]-J]<=V&&ca[255+J-ee]<=V&&ca[255+ee-re]<=V&&ca[255+Ge-Le]<=V&&ca[255+Le-fe]<=V&&ca[255+fe-ae]<=V}function Tb(g,y,k,I){var V=2*I+1;for(I=0;16>I;++I)Lb(g,y+I,k,V)&&Qh(g,y+I,k)}function bo(g,y,k,I){var V=2*I+1;for(I=0;16>I;++I)Lb(g,y+I*k,1,V)&&Qh(g,y+I*k,1)}function rl(g,y,k,I){var V;for(V=3;0<V;--V)Tb(g,y+=4*k,k,I)}function z2(g,y,k,I){var V;for(V=3;0<V;--V)bo(g,y+=4,k,I)}function dc(g,y,k,I,V,J,ee,re){for(J=2*J+1;0<V--;){if(Pb(g,y,k,J,ee))if(Eb(g,y,k,re))Qh(g,y,k);else{var ae=g,fe=y,Le=k,Ge=ae[fe-2*Le],Ye=ae[fe-Le],ze=ae[fe+0],pt=ae[fe+Le],tt=ae[fe+2*Le],Pe=27*(ht=V2[1020+3*(ze-Ye)+V2[1020+Ge-pt]])+63>>7,Re=18*ht+63>>7,ht=9*ht+63>>7;ae[fe-3*Le]=Pi[255+ae[fe-3*Le]+ht],ae[fe-2*Le]=Pi[255+Ge+Re],ae[fe-Le]=Pi[255+Ye+Pe],ae[fe+0]=Pi[255+ze-Pe],ae[fe+Le]=Pi[255+pt-Re],ae[fe+2*Le]=Pi[255+tt-ht]}y+=I}}function Ia(g,y,k,I,V,J,ee,re){for(J=2*J+1;0<V--;){if(Pb(g,y,k,J,ee))if(Eb(g,y,k,re))Qh(g,y,k);else{var ae=g,fe=y,Le=k,Ge=ae[fe-Le],Ye=ae[fe+0],ze=ae[fe+Le],pt=zb[112+((tt=3*(Ye-Ge))+4>>3)],tt=zb[112+(tt+3>>3)],Pe=pt+1>>1;ae[fe-2*Le]=Pi[255+ae[fe-2*Le]+Pe],ae[fe-Le]=Pi[255+Ge+tt],ae[fe+0]=Pi[255+Ye-pt],ae[fe+Le]=Pi[255+ze-Pe]}y+=I}}function Rp(g,y,k,I,V,J){dc(g,y,k,1,16,I,V,J)}function Yd(g,y,k,I,V,J){dc(g,y,1,k,16,I,V,J)}function U2(g,y,k,I,V,J){var ee;for(ee=3;0<ee;--ee)Ia(g,y+=4*k,k,1,16,I,V,J)}function Zh(g,y,k,I,V,J){var ee;for(ee=3;0<ee;--ee)Ia(g,y+=4,1,k,16,I,V,J)}function q2(g,y,k,I,V,J,ee,re){dc(g,y,V,1,8,J,ee,re),dc(k,I,V,1,8,J,ee,re)}function Dp(g,y,k,I,V,J,ee,re){dc(g,y,1,V,8,J,ee,re),dc(k,I,1,V,8,J,ee,re)}function Mp(g,y,k,I,V,J,ee,re){Ia(g,y+4*V,V,1,8,J,ee,re),Ia(k,I+4*V,V,1,8,J,ee,re)}function Ib(g,y,k,I,V,J,ee,re){Ia(g,y+4,1,V,8,J,ee,re),Ia(k,I+4,1,V,8,J,ee,re)}function ef(){this.ba=new Pt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new jt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Fp(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Op(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Rb(){this.ua=0,this.Wa=new oe,this.vb=new oe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new H,this.yc=new T}function H2(){this.xb=this.a=0,this.l=new ts,this.ca=new Pt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new R,this.Pb=0,this.wd=new R,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Rb,this.ab=0,this.gc=o(4,Op),this.Oc=0}function tf(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ts,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Kd(g,y,k,I,V,J,ee){for(g=g==null?0:g[y+0],y=0;y<ee;++y)V[J+y]=g+k[I+y]&255,g=V[J+y]}function Bp(g,y,k,I,V,J,ee){var re;if(g==null)Kd(null,null,k,I,V,J,ee);else for(re=0;re<ee;++re)V[J+re]=g[y+re]+k[I+re]&255}function uc(g,y,k,I,V,J,ee){if(g==null)Kd(null,null,k,I,V,J,ee);else{var re,ae=g[y+0],fe=ae,Le=ae;for(re=0;re<ee;++re)fe=Le+(ae=g[y+re])-fe,Le=k[I+re]+(-256&fe?0>fe?0:255:fe)&255,fe=ae,V[J+re]=Le}}function $p(g,y,k,I){var V=y.width,J=y.o;if(e(g!=null&&y!=null),0>k||0>=I||k+I>J)return null;if(!g.Cc){if(g.ga==null){var ee;if(g.ga=new tf,(ee=g.ga==null)||(ee=y.width*y.o,e(g.Gb.length==0),g.Gb=i(ee),g.Uc=0,g.Gb==null?ee=0:(g.mb=g.Gb,g.nb=g.Uc,g.rc=null,ee=1),ee=!ee),!ee){ee=g.ga;var re=g.Fa,ae=g.P,fe=g.qc,Le=g.mb,Ge=g.nb,Ye=ae+1,ze=fe-1,pt=ee.l;if(e(re!=null&&Le!=null&&y!=null),xc[0]=null,xc[1]=Kd,xc[2]=Bp,xc[3]=uc,ee.ca=Le,ee.tb=Ge,ee.c=y.width,ee.i=y.height,e(0<ee.c&&0<ee.i),1>=fe)y=0;else if(ee.$a=re[ae+0]>>0&3,ee.Z=re[ae+0]>>2&3,ee.Lc=re[ae+0]>>4&3,ae=re[ae+0]>>6&3,0>ee.$a||1<ee.$a||4<=ee.Z||1<ee.Lc||ae)y=0;else if(pt.put=Os,pt.ac=Fs,pt.bc=be,pt.ma=ee,pt.width=y.width,pt.height=y.height,pt.Da=y.Da,pt.v=y.v,pt.va=y.va,pt.j=y.j,pt.o=y.o,ee.$a)e:{e(ee.$a==1),y=ut();t:for(;;){if(y==null){y=0;break e}if(e(ee!=null),ee.mc=y,y.c=ee.c,y.i=ee.i,y.l=ee.l,y.l.ma=ee,y.l.width=ee.c,y.l.height=ee.i,y.a=0,q(y.m,re,Ye,ze),!wt(ee.c,ee.i,1,y,null)||(y.ab==1&&y.gc[0].hc==3&&Ue(y.s)?(ee.ic=1,re=y.c*y.i,y.Ta=null,y.Ua=0,y.V=i(re),y.Ba=0,y.V==null?(y.a=1,y=0):y=1):(ee.ic=0,y=xt(y,ee.c)),!y))break t;y=1;break e}ee.mc=null,y=0}else y=ze>=ee.c*ee.i;ee=!y}if(ee)return null;g.ga.Lc!=1?g.Ga=0:I=J-k}e(g.ga!=null),e(k+I<=J);e:{if(y=(re=g.ga).c,J=re.l.o,re.$a==0){if(Ye=g.rc,ze=g.Vc,pt=g.Fa,ae=g.P+1+k*y,fe=g.mb,Le=g.nb+k*y,e(ae<=g.P+g.qc),re.Z!=0)for(e(xc[re.Z]!=null),ee=0;ee<I;++ee)xc[re.Z](Ye,ze,pt,ae,fe,Le,y),Ye=fe,ze=Le,Le+=y,ae+=y;else for(ee=0;ee<I;++ee)r(fe,Le,pt,ae,y),Ye=fe,ze=Le,Le+=y,ae+=y;g.rc=Ye,g.Vc=ze}else{if(e(re.mc!=null),y=k+I,e((ee=re.mc)!=null),e(y<=ee.i),ee.C>=y)y=1;else if(re.ic||qe(),re.ic){re=ee.V,Ye=ee.Ba,ze=ee.c;var tt=ee.i,Pe=(pt=1,ae=ee.$/ze,fe=ee.$%ze,Le=ee.m,Ge=ee.s,ee.$),Re=ze*tt,ht=ze*y,bt=Ge.wc,ft=Pe<ht?je(Ge,fe,ae):null;e(Pe<=Re),e(y<=tt),e(Ue(Ge));t:for(;;){for(;!Le.h&&Pe<ht;){if(fe&bt||(ft=je(Ge,fe,ae)),e(ft!=null),ce(Le),256>(tt=Y(ft.G[0],ft.H[0],Le)))re[Ye+Pe]=tt,++Pe,++fe>=ze&&(fe=0,++ae<=y&&!(ae%16)&&He(ee,ae));else{if(!(280>tt)){pt=0;break t}tt=Ve(tt-256,Le);var zt,Mt=Y(ft.G[4],ft.H[4],Le);if(ce(Le),!(Pe>=(Mt=ct(ze,Mt=Ve(Mt,Le)))&&Re-Pe>=tt)){pt=0;break t}for(zt=0;zt<tt;++zt)re[Ye+Pe+zt]=re[Ye+Pe+zt-Mt];for(Pe+=tt,fe+=tt;fe>=ze;)fe-=ze,++ae<=y&&!(ae%16)&&He(ee,ae);Pe<ht&&fe&bt&&(ft=je(Ge,fe,ae))}e(Le.h==Z(Le))}He(ee,ae>y?y:ae);break t}!pt||Le.h&&Pe<Re?(pt=0,ee.a=Le.h?5:3):ee.$=Pe,y=pt}else y=Me(ee,ee.V,ee.Ba,ee.c,ee.i,y,X);if(!y){I=0;break e}}k+I>=J&&(g.Cc=1),I=1}if(!I)return null;if(g.Cc&&((I=g.ga)!=null&&(I.mc=null),g.ga=null,0<g.Ga))return alert("todo:WebPDequantizeLevels"),null}return g.nb+k*V}function _(g,y,k,I,V,J){for(;0<V--;){var ee,re=g,ae=y+(k?1:0),fe=g,Le=y+(k?0:3);for(ee=0;ee<I;++ee){var Ge=fe[Le+4*ee];Ge!=255&&(Ge*=32897,re[ae+4*ee+0]=re[ae+4*ee+0]*Ge>>23,re[ae+4*ee+1]=re[ae+4*ee+1]*Ge>>23,re[ae+4*ee+2]=re[ae+4*ee+2]*Ge>>23)}y+=J}}function G(g,y,k,I,V){for(;0<I--;){var J;for(J=0;J<k;++J){var ee=g[y+2*J+0],re=15&(fe=g[y+2*J+1]),ae=4369*re,fe=(240&fe|fe>>4)*ae>>16;g[y+2*J+0]=(240&ee|ee>>4)*ae>>16&240|(15&ee|ee<<4)*ae>>16>>4&15,g[y+2*J+1]=240&fe|re}y+=V}}function ge(g,y,k,I,V,J,ee,re){var ae,fe,Le=255;for(fe=0;fe<V;++fe){for(ae=0;ae<I;++ae){var Ge=g[y+ae];J[ee+4*ae]=Ge,Le&=Ge}y+=k,ee+=re}return Le!=255}function ke(g,y,k,I,V){var J;for(J=0;J<V;++J)k[I+J]=g[y+J]>>8}function qe(){la=_,er=G,tr=ge,Ar=ke}function rt(g,y,k){C[g]=function(I,V,J,ee,re,ae,fe,Le,Ge,Ye,ze,pt,tt,Pe,Re,ht,bt){var ft,zt=bt-1>>1,Mt=re[ae+0]|fe[Le+0]<<16,Zt=Ge[Ye+0]|ze[pt+0]<<16;e(I!=null);var Bt=3*Mt+Zt+131074>>2;for(y(I[V+0],255&Bt,Bt>>16,tt,Pe),J!=null&&(Bt=3*Zt+Mt+131074>>2,y(J[ee+0],255&Bt,Bt>>16,Re,ht)),ft=1;ft<=zt;++ft){var Bs=re[ae+ft]|fe[Le+ft]<<16,zs=Ge[Ye+ft]|ze[pt+ft]<<16,Ts=Mt+Bs+Zt+zs+524296,Cs=Ts+2*(Bs+Zt)>>3;Bt=Cs+Mt>>1,Mt=(Ts=Ts+2*(Mt+zs)>>3)+Bs>>1,y(I[V+2*ft-1],255&Bt,Bt>>16,tt,Pe+(2*ft-1)*k),y(I[V+2*ft-0],255&Mt,Mt>>16,tt,Pe+(2*ft-0)*k),J!=null&&(Bt=Ts+Zt>>1,Mt=Cs+zs>>1,y(J[ee+2*ft-1],255&Bt,Bt>>16,Re,ht+(2*ft-1)*k),y(J[ee+2*ft+0],255&Mt,Mt>>16,Re,ht+(2*ft+0)*k)),Mt=Bs,Zt=zs}1&bt||(Bt=3*Mt+Zt+131074>>2,y(I[V+bt-1],255&Bt,Bt>>16,tt,Pe+(bt-1)*k),J!=null&&(Bt=3*Zt+Mt+131074>>2,y(J[ee+bt-1],255&Bt,Bt>>16,Re,ht+(bt-1)*k)))}}function vt(){da[Ub]=xT,da[qb]=$j,da[Dj]=bT,da[Hb]=zj,da[Wb]=Uj,da[G2]=qj,da[Mj]=yT,da[Y2]=$j,da[K2]=zj,da[Vb]=Uj,da[X2]=qj}function $t(g){return g&~vT?0>g?0:255:g>>Hj}function Qt(g,y){return $t((19077*g>>8)+(26149*y>>8)-14234)}function ms(g,y,k){return $t((19077*g>>8)-(6419*y>>8)-(13320*k>>8)+8708)}function us(g,y){return $t((19077*g>>8)+(33050*y>>8)-17685)}function Ls(g,y,k,I,V){I[V+0]=Qt(g,k),I[V+1]=ms(g,y,k),I[V+2]=us(g,y)}function fr(g,y,k,I,V){I[V+0]=us(g,y),I[V+1]=ms(g,y,k),I[V+2]=Qt(g,k)}function vr(g,y,k,I,V){var J=ms(g,y,k);y=J<<3&224|us(g,y)>>3,I[V+0]=248&Qt(g,k)|J>>5,I[V+1]=y}function Dr(g,y,k,I,V){var J=240&us(g,y)|15;I[V+0]=240&Qt(g,k)|ms(g,y,k)>>4,I[V+1]=J}function Sn(g,y,k,I,V){I[V+0]=255,Ls(g,y,k,I,V+1)}function en(g,y,k,I,V){fr(g,y,k,I,V),I[V+3]=255}function Ra(g,y,k,I,V){Ls(g,y,k,I,V),I[V+3]=255}function Li(g,y){return 0>g?0:g>y?y:g}function yo(g,y,k){C[g]=function(I,V,J,ee,re,ae,fe,Le,Ge){for(var Ye=Le+(-2&Ge)*k;Le!=Ye;)y(I[V+0],J[ee+0],re[ae+0],fe,Le),y(I[V+1],J[ee+0],re[ae+0],fe,Le+k),V+=2,++ee,++ae,Le+=2*k;1&Ge&&y(I[V+0],J[ee+0],re[ae+0],fe,Le)}}function Db(g,y,k){return k==0?g==0?y==0?6:5:y==0?4:0:k}function zp(g,y,k,I,V){switch(g>>>30){case 3:al(y,k,I,V,0);break;case 2:jr(y,k,I,V);break;case 1:Wn(y,k,I,V)}}function Up(g,y){var k,I,V=y.M,J=y.Nb,ee=g.oc,re=g.pc+40,ae=g.oc,fe=g.pc+584,Le=g.oc,Ge=g.pc+600;for(k=0;16>k;++k)ee[re+32*k-1]=129;for(k=0;8>k;++k)ae[fe+32*k-1]=129,Le[Ge+32*k-1]=129;for(0<V?ee[re-1-32]=ae[fe-1-32]=Le[Ge-1-32]=129:(n(ee,re-32-1,127,21),n(ae,fe-32-1,127,9),n(Le,Ge-32-1,127,9)),I=0;I<g.za;++I){var Ye=y.ya[y.aa+I];if(0<I){for(k=-1;16>k;++k)r(ee,re+32*k-4,ee,re+32*k+12,4);for(k=-1;8>k;++k)r(ae,fe+32*k-4,ae,fe+32*k+4,4),r(Le,Ge+32*k-4,Le,Ge+32*k+4,4)}var ze=g.Gd,pt=g.Hd+I,tt=Ye.ad,Pe=Ye.Hc;if(0<V&&(r(ee,re-32,ze[pt].y,0,16),r(ae,fe-32,ze[pt].f,0,8),r(Le,Ge-32,ze[pt].ea,0,8)),Ye.Za){var Re=ee,ht=re-32+16;for(0<V&&(I>=g.za-1?n(Re,ht,ze[pt].y[15],4):r(Re,ht,ze[pt+1].y,0,4)),k=0;4>k;k++)Re[ht+128+k]=Re[ht+256+k]=Re[ht+384+k]=Re[ht+0+k];for(k=0;16>k;++k,Pe<<=2)Re=ee,ht=re+Vj[k],Da[Ye.Ob[k]](Re,ht),zp(Pe,tt,16*+k,Re,ht)}else if(Re=Db(I,V,Ye.Ob[0]),gc[Re](ee,re),Pe!=0)for(k=0;16>k;++k,Pe<<=2)zp(Pe,tt,16*+k,ee,re+Vj[k]);for(k=Ye.Gc,Re=Db(I,V,Ye.Dd),ll[Re](ae,fe),ll[Re](Le,Ge),Pe=tt,Re=ae,ht=fe,255&(Ye=k>>0)&&(170&Ye?Gp(Pe,256,Re,ht):aa(Pe,256,Re,ht)),Ye=Le,Pe=Ge,255&(k>>=8)&&(170&k?Gp(tt,320,Ye,Pe):aa(tt,320,Ye,Pe)),V<g.Ub-1&&(r(ze[pt].y,0,ee,re+480,16),r(ze[pt].f,0,ae,fe+224,8),r(ze[pt].ea,0,Le,Ge+224,8)),k=8*J*g.B,ze=g.sa,pt=g.ta+16*I+16*J*g.R,tt=g.qa,Ye=g.ra+8*I+k,Pe=g.Ha,Re=g.Ia+8*I+k,k=0;16>k;++k)r(ze,pt+k*g.R,ee,re+32*k,16);for(k=0;8>k;++k)r(tt,Ye+k*g.B,ae,fe+32*k,8),r(Pe,Re+k*g.B,Le,Ge+32*k,8)}}function sf(g,y,k,I,V,J,ee,re,ae){var fe=[0],Le=[0],Ge=0,Ye=ae!=null?ae.kd:0,ze=ae??new Fp;if(g==null||12>k)return 7;ze.data=g,ze.w=y,ze.ha=k,y=[y],k=[k],ze.gb=[ze.gb];e:{var pt=y,tt=k,Pe=ze.gb;if(e(g!=null),e(tt!=null),e(Pe!=null),Pe[0]=0,12<=tt[0]&&!t(g,pt[0],"RIFF")){if(t(g,pt[0]+8,"WEBP")){Pe=3;break e}var Re=it(g,pt[0]+4);if(12>Re||4294967286<Re){Pe=3;break e}if(Ye&&Re>tt[0]-8){Pe=7;break e}Pe[0]=Re,pt[0]+=12,tt[0]-=12}Pe=0}if(Pe!=0)return Pe;for(Re=0<ze.gb[0],k=k[0];;){e:{var ht=g;tt=y,Pe=k;var bt=fe,ft=Le,zt=pt=[0];if((Bt=Ge=[Ge])[0]=0,8>Pe[0])Pe=7;else{if(!t(ht,tt[0],"VP8X")){if(it(ht,tt[0]+4)!=10){Pe=3;break e}if(18>Pe[0]){Pe=7;break e}var Mt=it(ht,tt[0]+8),Zt=1+Je(ht,tt[0]+12);if(2147483648<=Zt*(ht=1+Je(ht,tt[0]+15))){Pe=3;break e}zt!=null&&(zt[0]=Mt),bt!=null&&(bt[0]=Zt),ft!=null&&(ft[0]=ht),tt[0]+=18,Pe[0]-=18,Bt[0]=1}Pe=0}}if(Ge=Ge[0],pt=pt[0],Pe!=0)return Pe;if(tt=!!(2&pt),!Re&&Ge)return 3;if(J!=null&&(J[0]=!!(16&pt)),ee!=null&&(ee[0]=tt),re!=null&&(re[0]=0),ee=fe[0],pt=Le[0],Ge&&tt&&ae==null){Pe=0;break}if(4>k){Pe=7;break}if(Re&&Ge||!Re&&!Ge&&!t(g,y[0],"ALPH")){k=[k],ze.na=[ze.na],ze.P=[ze.P],ze.Sa=[ze.Sa];e:{Mt=g,Pe=y,Re=k;var Bt=ze.gb;bt=ze.na,ft=ze.P,zt=ze.Sa,Zt=22,e(Mt!=null),e(Re!=null),ht=Pe[0];var Bs=Re[0];for(e(bt!=null),e(zt!=null),bt[0]=null,ft[0]=null,zt[0]=0;;){if(Pe[0]=ht,Re[0]=Bs,8>Bs){Pe=7;break e}var zs=it(Mt,ht+4);if(4294967286<zs){Pe=3;break e}var Ts=8+zs+1&-2;if(Zt+=Ts,0<Bt&&Zt>Bt){Pe=3;break e}if(!t(Mt,ht,"VP8 ")||!t(Mt,ht,"VP8L")){Pe=0;break e}if(Bs[0]<Ts){Pe=7;break e}t(Mt,ht,"ALPH")||(bt[0]=Mt,ft[0]=ht+8,zt[0]=zs),ht+=Ts,Bs-=Ts}}if(k=k[0],ze.na=ze.na[0],ze.P=ze.P[0],ze.Sa=ze.Sa[0],Pe!=0)break}k=[k],ze.Ja=[ze.Ja],ze.xa=[ze.xa];e:if(Bt=g,Pe=y,Re=k,bt=ze.gb[0],ft=ze.Ja,zt=ze.xa,Mt=Pe[0],ht=!t(Bt,Mt,"VP8 "),Zt=!t(Bt,Mt,"VP8L"),e(Bt!=null),e(Re!=null),e(ft!=null),e(zt!=null),8>Re[0])Pe=7;else{if(ht||Zt){if(Bt=it(Bt,Mt+4),12<=bt&&Bt>bt-12){Pe=3;break e}if(Ye&&Bt>Re[0]-8){Pe=7;break e}ft[0]=Bt,Pe[0]+=8,Re[0]-=8,zt[0]=Zt}else zt[0]=5<=Re[0]&&Bt[Mt+0]==47&&!(Bt[Mt+4]>>5),ft[0]=Re[0];Pe=0}if(k=k[0],ze.Ja=ze.Ja[0],ze.xa=ze.xa[0],y=y[0],Pe!=0)break;if(4294967286<ze.Ja)return 3;if(re==null||tt||(re[0]=ze.xa?2:1),ee=[ee],pt=[pt],ze.xa){if(5>k){Pe=7;break}re=ee,Ye=pt,tt=J,g==null||5>k?g=0:5<=k&&g[y+0]==47&&!(g[y+4]>>5)?(Re=[0],Bt=[0],bt=[0],q(ft=new R,g,y,k),ve(ft,Re,Bt,bt)?(re!=null&&(re[0]=Re[0]),Ye!=null&&(Ye[0]=Bt[0]),tt!=null&&(tt[0]=bt[0]),g=1):g=0):g=0}else{if(10>k){Pe=7;break}re=pt,g==null||10>k||!Zs(g,y+3,k-3)?g=0:(Ye=g[y+0]|g[y+1]<<8|g[y+2]<<16,tt=16383&(g[y+7]<<8|g[y+6]),g=16383&(g[y+9]<<8|g[y+8]),1&Ye||3<(Ye>>1&7)||!(Ye>>4&1)||Ye>>5>=ze.Ja||!tt||!g?g=0:(ee&&(ee[0]=tt),re&&(re[0]=g),g=1))}if(!g||(ee=ee[0],pt=pt[0],Ge&&(fe[0]!=ee||Le[0]!=pt)))return 3;ae!=null&&(ae[0]=ze,ae.offset=y-ae.w,e(4294967286>y-ae.w),e(ae.offset==ae.ha-k));break}return Pe==0||Pe==7&&Ge&&ae==null?(J!=null&&(J[0]|=ze.na!=null&&0<ze.na.length),I!=null&&(I[0]=ee),V!=null&&(V[0]=pt),0):Pe}function qp(g,y,k){var I=y.width,V=y.height,J=0,ee=0,re=I,ae=V;if(y.Da=g!=null&&0<g.Da,y.Da&&(re=g.cd,ae=g.bd,J=g.v,ee=g.j,11>k||(J&=-2,ee&=-2),0>J||0>ee||0>=re||0>=ae||J+re>I||ee+ae>V))return 0;if(y.v=J,y.j=ee,y.va=J+re,y.o=ee+ae,y.U=re,y.T=ae,y.da=g!=null&&0<g.da,y.da){if(!et(re,ae,k=[g.ib],J=[g.hb]))return 0;y.ib=k[0],y.hb=J[0]}return y.ob=g!=null&&g.ob,y.Kb=g==null||!g.Sd,y.da&&(y.ob=y.ib<3*I/4&&y.hb<3*V/4,y.Kb=0),1}function Hp(g){if(g==null)return 2;if(11>g.S){var y=g.f.RGBA;y.fb+=(g.height-1)*y.A,y.A=-y.A}else y=g.f.kb,g=g.height,y.O+=(g-1)*y.fa,y.fa=-y.fa,y.N+=(g-1>>1)*y.Ab,y.Ab=-y.Ab,y.W+=(g-1>>1)*y.Db,y.Db=-y.Db,y.F!=null&&(y.J+=(g-1)*y.lb,y.lb=-y.lb);return 0}function rf(g,y,k,I){if(I==null||0>=g||0>=y)return 2;if(k!=null){if(k.Da){var V=k.cd,J=k.bd,ee=-2&k.v,re=-2&k.j;if(0>ee||0>re||0>=V||0>=J||ee+V>g||re+J>y)return 2;g=V,y=J}if(k.da){if(!et(g,y,V=[k.ib],J=[k.hb]))return 2;g=V[0],y=J[0]}}I.width=g,I.height=y;e:{var ae=I.width,fe=I.height;if(g=I.S,0>=ae||0>=fe||!(g>=Ub&&13>g))g=2;else{if(0>=I.Rd&&I.sd==null){ee=J=V=y=0;var Le=(re=ae*Gj[g])*fe;if(11>g||(J=(fe+1)/2*(y=(ae+1)/2),g==12&&(ee=(V=ae)*fe)),(fe=i(Le+2*J+ee))==null){g=1;break e}I.sd=fe,11>g?((ae=I.f.RGBA).eb=fe,ae.fb=0,ae.A=re,ae.size=Le):((ae=I.f.kb).y=fe,ae.O=0,ae.fa=re,ae.Fd=Le,ae.f=fe,ae.N=0+Le,ae.Ab=y,ae.Cd=J,ae.ea=fe,ae.W=0+Le+J,ae.Db=y,ae.Ed=J,g==12&&(ae.F=fe,ae.J=0+Le+2*J),ae.Tc=ee,ae.lb=V)}if(y=1,V=I.S,J=I.width,ee=I.height,V>=Ub&&13>V)if(11>V)g=I.f.RGBA,y&=(re=Math.abs(g.A))*(ee-1)+J<=g.size,y&=re>=J*Gj[V],y&=g.eb!=null;else{g=I.f.kb,re=(J+1)/2,Le=(ee+1)/2,ae=Math.abs(g.fa),fe=Math.abs(g.Ab);var Ge=Math.abs(g.Db),Ye=Math.abs(g.lb),ze=Ye*(ee-1)+J;y&=ae*(ee-1)+J<=g.Fd,y&=fe*(Le-1)+re<=g.Cd,y=(y&=Ge*(Le-1)+re<=g.Ed)&ae>=J&fe>=re&Ge>=re,y&=g.y!=null,y&=g.f!=null,y&=g.ea!=null,V==12&&(y&=Ye>=J,y&=ze<=g.Tc,y&=g.F!=null)}else y=0;g=y?0:2}}return g!=0||k!=null&&k.fd&&(g=Hp(I)),g}var hn=64,nf=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],af=24,of=32,Wp=8,di=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];he("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(g){return g},C.Predictor2=function(g,y,k){return y[k+0]},C.Predictor3=function(g,y,k){return y[k+1]},C.Predictor4=function(g,y,k){return y[k-1]},C.Predictor5=function(g,y,k){return Ae(Ae(g,y[k+1]),y[k+0])},C.Predictor6=function(g,y,k){return Ae(g,y[k-1])},C.Predictor7=function(g,y,k){return Ae(g,y[k+0])},C.Predictor8=function(g,y,k){return Ae(y[k-1],y[k+0])},C.Predictor9=function(g,y,k){return Ae(y[k+0],y[k+1])},C.Predictor10=function(g,y,k){return Ae(Ae(g,y[k-1]),Ae(y[k+0],y[k+1]))},C.Predictor11=function(g,y,k){var I=y[k+0];return 0>=Qe(I>>24&255,g>>24&255,(y=y[k-1])>>24&255)+Qe(I>>16&255,g>>16&255,y>>16&255)+Qe(I>>8&255,g>>8&255,y>>8&255)+Qe(255&I,255&g,255&y)?I:g},C.Predictor12=function(g,y,k){var I=y[k+0];return(Ze((g>>24&255)+(I>>24&255)-((y=y[k-1])>>24&255))<<24|Ze((g>>16&255)+(I>>16&255)-(y>>16&255))<<16|Ze((g>>8&255)+(I>>8&255)-(y>>8&255))<<8|Ze((255&g)+(255&I)-(255&y)))>>>0},C.Predictor13=function(g,y,k){var I=y[k-1];return($e((g=Ae(g,y[k+0]))>>24&255,I>>24&255)<<24|$e(g>>16&255,I>>16&255)<<16|$e(g>>8&255,I>>8&255)<<8|$e(g>>0&255,I>>0&255))>>>0};var W2=C.PredictorAdd0;C.PredictorAdd1=lt,he("Predictor2","PredictorAdd2"),he("Predictor3","PredictorAdd3"),he("Predictor4","PredictorAdd4"),he("Predictor5","PredictorAdd5"),he("Predictor6","PredictorAdd6"),he("Predictor7","PredictorAdd7"),he("Predictor8","PredictorAdd8"),he("Predictor9","PredictorAdd9"),he("Predictor10","PredictorAdd10"),he("Predictor11","PredictorAdd11"),he("Predictor12","PredictorAdd12"),he("Predictor13","PredictorAdd13");var Vp=C.PredictorAdd2;Dt("ColorIndexInverseTransform","MapARGB","32b",function(g){return g>>8&255},function(g){return g}),Dt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(g){return g},function(g){return g>>8&255});var Mb,ia=C.ColorIndexInverseTransform,lf=C.MapARGB,Fb=C.VP8LColorIndexInverseTransformAlpha,Ob=C.MapAlpha,hc=C.VP8LPredictorsAdd=[];hc.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var Xd,ui,Hn,fc,nl,il,cf,al,jr,Gp,Wn,aa,df,Bb,Yp,Jd,Qd,mc,Zd,uf,eu,pc,Kp,oa,la,er,tr,Ar,qr=i(511),ol=i(2041),Xp=i(225),hf=i(767),$b=0,V2=ol,zb=Xp,Pi=hf,ca=qr,Ub=0,qb=1,Dj=2,Hb=3,Wb=4,G2=5,Mj=6,Y2=7,K2=8,Vb=9,X2=10,rT=[2,3,7],nT=[3,3,11],Fj=[280,256,256,256,40],iT=[0,1,1,1,0],aT=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],oT=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],lT=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],cT=8,J2=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Q2=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Jp=null,dT=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],uT=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Oj=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],hT=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],fT=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],mT=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],pT=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],gc=[],Da=[],ll=[],gT=1,Bj=2,xc=[],da=[];rt("UpsampleRgbLinePair",Ls,3),rt("UpsampleBgrLinePair",fr,3),rt("UpsampleRgbaLinePair",Ra,4),rt("UpsampleBgraLinePair",en,4),rt("UpsampleArgbLinePair",Sn,4),rt("UpsampleRgba4444LinePair",Dr,2),rt("UpsampleRgb565LinePair",vr,2);var xT=C.UpsampleRgbLinePair,bT=C.UpsampleBgrLinePair,$j=C.UpsampleRgbaLinePair,zj=C.UpsampleBgraLinePair,Uj=C.UpsampleArgbLinePair,qj=C.UpsampleRgba4444LinePair,yT=C.UpsampleRgb565LinePair,Gb=16,Yb=1<<Gb-1,Qp=-227,Z2=482,Hj=6,vT=(256<<Hj)-1,Wj=0,wT=i(256),NT=i(256),_T=i(256),ST=i(256),jT=i(Z2-Qp),AT=i(Z2-Qp);yo("YuvToRgbRow",Ls,3),yo("YuvToBgrRow",fr,3),yo("YuvToRgbaRow",Ra,4),yo("YuvToBgraRow",en,4),yo("YuvToArgbRow",Sn,4),yo("YuvToRgba4444Row",Dr,2),yo("YuvToRgb565Row",vr,2);var Vj=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Kb=[0,2,8],kT=[8,7,6,4,4,2,2,2,1,1,1,1],CT=1;this.WebPDecodeRGBA=function(g,y,k,I,V){var J=qb,ee=new ef,re=new Pt;ee.ba=re,re.S=J,re.width=[re.width],re.height=[re.height];var ae=re.width,fe=re.height,Le=new kt;if(Le==null||g==null)var Ge=2;else e(Le!=null),Ge=sf(g,y,k,Le.width,Le.height,Le.Pd,Le.Qd,Le.format,null);if(Ge!=0?ae=0:(ae!=null&&(ae[0]=Le.width[0]),fe!=null&&(fe[0]=Le.height[0]),ae=1),ae){re.width=re.width[0],re.height=re.height[0],I!=null&&(I[0]=re.width),V!=null&&(V[0]=re.height);e:{if(I=new ts,(V=new Fp).data=g,V.w=y,V.ha=k,V.kd=1,y=[0],e(V!=null),((g=sf(V.data,V.w,V.ha,null,null,null,y,null,V))==0||g==7)&&y[0]&&(g=4),(y=g)==0){if(e(ee!=null),I.data=V.data,I.w=V.w+V.offset,I.ha=V.ha-V.offset,I.put=Os,I.ac=Fs,I.bc=be,I.ma=ee,V.xa){if((g=ut())==null){ee=1;break e}if(function(Ye,ze){var pt=[0],tt=[0],Pe=[0];t:for(;;){if(Ye==null)return 0;if(ze==null)return Ye.a=2,0;if(Ye.l=ze,Ye.a=0,q(Ye.m,ze.data,ze.w,ze.ha),!ve(Ye.m,pt,tt,Pe)){Ye.a=3;break t}if(Ye.xb=Bj,ze.width=pt[0],ze.height=tt[0],!wt(pt[0],tt[0],1,Ye,null))break t;return 1}return e(Ye.a!=0),0}(g,I)){if(I=(y=rf(I.width,I.height,ee.Oa,ee.ba))==0){t:{I=g;s:for(;;){if(I==null){I=0;break t}if(e(I.s.yc!=null),e(I.s.Ya!=null),e(0<I.s.Wb),e((k=I.l)!=null),e((V=k.ma)!=null),I.xb!=0){if(I.ca=V.ba,I.tb=V.tb,e(I.ca!=null),!qp(V.Oa,k,Hb)){I.a=2;break s}if(!xt(I,k.width)||k.da)break s;if((k.da||at(I.ca.S))&&qe(),11>I.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),I.ca.f.kb.F!=null&&qe()),I.Pb&&0<I.s.ua&&I.s.vb.X==null&&!Be(I.s.vb,I.s.Wa.Xa)){I.a=1;break s}I.xb=0}if(!Me(I,I.V,I.Ba,I.c,I.i,k.o,le))break s;V.Dc=I.Ma,I=1;break t}e(I.a!=0),I=0}I=!I}I&&(y=g.a)}else y=g.a}else{if((g=new It)==null){ee=1;break e}if(g.Fa=V.na,g.P=V.P,g.qc=V.Sa,Pa(g,I)){if((y=rf(I.width,I.height,ee.Oa,ee.ba))==0){if(g.Aa=0,k=ee.Oa,e((V=g)!=null),k!=null){if(0<(ae=0>(ae=k.Md)?0:100<ae?255:255*ae/100)){for(fe=Le=0;4>fe;++fe)12>(Ge=V.pb[fe]).lc&&(Ge.ia=ae*kT[0>Ge.lc?0:Ge.lc]>>3),Le|=Ge.ia;Le&&(alert("todo:VP8InitRandom"),V.ia=1)}V.Ga=k.Id,100<V.Ga?V.Ga=100:0>V.Ga&&(V.Ga=0)}na(g,I)||(y=g.a)}}else y=g.a}y==0&&ee.Oa!=null&&ee.Oa.fd&&(y=Hp(ee.ba))}ee=y}J=ee!=0?null:11>J?re.f.RGBA.eb:re.f.kb.y}else J=null;return J};var Gj=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(C,B){for(var U="",P=0;P<4;P++)U+=String.fromCharCode(C[B++]);return U}function u(C,B){return(C[B+0]<<0|C[B+1]<<8|C[B+2]<<16)>>>0}function h(C,B){return(C[B+0]<<0|C[B+1]<<8|C[B+2]<<16|C[B+3]<<24)>>>0}new c;var m=[0],p=[0],x=[],w=new c,S=s,b=function(C,B){var U={},P=0,T=!1,z=0,H=0;if(U.frames=[],!function(W,Z,ue,ce){for(var ye=0;ye<ce;ye++)if(W[Z+ye]!=ue.charCodeAt(ye))return!0;return!1}(C,B,"RIFF",4)){var D,M;for(h(C,B+=4),B+=8;B<C.length;){var $=d(C,B),q=h(C,B+=4);B+=4;var K=q+(1&q);switch($){case"VP8 ":case"VP8L":U.frames[P]===void 0&&(U.frames[P]={}),(R=U.frames[P]).src_off=T?H:B-8,R.src_size=z+q+8,P++,T&&(T=!1,z=0,H=0);break;case"VP8X":(R=U.header={}).feature_flags=C[B];var de=B+4;R.canvas_width=1+u(C,de),de+=3,R.canvas_height=1+u(C,de),de+=3;break;case"ALPH":T=!0,z=K+8,H=B-8;break;case"ANIM":(R=U.header).bgcolor=h(C,B),de=B+4,R.loop_count=(D=C)[(M=de)+0]<<0|D[M+1]<<8,de+=2;break;case"ANMF":var Ne,R;(R=U.frames[P]={}).offset_x=2*u(C,B),B+=3,R.offset_y=2*u(C,B),B+=3,R.width=1+u(C,B),B+=3,R.height=1+u(C,B),B+=3,R.duration=u(C,B),B+=3,Ne=C[B++],R.dispose=1&Ne,R.blend=Ne>>1&1}$!="ANMF"&&(B+=K)}return U}}(S,0);b.response=S,b.rgbaoutput=!0,b.dataurl=!1;var v=b.header?b.header:null,N=b.frames?b.frames:null;if(v){v.loop_counter=v.loop_count,m=[v.canvas_height],p=[v.canvas_width];for(var j=0;j<N.length&&N[j].blend!=0;j++);}var E=N[0],A=w.WebPDecodeRGBA(S,E.src_off,E.src_size,p,m);E.rgba=A,E.imgwidth=p[0],E.imgheight=m[0];for(var L=0;L<p[0]*m[0]*4;L++)x[L]=A[L];return this.width=p,this.height=m,this.data=x,this}(function(s){var e=function(){return typeof Y_=="function"},t=function(m,p,x,w){var S=4,b=o;switch(w){case s.image_compression.FAST:S=1,b=i;break;case s.image_compression.MEDIUM:S=6,b=l;break;case s.image_compression.SLOW:S=9,b=c}m=r(m,p,x,b);var v=Y_(m,{level:S});return s.__addimage__.arrayBufferToBinaryString(v)},r=function(m,p,x,w){for(var S,b,v,N=m.length/p,j=new Uint8Array(m.length+N),E=u(),A=0;A<N;A+=1){if(v=A*p,S=m.subarray(v,v+p),w)j.set(w(S,x,b),v+A);else{for(var L,C=E.length,B=[];L<C;L+=1)B[L]=E[L](S,x,b);var U=h(B.concat());j.set(B[U],v+A)}b=S}return j},n=function(m){var p=Array.apply([],m);return p.unshift(0),p},i=function(m,p){var x,w=[],S=m.length;w[0]=1;for(var b=0;b<S;b+=1)x=m[b-p]||0,w[b+1]=m[b]-x+256&255;return w},o=function(m,p,x){var w,S=[],b=m.length;S[0]=2;for(var v=0;v<b;v+=1)w=x&&x[v]||0,S[v+1]=m[v]-w+256&255;return S},l=function(m,p,x){var w,S,b=[],v=m.length;b[0]=3;for(var N=0;N<v;N+=1)w=m[N-p]||0,S=x&&x[N]||0,b[N+1]=m[N]+256-(w+S>>>1)&255;return b},c=function(m,p,x){var w,S,b,v,N=[],j=m.length;N[0]=4;for(var E=0;E<j;E+=1)w=m[E-p]||0,S=x&&x[E]||0,b=x&&x[E-p]||0,v=d(w,S,b),N[E+1]=m[E]-v+256&255;return N},d=function(m,p,x){if(m===p&&p===x)return m;var w=Math.abs(p-x),S=Math.abs(m-x),b=Math.abs(m+p-x-x);return w<=S&&w<=b?m:S<=b?p:x},u=function(){return[n,i,o,l,c]},h=function(m){var p=m.map(function(x){return x.reduce(function(w,S){return w+Math.abs(S)},0)});return p.indexOf(Math.min.apply(null,p))};s.processPNG=function(m,p,x,w){var S,b,v,N,j,E,A,L,C,B,U,P,T,z,H,D=this.decode.FLATE_DECODE,M="";if(this.__addimage__.isArrayBuffer(m)&&(m=new Uint8Array(m)),this.__addimage__.isArrayBufferView(m)){if(m=(v=new J9(m)).imgData,b=v.bits,S=v.colorSpace,j=v.colors,[4,6].indexOf(v.colorType)!==-1){if(v.bits===8){C=(L=v.pixelBitlength==32?new Uint32Array(v.decodePixels().buffer):v.pixelBitlength==16?new Uint16Array(v.decodePixels().buffer):new Uint8Array(v.decodePixels().buffer)).length,U=new Uint8Array(C*v.colors),B=new Uint8Array(C);var $,q=v.pixelBitlength-v.bits;for(z=0,H=0;z<C;z++){for(T=L[z],$=0;$<q;)U[H++]=T>>>$&255,$+=v.bits;B[z]=T>>>$&255}}if(v.bits===16){C=(L=new Uint32Array(v.decodePixels().buffer)).length,U=new Uint8Array(C*(32/v.pixelBitlength)*v.colors),B=new Uint8Array(C*(32/v.pixelBitlength)),P=v.colors>1,z=0,H=0;for(var K=0;z<C;)T=L[z++],U[H++]=T>>>0&255,P&&(U[H++]=T>>>16&255,T=L[z++],U[H++]=T>>>0&255),B[K++]=T>>>16&255;b=8}w!==s.image_compression.NONE&&e()?(m=t(U,v.width*v.colors,v.colors,w),A=t(B,v.width,1,w)):(m=U,A=B,D=void 0)}if(v.colorType===3&&(S=this.color_spaces.INDEXED,E=v.palette,v.transparency.indexed)){var de=v.transparency.indexed,Ne=0;for(z=0,C=de.length;z<C;++z)Ne+=de[z];if((Ne/=255)===C-1&&de.indexOf(0)!==-1)N=[de.indexOf(0)];else if(Ne!==C){for(L=v.decodePixels(),B=new Uint8Array(L.length),z=0,C=L.length;z<C;z++)B[z]=de[L[z]];A=t(B,v.width,1)}}var R=function(W){var Z;switch(W){case s.image_compression.FAST:Z=11;break;case s.image_compression.MEDIUM:Z=13;break;case s.image_compression.SLOW:Z=14;break;default:Z=12}return Z}(w);return D===this.decode.FLATE_DECODE&&(M="/Predictor "+R+" "),M+="/Colors "+j+" /BitsPerComponent "+b+" /Columns "+v.width,(this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),(A&&this.__addimage__.isArrayBuffer(A)||this.__addimage__.isArrayBufferView(A))&&(A=this.__addimage__.arrayBufferToBinaryString(A)),{alias:x,data:m,index:p,filter:D,decodeParameters:M,transparency:N,palette:E,sMask:A,predictor:R,width:v.width,height:v.height,bitsPerComponent:b,colorSpace:S}}}})(es.API),function(s){s.processGIF89A=function(e,t,r,n){var i=new Q9(e),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},u=new u5(100).encode(d,100);return s.processJPEG.call(this,u,t,r,n)},s.processGIF87A=s.processGIF89A}(es.API),Ba.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var s=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(s);for(var e=0;e<s;e++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:n,green:r,blue:t,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ba.prototype.parseBGR=function(){this.pos=this.offset;try{var s="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[s]()}catch(t){Js.log("bit decode error:"+t)}},Ba.prototype.bit1=function(){var s,e=Math.ceil(this.width/8),t=e%4;for(s=this.height-1;s>=0;s--){for(var r=this.bottom_up?s:this.height-1-s,n=0;n<e;n++)for(var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+8*n*4,l=0;l<8&&8*n+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}t!==0&&(this.pos+=4-t)}},Ba.prototype.bit4=function(){for(var s=Math.ceil(this.width/2),e=s%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<s;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+2*n*4,l=i>>4,c=15&i,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*n+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Ba.prototype.bit8=function(){for(var s=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;if(n<this.palette.length){var o=this.palette[n];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}s!==0&&(this.pos+=4-s)}},Ba.prototype.bit15=function(){for(var s=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,l=(i>>5&e)/e*255|0,c=(i>>10&e)/e*255|0,d=i>>15?255:0,u=r*this.width*4+4*n;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=d}this.pos+=s}},Ba.prototype.bit16=function(){for(var s=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&e)/e*255|0,c=(o>>5&t)/t*255|0,d=(o>>11)/e*255|0,u=n*this.width*4+4*i;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=s}},Ba.prototype.bit24=function(){for(var s=this.height-1;s>=0;s--){for(var e=this.bottom_up?s:this.height-1-s,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=r,this.data[o+3]=255}this.pos+=this.width%4}},Ba.prototype.bit32=function(){for(var s=this.height-1;s>=0;s--)for(var e=this.bottom_up?s:this.height-1-s,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*t;this.data[l]=i,this.data[l+1]=n,this.data[l+2]=r,this.data[l+3]=o}},Ba.prototype.getData=function(){return this.data},function(s){s.processBMP=function(e,t,r,n){var i=new Ba(e,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new u5(100).encode(c,100);return s.processJPEG.call(this,d,t,r,n)}}(es.API),W3.prototype.getData=function(){return this.data},function(s){s.processWEBP=function(e,t,r,n){var i=new W3(e),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new u5(100).encode(c,100);return s.processJPEG.call(this,d,t,r,n)}}(es.API),es.API.processRGBA=function(s,e,t){for(var r=s.data,n=r.length,i=new Uint8Array(n/4*3),o=new Uint8Array(n/4),l=0,c=0,d=0;d<n;d+=4){var u=r[d],h=r[d+1],m=r[d+2],p=r[d+3];i[l++]=u,i[l++]=h,i[l++]=m,o[c++]=p}var x=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:x,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:s.width,height:s.height}},es.API.setLanguage=function(s){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[s]!==void 0&&(this.internal.languageSettings.languageCode=s,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},jf=es.API,Fy=jf.getCharWidthsArray=function(s,e){var t,r,n=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:n.metadata.Unicode.widths,c=l.fof?l.fof:1,d=e.kerning?e.kerning:n.metadata.Unicode.kerning,u=d.fof?d.fof:1,h=e.doKerning!==!1,m=0,p=s.length,x=0,w=l[0]||c,S=[];for(t=0;t<p;t++)r=s.charCodeAt(t),typeof n.metadata.widthOfString=="function"?S.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(r))+o*(1e3/i)||0)/1e3):(m=h&&Ws(d[r])==="object"&&!isNaN(parseInt(d[r][x],10))?d[r][x]/u:0,S.push((l[r]||w)/c+m)),x=r;return S},z3=jf.getStringUnitWidth=function(s,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),n=e.charSpace||this.internal.getCharSpace();return jf.processArabic&&(s=jf.processArabic(s)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(s,t,n)/t:Fy.apply(this,arguments).reduce(function(i,o){return i+o},0)},U3=function(s,e,t,r){for(var n=[],i=0,o=s.length,l=0;i!==o&&l+e[i]<t;)l+=e[i],i++;n.push(s.slice(0,i));var c=i;for(l=0;i!==o;)l+e[i]>r&&(n.push(s.slice(c,i)),l=0,c=i),l+=e[i],i++;return c!==i&&n.push(s.slice(c,i)),n},q3=function(s,e,t){t||(t={});var r,n,i,o,l,c,d,u=[],h=[u],m=t.textIndent||0,p=0,x=0,w=s.split(" "),S=Fy.apply(this,[" ",t])[0];if(c=t.lineIndent===-1?w[0].length+2:t.lineIndent||0){var b=Array(c).join(" "),v=[];w.map(function(j){(j=j.split(/\s*\n/)).length>1?v=v.concat(j.map(function(E,A){return(A&&E.length?`
`:"")+E})):v.push(j[0])}),w=v,c=z3.apply(this,[b,t])}for(i=0,o=w.length;i<o;i++){var N=0;if(r=w[i],c&&r[0]==`
`&&(r=r.substr(1),N=1),m+p+(x=(n=Fy.apply(this,[r,t])).reduce(function(j,E){return j+E},0))>e||N){if(x>e){for(l=U3.apply(this,[r,n,e-(m+p),e]),u.push(l.shift()),u=[l.pop()];l.length;)h.push([l.shift()]);x=n.slice(r.length-(u[0]?u[0].length:0)).reduce(function(j,E){return j+E},0)}else u=[r];h.push(u),m=x+c,p=S}else u.push(r),m+=p+x,p=S}return d=c?function(j,E){return(E?b:"")+j.join(" ")}:function(j){return j.join(" ")},h.map(d)},jf.splitTextToSize=function(s,e,t){var r,n=(t=t||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var h=this.internal.getFont(u.fontName,u.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(s)?s:String(s).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/n;i.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=t.lineIndent;var l,c,d=[];for(l=0,c=r.length;l<c;l++)d=d.concat(q3.apply(this,[r[l],o,i]));return d},function(s){s.__fontmetrics__=s.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},r={},n=0;n<e.length;n++)t[e[n]]="0123456789abcdef"[n],r["0123456789abcdef"[n]]=e[n];var i=function(h){return"0x"+parseInt(h,10).toString(16)},o=s.__fontmetrics__.compress=function(h){var m,p,x,w,S=["{"];for(var b in h){if(m=h[b],isNaN(parseInt(b,10))?p="'"+b+"'":(b=parseInt(b,10),p=(p=i(b).slice(2)).slice(0,-1)+r[p.slice(-1)]),typeof m=="number")m<0?(x=i(m).slice(3),w="-"):(x=i(m).slice(2),w=""),x=w+x.slice(0,-1)+r[x.slice(-1)];else{if(Ws(m)!=="object")throw new Error("Don't know what to do with value type "+Ws(m)+".");x=o(m)}S.push(p+x)}return S.push("}"),S.join("")},l=s.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,p,x,w,S={},b=1,v=S,N=[],j="",E="",A=h.length-1,L=1;L<A;L+=1)(w=h[L])=="'"?m?(x=m.join(""),m=void 0):m=[]:m?m.push(w):w=="{"?(N.push([v,x]),v={},x=void 0):w=="}"?((p=N.pop())[0][p[1]]=v,x=void 0,v=p[0]):w=="-"?b=-1:x===void 0?t.hasOwnProperty(w)?(j+=t[w],x=parseInt(j,16)*b,b=1,j=""):j+=w:t.hasOwnProperty(w)?(E+=t[w],v[x]=parseInt(E,16)*b,b=1,x=void 0,E=""):E+=w;return S},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};s.events.push(["addFont",function(h){var m=h.font,p=u.Unicode[m.postScriptName];p&&(m.metadata.Unicode={},m.metadata.Unicode.widths=p.widths,m.metadata.Unicode.kerning=p.kerning);var x=d.Unicode[m.postScriptName];x&&(m.metadata.Unicode.encoding=x,m.encoding=x.codePages[0])}])}(es.API),function(s){var e=function(t){for(var r=t.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=t.charCodeAt(i);return n};s.API.events.push(["addFont",function(t){var r=void 0,n=t.font,i=t.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(r=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(rg(l)),o.metadata=s.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,r)}}])}(es),function(s){function e(){return(is.canvg?Promise.resolve(is.canvg):nc(()=>import("./index.es-DgP4A6VI.js"),[])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}es.API.addSvgAsImage=function(t,r,n,i,o,l,c,d){if(isNaN(r)||isNaN(n))throw Js.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw Js.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=o;var h=u.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,u.width,u.height);var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return e().then(function(x){return x.fromString(h,t,m)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(m)}).then(function(){p.addImage(u.toDataURL("image/jpeg",1),r,n,i,o,c,d)})}}(),es.API.putTotalPages=function(s){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(s,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(s,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var n=0;n<this.internal.pages[r].length;n++)this.internal.pages[r][n]=this.internal.pages[r][n].replace(e,t);return this},es.API.viewerPreferences=function(s,e){var t;s=s||{},e=e||!1;var r,n,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,u=0,h=0;function m(x,w){var S,b=!1;for(S=0;S<x.length;S+=1)x[S]===w&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,s==="reset"||e===!0){var p=l.length;for(h=0;h<p;h+=1)t[l[h]].value=t[l[h]].defaultValue,t[l[h]].explicitSet=!1}if(Ws(s)==="object"){for(n in s)if(i=s[n],m(l,n)&&i!==void 0){if(t[n].type==="boolean"&&typeof i=="boolean")t[n].value=i;else if(t[n].type==="name"&&m(t[n].valueSet,i))t[n].value=i;else if(t[n].type==="integer"&&Number.isInteger(i))t[n].value=i;else if(t[n].type==="array"){for(d=0;d<i.length;d+=1)if(r=!0,i[d].length===1&&typeof i[d][0]=="number")c.push(String(i[d]-1));else if(i[d].length>1){for(u=0;u<i[d].length;u+=1)typeof i[d][u]!="number"&&(r=!1);r===!0&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}t[n].value="["+c.join(" ")+"]"}else t[n].value=t[n].defaultValue;t[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,w=[];for(x in t)t[x].explicitSet===!0&&(t[x].type==="name"?w.push("/"+x+" /"+t[x].value):w.push("/"+x+" "+t[x].value));w.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+w.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(s){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(r)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+o.length+l.length+n.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(n+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};s.addMetadata=function(r,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(es.API),function(s){var e=s.API,t=e.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],h=0,m=i.length;h<m;++h){if(l=o.metadata.characterToGlyph(i.charCodeAt(h)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(h),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},r=function(i){var o,l,c,d,u,h,m;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,m=(l=Object.keys(i).sort(function(p,x){return p-x})).length;h<m;h++)o=l[h],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(d=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof s.API.TTFFont&&l.encoding==="Identity-H"){for(var h=l.metadata.Unicode.widths,m=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),p="",x=0;x<m.length;x++)p+=String.fromCharCode(m[x]);var w=d();u({data:p,addLength1:!0,objectId:w}),c("endobj");var S=d();u({data:r(l.metadata.toUnicode),addLength1:!0,objectId:S}),c("endobj");var b=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Ff(l.fontName)),c("/FontFile2 "+w+" 0 R"),c("/FontBBox "+s.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var v=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+Ff(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+s.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+S+" 0 R"),c("/BaseFont /"+Ff(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof s.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var h=l.metadata.rawData,m="",p=0;p<h.length;p++)m+=String.fromCharCode(h[p]);var x=d();u({data:m,addLength1:!0,objectId:x}),c("endobj");var w=d();u({data:r(l.metadata.toUnicode),addLength1:!0,objectId:w}),c("endobj");var S=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+s.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Ff(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+w+" 0 R/BaseFont/"+Ff(l.fontName)+"/FontDescriptor "+S+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+s.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var n=function(i){var o,l=i.text||"",c=i.x,d=i.y,u=i.options||{},h=i.mutex||{},m=h.pdfEscape,p=h.activeFontKey,x=h.fonts,w=p,S="",b=0,v="",N=x[w].encoding;if(x[w].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:h};for(v=l,w=p,Array.isArray(l)&&(v=l[0]),b=0;b<v.length;b+=1)x[w].metadata.hasOwnProperty("cmap")&&(o=x[w].metadata.cmap.unicode.codeMap[v[b].charCodeAt(0)]),o||v[b].charCodeAt(0)<256&&x[w].metadata.hasOwnProperty("Unicode")?S+=v[b]:S+="";var j="";return parseInt(w.slice(1))<14||N==="WinAnsiEncoding"?j=m(S,w).split("").map(function(E){return E.charCodeAt(0).toString(16)}).join(""):N==="Identity-H"&&(j=t(S,x[w])),h.isHex=!0,{text:j,x:c,y:d,options:u,mutex:h}};e.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([n(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(n(Object.assign({},c,{text:o[d]})).text);i.text=l}else i.text=n(Object.assign({},c,{text:o})).text}])}(es),function(s){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};s.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},s.addFileToVFS=function(t,r){return e.call(this),this.internal.vFS[t]=r,this},s.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(es.API),function(s){s.__bidiEngine__=s.prototype.__bidiEngine__=function(r){var n,i,o,l,c,d,u,h=e,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},w={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},S=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,N=0;this.__bidiEngine__={};var j=function(P){var T=P.charCodeAt(),z=T>>8,H=w[z];return H!==void 0?h[256*H+(255&T)]:z===252||z===253?"AL":b.test(z)?"L":z===8?"R":"N"},E=function(P){for(var T,z=0;z<P.length;z++){if((T=j(P.charAt(z)))==="L")return!1;if(T==="R")return!0}return!1},A=function(P,T,z,H){var D,M,$,q,K=T[H];switch(K){case"L":case"R":v=!1;break;case"N":case"AN":break;case"EN":v&&(K="AN");break;case"AL":v=!0,K="R";break;case"WS":K="N";break;case"CS":H<1||H+1>=T.length||(D=z[H-1])!=="EN"&&D!=="AN"||(M=T[H+1])!=="EN"&&M!=="AN"?K="N":v&&(M="AN"),K=M===D?M:"N";break;case"ES":K=(D=H>0?z[H-1]:"B")==="EN"&&H+1<T.length&&T[H+1]==="EN"?"EN":"N";break;case"ET":if(H>0&&z[H-1]==="EN"){K="EN";break}if(v){K="N";break}for($=H+1,q=T.length;$<q&&T[$]==="ET";)$++;K=$<q&&T[$]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(q=T.length,$=H+1;$<q&&T[$]==="NSM";)$++;if($<q){var de=P[H],Ne=de>=1425&&de<=2303||de===64286;if(D=T[$],Ne&&(D==="R"||D==="AL")){K="R";break}}}K=H<1||(D=T[H-1])==="B"?"N":z[H-1];break;case"B":v=!1,n=!0,K=N;break;case"S":i=!0,K="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"BN":K="N"}return K},L=function(P,T,z){var H=P.split("");return z&&C(H,z,{hiLevel:N}),H.reverse(),T&&T.reverse(),H.join("")},C=function(P,T,z){var H,D,M,$,q,K=-1,de=P.length,Ne=0,R=[],W=N?p:m,Z=[];for(v=!1,n=!1,i=!1,D=0;D<de;D++)Z[D]=j(P[D]);for(M=0;M<de;M++){if(q=Ne,R[M]=A(P,Z,R,M),H=240&(Ne=W[q][x[R[M]]]),Ne&=15,T[M]=$=W[Ne][5],H>0)if(H===16){for(D=K;D<M;D++)T[D]=1;K=-1}else K=-1;if(W[Ne][6])K===-1&&(K=M);else if(K>-1){for(D=K;D<M;D++)T[D]=$;K=-1}Z[M]==="B"&&(T[M]=0),z.hiLevel|=$}i&&function(ue,ce,ye){for(var Se=0;Se<ye;Se++)if(ue[Se]==="S"){ce[Se]=N;for(var Ee=Se-1;Ee>=0&&ue[Ee]==="WS";Ee--)ce[Ee]=N}}(Z,T,de)},B=function(P,T,z,H,D){if(!(D.hiLevel<P)){if(P===1&&N===1&&!n)return T.reverse(),void(z&&z.reverse());for(var M,$,q,K,de=T.length,Ne=0;Ne<de;){if(H[Ne]>=P){for(q=Ne+1;q<de&&H[q]>=P;)q++;for(K=Ne,$=q-1;K<$;K++,$--)M=T[K],T[K]=T[$],T[$]=M,z&&(M=z[K],z[K]=z[$],z[$]=M);Ne=q}Ne++}}},U=function(P,T,z){var H=P.split(""),D={hiLevel:N};return z||(z=[]),C(H,z,D),function(M,$,q){if(q.hiLevel!==0&&u)for(var K,de=0;de<M.length;de++)$[de]===1&&(K=S.indexOf(M[de]))>=0&&(M[de]=S[K+1])}(H,z,D),B(2,H,T,z,D),B(1,H,T,z,D),H.join("")};return this.__bidiEngine__.doBidiReorder=function(P,T,z){if(function(D,M){if(M)for(var $=0;$<D.length;$++)M[$]=$;l===void 0&&(l=E(D)),d===void 0&&(d=E(D))}(P,T),o||!c||d)if(o&&c&&l^d)N=l?1:0,P=L(P,T,z);else if(!o&&c&&d)N=l?1:0,P=U(P,T,z),P=L(P,T);else if(!o||l||c||d){if(o&&!c&&l^d)P=L(P,T),l?(N=0,P=U(P,T,z)):(N=1,P=U(P,T,z),P=L(P,T));else if(o&&l&&!c&&d)N=1,P=U(P,T,z),P=L(P,T);else if(!o&&!c&&l^d){var H=u;l?(N=1,P=U(P,T,z),N=0,u=!1,P=U(P,T,z),u=H):(N=0,P=U(P,T,z),P=L(P,T),N=1,u=!1,P=U(P,T,z),u=H,P=L(P,T))}}else N=0,P=U(P,T,z);else N=l?1:0,P=U(P,T,z);return P},this.__bidiEngine__.setOptions=function(P){P&&(o=P.isInputVisual,c=P.isOutputVisual,l=P.isInputRtl,d=P.isOutputRtl,u=P.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new s.__bidiEngine__({isInputVisual:!0});s.API.events.push(["postProcessText",function(r){var n=r.text,i=(r.x,r.y,r.options||{}),o=(r.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,t.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var l=0;for(o=[],l=0;l<n.length;l+=1)Object.prototype.toString.call(n[l])==="[object Array]"?o.push([t.doBidiReorder(n[l][0]),n[l][1],n[l][2]]):o.push([t.doBidiReorder(n[l])]);r.text=o}else r.text=t.doBidiReorder(n);t.setOptions({isInputVisual:!0})}])}(es),es.API.TTFFont=function(){function s(e){var t;if(this.rawData=e,t=this.contents=new Md(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new f$(this),this.registerTTF()}return s.open=function(e){return new s(e)},s.prototype.parse=function(){return this.directory=new Z9(this.contents),this.head=new t$(this),this.name=new a$(this),this.cmap=new ZP(this),this.toUnicode={},this.hhea=new s$(this),this.maxp=new o$(this),this.hmtx=new l$(this),this.post=new n$(this),this.os2=new r$(this),this.loca=new h$(this),this.glyf=new c$(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},s.prototype.registerTTF=function(){var e,t,r,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)e=c[o],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(n=this.post.italic_angle),32768&(t=n>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},s.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},s.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},s.prototype.widthOfString=function(e,t,r){var n,i,o,l;for(o=0,i=0,l=(e=""+e).length;0<=l?i<l:i>l;i=0<=l?++i:--i)n=e.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(n))+r*(1e3/t)||0;return o*(t/1e3)},s.prototype.lineHeight=function(e,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},s}();var go,Md=function(){function s(e){this.data=e??[],this.pos=0,this.length=this.data.length}return s.prototype.readByte=function(){return this.data[this.pos++]},s.prototype.writeByte=function(e){return this.data[this.pos++]=e},s.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},s.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},s.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},s.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},s.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},s.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},s.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},s.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},s.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},s.prototype.writeString=function(e){var t,r,n;for(n=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)n.push(this.writeByte(e.charCodeAt(t)));return n},s.prototype.readShort=function(){return this.readInt16()},s.prototype.writeShort=function(e){return this.writeInt16(e)},s.prototype.readLongLong=function(){var e,t,r,n,i,o,l,c;return e=this.readByte(),t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^n)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*n+16777216*i+65536*o+256*l+c},s.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},s.prototype.readInt=function(){return this.readInt32()},s.prototype.writeInt=function(e){return this.writeInt32(e)},s.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},s.prototype.write=function(e){var t,r,n,i;for(i=[],r=0,n=e.length;r<n;r++)t=e[r],i.push(this.writeByte(t));return i},s}(),Z9=function(){var s;function e(t){var r,n,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(t){var r,n,i,o,l,c,d,u,h,m,p,x,w;for(w in p=Object.keys(t).length,c=Math.log(2),h=16*Math.floor(Math.log(p)/c),o=Math.floor(h/c),u=16*p-h,(n=new Md).writeInt(this.scalarType),n.writeShort(p),n.writeShort(h),n.writeShort(o),n.writeShort(u),i=16*p,d=n.pos+i,l=null,x=[],t)for(m=t[w],n.writeString(w),n.writeInt(s(m)),n.writeInt(d),n.writeInt(m.length),x=x.concat(m),w==="head"&&(l=d),d+=m.length;d%4;)x.push(0),d++;return n.write(x),r=2981146554-s(n.data),n.pos=l+8,n.writeUInt32(r),n.data},s=function(t){var r,n,i,o;for(t=eT.call(t);t.length%4;)t.push(0);for(i=new Md(t),n=0,r=0,o=t.length;r<o;r=r+=4)n+=i.readUInt32();return 4294967295&n},e}(),e$={}.hasOwnProperty,tl=function(s,e){for(var t in e)e$.call(e,t)&&(s[t]=e[t]);function r(){this.constructor=s}return r.prototype=e.prototype,s.prototype=new r,s.__super__=e.prototype,s};go=function(){function s(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return s.prototype.parse=function(){},s.prototype.encode=function(){},s.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},s}();var t$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Md).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),V3=function(){function s(e,t){var r,n,i,o,l,c,d,u,h,m,p,x,w,S,b,v,N;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),h=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(p=e.readUInt16(),m=p/2,e.pos+=6,i=function(){var j,E;for(E=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)E.push(e.readUInt16());return E}(),e.pos+=2,w=function(){var j,E;for(E=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)E.push(e.readUInt16());return E}(),d=function(){var j,E;for(E=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)E.push(e.readUInt16());return E}(),u=function(){var j,E;for(E=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)E.push(e.readUInt16());return E}(),n=(this.length-e.pos+this.offset)/2,l=function(){var j,E;for(E=[],c=j=0;0<=n?j<n:j>n;c=0<=n?++j:--j)E.push(e.readUInt16());return E}(),c=b=0,N=i.length;b<N;c=++b)for(S=i[c],r=v=x=w[c];x<=S?v<=S:v>=S;r=x<=S?++v:--v)u[c]===0?o=r+d[c]:(o=l[u[c]/2+(r-x)-(m-c)]||0)!==0&&(o+=d[c]),this.codeMap[r]=65535&o}e.pos=h}return s.encode=function(e,t){var r,n,i,o,l,c,d,u,h,m,p,x,w,S,b,v,N,j,E,A,L,C,B,U,P,T,z,H,D,M,$,q,K,de,Ne,R,W,Z,ue,ce,ye,Se,Ee,De,We,Je;switch(H=new Md,o=Object.keys(e).sort(function(it,Be){return it-Be}),t){case"macroman":for(w=0,S=function(){var it=[];for(x=0;x<256;++x)it.push(0);return it}(),v={0:0},i={},D=0,K=o.length;D<K;D++)v[Ee=e[n=o[D]]]==null&&(v[Ee]=++w),i[n]={old:e[n],new:v[e[n]]},S[n]=v[e[n]];return H.writeUInt16(1),H.writeUInt16(0),H.writeUInt32(12),H.writeUInt16(0),H.writeUInt16(262),H.writeUInt16(0),H.write(S),{charMap:i,subtable:H.data,maxGlyphID:w+1};case"unicode":for(T=[],h=[],N=0,v={},r={},b=d=null,M=0,de=o.length;M<de;M++)v[E=e[n=o[M]]]==null&&(v[E]=++N),r[n]={old:E,new:v[E]},l=v[E]-n,b!=null&&l===d||(b&&h.push(b),T.push(n),d=l),b=n;for(b&&h.push(b),h.push(65535),T.push(65535),U=2*(B=T.length),C=2*Math.pow(Math.log(B)/Math.LN2,2),m=Math.log(C/2)/Math.LN2,L=2*B-C,c=[],A=[],p=[],x=$=0,Ne=T.length;$<Ne;x=++$){if(P=T[x],u=h[x],P===65535){c.push(0),A.push(0);break}if(P-(z=r[P].new)>=32768)for(c.push(0),A.push(2*(p.length+B-x)),n=q=P;P<=u?q<=u:q>=u;n=P<=u?++q:--q)p.push(r[n].new);else c.push(z-P),A.push(0)}for(H.writeUInt16(3),H.writeUInt16(1),H.writeUInt32(12),H.writeUInt16(4),H.writeUInt16(16+8*B+2*p.length),H.writeUInt16(0),H.writeUInt16(U),H.writeUInt16(C),H.writeUInt16(m),H.writeUInt16(L),ye=0,R=h.length;ye<R;ye++)n=h[ye],H.writeUInt16(n);for(H.writeUInt16(0),Se=0,W=T.length;Se<W;Se++)n=T[Se],H.writeUInt16(n);for(De=0,Z=c.length;De<Z;De++)l=c[De],H.writeUInt16(l);for(We=0,ue=A.length;We<ue;We++)j=A[We],H.writeUInt16(j);for(Je=0,ce=p.length;Je<ce;Je++)w=p[Je],H.writeUInt16(w);return{charMap:r,subtable:H.data,maxGlyphID:N+1}}},s}(),ZP=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new V3(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,i;return r==null&&(r="macroman"),n=V3.encode(t,r),(i=new Md).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),s$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),r$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),n$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var o;for(n=t.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 196608:break;case 262144:return this.map=(function(){var l,c,d;for(d=[],o=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;o=0<=c?++l:--l)d.push(t.readUInt32());return d}).call(this)}},e}(),i$=function(s,e){this.raw=s,this.length=s.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},a$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,i,o,l,c,d,u,h,m,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),c=t.readShort(),n=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+c+t.readShort()});for(d={},o=h=0,m=n.length;h<m;o=++h)i=n[o],t.pos=i.offset,u=t.readString(i.length),l=new i$(u,i),d[p=i.nameID]==null&&(d[p]=[]),d[i.nameID].push(l);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e}(),o$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),l$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,i,o,l,c,d;for(t.pos=this.offset,this.metrics=[],r=0,c=this.file.hhea.numberOfMetrics;0<=c?r<c:r>c;r=0<=c?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,h;for(h=[],r=u=0;0<=i?u<i:u>i;r=0<=i?++u:--u)h.push(t.readInt16());return h}(),this.widths=(function(){var u,h,m,p;for(p=[],u=0,h=(m=this.metrics).length;u<h;u++)o=m[u],p.push(o.advance);return p}).call(this),n=this.widths[this.widths.length-1],d=[],r=l=0;0<=i?l<i:l>i;r=0<=i?++l:--l)d.push(this.widths.push(n));return d},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),eT=[].slice,c$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,i,o,l,c,d,u,h,m;return t in this.cache?this.cache[t]:(o=this.file.loca,r=this.file.contents,n=o.indexOf(t),(i=o.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,l=(c=new Md(r.read(i))).readShort(),u=c.readShort(),m=c.readShort(),d=c.readShort(),h=c.readShort(),this.cache[t]=l===-1?new u$(c,u,m,d,h):new d$(c,l,u,m,d,h),this.cache[t]))},e.prototype.encode=function(t,r,n){var i,o,l,c,d;for(l=[],o=[],c=0,d=r.length;c<d;c++)i=t[r[c]],o.push(l.length),i&&(l=l.concat(i.encode(n)));return o.push(l.length),{table:l,offsets:o}},e}(),d$=function(){function s(e,t,r,n,i,o){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!1}return s.prototype.encode=function(){return this.raw.data},s}(),u$=function(){function s(e,t,r,n,i){var o,l;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return s.prototype.encode=function(){var e,t,r;for(t=new Md(eT.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},s}(),h$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return tl(e,go),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=2)o.push(2*t.readUInt16());return o}).call(this):(function(){var i,o;for(o=[],n=0,i=this.length;n<i;n+=4)o.push(t.readUInt32());return o}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),i=0,o=0,l=0;l<n.length;++l)if(n[l]=i,o<r.length&&r[o]==l){++o,n[l]=i;var c=this.offsets[l],d=this.offsets[l+1]-c;d>0&&(i+=d)}for(var u=new Array(4*n.length),h=0;h<n.length;++h)u[4*h+3]=255&n[h],u[4*h+2]=(65280&n[h])>>8,u[4*h+1]=(16711680&n[h])>>16,u[4*h]=(4278190080&n[h])>>24;return u},e}(),f$=function(){function s(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return s.prototype.generateCmap=function(){var e,t,r,n,i;for(t in n=this.font.cmap.tables[0].codeMap,e={},i=this.subset)r=i[t],e[t]=n[r];return e},s.prototype.glyphsFor=function(e){var t,r,n,i,o,l,c;for(n={},o=0,l=e.length;o<l;o++)n[i=e[o]]=this.font.glyf.glyphFor(i);for(i in t=[],n)(r=n[i])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(i in c=this.glyphsFor(t))r=c[i],n[i]=r;return n},s.prototype.encode=function(e,t){var r,n,i,o,l,c,d,u,h,m,p,x,w,S,b;for(n in r=ZP.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),p={0:0},b=r.charMap)p[(c=b[n]).old]=c.new;for(x in m=r.maxGlyphID,o)x in p||(p[x]=m++);return u=function(v){var N,j;for(N in j={},v)j[v[N]]=N;return j}(p),h=Object.keys(u).sort(function(v,N){return v-N}),w=function(){var v,N,j;for(j=[],v=0,N=h.length;v<N;v++)l=h[v],j.push(u[l]);return j}(),i=this.font.glyf.encode(o,w,p),d=this.font.loca.encode(i.offsets,w),S={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(S["OS/2"]=this.font.os2.raw()),this.font.directory.encode(S)},s}();es.API.PDFObject=function(){var s;function e(){}return s=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},e.convert=function(t){var r,n,i,o;if(Array.isArray(t))return"["+function(){var l,c,d;for(d=[],l=0,c=t.length;l<c;l++)r=t[l],d.push(e.convert(r));return d}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+s(t.getUTCFullYear(),4)+s(t.getUTCMonth(),2)+s(t.getUTCDate(),2)+s(t.getUTCHours(),2)+s(t.getUTCMinutes(),2)+s(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(n in i=["<<"],t)o=t[n],i.push("/"+n+" "+e.convert(o));return i.push(">>"),i.join(`
`)}return""+t},e}();const m$=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:W9,AcroFormAppearance:Vt,AcroFormButton:Jr,AcroFormCheckBox:ag,AcroFormChoiceField:Ch,AcroFormComboBox:Lh,AcroFormEditBox:ng,AcroFormListBox:Eh,AcroFormPasswordField:og,AcroFormPushButton:ig,AcroFormRadioButton:Ph,AcroFormTextField:Ed,GState:Og,ShadingPattern:Bc,TilingPattern:wu,default:es,jsPDF:es},Symbol.toStringTag,{value:"Module"}));var tT={exports:{}};const p$=K3(m$);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(s,e){(function(r,n){s.exports=n(function(){try{return p$}catch{}}())})(typeof globalThis<"u"?globalThis:typeof si<"u"?si:typeof window<"u"?window:typeof self<"u"?self:si,function(t){return function(){var r={172:function(l,c){var d=this&&this.__extends||function(){var m=function(p,x){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,S){w.__proto__=S}||function(w,S){for(var b in S)Object.prototype.hasOwnProperty.call(S,b)&&(w[b]=S[b])},m(p,x)};return function(p,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");m(p,x);function w(){this.constructor=p}p.prototype=x===null?Object.create(x):(w.prototype=x.prototype,new w)}}();Object.defineProperty(c,"__esModule",{value:!0}),c.CellHookData=c.HookData=void 0;var u=function(){function m(p,x,w){this.table=x,this.pageNumber=x.pageNumber,this.pageCount=this.pageNumber,this.settings=x.settings,this.cursor=w,this.doc=p.getDocument()}return m}();c.HookData=u;var h=function(m){d(p,m);function p(x,w,S,b,v,N){var j=m.call(this,x,w,N)||this;return j.cell=S,j.row=b,j.column=v,j.section=b.section,j}return p}(u);c.CellHookData=h},340:function(l,c,d){Object.defineProperty(c,"__esModule",{value:!0});var u=d(4),h=d(136),m=d(744),p=d(776),x=d(664),w=d(972);function S(b){b.API.autoTable=function(){for(var v=[],N=0;N<arguments.length;N++)v[N]=arguments[N];var j;v.length===1?j=v[0]:(console.error("Use of deprecated autoTable initiation"),j=v[2]||{},j.columns=v[0],j.body=v[1]);var E=(0,p.parseInput)(this,j),A=(0,w.createTable)(this,E);return(0,x.drawTable)(this,A),this},b.API.lastAutoTable=!1,b.API.previousAutoTable=!1,b.API.autoTable.previous=!1,b.API.autoTableText=function(v,N,j,E){(0,h.default)(v,N,j,E,this)},b.API.autoTableSetDefaults=function(v){return m.DocHandler.setDefaults(v,this),this},b.autoTableSetDefaults=function(v,N){m.DocHandler.setDefaults(v,N)},b.API.autoTableHtmlToJson=function(v,N){var j;if(N===void 0&&(N=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var E=new m.DocHandler(this),A=(0,u.parseHtml)(E,v,window,N,!1),L=A.head,C=A.body,B=((j=L[0])===null||j===void 0?void 0:j.map(function(U){return U.content}))||[];return{columns:B,rows:C,data:C}},b.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var v=this.lastAutoTable;return v&&v.finalY?v.finalY:0},b.API.autoTableAddPageContent=function(v){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),b.API.autoTable.globalDefaults||(b.API.autoTable.globalDefaults={}),b.API.autoTable.globalDefaults.addPageContent=v,this},b.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}c.default=S},136:function(l,c){Object.defineProperty(c,"__esModule",{value:!0});function d(u,h,m,p,x){p=p||{};var w=1.15,S=x.internal.scaleFactor,b=x.internal.getFontSize()/S,v=x.getLineHeightFactor?x.getLineHeightFactor():w,N=b*v,j=/\r\n|\r|\n/g,E="",A=1;if((p.valign==="middle"||p.valign==="bottom"||p.halign==="center"||p.halign==="right")&&(E=typeof u=="string"?u.split(j):u,A=E.length||1),m+=b*(2-w),p.valign==="middle"?m-=A/2*N:p.valign==="bottom"&&(m-=A*N),p.halign==="center"||p.halign==="right"){var L=b;if(p.halign==="center"&&(L*=.5),E&&A>=1){for(var C=0;C<E.length;C++)x.text(E[C],h-x.getStringUnitWidth(E[C])*L,m),m+=N;return x}h-=x.getStringUnitWidth(u)*L}return p.halign==="justify"?x.text(u,h,m,{maxWidth:p.maxWidth||100,align:"justify"}):x.text(u,h,m),x}c.default=d},420:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.getPageAvailableWidth=c.parseSpacing=c.getFillStyle=c.addTableBorder=c.getStringWidth=void 0;function d(x,w,S){S.applyStyles(w,!0);var b=Array.isArray(x)?x:[x],v=b.map(function(N){return S.getTextWidth(N)}).reduce(function(N,j){return Math.max(N,j)},0);return v}c.getStringWidth=d;function u(x,w,S,b){var v=w.settings.tableLineWidth,N=w.settings.tableLineColor;x.applyStyles({lineWidth:v,lineColor:N});var j=h(v,!1);j&&x.rect(S.x,S.y,w.getWidth(x.pageSize().width),b.y-S.y,j)}c.addTableBorder=u;function h(x,w){var S=x>0,b=w||w===0;return S&&b?"DF":S?"S":b?"F":null}c.getFillStyle=h;function m(x,w){var S,b,v,N;if(x=x||w,Array.isArray(x)){if(x.length>=4)return{top:x[0],right:x[1],bottom:x[2],left:x[3]};if(x.length===3)return{top:x[0],right:x[1],bottom:x[2],left:x[1]};if(x.length===2)return{top:x[0],right:x[1],bottom:x[0],left:x[1]};x.length===1?x=x[0]:x=w}return typeof x=="object"?(typeof x.vertical=="number"&&(x.top=x.vertical,x.bottom=x.vertical),typeof x.horizontal=="number"&&(x.right=x.horizontal,x.left=x.horizontal),{left:(S=x.left)!==null&&S!==void 0?S:w,top:(b=x.top)!==null&&b!==void 0?b:w,right:(v=x.right)!==null&&v!==void 0?v:w,bottom:(N=x.bottom)!==null&&N!==void 0?N:w}):(typeof x!="number"&&(x=w),{top:x,right:x,bottom:x,left:x})}c.parseSpacing=m;function p(x,w){var S=m(w.settings.margin,0);return x.pageSize().width-(S.left+S.right)}c.getPageAvailableWidth=p},796:function(l,c){var d=this&&this.__extends||function(){var p=function(x,w){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,b){S.__proto__=b}||function(S,b){for(var v in b)Object.prototype.hasOwnProperty.call(b,v)&&(S[v]=b[v])},p(x,w)};return function(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Class extends value "+String(w)+" is not a constructor or null");p(x,w);function S(){this.constructor=x}x.prototype=w===null?Object.create(w):(S.prototype=w.prototype,new S)}}();Object.defineProperty(c,"__esModule",{value:!0}),c.getTheme=c.defaultStyles=c.HtmlRowInput=void 0;var u=function(p){d(x,p);function x(w){var S=p.call(this)||this;return S._element=w,S}return x}(Array);c.HtmlRowInput=u;function h(p){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/p,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}c.defaultStyles=h;function m(p){var x={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return x[p]}c.getTheme=m},903:function(l,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.parseCss=void 0;var u=d(420);function h(S,b,v,N,j){var E={},A=1.3333333333333333,L=p(b,function(K){return j.getComputedStyle(K).backgroundColor});L!=null&&(E.fillColor=L);var C=p(b,function(K){return j.getComputedStyle(K).color});C!=null&&(E.textColor=C);var B=w(N,v);B&&(E.cellPadding=B);var U="borderTopColor",P=A*v,T=N.borderTopWidth;if(N.borderBottomWidth===T&&N.borderRightWidth===T&&N.borderLeftWidth===T){var z=(parseFloat(T)||0)/P;z&&(E.lineWidth=z)}else E.lineWidth={top:(parseFloat(N.borderTopWidth)||0)/P,right:(parseFloat(N.borderRightWidth)||0)/P,bottom:(parseFloat(N.borderBottomWidth)||0)/P,left:(parseFloat(N.borderLeftWidth)||0)/P},E.lineWidth.top||(E.lineWidth.right?U="borderRightColor":E.lineWidth.bottom?U="borderBottomColor":E.lineWidth.left&&(U="borderLeftColor"));var H=p(b,function(K){return j.getComputedStyle(K)[U]});H!=null&&(E.lineColor=H);var D=["left","right","center","justify"];D.indexOf(N.textAlign)!==-1&&(E.halign=N.textAlign),D=["middle","bottom","top"],D.indexOf(N.verticalAlign)!==-1&&(E.valign=N.verticalAlign);var M=parseInt(N.fontSize||"");isNaN(M)||(E.fontSize=M/A);var $=m(N);$&&(E.fontStyle=$);var q=(N.fontFamily||"").toLowerCase();return S.indexOf(q)!==-1&&(E.font=q),E}c.parseCss=h;function m(S){var b="";return(S.fontWeight==="bold"||S.fontWeight==="bolder"||parseInt(S.fontWeight)>=700)&&(b="bold"),(S.fontStyle==="italic"||S.fontStyle==="oblique")&&(b+="italic"),b}function p(S,b){var v=x(S,b);if(!v)return null;var N=v.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!N||!Array.isArray(N))return null;var j=[parseInt(N[1]),parseInt(N[2]),parseInt(N[3])],E=parseInt(N[4]);return E===0||isNaN(j[0])||isNaN(j[1])||isNaN(j[2])?null:j}function x(S,b){var v=b(S);return v==="rgba(0, 0, 0, 0)"||v==="transparent"||v==="initial"||v==="inherit"?S.parentElement==null?null:x(S.parentElement,b):v}function w(S,b){var v=[S.paddingTop,S.paddingRight,S.paddingBottom,S.paddingLeft],N=96/(72/b),j=(parseInt(S.lineHeight)-parseInt(S.fontSize))/b/2,E=v.map(function(L){return parseInt(L||"0")/N}),A=(0,u.parseSpacing)(E,0);return j>A.top&&(A.top=j),j>A.bottom&&(A.bottom=j),A}},744:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.DocHandler=void 0;var d={},u=function(){function h(m){this.jsPDFDocument=m,this.userStyles={textColor:m.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:m.internal.getFontSize(),fontStyle:m.internal.getFont().fontStyle,font:m.internal.getFont().fontName,lineWidth:m.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:m.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return h.setDefaults=function(m,p){p===void 0&&(p=null),p?p.__autoTableDocumentDefaults=m:d=m},h.unifyColor=function(m){return Array.isArray(m)?m:typeof m=="number"?[m,m,m]:typeof m=="string"?[m]:null},h.prototype.applyStyles=function(m,p){var x,w,S;p===void 0&&(p=!1),m.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(m.fontStyle);var b=this.jsPDFDocument.internal.getFont(),v=b.fontStyle,N=b.fontName;if(m.font&&(N=m.font),m.fontStyle){v=m.fontStyle;var j=this.getFontList()[N];j&&j.indexOf(v)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(j[0]),v=j[0])}if(this.jsPDFDocument.setFont(N,v),m.fontSize&&this.jsPDFDocument.setFontSize(m.fontSize),!p){var E=h.unifyColor(m.fillColor);E&&(x=this.jsPDFDocument).setFillColor.apply(x,E),E=h.unifyColor(m.textColor),E&&(w=this.jsPDFDocument).setTextColor.apply(w,E),E=h.unifyColor(m.lineColor),E&&(S=this.jsPDFDocument).setDrawColor.apply(S,E),typeof m.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(m.lineWidth)}},h.prototype.splitTextToSize=function(m,p,x){return this.jsPDFDocument.splitTextToSize(m,p,x)},h.prototype.rect=function(m,p,x,w,S){return this.jsPDFDocument.rect(m,p,x,w,S)},h.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},h.prototype.getTextWidth=function(m){return this.jsPDFDocument.getTextWidth(m)},h.prototype.getDocument=function(){return this.jsPDFDocument},h.prototype.setPage=function(m){this.jsPDFDocument.setPage(m)},h.prototype.addPage=function(){return this.jsPDFDocument.addPage()},h.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},h.prototype.getGlobalOptions=function(){return d||{}},h.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},h.prototype.pageSize=function(){var m=this.jsPDFDocument.internal.pageSize;return m.width==null&&(m={width:m.getWidth(),height:m.getHeight()}),m},h.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},h.prototype.getLineHeightFactor=function(){var m=this.jsPDFDocument;return m.getLineHeightFactor?m.getLineHeightFactor():1.15},h.prototype.getLineHeight=function(m){return m/this.scaleFactor()*this.getLineHeightFactor()},h.prototype.pageNumber=function(){var m=this.jsPDFDocument.internal.getCurrentPageInfo();return m?m.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},h}();c.DocHandler=u},4:function(l,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.parseHtml=void 0;var u=d(903),h=d(796);function m(w,S,b,v,N){var j,E;v===void 0&&(v=!1),N===void 0&&(N=!1);var A;typeof S=="string"?A=b.document.querySelector(S):A=S;var L=Object.keys(w.getFontList()),C=w.scaleFactor(),B=[],U=[],P=[];if(!A)return console.error("Html table could not be found with input: ",S),{head:B,body:U,foot:P};for(var T=0;T<A.rows.length;T++){var z=A.rows[T],H=(E=(j=z==null?void 0:z.parentElement)===null||j===void 0?void 0:j.tagName)===null||E===void 0?void 0:E.toLowerCase(),D=p(L,C,b,z,v,N);D&&(H==="thead"?B.push(D):H==="tfoot"?P.push(D):U.push(D))}return{head:B,body:U,foot:P}}c.parseHtml=m;function p(w,S,b,v,N,j){for(var E=new h.HtmlRowInput(v),A=0;A<v.cells.length;A++){var L=v.cells[A],C=b.getComputedStyle(L);if(N||C.display!=="none"){var B=void 0;j&&(B=(0,u.parseCss)(w,L,S,C,b)),E.push({rowSpan:L.rowSpan,colSpan:L.colSpan,styles:B,_element:L,content:x(L)})}}var U=b.getComputedStyle(v);if(E.length>0&&(N||U.display!=="none"))return E}function x(w){var S=w.cloneNode(!0);return S.innerHTML=S.innerHTML.replace(/\n/g,"").replace(/ +/g," "),S.innerHTML=S.innerHTML.split(/<br.*?>/).map(function(b){return b.trim()}).join(`
`),S.innerText||S.textContent||""}},776:function(l,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.parseInput=void 0;var u=d(4),h=d(356),m=d(420),p=d(744),x=d(792);function w(A,L){var C=new p.DocHandler(A),B=C.getDocumentOptions(),U=C.getGlobalOptions();(0,x.default)(C,U,B,L);var P=(0,h.assign)({},U,B,L),T;typeof window<"u"&&(T=window);var z=S(U,B,L),H=b(U,B,L),D=v(C,P),M=j(C,P,T);return{id:L.tableId,content:M,hooks:H,styles:z,settings:D}}c.parseInput=w;function S(A,L,C){for(var B={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},U=function(H){if(H==="columnStyles"){var D=A[H],M=L[H],$=C[H];B.columnStyles=(0,h.assign)({},D,M,$)}else{var q=[A,L,C],K=q.map(function(de){return de[H]||{}});B[H]=(0,h.assign)({},K[0],K[1],K[2])}},P=0,T=Object.keys(B);P<T.length;P++){var z=T[P];U(z)}return B}function b(A,L,C){for(var B=[A,L,C],U={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},P=0,T=B;P<T.length;P++){var z=T[P];z.didParseCell&&U.didParseCell.push(z.didParseCell),z.willDrawCell&&U.willDrawCell.push(z.willDrawCell),z.didDrawCell&&U.didDrawCell.push(z.didDrawCell),z.willDrawPage&&U.willDrawPage.push(z.willDrawPage),z.didDrawPage&&U.didDrawPage.push(z.didDrawPage)}return U}function v(A,L){var C,B,U,P,T,z,H,D,M,$,q,K,de=(0,m.parseSpacing)(L.margin,40/A.scaleFactor()),Ne=(C=N(A,L.startY))!==null&&C!==void 0?C:de.top,R;L.showFoot===!0?R="everyPage":L.showFoot===!1?R="never":R=(B=L.showFoot)!==null&&B!==void 0?B:"everyPage";var W;L.showHead===!0?W="everyPage":L.showHead===!1?W="never":W=(U=L.showHead)!==null&&U!==void 0?U:"everyPage";var Z=(P=L.useCss)!==null&&P!==void 0?P:!1,ue=L.theme||(Z?"plain":"striped"),ce=!!L.horizontalPageBreak,ye=(T=L.horizontalPageBreakRepeat)!==null&&T!==void 0?T:null;return{includeHiddenHtml:(z=L.includeHiddenHtml)!==null&&z!==void 0?z:!1,useCss:Z,theme:ue,startY:Ne,margin:de,pageBreak:(H=L.pageBreak)!==null&&H!==void 0?H:"auto",rowPageBreak:(D=L.rowPageBreak)!==null&&D!==void 0?D:"auto",tableWidth:(M=L.tableWidth)!==null&&M!==void 0?M:"auto",showHead:W,showFoot:R,tableLineWidth:($=L.tableLineWidth)!==null&&$!==void 0?$:0,tableLineColor:(q=L.tableLineColor)!==null&&q!==void 0?q:200,horizontalPageBreak:ce,horizontalPageBreakRepeat:ye,horizontalPageBreakBehaviour:(K=L.horizontalPageBreakBehaviour)!==null&&K!==void 0?K:"afterAllRows"}}function N(A,L){var C=A.getLastAutoTable(),B=A.scaleFactor(),U=A.pageNumber(),P=!1;if(C&&C.startPageNumber){var T=C.startPageNumber+C.pageNumber-1;P=T===U}return typeof L=="number"?L:(L==null||L===!1)&&P&&(C==null?void 0:C.finalY)!=null?C.finalY+20/B:null}function j(A,L,C){var B=L.head||[],U=L.body||[],P=L.foot||[];if(L.html){var T=L.includeHiddenHtml;if(C){var z=(0,u.parseHtml)(A,L.html,C,T,L.useCss)||{};B=z.head||B,U=z.body||B,P=z.foot||B}else console.error("Cannot parse html in non browser environment")}var H=L.columns||E(B,U,P);return{columns:H,head:B,body:U,foot:P}}function E(A,L,C){var B=A[0]||L[0]||C[0]||[],U=[];return Object.keys(B).filter(function(P){return P!=="_element"}).forEach(function(P){var T=1,z;Array.isArray(B)?z=B[parseInt(P)]:z=B[P],typeof z=="object"&&!Array.isArray(z)&&(T=(z==null?void 0:z.colSpan)||1);for(var H=0;H<T;H++){var D=void 0;Array.isArray(B)?D=U.length:D=P+(H>0?"_".concat(H):"");var M={dataKey:D};U.push(M)}}),U}},792:function(l,c){Object.defineProperty(c,"__esModule",{value:!0});function d(h,m,p,x){for(var w=function(N){N&&typeof N!="object"&&console.error("The options parameter should be of type object, is: "+typeof N),typeof N.extendWidth<"u"&&(N.tableWidth=N.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof N.margins<"u"&&(typeof N.margin>"u"&&(N.margin=N.margins),console.error("Use of deprecated option: margins, use margin instead.")),N.startY&&typeof N.startY!="number"&&(console.error("Invalid value for startY option",N.startY),delete N.startY),!N.didDrawPage&&(N.afterPageContent||N.beforePageContent||N.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),N.didDrawPage=function(P){h.applyStyles(h.userStyles),N.beforePageContent&&N.beforePageContent(P),h.applyStyles(h.userStyles),N.afterPageContent&&N.afterPageContent(P),h.applyStyles(h.userStyles),N.afterPageAdd&&P.pageNumber>1&&P.afterPageAdd(P),h.applyStyles(h.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(P){N[P]&&console.error('The "'.concat(P,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(P){var T=P[0],z=P[1];N[z]&&(console.error("Use of deprecated option ".concat(z,". Use ").concat(T," instead")),N[T]=N[z])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(P){var T=typeof P=="string"?P:P[0],z=typeof P=="string"?P:P[1];typeof N[T]<"u"&&(typeof N.styles[z]>"u"&&(N.styles[z]=N[T]),console.error("Use of deprecated option: "+T+", use the style "+z+" instead."))});for(var j=0,E=["styles","bodyStyles","headStyles","footStyles"];j<E.length;j++){var A=E[j];u(N[A]||{})}for(var L=N.columnStyles||{},C=0,B=Object.keys(L);C<B.length;C++){var U=B[C];u(L[U]||{})}},S=0,b=[m,p,x];S<b.length;S++){var v=b[S];w(v)}}c.default=d;function u(h){h.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),h.minCellHeight||(h.minCellHeight=h.rowHeight)):h.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),h.cellWidth||(h.cellWidth=h.columnWidth))}},260:function(l,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.Column=c.Cell=c.Row=c.Table=void 0;var u=d(796),h=d(172),m=d(420),p=function(){function b(v,N){this.pageNumber=1,this.pageCount=1,this.id=v.id,this.settings=v.settings,this.styles=v.styles,this.hooks=v.hooks,this.columns=N.columns,this.head=N.head,this.body=N.body,this.foot=N.foot}return b.prototype.getHeadHeight=function(v){return this.head.reduce(function(N,j){return N+j.getMaxCellHeight(v)},0)},b.prototype.getFootHeight=function(v){return this.foot.reduce(function(N,j){return N+j.getMaxCellHeight(v)},0)},b.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},b.prototype.callCellHooks=function(v,N,j,E,A,L){for(var C=0,B=N;C<B.length;C++){var U=B[C],P=new h.CellHookData(v,this,j,E,A,L),T=U(P)===!1;if(j.text=Array.isArray(j.text)?j.text:[j.text],T)return!1}return!0},b.prototype.callEndPageHooks=function(v,N){v.applyStyles(v.userStyles);for(var j=0,E=this.hooks.didDrawPage;j<E.length;j++){var A=E[j];A(new h.HookData(v,this,N))}},b.prototype.callWillDrawPageHooks=function(v,N){for(var j=0,E=this.hooks.willDrawPage;j<E.length;j++){var A=E[j];A(new h.HookData(v,this,N))}},b.prototype.getWidth=function(v){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var N=this.columns.reduce(function(E,A){return E+A.wrappedWidth},0);return N}else{var j=this.settings.margin;return v-j.left-j.right}},b}();c.Table=p;var x=function(){function b(v,N,j,E,A){A===void 0&&(A=!1),this.height=0,this.raw=v,v instanceof u.HtmlRowInput&&(this.raw=v._element,this.element=v._element),this.index=N,this.section=j,this.cells=E,this.spansMultiplePages=A}return b.prototype.getMaxCellHeight=function(v){var N=this;return v.reduce(function(j,E){var A;return Math.max(j,((A=N.cells[E.index])===null||A===void 0?void 0:A.height)||0)},0)},b.prototype.hasRowSpan=function(v){var N=this;return v.filter(function(j){var E=N.cells[j.index];return E?E.rowSpan>1:!1}).length>0},b.prototype.canEntireRowFit=function(v,N){return this.getMaxCellHeight(N)<=v},b.prototype.getMinimumRowHeight=function(v,N){var j=this;return v.reduce(function(E,A){var L=j.cells[A.index];if(!L)return 0;var C=N.getLineHeight(L.styles.fontSize),B=L.padding("vertical"),U=B+C;return U>E?U:E},0)},b}();c.Row=x;var w=function(){function b(v,N,j){var E,A;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=N,this.section=j,this.raw=v;var L=v;v!=null&&typeof v=="object"&&!Array.isArray(v)?(this.rowSpan=v.rowSpan||1,this.colSpan=v.colSpan||1,L=(A=(E=v.content)!==null&&E!==void 0?E:v.title)!==null&&A!==void 0?A:v,v._element&&(this.raw=v._element)):(this.rowSpan=1,this.colSpan=1);var C=L!=null?""+L:"",B=/\r\n|\r|\n/g;this.text=C.split(B)}return b.prototype.getTextPos=function(){var v;if(this.styles.valign==="top")v=this.y+this.padding("top");else if(this.styles.valign==="bottom")v=this.y+this.height-this.padding("bottom");else{var N=this.height-this.padding("vertical");v=this.y+N/2+this.padding("top")}var j;if(this.styles.halign==="right")j=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var E=this.width-this.padding("horizontal");j=this.x+E/2+this.padding("left")}else j=this.x+this.padding("left");return{x:j,y:v}},b.prototype.getContentHeight=function(v,N){N===void 0&&(N=1.15);var j=Array.isArray(this.text)?this.text.length:1,E=this.styles.fontSize/v*N,A=j*E+this.padding("vertical");return Math.max(A,this.styles.minCellHeight)},b.prototype.padding=function(v){var N=(0,m.parseSpacing)(this.styles.cellPadding,0);return v==="vertical"?N.top+N.bottom:v==="horizontal"?N.left+N.right:N[v]},b}();c.Cell=w;var S=function(){function b(v,N,j){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=v,this.raw=N,this.index=j}return b.prototype.getMaxCustomCellWidth=function(v){for(var N=0,j=0,E=v.allRows();j<E.length;j++){var A=E[j],L=A.cells[this.index];L&&typeof L.styles.cellWidth=="number"&&(N=Math.max(N,L.styles.cellWidth))}return N},b}();c.Column=S},356:function(l,c){Object.defineProperty(c,"__esModule",{value:!0}),c.assign=void 0;function d(u,h,m,p,x){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var w=Object(u),S=1;S<arguments.length;S++){var b=arguments[S];if(b!=null)for(var v in b)Object.prototype.hasOwnProperty.call(b,v)&&(w[v]=b[v])}return w}c.assign=d},972:function(l,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.createTable=void 0;var u=d(744),h=d(260),m=d(324),p=d(796),x=d(356);function w(A,L){var C=new u.DocHandler(A),B=S(L,C.scaleFactor()),U=new h.Table(L,B);return(0,m.calculateWidths)(C,U),C.applyStyles(C.userStyles),U}c.createTable=w;function S(A,L){var C=A.content,B=j(C.columns);if(C.head.length===0){var U=v(B,"head");U&&C.head.push(U)}if(C.foot.length===0){var U=v(B,"foot");U&&C.foot.push(U)}var P=A.settings.theme,T=A.styles;return{columns:B,head:b("head",C.head,B,T,P,L),body:b("body",C.body,B,T,P,L),foot:b("foot",C.foot,B,T,P,L)}}function b(A,L,C,B,U,P){var T={},z=L.map(function(H,D){for(var M=0,$={},q=0,K=0,de=0,Ne=C;de<Ne.length;de++){var R=Ne[de];if(T[R.index]==null||T[R.index].left===0)if(K===0){var W=void 0;Array.isArray(H)?W=H[R.index-q-M]:W=H[R.dataKey];var Z={};typeof W=="object"&&!Array.isArray(W)&&(Z=(W==null?void 0:W.styles)||{});var ue=E(A,R,D,U,B,P,Z),ce=new h.Cell(W,ue,A);$[R.dataKey]=ce,$[R.index]=ce,K=ce.colSpan-1,T[R.index]={left:ce.rowSpan-1,times:K}}else K--,q++;else T[R.index].left--,K=T[R.index].times,M++}return new h.Row(H,D,A,$)});return z}function v(A,L){var C={};return A.forEach(function(B){if(B.raw!=null){var U=N(L,B.raw);U!=null&&(C[B.dataKey]=U)}}),Object.keys(C).length>0?C:null}function N(A,L){if(A==="head"){if(typeof L=="object")return L.header||L.title||null;if(typeof L=="string"||typeof L=="number")return L}else if(A==="foot"&&typeof L=="object")return L.footer;return null}function j(A){return A.map(function(L,C){var B,U,P;return typeof L=="object"?P=(U=(B=L.dataKey)!==null&&B!==void 0?B:L.key)!==null&&U!==void 0?U:C:P=C,new h.Column(P,L,C)})}function E(A,L,C,B,U,P,T){var z=(0,p.getTheme)(B),H;A==="head"?H=U.headStyles:A==="body"?H=U.bodyStyles:A==="foot"&&(H=U.footStyles);var D=(0,x.assign)({},z.table,z[A],U.styles,H),M=U.columnStyles[L.dataKey]||U.columnStyles[L.index]||{},$=A==="body"?M:{},q=A==="body"&&C%2===0?(0,x.assign)({},z.alternateRow,U.alternateRowStyles):{},K=(0,p.defaultStyles)(P),de=(0,x.assign)({},K,D,q,$);return(0,x.assign)(de,T)}},664:function(l,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.addPage=c.drawTable=void 0;var u=d(420),h=d(260),m=d(744),p=d(356),x=d(136),w=d(224);function S(M,$){var q=$.settings,K=q.startY,de=q.margin,Ne={x:de.left,y:K},R=$.getHeadHeight($.columns)+$.getFootHeight($.columns),W=K+de.bottom+R;if(q.pageBreak==="avoid"){var Z=$.body,ue=Z.reduce(function(Se,Ee){return Se+Ee.height},0);W+=ue}var ce=new m.DocHandler(M);(q.pageBreak==="always"||q.startY!=null&&W>ce.pageSize().height)&&(D(ce),Ne.y=de.top),$.callWillDrawPageHooks(ce,Ne);var ye=(0,p.assign)({},Ne);$.startPageNumber=ce.pageNumber(),q.horizontalPageBreak?b(ce,$,ye,Ne):(ce.applyStyles(ce.userStyles),(q.showHead==="firstPage"||q.showHead==="everyPage")&&$.head.forEach(function(Se){return U(ce,$,Se,Ne,$.columns)}),ce.applyStyles(ce.userStyles),$.body.forEach(function(Se,Ee){var De=Ee===$.body.length-1;B(ce,$,Se,De,ye,Ne,$.columns)}),ce.applyStyles(ce.userStyles),(q.showFoot==="lastPage"||q.showFoot==="everyPage")&&$.foot.forEach(function(Se){return U(ce,$,Se,Ne,$.columns)})),(0,u.addTableBorder)(ce,$,ye,Ne),$.callEndPageHooks(ce,Ne),$.finalY=Ne.y,M.lastAutoTable=$,M.previousAutoTable=$,M.autoTable&&(M.autoTable.previous=$),ce.applyStyles(ce.userStyles)}c.drawTable=S;function b(M,$,q,K){var de=(0,w.calculateAllColumnsCanFitInPage)(M,$),Ne=$.settings;if(Ne.horizontalPageBreakBehaviour==="afterAllRows")de.forEach(function(ue,ce){M.applyStyles(M.userStyles),ce>0?H(M,$,q,K,ue.columns,!0):v(M,$,K,ue.columns),N(M,$,q,K,ue.columns),E(M,$,K,ue.columns)});else for(var R=-1,W=de[0],Z=function(){var ue=R;if(W){M.applyStyles(M.userStyles);var ce=W.columns;R>=0?H(M,$,q,K,ce,!0):v(M,$,K,ce),ue=j(M,$,R+1,K,ce),E(M,$,K,ce)}var ye=ue-R;de.slice(1).forEach(function(Se){M.applyStyles(M.userStyles),H(M,$,q,K,Se.columns,!0),j(M,$,R+1,K,Se.columns,ye),E(M,$,K,Se.columns)}),R=ue};R<$.body.length-1;)Z()}function v(M,$,q,K){var de=$.settings;M.applyStyles(M.userStyles),(de.showHead==="firstPage"||de.showHead==="everyPage")&&$.head.forEach(function(Ne){return U(M,$,Ne,q,K)})}function N(M,$,q,K,de){M.applyStyles(M.userStyles),$.body.forEach(function(Ne,R){var W=R===$.body.length-1;B(M,$,Ne,W,q,K,de)})}function j(M,$,q,K,de,Ne){M.applyStyles(M.userStyles),Ne=Ne??$.body.length;var R=Math.min(q+Ne,$.body.length),W=-1;return $.body.slice(q,R).forEach(function(Z,ue){var ce=q+ue===$.body.length-1,ye=z(M,$,ce,K);Z.canEntireRowFit(ye,de)&&(U(M,$,Z,K,de),W=q+ue)}),W}function E(M,$,q,K){var de=$.settings;M.applyStyles(M.userStyles),(de.showFoot==="lastPage"||de.showFoot==="everyPage")&&$.foot.forEach(function(Ne){return U(M,$,Ne,q,K)})}function A(M,$,q){var K=q.getLineHeight(M.styles.fontSize),de=M.padding("vertical"),Ne=Math.floor(($-de)/K);return Math.max(0,Ne)}function L(M,$,q,K){var de={};M.spansMultiplePages=!0,M.height=0;for(var Ne=0,R=0,W=q.columns;R<W.length;R++){var Z=W[R],ue=M.cells[Z.index];if(ue){Array.isArray(ue.text)||(ue.text=[ue.text]);var ce=new h.Cell(ue.raw,ue.styles,ue.section);ce=(0,p.assign)(ce,ue),ce.text=[];var ye=A(ue,$,K);ue.text.length>ye&&(ce.text=ue.text.splice(ye,ue.text.length));var Se=K.scaleFactor(),Ee=K.getLineHeightFactor();ue.contentHeight=ue.getContentHeight(Se,Ee),ue.contentHeight>=$&&(ue.contentHeight=$,ce.styles.minCellHeight-=$),ue.contentHeight>M.height&&(M.height=ue.contentHeight),ce.contentHeight=ce.getContentHeight(Se,Ee),ce.contentHeight>Ne&&(Ne=ce.contentHeight),de[Z.index]=ce}}var De=new h.Row(M.raw,-1,M.section,de,!0);De.height=Ne;for(var We=0,Je=q.columns;We<Je.length;We++){var Z=Je[We],ce=De.cells[Z.index];ce&&(ce.height=De.height);var ue=M.cells[Z.index];ue&&(ue.height=M.height)}return De}function C(M,$,q,K){var de=M.pageSize().height,Ne=K.settings.margin,R=Ne.top+Ne.bottom,W=de-R;$.section==="body"&&(W-=K.getHeadHeight(K.columns)+K.getFootHeight(K.columns));var Z=$.getMinimumRowHeight(K.columns,M),ue=Z<q;if(Z>W)return console.error("Will not be able to print row ".concat($.index," correctly since it's minimum height is larger than page height")),!0;if(!ue)return!1;var ce=$.hasRowSpan(K.columns),ye=$.getMaxCellHeight(K.columns)>W;return ye?(ce&&console.error("The content of row ".concat($.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(ce||K.settings.rowPageBreak==="avoid")}function B(M,$,q,K,de,Ne,R){var W=z(M,$,K,Ne);if(q.canEntireRowFit(W,R))U(M,$,q,Ne,R);else if(C(M,q,W,$)){var Z=L(q,W,$,M);U(M,$,q,Ne,R),H(M,$,de,Ne,R),B(M,$,Z,K,de,Ne,R)}else H(M,$,de,Ne,R),B(M,$,q,K,de,Ne,R)}function U(M,$,q,K,de){K.x=$.settings.margin.left;for(var Ne=0,R=de;Ne<R.length;Ne++){var W=R[Ne],Z=q.cells[W.index];if(!Z){K.x+=W.width;continue}M.applyStyles(Z.styles),Z.x=K.x,Z.y=K.y;var ue=$.callCellHooks(M,$.hooks.willDrawCell,Z,q,W,K);if(ue===!1){K.x+=W.width;continue}P(M,Z,K);var ce=Z.getTextPos();(0,x.default)(Z.text,ce.x,ce.y,{halign:Z.styles.halign,valign:Z.styles.valign,maxWidth:Math.ceil(Z.width-Z.padding("left")-Z.padding("right"))},M.getDocument()),$.callCellHooks(M,$.hooks.didDrawCell,Z,q,W,K),K.x+=W.width}K.y+=q.height}function P(M,$,q){var K=$.styles;if(M.getDocument().setFillColor(M.getDocument().getFillColor()),typeof K.lineWidth=="number"){var de=(0,u.getFillStyle)(K.lineWidth,K.fillColor);de&&M.rect($.x,q.y,$.width,$.height,de)}else typeof K.lineWidth=="object"&&(K.fillColor&&M.rect($.x,q.y,$.width,$.height,"F"),T(M,$,q,K.lineWidth))}function T(M,$,q,K){var de,Ne,R,W;K.top&&(de=q.x,Ne=q.y,R=q.x+$.width,W=q.y,K.right&&(R+=.5*K.right),K.left&&(de-=.5*K.left),Z(K.top,de,Ne,R,W)),K.bottom&&(de=q.x,Ne=q.y+$.height,R=q.x+$.width,W=q.y+$.height,K.right&&(R+=.5*K.right),K.left&&(de-=.5*K.left),Z(K.bottom,de,Ne,R,W)),K.left&&(de=q.x,Ne=q.y,R=q.x,W=q.y+$.height,K.top&&(Ne-=.5*K.top),K.bottom&&(W+=.5*K.bottom),Z(K.left,de,Ne,R,W)),K.right&&(de=q.x+$.width,Ne=q.y,R=q.x+$.width,W=q.y+$.height,K.top&&(Ne-=.5*K.top),K.bottom&&(W+=.5*K.bottom),Z(K.right,de,Ne,R,W));function Z(ue,ce,ye,Se,Ee){M.getDocument().setLineWidth(ue),M.getDocument().line(ce,ye,Se,Ee,"S")}}function z(M,$,q,K){var de=$.settings.margin.bottom,Ne=$.settings.showFoot;return(Ne==="everyPage"||Ne==="lastPage"&&q)&&(de+=$.getFootHeight($.columns)),M.pageSize().height-K.y-de}function H(M,$,q,K,de,Ne){de===void 0&&(de=[]),Ne===void 0&&(Ne=!1),M.applyStyles(M.userStyles),$.settings.showFoot==="everyPage"&&!Ne&&$.foot.forEach(function(W){return U(M,$,W,K,de)}),$.callEndPageHooks(M,K);var R=$.settings.margin;(0,u.addTableBorder)(M,$,q,K),D(M),$.pageNumber++,$.pageCount++,K.x=R.left,K.y=R.top,q.y=R.top,$.callWillDrawPageHooks(M,K),$.settings.showHead==="everyPage"&&($.head.forEach(function(W){return U(M,$,W,K,de)}),M.applyStyles(M.userStyles))}c.addPage=H;function D(M){var $=M.pageNumber();M.setPage($+1);var q=M.pageNumber();return q===$?(M.addPage(),!0):!1}},224:function(l,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.calculateAllColumnsCanFitInPage=void 0;var u=d(420);function h(p,x,w){var S;w===void 0&&(w={});var b=(0,u.getPageAvailableWidth)(p,x),v=new Map,N=[],j=[],E=[];x.settings.horizontalPageBreakRepeat,Array.isArray(x.settings.horizontalPageBreakRepeat)?E=x.settings.horizontalPageBreakRepeat:(typeof x.settings.horizontalPageBreakRepeat=="string"||typeof x.settings.horizontalPageBreakRepeat=="number")&&(E=[x.settings.horizontalPageBreakRepeat]),E.forEach(function(B){var U=x.columns.find(function(P){return P.dataKey===B||P.index===B});U&&!v.has(U.index)&&(v.set(U.index,!0),N.push(U.index),j.push(x.columns[U.index]),b-=U.wrappedWidth)});for(var A=!0,L=(S=w==null?void 0:w.start)!==null&&S!==void 0?S:0;L<x.columns.length;){if(v.has(L)){L++;continue}var C=x.columns[L].wrappedWidth;if(A||b>=C)A=!1,N.push(L),j.push(x.columns[L]),b-=C;else break;L++}return{colIndexes:N,columns:j,lastIndex:L-1}}function m(p,x){for(var w=[],S=0;S<x.columns.length;S++){var b=h(p,x,{start:S});b.columns.length&&(w.push(b),S=b.lastIndex)}return w}c.calculateAllColumnsCanFitInPage=m},324:function(l,c,d){Object.defineProperty(c,"__esModule",{value:!0}),c.ellipsize=c.resizeColumns=c.calculateWidths=void 0;var u=d(420);function h(N,j){m(N,j);var E=[],A=0;j.columns.forEach(function(C){var B=C.getMaxCustomCellWidth(j);B?C.width=B:(C.width=C.wrappedWidth,E.push(C)),A+=C.width});var L=j.getWidth(N.pageSize().width)-A;L&&(L=p(E,L,function(C){return Math.max(C.minReadableWidth,C.minWidth)})),L&&(L=p(E,L,function(C){return C.minWidth})),L=Math.abs(L),!j.settings.horizontalPageBreak&&L>.1/N.scaleFactor()&&(L=L<1?L:Math.round(L),console.warn("Of the table content, ".concat(L," units width could not fit page"))),w(j),S(j,N),x(j)}c.calculateWidths=h;function m(N,j){var E=N.scaleFactor(),A=j.settings.horizontalPageBreak,L=(0,u.getPageAvailableWidth)(N,j);j.allRows().forEach(function(C){for(var B=0,U=j.columns;B<U.length;B++){var P=U[B],T=C.cells[P.index];if(T){var z=j.hooks.didParseCell;j.callCellHooks(N,z,T,C,P,null);var H=T.padding("horizontal");T.contentWidth=(0,u.getStringWidth)(T.text,T.styles,N)+H;var D=(0,u.getStringWidth)(T.text.join(" ").split(/[^\S\u00A0]+/),T.styles,N);if(T.minReadableWidth=D+T.padding("horizontal"),typeof T.styles.cellWidth=="number")T.minWidth=T.styles.cellWidth,T.wrappedWidth=T.styles.cellWidth;else if(T.styles.cellWidth==="wrap"||A===!0)T.contentWidth>L?(T.minWidth=L,T.wrappedWidth=L):(T.minWidth=T.contentWidth,T.wrappedWidth=T.contentWidth);else{var M=10/E;T.minWidth=T.styles.minCellWidth||M,T.wrappedWidth=T.contentWidth,T.minWidth>T.wrappedWidth&&(T.wrappedWidth=T.minWidth)}}}}),j.allRows().forEach(function(C){for(var B=0,U=j.columns;B<U.length;B++){var P=U[B],T=C.cells[P.index];if(T&&T.colSpan===1)P.wrappedWidth=Math.max(P.wrappedWidth,T.wrappedWidth),P.minWidth=Math.max(P.minWidth,T.minWidth),P.minReadableWidth=Math.max(P.minReadableWidth,T.minReadableWidth);else{var z=j.styles.columnStyles[P.dataKey]||j.styles.columnStyles[P.index]||{},H=z.cellWidth||z.minCellWidth;H&&typeof H=="number"&&(P.minWidth=H,P.wrappedWidth=H)}T&&(T.colSpan>1&&!P.minWidth&&(P.minWidth=T.minWidth),T.colSpan>1&&!P.wrappedWidth&&(P.wrappedWidth=T.minWidth))}})}function p(N,j,E){for(var A=j,L=N.reduce(function(M,$){return M+$.wrappedWidth},0),C=0;C<N.length;C++){var B=N[C],U=B.wrappedWidth/L,P=A*U,T=B.width+P,z=E(B),H=T<z?z:T;j-=H-B.width,B.width=H}if(j=Math.round(j*1e10)/1e10,j){var D=N.filter(function(M){return j<0?M.width>E(M):!0});D.length&&(j=p(D,j,E))}return j}c.resizeColumns=p;function x(N){for(var j={},E=1,A=N.allRows(),L=0;L<A.length;L++)for(var C=A[L],B=0,U=N.columns;B<U.length;B++){var P=U[B],T=j[P.index];if(E>1)E--,delete C.cells[P.index];else if(T)T.cell.height+=C.height,E=T.cell.colSpan,delete C.cells[P.index],T.left--,T.left<=1&&delete j[P.index];else{var z=C.cells[P.index];if(!z)continue;if(z.height=C.height,z.rowSpan>1){var H=A.length-L,D=z.rowSpan>H?H:z.rowSpan;j[P.index]={cell:z,left:D,row:C}}}}}function w(N){for(var j=N.allRows(),E=0;E<j.length;E++)for(var A=j[E],L=null,C=0,B=0,U=0;U<N.columns.length;U++){var P=N.columns[U];if(B-=1,B>1&&N.columns[U+1])C+=P.width,delete A.cells[P.index];else if(L){var T=L;delete A.cells[P.index],L=null,T.width=P.width+C}else{var T=A.cells[P.index];if(!T)continue;if(B=T.colSpan,C=0,T.colSpan>1){L=T,C+=P.width;continue}T.width=P.width+C}}}function S(N,j){for(var E={count:0,height:0},A=0,L=N.allRows();A<L.length;A++){for(var C=L[A],B=0,U=N.columns;B<U.length;B++){var P=U[B],T=C.cells[P.index];if(T){j.applyStyles(T.styles,!0);var z=T.width-T.padding("horizontal");if(T.styles.overflow==="linebreak")T.text=j.splitTextToSize(T.text,z+1/j.scaleFactor(),{fontSize:T.styles.fontSize});else if(T.styles.overflow==="ellipsize")T.text=b(T.text,z,T.styles,j,"...");else if(T.styles.overflow==="hidden")T.text=b(T.text,z,T.styles,j,"");else if(typeof T.styles.overflow=="function"){var H=T.styles.overflow(T.text,z);typeof H=="string"?T.text=[H]:T.text=H}T.contentHeight=T.getContentHeight(j.scaleFactor(),j.getLineHeightFactor());var D=T.contentHeight/T.rowSpan;T.rowSpan>1&&E.count*E.height<D*T.rowSpan?E={height:D,count:T.rowSpan}:E&&E.count>0&&E.height>D&&(D=E.height),D>C.height&&(C.height=D)}}E.count--}}function b(N,j,E,A,L){return N.map(function(C){return v(C,j,E,A,L)})}c.ellipsize=b;function v(N,j,E,A,L){var C=1e4*A.scaleFactor();if(j=Math.ceil(j*C)/C,j>=(0,u.getStringWidth)(N,E,A))return N;for(;j<(0,u.getStringWidth)(N+L,E,A)&&!(N.length<=1);)N=N.substring(0,N.length-1);return N.trim()+L}},964:function(l){if(typeof t>"u"){var c=new Error("Cannot find module 'undefined'");throw c.code="MODULE_NOT_FOUND",c}l.exports=t}},n={};function i(l){var c=n[l];if(c!==void 0)return c.exports;var d=n[l]={exports:{}};return r[l].call(d.exports,d,d.exports,i),d.exports}var o={};return function(){var l=o;Object.defineProperty(l,"__esModule",{value:!0}),l.Cell=l.Column=l.Row=l.Table=l.CellHookData=l.__drawTable=l.__createTable=l.applyPlugin=void 0;var c=i(340),d=i(776),u=i(664),h=i(972),m=i(260);Object.defineProperty(l,"Table",{enumerable:!0,get:function(){return m.Table}});var p=i(172);Object.defineProperty(l,"CellHookData",{enumerable:!0,get:function(){return p.CellHookData}});var x=i(260);Object.defineProperty(l,"Cell",{enumerable:!0,get:function(){return x.Cell}}),Object.defineProperty(l,"Column",{enumerable:!0,get:function(){return x.Column}}),Object.defineProperty(l,"Row",{enumerable:!0,get:function(){return x.Row}});function w(j){(0,c.default)(j)}l.applyPlugin=w;function S(j,E){var A=(0,d.parseInput)(j,E),L=(0,h.createTable)(j,A);(0,u.drawTable)(j,L)}function b(j,E){var A=(0,d.parseInput)(j,E);return(0,h.createTable)(j,A)}l.__createTable=b;function v(j,E){(0,u.drawTable)(j,E)}l.__drawTable=v;try{var N=i(964);N.jsPDF&&(N=N.jsPDF),w(N)}catch{}l.default=S}(),o}()})})(tT);var g$=tT.exports;const Oy=Y3(g$),Xn=s=>{if(typeof s=="number")return Number.isFinite(s)?s:0;const e=String(s??"").replace(/[,\s]/g,"").replace(/[^0-9.+-]/g,""),t=parseFloat(e);return Number.isFinite(t)?t:0},ps=s=>s.toLocaleString("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}),x$=s=>String(s||"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),nu=s=>{const e=String(s||"").toLowerCase().replace(/\s+/g," ").trim();return e==="business name and owner"||e==="business name and owder"||e.includes("business name")&&e.includes("owner")},iu=s=>String(s||"").toLowerCase().replace(/\s+/g," ").trim()==="funder list",j1=s=>{const e=String(s||"").trim(),t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!t)return e||"—";const[,r,n,i]=t,o=new Date(Number(r),Number(n)-1,Number(i));try{return o.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"2-digit"})}catch{return e}},b$=s=>{if(!s)return"—";const e=String(s).trim();try{if(/^\d{4}-\d{2}(-\d{2})?$/.test(e)){const i=e.split("-"),o=parseInt(i[0]),l=parseInt(i[1])-1,c=i.length>2?parseInt(i[2]):15;return new Date(o,l,c).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}const t=["january","february","march","april","may","june","july","august","september","october","november","december"],r=e.toLowerCase();for(let i=0;i<t.length;i++)if(r.includes(t[i])){const o=e.match(/\d{4}/),l=o?parseInt(o[0]):new Date().getFullYear(),c=e.match(/\b(\d{1,2})\b/),d=c?parseInt(c[1]):15;return new Date(l,i,d).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}const n=new Date(e);if(!isNaN(n.getTime()))return n.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch(t){console.error("Failed to parse date:",t)}return e},y$=()=>{const s=new Date,e=s.getFullYear(),t=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0");return`${e}-${t}-${r}`},h5=()=>{const s=y$(),e=Date.now(),t=Math.random().toString(36).slice(2,6);return`${s}-${e}-${t}`},By=async(s,e={})=>{const t={...e};return"timeoutMs"in t&&delete t.timeoutMs,fetch(s,t)},v$=({isDragOver:s,batchProcessing:e,disabled:t,onDragOver:r,onDragLeave:n,onDrop:i,onChooseFiles:o})=>a.jsx("div",{className:`relative p-10 border-2 border-dashed rounded-3xl text-center transition-all duration-300 ${s&&!t?"border-blue-400 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-xl scale-[1.02]":"border-gray-300 bg-gradient-to-br from-gray-50/50 via-white to-blue-50/30 "+(t?"opacity-60":"hover:border-blue-400 hover:bg-gradient-to-br hover:from-blue-50/50 hover:to-indigo-50/50 hover:shadow-lg hover:scale-[1.01]")} ${t?"pointer-events-none":""}`,onDragOver:r,onDragLeave:n,onDrop:i,children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"p-4 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-2xl w-fit mx-auto mb-6 shadow-sm",children:a.jsx(u1,{className:"w-8 h-8 text-blue-600"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Upload Bank Statements"}),a.jsx("p",{className:"text-sm text-gray-600 mb-8 max-w-md mx-auto leading-relaxed",children:"Drag & drop PDF files here or click to browse."}),a.jsxs("label",{className:`cursor-pointer inline-flex items-center gap-3 px-8 py-4 rounded-2xl font-bold focus:outline-none focus:ring-4 focus:ring-blue-500/40 transition-all duration-200 shadow-lg ${e||t?"pointer-events-none opacity-60 bg-gray-400 text-white":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl hover:scale-105"}`,children:[a.jsx(u1,{className:"w-5 h-5"}),"Choose Files",a.jsx("input",{type:"file",className:"sr-only",accept:".pdf",multiple:!0,disabled:e||!!t,onChange:l=>!(e||t)&&o(l.target.files)})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-4 font-medium",children:"PDF files only, max 10MB each"})]})}),w$=({categoryDropdownOpen:s,onToggleDropdown:e,selectedCategories:t,allCategories:r,mainCategorySummaries:n,onClearAll:i,onSelectAll:o,onToggleCategory:l,categorySearch:c,onCategorySearchChange:d,onCategorySearchEnter:u,onApplyCategories:h})=>a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex flex-col lg:flex-row items-stretch lg:items-center justify-between gap-4",children:[a.jsx("div",{className:"flex flex-col gap-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("label",{className:"text-sm font-semibold text-slate-700 min-w-fit",children:"Filter by Category:"}),a.jsxs("div",{className:"relative category-dropdown",children:[a.jsxs("button",{type:"button",onClick:e,className:"text-sm border border-slate-300 rounded-lg px-4 py-2.5 bg-white hover:border-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 min-w-[200px] flex items-center justify-between",children:[a.jsx("span",{children:t.size===0?"All Categories":t.size===1?Array.from(t)[0]:`${t.size} selected`}),a.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&a.jsxs("div",{className:"absolute z-10 mt-1 w-[360px] min-w-[320px] max-w-[420px] bg-white border border-slate-300 rounded-lg shadow-lg max-h-72 overflow-hidden",children:[a.jsxs("div",{className:"p-2 max-h-60 overflow-y-auto",children:[a.jsx("button",{type:"button",onClick:i,className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-100 rounded font-semibold text-slate-700",children:"Clear All"}),a.jsx("button",{type:"button",onClick:o,className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-100 rounded font-semibold text-slate-700",children:"Select All"}),a.jsx("hr",{className:"my-2"}),r.map(m=>{const p=n[m],x=(p==null?void 0:p.subWithData)||[],w=x.length,S=x.slice(0,3).join(", ");return a.jsxs("label",{className:"flex items-center justify-between gap-2 px-3 py-2 text-sm hover:bg-slate-100 rounded cursor-pointer w-full",children:[a.jsx("input",{type:"checkbox",checked:t.has(m),onChange:b=>l(m,b.target.checked),onClick:b=>b.stopPropagation(),className:"mr-3 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"text-slate-700 font-medium flex-1 truncate",children:m}),a.jsxs("div",{className:"ml-2 flex items-center gap-2 whitespace-nowrap",children:[a.jsxs("span",{className:"px-2 py-0.5 text-[10px] rounded-full bg-slate-100 text-slate-700 border border-slate-200 whitespace-nowrap",children:[w," with data"]}),w>0&&a.jsxs("span",{className:"text-[10px] text-slate-500 truncate max-w-[220px]",title:x.join(", "),children:[S,w>3?`, +${w-3} more`:""]})]})]},m)})]}),a.jsx("div",{className:"p-2 border-t border-slate-200 bg-white sticky bottom-0",children:a.jsx("button",{type:"button",onClick:()=>{h&&h(),e();try{const m=document.getElementById("categories-summary");m?m.scrollIntoView({behavior:"smooth",block:"start"}):typeof window<"u"&&window.scrollBy({top:600,behavior:"smooth"})}catch{}},className:"w-full px-4 py-2 text-sm font-semibold rounded-md bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Apply"})})]})]})]})}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("label",{className:"text-sm font-semibold text-slate-700 min-w-fit",children:"Search Transactions:"}),a.jsx("input",{type:"text",value:c,onChange:m=>d(m.target.value),onKeyDown:m=>{m.key==="Enter"&&u()},placeholder:"Search by date, description, or amount...",className:"w-full lg:w-80 text-sm border border-slate-300 rounded-lg px-4 py-2.5 bg-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"})]})]})}),N$=({open:s,title:e,rows:t,onClose:r,selected:n,onToggleIndex:i,onToggleAll:o,selectedTotal:l})=>{if(!s)return null;const c=n.size===t.length&&t.length>0;return a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm",children:[a.jsx("div",{className:"absolute inset-0",onClick:r,"aria-hidden":!0}),a.jsxs("div",{role:"dialog","aria-modal":"true",className:"relative bg-white rounded-3xl shadow-2xl border border-slate-200/50 w-full max-w-2xl overflow-hidden animate-in fade-in-0 zoom-in-95 duration-200",children:[a.jsx("div",{className:"px-8 py-6 bg-gradient-to-r from-slate-50 via-white to-blue-50/30 border-b border-slate-200/60",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg",children:a.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1",children:"Transaction Category"}),a.jsx("div",{className:"text-xl font-bold text-slate-900 leading-tight",children:e}),a.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:[t.length," transaction",t.length!==1?"s":""]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1",children:"Selected Total"}),a.jsx("div",{className:"text-2xl font-black text-emerald-600 font-mono",children:ps(l)})]})]})}),a.jsxs("div",{className:"px-8 py-4 bg-slate-50/50 border-b border-slate-200/60 flex items-center justify-between",children:[a.jsxs("label",{className:"inline-flex items-center gap-3 text-sm font-semibold text-slate-700 cursor-pointer hover:text-slate-900 transition-colors",children:[a.jsx("input",{type:"checkbox",checked:c,onChange:o,className:"w-5 h-5 rounded-lg border-2 border-slate-300 text-blue-600 focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-all duration-200"}),a.jsx("span",{children:"Select all transactions"})]}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("div",{className:"text-sm text-slate-600",children:[a.jsx("span",{className:"font-semibold text-slate-900",children:n.size})," of ",a.jsx("span",{className:"font-semibold text-slate-900",children:t.length})," selected"]})})]}),a.jsx("div",{className:"max-h-[65vh] overflow-y-auto",children:t.length===0?a.jsxs("div",{className:"p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsx("div",{className:"text-slate-500 font-medium",children:"No transactions found"})]}):t.map((d,u)=>a.jsxs("button",{type:"button",onClick:()=>i(u),className:`w-full text-left px-8 py-4 flex items-center justify-between transition-all duration-200 border-l-4 ${n.has(u)?"bg-blue-50/50 hover:bg-blue-100/50 border-l-blue-500 shadow-sm":"bg-white hover:bg-slate-50 border-l-transparent"} ${u%2===0?"bg-opacity-50":""}`,children:[a.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-1",children:[a.jsx("input",{type:"checkbox",checked:n.has(u),onChange:()=>i(u),className:"w-5 h-5 rounded-lg border-2 border-slate-300 text-blue-600 focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-all duration-200",onClick:h=>h.stopPropagation()}),a.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-1",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-2 h-8 bg-gradient-to-b from-blue-400 to-indigo-500 rounded-full shadow-sm"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900 whitespace-nowrap",children:j1(d.date)}),a.jsx("div",{className:"w-1 h-1 bg-slate-300 rounded-full flex-shrink-0"}),a.jsx("div",{className:"text-xs text-slate-500 font-medium uppercase tracking-wide",children:"Transaction"})]}),a.jsx("div",{className:"text-sm text-slate-700 leading-relaxed truncate pr-4",title:d.description,children:d.description||"No description available"})]})]})]}),a.jsxs("div",{className:"flex-shrink-0 text-right ml-4",children:[a.jsx("div",{className:"text-lg font-black text-slate-900 font-mono",children:ps(d.amount)}),a.jsx("div",{className:"text-xs text-slate-500 mt-1",children:n.has(u)?"Included":"Excluded"})]})]},`modal-row-${u}`))}),a.jsx("div",{className:"px-8 py-6 bg-gradient-to-r from-slate-50 via-white to-blue-50/30 border-t border-slate-200/60",children:a.jsx("div",{className:"flex items-center justify-end",children:a.jsx("button",{type:"button",onClick:r,className:"px-6 py-2.5 rounded-xl text-sm font-bold bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 shadow-lg hover:shadow-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/30",children:"Done"})})})]})]})},_$=({documentDetails:s,monthlyData:e,onSave:t})=>{const[r,n]=Yt.useState(null),[i,o]=Yt.useState({}),[l,c]=Yt.useState(null);let d=0;const u={},h={},m={},p={};try{Object.entries(e).forEach(([E,A])=>{if(Array.isArray(A)){u[E]||(u[E]=0),h[E]||(h[E]=0),m[E]||(m[E]=[]);let L=0;A.forEach(C=>{const B=(C==null?void 0:C.date)||(C==null?void 0:C.Date)||(C==null?void 0:C.transaction_date)||(C==null?void 0:C.posted_at)||"",U=(C==null?void 0:C.description)||(C==null?void 0:C.Description)||(C==null?void 0:C.memo)||(C==null?void 0:C.details)||"",P=[C==null?void 0:C.amount,C==null?void 0:C.Amount,C==null?void 0:C.value,C==null?void 0:C.amt,C==null?void 0:C.debit_amount,C==null?void 0:C.debitAmount,C==null?void 0:C.daily_amount,C&&(C["Daily Amount"]||C["daily Amount"]),C==null?void 0:C.original_amount,C==null?void 0:C.OriginalAmount];let T=0;for(const H of P){const D=parseFloat(String(H??"").toString().replace(/[^0-9.-]/g,""));if(Number.isFinite(D)&&D!==0){T=D;break}}if(!Number.isFinite(T)||T===0){const H=String(U||"").match(/-?\$?\s*([0-9]{1,3}(?:,[0-9]{3})*(?:\.[0-9]{2})|[0-9]+(?:\.[0-9]{2})?)/g);if(H&&H.length){const D=H[H.length-1],M=parseFloat(D.replace(/[^0-9.-]/g,""));Number.isFinite(M)&&(T=M)}}Number.isFinite(T)||(T=0),u[E]+=T,L+=T,!nu(E)&&!iu(E)&&(d+=T);const z=`${E}::${E}`;p[z]||(p[z]=[]),p[z].push({date:String(B||""),description:String(U||""),amount:T})}),h[E]+=L,m[E].push({name:E,amount:L})}else if(A&&typeof A=="object"){let L=0;m[E]||(m[E]=[]),Object.entries(A).forEach(([C,B])=>{u[C]||(u[C]=0);const P=(z=>z?Array.isArray(z)?z.flat().filter(Boolean):typeof z=="object"?Object.values(z).reduce((M,$)=>{if(Array.isArray($))M.push(...$);else if($&&typeof $=="object"){const q=$.transactions;Array.isArray(q)&&M.push(...q)}return M},[]).filter(Boolean):[]:[])(B);let T=0;P.forEach(z=>{const H=(z==null?void 0:z.date)||(z==null?void 0:z.Date)||(z==null?void 0:z.transaction_date)||(z==null?void 0:z.posted_at)||"",D=(z==null?void 0:z.description)||(z==null?void 0:z.Description)||(z==null?void 0:z.memo)||(z==null?void 0:z.details)||"",M=[z==null?void 0:z.amount,z==null?void 0:z.Amount,z==null?void 0:z.value,z==null?void 0:z.amt,z==null?void 0:z.debit_amount,z==null?void 0:z.debitAmount,z==null?void 0:z.daily_amount,z&&(z["Daily Amount"]||z["daily Amount"]),z==null?void 0:z.original_amount,z==null?void 0:z.OriginalAmount];let $=0;for(const K of M){const de=parseFloat(String(K??"").toString().replace(/[^0-9.-]/g,""));if(Number.isFinite(de)&&de!==0){$=de;break}}if(!Number.isFinite($)||$===0){const K=String(D||"").match(/-?\$?\s*([0-9]{1,3}(?:,[0-9]{3})*(?:\.[0-9]{2})|[0-9]+(?:\.[0-9]{2})?)/g);if(K&&K.length){const de=K[K.length-1],Ne=parseFloat(de.replace(/[^0-9.-]/g,""));Number.isFinite(Ne)&&($=Ne)}}Number.isFinite($)||($=0),u[C]+=$,T+=$,!nu(C)&&!iu(C)&&(d+=$);const q=`${E}::${C}`;p[q]||(p[q]=[]),p[q].push({date:String(H||""),description:String(D||""),amount:$})}),L+=T,m[E].push({name:C,amount:T})}),h[E]||(h[E]=0),h[E]+=L}})}catch(E){console.error("Error calculating category totals:",E)}const x=parseFloat(String(s==null?void 0:s.total_deposits).replace(/[^0-9.-]/g,""))||0,w={};let S=0;Object.entries(m).forEach(([E,A])=>{let L=0;A.forEach(C=>{const B=`${E}::${C.name}`,U=p[B]||[],P=i[B];let T=0;P?U.forEach((z,H)=>{P.has(H)&&(T+=z.amount||0)}):T=nu(C.name)||iu(C.name)?0:C.amount||U.reduce((H,D)=>H+(D.amount||0),0),L+=T}),w[E]=L,S+=L});const b=x-S,v=s&&(s.monthly_revenue??(s.extracted_json&&(s.extracted_json.monthly_revenue??(s.mca_summary&&s.mca_summary.monthly_revenue)))),N=Xn(v),j=l!==null&&Number.isFinite(l)?l:Number.isFinite(N)&&N!==0?N:b;return Yt.useEffect(()=>{const E=Xn(s==null?void 0:s.monthly_revenue);l!==null&&Number.isFinite(E)&&E!==0&&c(null)},[s==null?void 0:s.monthly_revenue]),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-slate-800 to-slate-900 rounded-xl shadow-lg p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-300 text-sm font-medium uppercase tracking-wider",children:"Month"}),a.jsx("div",{className:"text-xl font-bold text-white",children:String((s==null?void 0:s.month)||((s==null?void 0:s.statement_date)||"").slice(0,7)||"—")})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-slate-300 text-sm font-medium uppercase tracking-wider",children:"Total Deposits"}),a.jsxs("div",{className:"text-3xl font-black text-white",children:["$",x.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-slate-200 p-8",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Transaction Summary"}),a.jsx("div",{className:"w-16 h-1 bg-gradient-to-r from-blue-500 to-indigo-500 mx-auto rounded-full"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 border-2 border-emerald-200 rounded-xl p-6",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-emerald-700 text-sm font-semibold",children:"Total Deposits"}),a.jsxs("div",{className:"text-2xl font-bold text-emerald-900",children:["$",x.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})}),a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:a.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-blue-700 text-sm font-semibold",children:"Total from Categories"}),a.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:["$",S.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})})]}),Object.keys(m).length>0&&a.jsxs("div",{id:"categories-summary",className:"bg-gradient-to-br from-white via-slate-50/30 to-blue-50/20 rounded-2xl border border-slate-200/60 overflow-hidden",children:[a.jsx("div",{className:"px-8 py-6 bg-gradient-to-r from-slate-800 via-slate-700 to-blue-900 border-b border-slate-600/20",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl flex items-center justify-center",children:a.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xl font-bold text-white leading-tight",children:"Categories Included in Calculation"}),a.jsx("p",{className:"text-slate-300 text-sm mt-1",children:"Click subcategory chips to view and select transactions"})]})]})}),a.jsx("div",{className:"p-8 space-y-6",children:Object.entries(h).filter(([,E])=>E>0).sort(([,E],[,A])=>A-E).map(([E,A])=>{const C=(m[E]||[]).filter(P=>P.amount>0),B=C.length;let U=0;return C.forEach(P=>{const T=`${E}::${P.name}`,z=p[T]||[],H=i[T];let D=0;H?z.forEach((M,$)=>{H.has($)&&(D+=M.amount||0)}):D=nu(P.name)||iu(P.name)?0:P.amount||z.reduce(($,q)=>$+(q.amount||0),0),D>0&&(U+=1)}),a.jsx("div",{className:"group bg-white rounded-2xl p-6 border border-slate-200/60 transition-all duration-300 hover:scale-[1.02] hover:border-blue-300/50",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-3 h-8 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-full"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-lg font-bold text-slate-900 leading-tight",children:E}),a.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),B," subcategories"]}),a.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold bg-emerald-50 text-emerald-700 border border-emerald-200",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"}),U," included"]})]})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[m[E].filter(P=>P.amount>0).sort((P,T)=>T.amount-P.amount).slice(0,6).map(P=>{const T=`${E}::${P.name}`,z=p[T]||[],H=i[T];let D=0;H?z.forEach((q,K)=>{H.has(K)&&(D+=q.amount||0)}):D=nu(P.name)||iu(P.name)?0:P.amount||z.reduce((K,de)=>K+(de.amount||0),0);const M=z.length,$=H?H.size:M;return a.jsxs("div",{className:"flex flex-col items-start",children:[a.jsxs("button",{type:"button",onClick:()=>{const q=(p[T]||[]).slice().sort((K,de)=>String(K.date||"").localeCompare(String(de.date||"")));n({key:T,title:P.name,amount:P.amount,rows:q})},className:`inline-flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-semibold border-2 transition-all duration-200 hover:scale-105 ${nu(P.name)||iu(P.name)?"bg-gradient-to-r from-amber-50 to-orange-50 text-amber-800 border-amber-300 hover:from-amber-100 hover:to-orange-100 hover:border-amber-400":"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 border-blue-300 hover:from-blue-100 hover:to-indigo-100 hover:border-blue-400"}`,title:`View transactions for ${P.name}`,children:[a.jsx("span",{className:"font-semibold truncate max-w-[180px]",children:P.name}),a.jsx("div",{className:"w-px h-4 bg-current opacity-30"}),a.jsx("span",{className:"font-black font-mono text-sm",children:ps(D)})]}),a.jsxs("span",{className:"mt-1 text-[11px] text-slate-500 font-medium",children:[$," of ",M," Selected transactions"]})]},`${E}-${P.name}`)}),m[E].filter(P=>P.amount>0).length>6&&a.jsxs("div",{className:"inline-flex items-center px-3 py-2 rounded-xl bg-slate-100 border border-slate-200 text-xs font-semibold text-slate-600",children:["+",m[E].filter(P=>P.amount>0).length-6," more"]})]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1",children:"Main Total"}),a.jsx("div",{className:"text-2xl font-black text-slate-900 font-mono leading-tight",children:ps(w[E]??A)}),a.jsxs("div",{className:"text-xs text-slate-500 mt-1 font-medium",children:[((w[E]??A)/S*100).toFixed(1),"% of total"]})]})]})},E)})})]}),a.jsx("div",{className:`rounded-xl border-2 p-6 ${j>=0?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200":"bg-gradient-to-br from-red-50 to-rose-50 border-red-200"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${j>=0?"bg-green-500":"bg-red-500"}`,children:a.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:j>=0?"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6":"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})})}),a.jsxs("div",{children:[a.jsx("div",{className:`text-sm font-semibold ${j>=0?"text-green-700":"text-red-700"}`,children:"Net Difference"}),a.jsxs("div",{className:`text-3xl font-black ${j>=0?"text-green-900":"text-red-900"}`,children:[j>=0?"+":"","$",Math.abs(j).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),a.jsxs("div",{className:`${j>=0?"text-green-600":"text-red-600"}`,children:[a.jsx("div",{className:"text-sm font-medium",children:j>=0?"Surplus":"Deficit"}),a.jsxs("div",{className:"text-xs opacity-75",children:[x?(Math.abs(j)/x*100).toFixed(1):"0.0","% of total"]})]})]})}),a.jsx("div",{className:"flex items-center justify-end mt-2",children:a.jsx("button",{type:"button",onClick:()=>{if(!t)return;const E={};Object.entries(i).forEach(([A,L])=>{E[A]=Array.from(L.values()).sort((C,B)=>C-B)}),c(b),t({documentDetails:s,selectedMap:E,selectedTotalFromCategories:S,effectiveMainTotals:w,difference:b})},className:"px-5 py-2 rounded-xl text-sm font-bold bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500/30",children:"Save Selection"})})]})]}),r&&(()=>{const E=r.key,A=r.rows,C=nu(r.title)||iu(r.title)?new Set:new Set(A.map((z,H)=>H)),B=i[E]??C,U=A.reduce((z,H,D)=>z+(B.has(D)&&H.amount||0),0),P=z=>{o(H=>{const D={...H},M=new Set(D[E]??[]);return M.has(z)?M.delete(z):M.add(z),D[E]=M,D})},T=()=>{o(z=>{const H={...z},D=new Set(A.map(($,q)=>q)),M=H[E];return M&&M.size===A.length?H[E]=new Set:H[E]=D,H})};return a.jsx(N$,{open:!!r,title:r.title,amount:r.amount,rows:A,onClose:()=>n(null),selected:B,onToggleIndex:P,onToggleAll:T,selectedTotal:U})})()]})},S$=({files:s,bucketSubmitting:e,batchProcessing:t,onSubmitAll:r,onRemoveAt:n})=>s.length>0?a.jsxs("div",{className:"mt-6 bg-white rounded-2xl border border-slate-200 shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"px-6 py-4 bg-gradient-to-r from-slate-50 to-blue-50/30 border-b border-slate-200 flex items-center justify-between",children:[a.jsxs("div",{className:"text-slate-800 font-bold",children:["Files Staged (",s.length,")"]}),a.jsx("button",{type:"button",onClick:r,disabled:e||t,className:`inline-flex items-center gap-2 px-4 py-2 rounded-lg font-semibold text-white ${e||t?"bg-gray-400":"bg-blue-600 hover:bg-blue-700"} transition-colors`,children:e||t?"Submitting…":"Submit All"})]}),a.jsx("div",{className:"divide-y divide-slate-100",children:s.map((i,o)=>a.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-slate-100 flex items-center justify-center",children:a.jsx(Is,{className:"w-5 h-5 text-slate-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",title:i.name,children:i.name}),a.jsxs("div",{className:"text-xs text-slate-600",children:[(i.size/1024/1024).toFixed(1)," MB • ",i.type||"application/pdf"]})]})]}),a.jsx("button",{type:"button",onClick:()=>n(o),className:"px-3 py-1.5 text-sm rounded-lg border border-slate-200 text-slate-600 hover:bg-slate-50",title:"Remove",children:"Remove"})]},`${i.name}-${o}`))})]}):null,j$=({hasBankruptcies:s,hasOpenJudgments:e,onToggleBankruptcies:t,onToggleOpenJudgments:r})=>a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-amber-100 to-orange-100 rounded-xl shadow-sm border border-amber-200",children:a.jsx(Br,{className:"w-5 h-5 text-amber-700"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Legal & Compliance"})]}),a.jsx("p",{className:"text-sm text-gray-600 ml-12",children:"Legal status and financial history"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[a.jsx("div",{className:"group",children:a.jsxs("label",{className:"flex items-start gap-4 p-5 rounded-2xl border-2 border-gray-200 bg-white hover:border-gray-300 hover:shadow-md transition-all duration-200 cursor-pointer",children:[a.jsx("div",{className:"flex items-center justify-center w-6 h-6 mt-0.5",children:a.jsx("input",{type:"checkbox",checked:!!s,onChange:n=>t(n.target.checked),className:"w-5 h-5 rounded-lg border-2 border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-colors duration-200"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{className:"text-base font-semibold text-gray-900 block mb-1",children:"Has Bankruptcies"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Any bankruptcy filings in business history"})]})]})}),a.jsx("div",{className:"group",children:a.jsxs("label",{className:"flex items-start gap-4 p-5 rounded-2xl border-2 border-gray-200 bg-white hover:border-gray-300 hover:shadow-md transition-all duration-200 cursor-pointer",children:[a.jsx("div",{className:"flex items-center justify-center w-6 h-6 mt-0.5",children:a.jsx("input",{type:"checkbox",checked:!!e,onChange:n=>r(n.target.checked),className:"w-5 h-5 rounded-lg border-2 border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-colors duration-200"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{className:"text-base font-semibold text-gray-900 block mb-1",children:"Has Open Judgments"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Any outstanding legal judgments"})]})]})})]})]}),A$="/.netlify/functions/mtd-webhook",k$=({applicationId:s,businessName:e,ownerName:t,onChooseFiles:r})=>{const n=Yt.useCallback(pe=>{try{const xe=new Date(String(pe||"").replace(/\//g,"-"));return isNaN(xe.getTime())?String(pe||""):xe.toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})}catch{return String(pe||"")}},[]),[i,o]=Yt.useState(!1),[l,c]=Yt.useState(!1),[d,u]=Yt.useState(null),h=Yt.useRef(null),[m,p]=Yt.useState(()=>{const pe=s?`mtd_recent_${s}`:void 0;if(!pe)return[];try{const xe=localStorage.getItem(pe);if(xe){const he=JSON.parse(xe);if(Array.isArray(he))return he}}catch{}return[]}),[x,w]=Yt.useState(null),[S,b]=Yt.useState(()=>new Set);Yt.useEffect(()=>{b(new Set)},[x==null?void 0:x.id]);const[v,N]=Yt.useState(!1),[j,E]=Yt.useState(!1),[A,L]=Yt.useState({open:!1,message:""}),C=Yt.useCallback(pe=>{L({open:!0,message:pe}),window.setTimeout(()=>L({open:!1,message:""}),2e3)},[]),[B,U]=Yt.useState("transactions"),P=async pe=>{if(pe!=null&&pe.id){w({id:pe.id,name:pe.name,loading:!0}),U("transactions");try{const xe=await EE(pe.id);w({id:pe.id,name:pe.name,loading:!1,mtd_summary:xe==null?void 0:xe.mtd_summary,total_amount:(xe==null?void 0:xe.total_amount)??null,available_balance:(xe==null?void 0:xe.available_balance)??null,negative:(xe==null?void 0:xe.negative)??null,funder_mtd:xe==null?void 0:xe.funder_mtd,total_mtd:(xe==null?void 0:xe.total_mtd)??null,mtd_selected:xe==null?void 0:xe.mtd_selected})}catch(xe){console.warn("Failed to load MTD analysis:",xe),w({id:pe.id,name:pe.name,loading:!1})}}},T=()=>w(null),z=async()=>{if(x!=null&&x.id)try{N(!0);const pe=R.reduce((xe,he)=>{const we=`FUNDER_MTD|${String(he.date||"")}|${String(he.description||"")}|${String(he.funder||"")}|${String(he.type||"")}|${Number(he.amount||0)}|${String(he.frequency||"")}|${String(he.notes||"")}`;return xe+(S.has(we)&&Number(he==null?void 0:he.amount)||0)},0);await LE(x.id,pe),w(xe=>xe&&{...xe,total_mtd:pe}),C("Funder MTD selection saved")}finally{N(!1)}},H=Yt.useMemo(()=>{const pe=x==null?void 0:x.mtd_summary;if(!pe)return[];const xe=$e=>{const Qe=typeof $e=="number"?$e:parseFloat(String($e??"").replace(/[^0-9.-]/g,""));return Number.isFinite(Qe)?Qe:0},he=($e,Qe)=>{if($e&&typeof $e=="object")for(const lt of Qe){const At=$e[lt];if(At!=null)return At}},we=($e,Qe,lt)=>{const At=he(lt,["date","Date","transaction_date","posted_at","txn_date"]),Nt=he(lt,["description","Description","memo","details","desc"]),Lt=xe(he(lt,["amount","Amount","value","amt","debit_amount","credit_amount","daily_amount"])),Dt=he(lt,["type","Type","txn_type","transaction_type","debit_credit","status"]),yt=String(Dt??(Lt<0?"DEBIT":"CREDIT")).toUpperCase(),os=xe(he(lt,["balance","Balance","running_balance","current_balance","ending_balance","available_balance"])),me=$e.get(Qe)||[];me.push({date:String(At||""),description:String(Nt||""),type:yt,amount:Lt,balance:Number.isFinite(os)?os:void 0}),$e.set(Qe,me)},Ae=new Map;return pe&&typeof pe=="object"&&!Array.isArray(pe)&&Object.entries(pe).forEach(([$e,Qe])=>{if(Array.isArray(Qe))Qe.forEach(lt=>we(Ae,$e,lt));else if(Qe&&typeof Qe=="object"){const lt=Qe.transactions;Array.isArray(lt)&&lt.forEach(At=>we(Ae,$e,At))}}),Array.isArray(pe)&&pe.forEach($e=>{const Qe=($e==null?void 0:$e.category)||($e==null?void 0:$e.name)||($e==null?void 0:$e.main)||"Transactions",lt=Array.isArray($e==null?void 0:$e.transactions)?$e.transactions:Array.isArray($e)?$e:[];if(Array.isArray(lt)&&lt.length){const At=($e==null?void 0:$e.date)||($e==null?void 0:$e.Date)||"";lt.forEach(Nt=>we(Ae,Qe,{...Nt,date:(Nt==null?void 0:Nt.date)??At}))}else($e!=null&&$e.date||$e!=null&&$e.amount||$e!=null&&$e.description)&&we(Ae,Qe,$e)}),Array.from(Ae.entries()).map(([$e,Qe])=>({category:$e,rows:Qe||[]}))},[x==null?void 0:x.mtd_summary]),D=Yt.useMemo(()=>{const pe=[];return H.forEach(xe=>{xe.rows.forEach(he=>{const we=`${xe.category}|${String(he.date||"")}|${String(he.description||"")}|${String(he.type||"")}|${Number(he.amount||0)}`;pe.push(we)})}),pe},[H]),M=D.length>0&&D.every(pe=>S.has(pe)),$=D.some(pe=>S.has(pe))&&!M,q=Yt.useRef(null);Yt.useEffect(()=>{q.current&&(q.current.indeterminate=$)},[$,M]);const K=Yt.useCallback(()=>{b(pe=>{const xe=new Set(pe);return M?D.forEach(he=>xe.delete(he)):D.forEach(he=>xe.add(he)),xe})},[M,D]),de=Yt.useCallback(()=>{let pe=0;return H.forEach(xe=>{xe.rows.forEach(he=>{const we=`${xe.category}|${String(he.date||"")}|${String(he.description||"")}|${String(he.type||"")}|${Number(he.amount||0)}`;S.has(we)&&(pe+=Number(he==null?void 0:he.amount)||0)})}),pe},[H,S]),Ne=async()=>{if(x!=null&&x.id)try{E(!0);const pe=de();await yE(x.id,pe),w(xe=>xe&&{...xe,total_amount:pe}),C("Transactions selection saved")}finally{E(!1)}},R=Yt.useMemo(()=>{const pe=x==null?void 0:x.funder_mtd,xe=we=>{const Ae=typeof we=="number"?we:parseFloat(String(we??"").replace(/[^0-9.-]/g,""));return Number.isFinite(Ae)?Ae:0},he=[];return Array.isArray(pe)&&pe.forEach(we=>{const Ae=(we==null?void 0:we.date)||(we==null?void 0:we.Date)||"",Ze=(we==null?void 0:we.description)||(we==null?void 0:we.Description)||"";let $e=xe((we==null?void 0:we.amount)??(we==null?void 0:we.Amount));const Qe=String((we==null?void 0:we.status)||(we==null?void 0:we.Type)||($e<0?"DEBIT":"CREDIT")).toUpperCase(),lt=xe((we==null?void 0:we.available_balance)??(we==null?void 0:we.balance)??(we==null?void 0:we.Balance)),At=String((we==null?void 0:we.FUNDER)||(we==null?void 0:we.funder)||(we==null?void 0:we.Funder)||"").trim(),Nt=String((we==null?void 0:we.FREQUENCY)||(we==null?void 0:we.frequency)||(we==null?void 0:we.Frequency)||"").trim(),Lt=String((we==null?void 0:we.NOTES)||(we==null?void 0:we.notes)||(we==null?void 0:we.Notes)||"").trim(),Dt=$e;Nt.toLowerCase()==="weekly"&&($e=$e/5),he.push({date:String(Ae||""),description:String(Ze||""),type:Qe,amount:$e,originalAmount:Dt,balance:Number.isFinite(lt)?lt:void 0,funder:At,frequency:Nt,notes:Lt})}),he},[x==null?void 0:x.funder_mtd]),W=Yt.useCallback(pe=>R.filter(he=>{const we=`FUNDER_MTD|${String(he.date||"")}|${String(he.description||"")}|${String(he.funder||"")}|${String(he.type||"")}|${Number(he.amount||0)}|${String(he.frequency||"")}|${String(he.notes||"")}`;return pe.has(we)}).map(he=>({date:String(he.date||""),type:String(he.type||"").toLowerCase(),FUNDER:String(he.funder||""),amount:Number(he.amount||0).toFixed(2),balance:typeof he.balance=="number"&&isFinite(Number(he.balance))?Number(he.balance).toFixed(2):"NaN",description:String(he.description||""),FREQUENCY:String(he.frequency||""),NOTES:String(he.notes||"")})),[R]);Yt.useEffect(()=>{const pe=x==null?void 0:x.mtd_selected;if(!pe||!Array.isArray(pe)||!R.length)return;const xe=new Set;R.forEach(he=>{if(pe.find(Ae=>{const Ze=Number((Ae==null?void 0:Ae.amount)||0),$e=Number(he.amount||0);return String((Ae==null?void 0:Ae.date)||"")===String(he.date||"")&&String((Ae==null?void 0:Ae.description)||"")===String(he.description||"")&&String((Ae==null?void 0:Ae.FUNDER)||(Ae==null?void 0:Ae.funder)||"")===String(he.funder||"")&&String((Ae==null?void 0:Ae.type)||"").toLowerCase()===String(he.type||"").toLowerCase()&&Math.abs(Ze-$e)<.01&&String((Ae==null?void 0:Ae.FREQUENCY)||(Ae==null?void 0:Ae.frequency)||"")===String(he.frequency||"")&&String((Ae==null?void 0:Ae.NOTES)||(Ae==null?void 0:Ae.notes)||"")===String(he.notes||"")})){const Ae=`FUNDER_MTD|${String(he.date||"")}|${String(he.description||"")}|${String(he.funder||"")}|${String(he.type||"")}|${Number(he.amount||0)}|${String(he.frequency||"")}|${String(he.notes||"")}`;xe.add(Ae)}}),xe.size&&b(xe)},[R,x==null?void 0:x.mtd_selected,x==null?void 0:x.id]);const Z=Yt.useMemo(()=>R.map(pe=>`FUNDER_MTD|${String(pe.date||"")}|${String(pe.description||"")}|${String(pe.funder||"")}|${String(pe.type||"")}|${Number(pe.amount||0)}|${String(pe.frequency||"")}|${String(pe.notes||"")}`),[R]),ue=Z.length>0&&Z.every(pe=>S.has(pe)),ce=Z.some(pe=>S.has(pe))&&!ue,ye=Yt.useRef(null);Yt.useEffect(()=>{ye.current&&(ye.current.indeterminate=ce)},[ce,ue]);const Se=Yt.useCallback(()=>{b(pe=>{const xe=new Set(pe);if(ue?Z.forEach(he=>xe.delete(he)):Z.forEach(he=>xe.add(he)),x!=null&&x.id){const he=W(xe);CN(x.id,he).catch(()=>{})}return xe})},[ue,Z,x==null?void 0:x.id,W]),Ee=Yt.useMemo(()=>s?`mtd_recent_${s}`:void 0,[s]),De=Yt.useMemo(()=>{const pe=x==null?void 0:x.mtd_summary,xe=!!pe&&(Array.isArray(pe)?pe.length>0:Object.keys(pe).length>0),he=typeof(x==null?void 0:x.available_balance)=="number",we=typeof(x==null?void 0:x.negative)=="number",Ae=Array.isArray(x==null?void 0:x.funder_mtd);return xe&&he&&we&&Ae},[x]);Yt.useEffect(()=>{if(Ee)try{localStorage.setItem(Ee,JSON.stringify(m))}catch{}},[Ee,m]),Yt.useEffect(()=>{let pe=!1;return(async()=>{try{if(!s)return;const he=await co(s);if(pe)return;p(he.map(we=>({id:we.id,name:we.file_name,size:Number(we.file_size||0),status:we.upload_status==="failed"?"error":we.upload_status==="completed"?"completed":"processing",url:we.file_url||void 0})))}catch{}})(),()=>{pe=!0}},[s]),Yt.useEffect(()=>{if(s)try{const pe=Ct.channel(`application_mtd-${s}`).on("postgres_changes",{event:"*",schema:"public",table:"application_mtd",filter:`application_id=eq.${s}`},async()=>{try{const xe=await co(s);p(xe.map(he=>({id:he.id,name:he.file_name,size:Number(he.file_size||0),status:he.upload_status==="failed"?"error":he.upload_status==="completed"?"completed":"processing",url:he.file_url||void 0})))}catch{}}).subscribe();return()=>{try{Ct.removeChannel(pe)}catch{}}}catch{return}},[s]);const We=pe=>{pe.preventDefault(),i||o(!0)},Je=pe=>{pe.preventDefault(),o(!1)},it=pe=>{var he;pe.preventDefault(),o(!1);const xe=((he=pe.dataTransfer)==null?void 0:he.files)||null;et(xe)},Be=async(pe,xe)=>{let he;p(we=>{const Ae=we.findIndex($e=>$e.name===pe&&$e.size===xe);return Ae>=0&&(he=we[Ae]),we.filter(($e,Qe)=>Qe!==Ae)});try{const we=he==null?void 0:he.id,{deleteApplicationMTD:Ae,resolveAndDeleteApplicationMTD:Ze}=await nc(async()=>{const{deleteApplicationMTD:$e,resolveAndDeleteApplicationMTD:Qe}=await Promise.resolve().then(()=>aO);return{deleteApplicationMTD:$e,resolveAndDeleteApplicationMTD:Qe}},void 0);if(we)await Ae(we);else if(s){const $e=typeof xe=="number"&&xe>0?xe:void 0;await Ze(s,pe,$e)}if(s)try{const $e=await co(s);p($e.map(Qe=>({id:Qe.id,name:Qe.file_name,size:Number(Qe.file_size||0),status:Qe.upload_status==="failed"?"error":Qe.upload_status==="completed"?"completed":"processing",url:Qe.file_url||void 0})))}catch{}if(he!=null&&he.url)try{const $e=new URL(he.url),Qe="/object/public/",lt=$e.pathname.indexOf(Qe);if(lt!==-1){const At=$e.pathname.substring(lt+Qe.length),Nt=At.indexOf("/"),Lt=At.substring(0,Nt),Dt=At.substring(Nt+1);await Ct.storage.from(Lt).remove([Dt])}}catch{}}catch(we){he&&p(Ae=>[he,...Ae]),console.error("Failed to delete MTD document:",we);try{const Ae=we instanceof Error?we.message:String(we);alert(`Failed to delete MTD document. ${Ae}`)}catch{}}},Te=()=>{h.current&&h.current.click()},oe=pe=>{et(pe)},et=async pe=>{if(!(!pe||pe.length===0)){c(!0),u(null);try{for(const xe of Array.from(pe)){if(xe.type!=="application/pdf"||xe.size>10*1024*1024)continue;p(Qe=>[...Qe,{name:xe.name,size:xe.size,status:"processing"}]);let he;try{const Qe=`mtd/${Date.now()}-${xe.name}`,{error:lt}=await Ct.storage.from("application_documents").upload(Qe,xe,{upsert:!0});if(!lt){const{data:At}=Ct.storage.from("application_documents").getPublicUrl(Qe);he=At==null?void 0:At.publicUrl}}catch{}let we;try{s&&(we=(await mj({application_id:s,file_name:xe.name,file_size:xe.size,file_type:xe.type,statement_date:new Date().toISOString().slice(0,10),file_url:he,upload_status:"processing"})).id)}catch{}if(p(Qe=>Qe.map(lt=>lt.name===xe.name&&lt.size===xe.size?{...lt,status:"completed",id:we,url:he}:lt)),we)try{await kN(we,"completed")}catch{}const Ae=await new Promise((Qe,lt)=>{const At=new FileReader;At.onload=()=>{const Nt=String(At.result||"");Qe(Nt.split(",")[1]||"")},At.onerror=lt,At.readAsDataURL(xe)}),Ze={fileName:xe.name,fileSize:xe.size,fileType:xe.type,fileData:Ae,applicationId:s||"",businessName:e||"",ownerName:t||"",uploadType:"mtd",documentId:we||"",timestamp:new Date().toISOString()},$e=await fetch(A$,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ze)});if(!$e.ok){const Qe=await $e.text().catch(()=>"");throw new Error(`Upload failed (${$e.status}): ${$e.statusText} ${Qe==null?void 0:Qe.slice(0,200)}`)}$e.json().then(Qe=>{console.log("MTD webhook success:",Qe)}).catch(()=>{})}r&&r(pe)}catch(xe){console.error("MTD upload error:",xe),u("Upload failed or server unavailable. Please try again.");try{const he=Array.from(pe||[]).pop();if(he){let we;if(p(Ae=>Ae.map(Ze=>{const $e=Ze.name===he.name&&Ze.size===he.size;return $e&&(we=Ze.id),$e?{...Ze,status:"error"}:Ze})),we)try{await kN(we,"failed")}catch{}}}catch{}}finally{c(!1)}}};return a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"mb-8 bg-white rounded-2xl p-6 border border-slate-200 shadow-sm",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl shadow-lg",children:a.jsx("svg",{className:"w-6 h-6 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3v10l-3.5-2M21 21H3m9-4a8 8 0 100-16 8 8 0 000 16z"})})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-slate-800",children:"Month-To-Date (MTD)"}),a.jsx("p",{className:"text-slate-600",children:"Real-time MTD insights and actions"})]})]}),a.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:[a.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"}),"System Ready"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl border border-slate-200 bg-slate-50",children:[a.jsx("div",{className:"p-2 rounded-lg bg-emerald-100 text-emerald-700",children:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12h18M3 6h18M3 18h18"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-800",children:"Live Metrics"}),a.jsx("p",{className:"text-xs text-slate-600",children:"Deposits, expenses, net MTD"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl border border-slate-200 bg-slate-50",children:[a.jsx("div",{className:"p-2 rounded-lg bg-indigo-100 text-indigo-700",children:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-800",children:"Fast Processing"}),a.jsx("p",{className:"text-xs text-slate-600",children:"AI-powered analysis"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl border border-slate-200 bg-slate-50",children:[a.jsx("div",{className:"p-2 rounded-lg bg-fuchsia-100 text-fuchsia-700",children:a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 12h2m-1-9a9 9 0 100 18 9 9 0 000-18zm0 13a4 4 0 110-8 4 4 0 010 8z"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-slate-800",children:"Smart Insights"}),a.jsx("p",{className:"text-xs text-slate-600",children:"Trends and quick stats"})]})]})]})]}),m.length>0&&a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6 p-4 bg-gradient-to-r from-white to-slate-50 rounded-xl border border-slate-200 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg shadow-sm",children:a.jsx(Is,{className:"w-4 h-4 text-white"})}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-bold text-slate-800",children:[m.length," ",m.length===1?"Document":"Documents"," Uploaded"]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Ready for processing and analysis"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-emerald-50 rounded-lg border border-emerald-200",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full"}),a.jsx("span",{className:"text-sm font-medium text-emerald-700",children:"All Systems Active"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-4 px-6 py-3 bg-slate-50 border-b border-slate-200 text-xs font-semibold text-slate-700 uppercase tracking-wide",children:[a.jsx("div",{className:"col-span-6",children:"Document"}),a.jsx("div",{className:"col-span-3",children:"Status"}),a.jsx("div",{className:"col-span-2",children:"Size"}),a.jsx("div",{className:"col-span-1 text-right",children:"Actions"})]}),a.jsx("div",{children:m.map(pe=>a.jsxs("div",{className:"grid grid-cols-12 gap-4 px-6 py-4 border-b border-slate-100 last:border-b-0 items-center",children:[a.jsx("div",{className:"col-span-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl shadow-sm border bg-gradient-to-br from-emerald-100 to-green-100 border-emerald-200",children:a.jsx(Is,{className:"w-6 h-6 text-emerald-700"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate max-w-[460px]",title:pe.name,children:pe.name}),a.jsx("div",{className:"text-xs text-slate-500",children:"PDF Document"}),a.jsx("div",{className:"mt-1 flex items-center gap-3",children:a.jsxs("a",{href:pe.url||"#",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-xs font-medium text-blue-700 hover:text-blue-800",children:[a.jsxs("svg",{className:"w-3.5 h-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7-11-7-11-7z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"View Document"]})})]})]})}),a.jsxs("div",{className:"col-span-3",children:[pe.status==="processing"&&a.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-bold bg-blue-50 text-blue-800 border border-blue-200",children:[a.jsx("span",{className:"w-3 h-3 mr-1 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),"Processing"]}),pe.status==="completed"&&a.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-bold bg-emerald-50 text-emerald-800 border border-emerald-200",children:[a.jsx(_s,{className:"w-3 h-3 mr-1"}),"Completed"]}),pe.status==="error"&&a.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-bold bg-rose-50 text-rose-800 border border-rose-200",children:[a.jsx("span",{className:"w-3 h-3 mr-1",children:"⚠"}),"Error"]})]}),a.jsx("div",{className:"col-span-2",children:a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-semibold bg-slate-100 text-slate-700",children:[a.jsx("svg",{className:"w-3 h-3 text-slate-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(pe.size/1024/1024).toFixed(1)," MB"]})}),a.jsxs("div",{className:"col-span-1 flex justify-end gap-3 text-slate-500",children:[a.jsx("button",{className:"p-2 rounded-lg hover:bg-slate-100",title:"View details",onClick:()=>P({id:pe.id,name:pe.name}),children:a.jsx(Is,{className:"w-4 h-4"})}),a.jsx("button",{className:"p-2 rounded-lg hover:bg-slate-100",title:"Refresh",children:a.jsx(MC,{className:"w-4 h-4"})}),a.jsx("button",{className:"p-2 rounded-lg hover:bg-slate-100",title:"Delete",onClick:()=>Be(pe.name,pe.size),children:a.jsx(vp,{className:"w-4 h-4"})})]})]},`${pe.name}-${pe.size}`))})]})]}),a.jsx("div",{className:`relative p-10 border-2 border-dashed rounded-3xl text-center transition-all duration-300 ${i?"border-blue-400 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-xl scale-[1.01]":"border-blue-300/60 bg-gradient-to-br from-white via-slate-50 to-blue-50/30 hover:border-blue-400 hover:bg-blue-50/40"}`,onDragOver:We,onDragLeave:Je,onDrop:it,children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"p-4 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-2xl w-fit mx-auto mb-6 shadow-sm",children:a.jsx("svg",{className:"w-8 h-8 text-blue-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h10a4 4 0 004-4m-7-4l-3-3m0 0l-3 3m3-3v12"})})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Upload Bank Statements"}),a.jsx("p",{className:"text-sm text-gray-600 mb-8 max-w-md mx-auto leading-relaxed",children:"Drag & drop PDF files here or click to browse."}),a.jsx("button",{type:"button",onClick:Te,disabled:l,className:`inline-flex items-center gap-3 px-8 py-4 rounded-2xl font-bold transition-all duration-200 shadow-md focus:outline-none focus:ring-4 focus:ring-blue-500/40 ${l?"bg-gray-400 text-white cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 hover:shadow-lg hover:scale-[1.02]"}`,children:l?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Uploading..."]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h10a4 4 0 004-4m-7-4l-3-3m0 0l-3 3m3-3v12"})}),"Choose Files"]})}),a.jsx("input",{ref:h,type:"file",className:"sr-only",accept:".pdf",multiple:!0,onChange:pe=>oe(pe.target.files)}),a.jsx("p",{className:"text-xs text-gray-500 mt-4 font-medium",children:"PDF files only, max 10MB each"}),d&&a.jsx("p",{className:"text-xs mt-3 font-semibold text-rose-600",children:d})]})}),x&&a.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm",children:[a.jsx("div",{className:"absolute inset-0",onClick:T,"aria-hidden":!0}),a.jsxs("div",{role:"dialog","aria-modal":"true",className:"relative bg-white rounded-3xl shadow-2xl border border-slate-200/60 w-full max-w-5xl overflow-hidden",children:[a.jsx("div",{className:"px-8 py-6 bg-gradient-to-r from-slate-50 via-white to-blue-50/30 border-b border-slate-200/60",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg",children:a.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"Bank Statement Analysis"}),a.jsx("p",{className:"text-sm text-slate-600",children:"Transaction Categories & Details"}),a.jsx("div",{className:"text-xs text-slate-500 mt-1 truncate max-w-[48ch]",children:x.name})]})]}),a.jsx("button",{onClick:T,className:"px-3 py-1.5 rounded-lg text-sm font-semibold text-slate-700 hover:bg-slate-100 border border-slate-200",children:"Close"})]})}),a.jsx("div",{className:"p-8 space-y-6 max-h-[75vh] overflow-y-auto",children:x.loading?a.jsxs("div",{className:"p-6 border border-amber-200 bg-amber-50 rounded-xl text-amber-800 flex items-center gap-3",children:[a.jsx("div",{className:"w-5 h-5 border-2 border-amber-600 border-t-transparent rounded-full animate-spin"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:"Preparing Bank Statement Analysis"}),a.jsx("p",{className:"text-sm",children:"Please wait while we load the Month-To-Date analysis."})]})]}):De?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 border-2 border-emerald-200 rounded-xl p-6",children:[a.jsx("div",{className:"text-emerald-700 text-sm font-semibold",children:"Total Amount"}),a.jsx("div",{className:"text-2xl font-bold text-emerald-900 mt-1",children:typeof(x==null?void 0:x.total_amount)=="number"?`$${x.total_amount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:"—"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-teal-50 border-2 border-cyan-200 rounded-xl p-6",children:[a.jsx("div",{className:"text-cyan-700 text-sm font-semibold",children:"Available Balance"}),a.jsx("div",{className:"text-2xl font-bold text-cyan-900 mt-1",children:typeof(x==null?void 0:x.available_balance)=="number"?x.available_balance.toLocaleString("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}):"—"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-rose-50 to-red-50 border-2 border-rose-200 rounded-xl p-6",children:[a.jsx("div",{className:"text-rose-700 text-sm font-semibold",children:"Negative Count"}),a.jsx("div",{className:"text-2xl font-bold text-rose-900 mt-1",children:typeof(x==null?void 0:x.negative)=="number"?x.negative.toLocaleString("en-US"):"—"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-violet-50 to-fuchsia-50 border-2 border-violet-200 rounded-xl p-6",children:[a.jsx("div",{className:"text-violet-700 text-sm font-semibold",children:"Funder MTD"}),a.jsx("div",{className:"text-2xl font-bold text-violet-900 mt-1",children:typeof(x==null?void 0:x.total_mtd)=="number"?x.total_mtd.toLocaleString("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}):"—"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{type:"button",onClick:()=>U("transactions"),className:`px-4 py-2 rounded-lg text-sm font-semibold border transition ${B==="transactions"?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,children:"Transactions"}),a.jsx("button",{type:"button",onClick:()=>U("funder"),className:`px-4 py-2 rounded-lg text-sm font-semibold border transition ${B==="funder"?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,children:"Funder MTD"})]}),B==="transactions"&&a.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden",children:H.length===0?a.jsx("div",{className:"p-10 text-center text-slate-500 text-sm",children:"No transaction data available"}):a.jsx("div",{className:"p-0",children:H.map((pe,xe)=>a.jsxs("div",{className:"mb-6 last:mb-0",children:[a.jsxs("div",{className:"px-6 py-3 bg-blue-600 text-white font-bold uppercase tracking-wide flex items-center gap-3",children:[a.jsx("span",{className:"w-2 h-2 rounded-full bg-white/90"}),String(pe.category||"Category").toUpperCase()]}),a.jsxs("div",{className:"px-4 py-2 bg-slate-50 border-b border-slate-200 grid grid-cols-12 gap-x-3 text-[10px] font-semibold text-slate-600 uppercase tracking-wider",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("input",{ref:q,type:"checkbox",checked:M,onChange:K,className:"w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer",title:"Select all transactions"}),a.jsx("span",{children:"Select"})]})}),a.jsx("div",{className:"col-span-1",children:"Date"}),a.jsx("div",{className:"col-span-5",children:"Description"}),a.jsx("div",{className:"col-span-1",children:"Type"}),a.jsx("div",{className:"col-span-2 text-center",children:"Amount"}),a.jsx("div",{className:"col-span-2 text-right",children:"Balance"})]}),a.jsx("div",{className:"",children:pe.rows.length===0?a.jsx("div",{className:"px-6 py-6 text-sm text-slate-500",children:"No transactions"}):(()=>{const he=new Map;return pe.rows.forEach(we=>{const Ae=n(we.date),Ze=he.get(Ae)||[];Ze.push(we),he.set(Ae,Ze)}),Array.from(he.entries()).map(([we,Ae],Ze)=>a.jsx("div",{className:"px-4",children:Ae.map(($e,Qe)=>{const lt=`${pe.category}|${String($e.date||"")}|${String($e.description||"")}|${String($e.type||"")}|${Number($e.amount||0)}`,At=S.has(lt),Nt=`${Qe>0?"border-t border-dotted border-slate-300 pt-3":""}`;return a.jsxs("div",{className:"py-3 grid grid-cols-12 items-start gap-x-3",children:[a.jsx("div",{className:`col-span-1 ${Nt}`,children:a.jsx("input",{type:"checkbox",checked:At,onChange:()=>{b(Lt=>{const Dt=new Set(Lt);return Dt.has(lt)?Dt.delete(lt):Dt.add(lt),Dt})},className:"w-4 h-4 cursor-pointer accent-blue-600"})}),Qe===0?a.jsx("div",{className:"col-span-1 text-slate-700 text-xs font-semibold",children:we}):a.jsx("div",{className:"col-span-1"}),a.jsx("div",{className:`col-span-5 text-slate-700 text-xs leading-relaxed pr-2 whitespace-pre-wrap break-words ${Nt}`,children:$e.description||"—"}),a.jsx("div",{className:`col-span-1 text-slate-700 text-xs font-semibold tracking-wide whitespace-pre-wrap break-words ${Nt}`,children:String($e.type||"").toUpperCase()||"—"}),a.jsx("div",{className:`col-span-2 text-center font-bold text-slate-900 tabular-nums font-mono text-[12px] whitespace-nowrap ${Nt}`,children:ps(Number($e.amount||0))}),a.jsx("div",{className:`col-span-2 text-right font-semibold text-slate-900 tabular-nums font-mono text-[12px] whitespace-nowrap ${Nt}`,children:typeof $e.balance=="number"?ps(Number($e.balance)):$e.balance?String($e.balance):"—"})]},Qe)})},`${we}-${Ze}`))})()}),(()=>{const he=pe.rows.reduce((we,Ae)=>{const Ze=`${pe.category}|${String(Ae.date||"")}|${String(Ae.description||"")}|${String(Ae.type||"")}|${Number(Ae.amount||0)}`;return we+(S.has(Ze)&&Number(Ae==null?void 0:Ae.amount)||0)},0);return a.jsxs("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 grid grid-cols-12 gap-x-6 items-center",children:[a.jsx("div",{className:"col-span-8 text-slate-600 font-semibold uppercase text-xs",children:"Total"}),a.jsx("div",{className:"col-span-2 text-center text-slate-900 font-black",children:ps(he)}),a.jsx("div",{className:"col-span-2 flex justify-end",children:a.jsx("button",{type:"button",onClick:Ne,disabled:j,className:`px-3 py-1.5 rounded-lg text-xs font-bold border transition ${j?"bg-slate-200 text-slate-500 border-slate-300 cursor-not-allowed":"bg-blue-600 text-white border-blue-600 hover:bg-blue-700"}`,children:j?"Saving…":"Save Selection"})})]})})()]},`${pe.category}-${xe}`))})}),B==="funder"&&a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden",children:[a.jsxs("div",{className:"px-6 py-3 bg-blue-600 text-white font-bold uppercase tracking-wide flex items-center gap-3",children:[a.jsx("span",{className:"w-2 h-2 rounded-full bg-white/90"}),"FUNDER MTD"]}),a.jsxs("div",{className:"px-4 py-2 bg-slate-50 border-b border-slate-200 grid grid-cols-12 gap-x-3 text-[10px] font-semibold text-slate-600 uppercase tracking-wider",children:[a.jsx("div",{className:"col-span-1",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("input",{ref:ye,type:"checkbox",checked:ue,onChange:Se,className:"w-4 h-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer",title:"Select all funder rows"}),a.jsx("span",{children:"Select"})]})}),a.jsx("div",{className:"col-span-1",children:"Date"}),a.jsx("div",{className:"col-span-2",children:"Description"}),a.jsx("div",{className:"col-span-2",children:"Funder"}),a.jsx("div",{className:"col-span-1",children:"Type"}),a.jsx("div",{className:"col-span-1",children:"Frequency"}),a.jsx("div",{className:"col-span-2",children:"Notes"}),a.jsx("div",{className:"col-span-1 text-center",children:"Amount"}),a.jsx("div",{className:"col-span-1 text-right",children:"Balance"})]}),R.length===0?a.jsx("div",{className:"p-10 text-center text-slate-500 text-sm",children:"No Funder MTD entries"}):(()=>{const pe=new Map;return R.forEach(xe=>{const he=j1(xe.date||""),we=pe.get(he)||[];we.push(xe),pe.set(he,we)}),a.jsx("div",{className:"",children:Array.from(pe.entries()).map(([xe,he],we)=>a.jsx("div",{className:"px-4",children:he.map((Ae,Ze)=>{var At;const $e=`FUNDER_MTD|${String(Ae.date||"")}|${String(Ae.description||"")}|${String(Ae.funder||"")}|${String(Ae.type||"")}|${Number(Ae.amount||0)}|${String(Ae.frequency||"")}|${String(Ae.notes||"")}`,Qe=S.has($e),lt=`${Ze>0?"border-t border-dotted border-slate-300 pt-3":""}`;return a.jsxs("div",{className:"py-3 grid grid-cols-12 items-start gap-x-3",children:[a.jsx("div",{className:`col-span-1 ${lt}`,children:a.jsx("input",{type:"checkbox",checked:Qe,onChange:()=>{b(Nt=>{const Lt=new Set(Nt);if(Lt.has($e)?Lt.delete($e):Lt.add($e),x!=null&&x.id){const Dt=W(Lt);CN(x.id,Dt).catch(()=>{})}return Lt})},className:"w-4 h-4 cursor-pointer accent-blue-600"})}),Ze===0?a.jsx("div",{className:"col-span-1 text-slate-700 text-xs font-semibold",children:xe}):a.jsx("div",{className:"col-span-1"}),a.jsx("div",{className:`col-span-2 text-slate-700 text-xs leading-relaxed pr-2 whitespace-pre-wrap break-words ${lt}`,children:Ae.description||"—"}),a.jsx("div",{className:`col-span-2 text-slate-700 text-xs font-semibold tracking-wide whitespace-pre-wrap break-words ${lt}`,children:Ae.funder||"—"}),a.jsx("div",{className:`col-span-1 text-slate-700 text-xs font-semibold tracking-wide whitespace-pre-wrap break-words ${lt}`,children:String(Ae.type||"").toUpperCase()||"—"}),a.jsx("div",{className:`col-span-1 text-slate-700 text-xs font-semibold tracking-wide whitespace-pre-wrap break-words ${lt}`,children:Ae.frequency||"—"}),a.jsx("div",{className:`col-span-2 text-slate-700 text-xs leading-relaxed pr-2 whitespace-pre-wrap break-words ${lt}`,children:Ae.notes||"—"}),a.jsx("div",{className:`col-span-1 text-center font-bold text-slate-900 tabular-nums font-mono text-[12px] whitespace-nowrap ${lt}`,children:((At=Ae.frequency)==null?void 0:At.toLowerCase())==="weekly"?a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[10px] text-slate-500",children:ps(Number(Ae.originalAmount||0))}),a.jsx("span",{className:"text-[10px]",children:"="}),a.jsx("span",{children:ps(Number(Ae.amount||0))})]}):ps(Number(Ae.amount||0))}),a.jsx("div",{className:`col-span-1 text-right font-semibold text-slate-900 tabular-nums font-mono text-[12px] whitespace-nowrap ${lt}`,children:typeof Ae.balance=="number"?ps(Number(Ae.balance)):Ae.balance?String(Ae.balance):"—"})]},Ze)})},`${xe}-${we}`))})})(),(()=>{const pe=R.reduce((xe,he)=>{const we=`FUNDER_MTD|${String(he.date||"")}|${String(he.description||"")}|${String(he.funder||"")}|${String(he.type||"")}|${Number(he.amount||0)}|${String(he.frequency||"")}|${String(he.notes||"")}`;return xe+(S.has(we)&&Number(he==null?void 0:he.amount)||0)},0);return a.jsxs("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 grid grid-cols-12 gap-x-6 items-center",children:[a.jsx("div",{className:"col-span-8 text-slate-600 font-semibold uppercase text-xs",children:"Total"}),a.jsx("div",{className:"col-span-2 text-center text-slate-900 font-black",children:ps(pe)}),a.jsx("div",{className:"col-span-2 flex justify-end",children:a.jsx("button",{type:"button",onClick:z,disabled:v,className:`px-3 py-1.5 rounded-lg text-xs font-bold border transition ${v?"bg-slate-200 text-slate-500 border-slate-300 cursor-not-allowed":"bg-blue-600 text-white border-blue-600 hover:bg-blue-700"}`,children:v?"Saving…":"Save Selection"})})]})})()]})]}):a.jsxs("div",{className:"p-6 border border-amber-200 bg-amber-50 rounded-xl text-amber-800 flex items-center gap-3",children:[a.jsx("div",{className:"w-5 h-5 border-2 border-amber-600 border-t-transparent rounded-full animate-spin"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:"Preparing MTD Metrics"}),a.jsx("p",{className:"text-sm",children:"Waiting for summary, available balance, negative count, and funder MTD to be available…"})]})]})}),A.open&&a.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-20 flex justify-center",children:a.jsxs("div",{className:"pointer-events-auto inline-flex items-center gap-2 px-4 py-2 rounded-xl shadow-lg border border-emerald-200 bg-white text-emerald-700 text-sm font-semibold",children:[a.jsx(_s,{className:"w-4 h-4"}),a.jsx("span",{children:A.message})]})}),a.jsxs("div",{className:"px-8 py-6 bg-slate-50 border-t border-slate-200 flex justify-between items-center",children:[a.jsx("div",{className:"text-xs font-semibold text-slate-600 uppercase tracking-widest",children:"BANK STATEMENT ANALYSIS • CONFIDENTIAL"}),a.jsx("button",{onClick:T,className:"px-6 py-2.5 rounded-xl text-sm font-bold bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 shadow-lg",children:"Close Analysis"})]})]})]})]})},$y="/.netlify/functions/new-deal",C$="/.netlify/functions/updating-applications",E$="/.netlify/functions/document-file",L$=!1,P$=({onContinue:s,onBack:e,initial:t,loading:r})=>{const[n,i]=ne.useState({id:(t==null?void 0:t.id)||"",applicationId:(t==null?void 0:t.applicationId)||"",hasBankruptcies:!!(t!=null&&t.hasBankruptcies)||!1,hasOpenJudgments:!!(t!=null&&t.hasOpenJudgments)||!1,creditScore:(t==null?void 0:t.creditScore)||"",requestedAmount:(t==null?void 0:t.requestedAmount)||""});ne.useEffect(()=>{t&&(console.log("[SubmissionIntermediate] received initial:",t),i(Y=>({...Y,id:t.id??Y.id??"",applicationId:t.applicationId??Y.applicationId??"",hasBankruptcies:typeof t.hasBankruptcies=="boolean"?t.hasBankruptcies:!!Y.hasBankruptcies,hasOpenJudgments:typeof t.hasOpenJudgments=="boolean"?t.hasOpenJudgments:!!Y.hasOpenJudgments,creditScore:t.creditScore??Y.creditScore??"",requestedAmount:t.requestedAmount??Y.requestedAmount??""})))},[t]);const o=async Y=>{try{K(!0);const ie=await Jo(Y);$(ie||[])}finally{K(!1)}},l=async()=>{try{E(!0);const Y=new es("p","pt","a4"),ie=Y.internal.pageSize.getWidth(),je=Y.internal.pageSize.getHeight(),se=50;let le=60;const Ue=n.applicationId||(t==null?void 0:t.applicationId)||n.id||(t==null?void 0:t.id)||"";Y.setTextColor(25,25,25),Y.setFont("times","bold"),Y.setFontSize(22),Y.text("FINANCIAL ANALYSIS REPORT",se,45),Y.setDrawColor(25,25,25),Y.setLineWidth(2.5),Y.line(se,52,se+280,52),Y.setLineWidth(.8),Y.line(se,55,se+280,55),Y.setFont("times","italic"),Y.setFontSize(11),Y.setTextColor(60,60,60);const Ie=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),He=Y.getTextWidth(Ie);Y.text(Ie,ie-se-He,45),le=75;const Me=Array.isArray(M)?M.length:0,st=Array.isArray(Ce)?Ce:[],ut=st.reduce((ot,gt)=>ot+(Number(gt.total_deposits)||0),0),wt=st.reduce((ot,gt)=>ot+(Number(gt.monthly_revenue)||0),0),xt=st.reduce((ot,gt)=>ot+(Number(gt.negative_days)||0),0),X=Math.max(1,st.length),Ke=ut/X,Oe=wt/X;if(Y.setTextColor(0,0,0),st.length>0){Y.setFillColor(245,247,250),Y.rect(se-8,le-10,ie-2*se+16,24,"F"),Y.setDrawColor(180,190,200),Y.setLineWidth(.5),Y.rect(se-8,le-10,ie-2*se+16,24,"S"),Y.setTextColor(30,40,50),Y.setFont("times","bold"),Y.setFontSize(14),Y.text("FINANCIAL OVERVIEW",se,le+6),le+=28;const ot=st.slice().sort((gt,Fe)=>Date.parse(String(gt.month||"")+"-01")-Date.parse(String(Fe.month||"")+"-01")).map(gt=>[gt.month||"Unknown Period",ps(Number(gt.total_deposits)||0),ps(Number(gt.monthly_revenue)||0),String(Number(gt.negative_days)||0),(gt.file_name||"Document").replace(/\.[^/.]+$/,"")]);Oy(Y,{startY:le,styles:{font:"times",fontSize:10,cellPadding:10,lineColor:[200,210,220],lineWidth:.8,textColor:[30,30,30]},headStyles:{fillColor:[52,73,94],textColor:[255,255,255],fontSize:11,fontStyle:"bold",halign:"center",font:"times",cellPadding:12},alternateRowStyles:{fillColor:[252,253,254]},bodyStyles:{lineColor:[220,230,240],lineWidth:.5},theme:"striped",head:[["Period","Total Deposits","Net Revenue","Negative Days","Source Document"]],body:ot,columnStyles:{0:{halign:"center",fontStyle:"bold",fontSize:10,font:"times",fillColor:[250,251,252]},1:{halign:"right",fontSize:10,fontStyle:"bold",font:"times",textColor:[22,101,52]},2:{halign:"right",fontSize:10,fontStyle:"bold",font:"times",textColor:[22,101,52]},3:{halign:"center",fontSize:10,font:"times"},4:{halign:"left",fontSize:9,textColor:[75,85,99],font:"times",fontStyle:"italic"}},tableWidth:"auto",margin:{left:se,right:se}});{const gt=Y.lastAutoTable;gt&&typeof gt.finalY=="number"&&(le=gt.finalY+15)}}if(Array.isArray(de)&&de.length>0&&(Y.setFillColor(245,247,250),Y.rect(se-8,le-10,ie-2*se+16,24,"F"),Y.setDrawColor(180,190,200),Y.setLineWidth(.5),Y.rect(se-8,le-10,ie-2*se+16,24,"S"),Y.setTextColor(30,40,50),Y.setFont("times","bold"),Y.setFontSize(14),Y.text("Funder MTD Totals (Selected Rows)",se,le+6),le+=28,de.forEach(gt=>{const Fe=(()=>{const It=gt==null?void 0:gt.total_mtd,fs=typeof It=="number"?It:Xn(String(It??""));return Number.isFinite(fs)?Number(fs):0})(),ns=Array.isArray(gt==null?void 0:gt.mtd_selected)?gt==null?void 0:gt.mtd_selected:[],Gt=`${ns.length||0} SELECTED ROW${(ns.length||0)===1?"":"S"}`;Y.setFont("times","bold"),Y.setFontSize(10),Y.setTextColor(71,85,105),Y.text(Gt,se,le);const mt=`Transactions Total Deposits for MTD  ${ps(Fe)}`;Y.setFont("times","italic"),Y.setFontSize(10),Y.setTextColor(71,85,105);const Jt=Y.getTextWidth(mt);Y.text(mt,ie-se-Jt,le),le+=10;const ds=[];let ts=0;if(ns.forEach(It=>{const fs=It!=null&&It.date?String(It.date):"—",Zs=It!=null&&It.description?String(It.description):"—",Pa=(It==null?void 0:It.FUNDER)??(It==null?void 0:It.funder)?String((It==null?void 0:It.FUNDER)??(It==null?void 0:It.funder)):"—",lc=It!=null&&It.type?String(It.type).toUpperCase():"—",Ei=It==null?void 0:It.amount,na=typeof Ei=="number"?Ei:Xn(String(Ei??""));Number.isFinite(na)&&(ts+=Number(na)),ds.push([fs,Zs,Pa,lc,Number.isFinite(na)?ps(Number(na)):Ei==null?"—":String(Ei)])}),ds.length===0&&Fe>0&&(ds.push(["—","—","—","—",ps(Fe)]),ts=Fe),ds.length>0){Oy(Y,{startY:le+4,styles:{font:"times",fontSize:10,cellPadding:8,lineColor:[200,210,220],lineWidth:.6,textColor:[30,30,30]},headStyles:{fillColor:[37,99,235],textColor:[255,255,255],fontSize:11,fontStyle:"bold",halign:"center",font:"times",cellPadding:10},bodyStyles:{lineColor:[220,230,240],lineWidth:.5},theme:"striped",head:[["Date","Description","Funder","Type","Amount"]],body:ds,columnStyles:{0:{halign:"center",fontSize:10,font:"times"},1:{halign:"left",fontSize:10,font:"times"},2:{halign:"center",fontSize:10,font:"times"},3:{halign:"center",fontSize:10,font:"times"},4:{halign:"right",fontStyle:"bold",fontSize:10,textColor:[22,101,52],font:"times"}},tableWidth:"auto",margin:{left:se,right:se}});{const Zs=Y.lastAutoTable;Zs&&typeof Zs.finalY=="number"&&(le=Zs.finalY+6)}Y.setFont("times","bold"),Y.setFontSize(12),Y.setTextColor(20,83,45);const It=`TOTAL  ${ps(ts)}`,fs=Y.getTextWidth(It);Y.text(It,ie-se-fs,le+6),le+=18}else le+=6})),Array.isArray(dt)&&dt.length>0){Y.setFillColor(245,247,250),Y.rect(se-8,le-10,ie-2*se+16,24,"F"),Y.setDrawColor(180,190,200),Y.setLineWidth(.5),Y.rect(se-8,le-10,ie-2*se+16,24,"S"),Y.setTextColor(30,40,50),Y.setFont("times","bold"),Y.setFontSize(14),Y.text("Funders Analysis",se,le+6),le+=28;const ot=[];if((dt||[]).forEach((gt,Fe)=>{if(!he.has(Fe))return;const ns=String((gt==null?void 0:gt.period)||""),Gt=String((gt==null?void 0:gt.funder)||""),mt=String(gt!=null&&gt.isWeekly?"WEEKLY = DAILY":(gt==null?void 0:gt.freq)||""),Jt=Number(gt==null?void 0:gt.amountNum),ds=Number(gt==null?void 0:gt.displayAmount),ts=String((gt==null?void 0:gt.notes)||"");if(gt!=null&&gt.isWeekly){const It=Number.isFinite(Jt)?ps(Jt):"—",fs=Number.isFinite(ds)?ps(ds):"—";ot.push([ns||"—",Gt||"—","WEEKLY = DAILY",It,fs,ts||"—"])}else{const It=Number.isFinite(ds)?ps(ds):"—";ot.push([ns||"—",Gt||"—",mt||"—","—",It,ts||"—"])}}),ot.length>0){const Fe=ot.slice(0,10);Oy(Y,{startY:le,styles:{font:"times",fontSize:10,cellPadding:10,lineColor:[200,210,220],lineWidth:.8,textColor:[30,30,30]},headStyles:{fillColor:[52,73,94],textColor:[255,255,255],fontSize:11,fontStyle:"bold",halign:"center",font:"times",cellPadding:12},alternateRowStyles:{fillColor:[252,253,254]},bodyStyles:{lineColor:[220,230,240],lineWidth:.5},theme:"striped",head:[["Period","Funding Source","Frequency","Original Amount","Daily Amount","Notes"]],body:Fe,columnStyles:{0:{halign:"center",fontStyle:"bold",fontSize:10,font:"times",fillColor:[250,251,252]},1:{halign:"left",fontSize:10,font:"times",fontStyle:"bold",fillColor:[248,250,252]},2:{halign:"center",fontSize:10,font:"times"},3:{halign:"right",fontStyle:"bold",fontSize:10,textColor:[120,120,120],font:"times"},4:{halign:"right",fontStyle:"bold",fontSize:10,textColor:[22,101,52],font:"times"},5:{halign:"left",fontSize:9,textColor:[75,85,99],font:"times",fontStyle:"italic"}},tableWidth:"auto",margin:{left:se,right:se}});{const ns=Y.lastAutoTable;ns&&typeof ns.finalY=="number"&&(le=ns.finalY+15)}ot.length>10&&(Y.setFont("helvetica","italic"),Y.setFontSize(9),Y.setTextColor(100,116,139),Y.text(`Showing 10 of ${ot.length} transactions. Additional data available in application.`,se,le),le+=20)}}if(st.length>0||Array.isArray(O)&&O.length>0){Y.setFillColor(245,247,250),Y.rect(se-8,le-10,ie-2*se+16,24,"F"),Y.setDrawColor(180,190,200),Y.setLineWidth(.5),Y.rect(se-8,le-10,ie-2*se+16,24,"S"),Y.setTextColor(30,40,50),Y.setFont("times","bold"),Y.setFontSize(14),Y.text("MCA SUMMARY",se,le+6),le+=28;const ot=dt.reduce((ts,It,fs)=>{if(!he.has(fs))return ts;const Zs=Number(It==null?void 0:It.displayAmount);return ts+(Number.isFinite(Zs)?Zs:0)},0),gt=(de||[]).reduce((ts,It)=>ts+(Number(It==null?void 0:It.total_mtd)||0),0),Fe=20,Gt=(ot+gt)*Fe,mt=Oe>0?Gt/Oe:0,Jt=(()=>{const It=mt*100,fs=Math.pow(10,1),Zs=It*fs,Pa=Math.floor(Zs),lc=Zs-Pa,Ei=Math.abs(lc-.5)<1e-10;let na;return Ei?na=Pa%2===0?Pa:Pa+1:na=Math.round(Zs),na/fs})(),ds=[];Me>0&&(ds.push(["Documents Uploaded",String(Me)]),Ke>0&&ds.push(["Total Average Deposits",ps(Ke)]),Oe>0&&ds.push(["Total Revenue (Average)",ps(Oe)]),xt>0&&ds.push(["Total Negative Days",String(xt)]),ds.push(["",""])),(ot>0||gt>0)&&(ds.push(["RISK ASSESSMENT",""]),ds.push(["Total Amount of Funders",ps(ot)]),gt>0&&ds.push(["Funder MTD Totals",ps(gt)]),ds.push(["Calculation Multiplier",`× ${Fe}`]),ds.push(["SUBTOTAL",ps(Gt)]),mt>0&&ds.push(["Ratio (Total ÷ Revenue)",mt.toFixed(2)]),ds.push(["",""]),ds.push(["RECOMMENDATION",""]),ds.push(["Holdback Rate",`${Jt.toFixed(1)}%`])),ds.length>0&&Oy(Y,{startY:le,styles:{font:"times",fontSize:10,cellPadding:10,lineColor:[200,210,220],lineWidth:.8,textColor:[30,30,30]},headStyles:{fillColor:[52,73,94],textColor:[255,255,255],fontSize:11,fontStyle:"bold",halign:"center",font:"times",cellPadding:12},alternateRowStyles:{fillColor:[252,253,254]},bodyStyles:{lineColor:[220,230,240],lineWidth:.5},theme:"striped",head:[["Analysis Category","Value"]],body:ds,columnStyles:{0:{halign:"left",fontStyle:"bold",fontSize:10,font:"times",fillColor:[250,251,252]},1:{halign:"right",fontSize:10,fontStyle:"bold",font:"times"}},tableWidth:"auto",margin:{left:se,right:se},didParseCell:ts=>{const It=ts,fs=It.row.index,Zs=ds[fs];Zs&&(Zs[0]==="DOCUMENT ANALYSIS"||Zs[0]==="RISK ASSESSMENT"||Zs[0]==="RECOMMENDATION")&&(It.cell.styles.fillColor=[52,73,94],It.cell.styles.textColor=[255,255,255],It.cell.styles.fontSize=10,It.cell.styles.fontStyle="bold"),Zs&&Zs[0]==="Holdback Rate"&&It.column.index===1&&(It.cell.styles.textColor=[20,83,45],It.cell.styles.fontSize=12,It.cell.styles.fontStyle="bold",It.cell.styles.font="times")}})}const Xe=ot=>{Y.setFillColor(248,250,252),Y.rect(0,je-25,ie,25,"F"),Y.setDrawColor(226,232,240),Y.setLineWidth(1),Y.line(0,je-25,ie,je-25),Y.setTextColor(51,65,85),Y.setFont("helvetica","normal"),Y.setFontSize(9),Y.text("Financial Analysis Report",se,je-10),Y.text(`Page ${ot}`,ie-se,je-10,{align:"right"})},nt=Y.getNumberOfPages();for(let ot=1;ot<=nt;ot++)Y.setPage(ot),Xe(ot);const Et=`mca-application${Ue?"-"+Ue:""}-office-report.pdf`;Y.save(Et)}catch(Y){console.warn("Failed to export PDF:",Y),alert("Failed to generate PDF. Please try again.")}finally{E(!1)}};ne.useEffect(()=>{const Y=n.id||n.applicationId||(t==null?void 0:t.id)||(t==null?void 0:t.applicationId)||"";if(!Y)return;let ie=!1;return(async()=>{try{K(!0);const se=await Jo(Y);ie||$(se||[])}catch(se){console.warn("Failed to load application documents:",se)}finally{ie||K(!1)}})(),()=>{ie=!0}},[n.id,n.applicationId,t==null?void 0:t.id,t==null?void 0:t.applicationId]),ne.useEffect(()=>{const Y=n.id||n.applicationId||(t==null?void 0:t.id)||(t==null?void 0:t.applicationId)||"";if(!Y)return;let ie=!1;return(async()=>{try{const se=await co(Y);ie||Ne(se||[])}catch(se){console.warn("Failed to load application_mtd rows:",se)}finally{}})(),()=>{ie=!0}},[n.id,n.applicationId,t==null?void 0:t.id,t==null?void 0:t.applicationId]);const c=(Y,ie)=>i(je=>({...je,[Y]:ie})),[d,u]=ne.useState(!1),[h,m]=ne.useState(!1),[,p]=ne.useState(new Map),[x,w]=ne.useState([]),[S,b]=ne.useState(!1),[v,N]=ne.useState(!1),[j,E]=ne.useState(!1),[A,L]=ne.useState("monthly"),C=ne.useRef(null),B=Y=>{if(!Y||Y.length===0)return;const ie=[];Array.from(Y).forEach(je=>{if(je.type!=="application/pdf"||je.size>10*1024*1024)return;x.find(le=>le.name===je.name&&le.size===je.size)||ie.push(je)}),ie.length&&w(je=>[...je,...ie])},U=Y=>{w(ie=>ie.filter((je,se)=>se!==Y))},P=async()=>{if(!x.length||S)return;const Y=n.applicationId||(t==null?void 0:t.applicationId)||n.id||(t==null?void 0:t.id)||"";if(!Y){alert("Missing application ID");return}b(!0),N(!0);try{const ie=await Promise.allSettled(x.map(async se=>{const le=h5();return await at(se,le),se.name})),je=new Set(ie.filter(se=>se.status==="fulfilled").map(se=>se.value));w(se=>se.filter(le=>!je.has(le.name)));try{Y&&await o(Y)}catch{}}catch(ie){console.warn("[bucket submit] failed:",ie),alert("Failed to submit files. Please try again.")}finally{b(!1),N(!1)}},[T,z]=ne.useState(0);ne.useEffect(()=>{if(!(r||d)){z(0);return}z(10);const Y=setInterval(()=>{z(ie=>ie>=90?ie:Math.min(ie+Math.random()*10+5,90))},300);return()=>clearInterval(Y)},[r,d]);const[H,D]=ne.useState(new Map),[M,$]=ne.useState([]),[q,K]=ne.useState(!1),[de,Ne]=ne.useState([]),R=ne.useRef(new Set),W=ne.useRef(new Set),Z=Y=>String(Y||"").toLowerCase().trim().replace(/\s*\(\d+\)(?=\.[a-z0-9]+$)/i,"");ne.useEffect(()=>{const Y=new Set((M||[]).map(ie=>Z(ie==null?void 0:ie.file_name)));if(D(ie=>{var se;if(!ie||ie.size===0)return ie;const je=new Map(ie);for(const[le,Ue]of Array.from(je.entries()))if((Ue==null?void 0:Ue.status)==="completed"){const Ie=Z((se=Ue==null?void 0:Ue.file)==null?void 0:se.name);Y.has(Ie)||je.delete(le)}return je}),W.current.size>0)for(const ie of Array.from(W.current))Y.has(ie)&&W.current.delete(ie)},[M]),ne.useEffect(()=>{const Y=n.applicationId||(t==null?void 0:t.applicationId)||n.id||(t==null?void 0:t.id)||"";if(!Y)return;const ie=Ct.channel(`rt-application_mtd-${Y}`).on("postgres_changes",{event:"*",schema:"public",table:"application_mtd",filter:`application_id=eq.${Y}`},async()=>{try{const je=await co(Y);Ne(je||[])}catch{}}).subscribe();return()=>{try{Ct.removeChannel(ie)}catch{}}},[n.applicationId,n.id,t==null?void 0:t.applicationId,t==null?void 0:t.id]),ne.useEffect(()=>{const Y=n.applicationId||(t==null?void 0:t.applicationId)||n.id||(t==null?void 0:t.id)||"";if(!Y)return;const ie=setInterval(async()=>{try{const je=await co(Y);Ne(je||[])}catch{}},7e3);return()=>clearInterval(ie)},[n.applicationId,n.id,t==null?void 0:t.applicationId,t==null?void 0:t.id]);const[ue,ce]=ne.useState(null),[ye,Se]=ne.useState(null),[Ee,De]=ne.useState(null),[We,Je]=ne.useState(!1),[it,Be]=ne.useState(new Set),[Te,oe]=ne.useState(""),[et,pe]=ne.useState(!1),xe=ne.useRef(null),[he,we]=ne.useState(new Set),[Ae,Ze]=ne.useState(new Set),$e=Y=>{const ie=Z(String(Y||""));ie&&Ze(je=>{const se=new Set(je);return se.add(ie),se})},[Qe,lt]=ne.useState({show:!1,type:"success",title:"",message:""});ne.useEffect(()=>{const Y=ie=>{const je=ie.target;et&&!je.closest(".category-dropdown")&&pe(!1)};return document.addEventListener("mousedown",Y),()=>document.removeEventListener("mousedown",Y)},[et]),ne.useEffect(()=>{if(!ye||it.size===0)return;const Y=Array.from(it)[0],ie=`cat-${x$(Y)}`,je=setTimeout(()=>{const se=document.getElementById(ie);se&&se.scrollIntoView({behavior:"smooth",block:"start"})},100);return()=>clearTimeout(je)},[it,ye]);const At=ne.useRef(null),Nt=v||Array.from(H.values()).some(Y=>Y.status==="uploading"),Lt=Yt.useMemo(()=>{var ie;const Y=new Set((M||[]).map(je=>Z(je==null?void 0:je.file_name)));for(const je of Array.from(H.values()))if((je==null?void 0:je.status)==="completed"){const se=Z((ie=je==null?void 0:je.file)==null?void 0:ie.name);if(se&&!Y.has(se))return!0}return!1},[H,M]),Dt=Yt.useMemo(()=>{try{const Y=(se,le)=>{try{return le.split(".").reduce((Ue,Ie)=>Ue&&Ue[Ie]!==void 0?Ue[Ie]:void 0,se)}catch{return}},ie=(se,le)=>{for(const Ue of le){const Ie=Y(se,Ue);if(Ie!=null&&Ie!=="")return Ie}},je=new Set;for(const se of Array.from(H.values()))if(!(!se||!se.file)&&(se.status==="uploading"||se.status==="completed")){const le=Z(se.file.name);le&&je.add(le)}return je.size===0?!1:(M||[]).some(se=>{let le=String((se==null?void 0:se.month)||"").trim();if(!le){const ut=se!=null&&se.statement_date?String(se.statement_date).slice(0,7):"";/\d{4}-\d{2}/.test(ut)&&(le=ut)}if(!le)return!1;const Ue=Z(se==null?void 0:se.file_name);if(!Ue||!je.has(Ue))return!1;const Ie=se==null?void 0:se.extracted_json,He=(se==null?void 0:se.monthly_revenue)??(Ie?ie(Ie,["monthly_revenue","summary.monthly_revenue","mca_summary.monthly_revenue","totals.monthly_revenue"]):void 0),Me=He!=null?typeof He=="number"?He:Xn(String(He)):0;return(ut=>Number.isFinite(Number(ut))?Number(ut):0)(Me)===0})}catch{return!1}},[M,H]),yt=Yt.useMemo(()=>{try{return Array.from(H.values()).some(Y=>(Y==null?void 0:Y.status)==="uploading")}catch{return!1}},[H]),os=Yt.useMemo(()=>{try{const Y=new Set(Array.from(H.values()).filter(se=>!!se&&!!se.file).map(se=>Z(se.file.name)));if(Y.size===0)return!1;const ie=(se,le)=>{try{return le.split(".").reduce((Ue,Ie)=>Ue&&Ue[Ie]!==void 0?Ue[Ie]:void 0,se)}catch{return}},je=(se,le)=>{for(const Ue of le){const Ie=ie(se,Ue);if(Ie!=null&&Ie!=="")return Ie}};return(M||[]).some(se=>{const le=Z(se==null?void 0:se.file_name);if(!le||!Y.has(le))return!1;let Ue=String((se==null?void 0:se.month)||"").trim();if(!Ue){const ut=se!=null&&se.statement_date?String(se.statement_date).slice(0,7):"";/\d{4}-\d{2}/.test(ut)&&(Ue=ut)}if(!Ue)return!1;const Ie=se==null?void 0:se.extracted_json,He=(se==null?void 0:se.total_deposits)??(Ie?je(Ie,["total_deposits","summary.total_deposits","mca_summary.total_deposits","totals.total_deposits"]):void 0),Me=He!=null?typeof He=="number"?He:Xn(String(He)):0;return(ut=>Number.isFinite(Number(ut))?Number(ut):0)(Me)===0})}catch{return!1}},[M,H]),me=Nt||q||W.current.size>0||Lt||Dt;ne.useEffect(()=>{const Y=n.applicationId||(t==null?void 0:t.applicationId)||n.id||(t==null?void 0:t.id)||"";if(Y)try{const ie=Ct.channel(`application_documents-${Y}`).on("postgres_changes",{event:"*",schema:"public",table:"application_documents",filter:`application_id=eq.${Y}`},()=>{o(Y)}).subscribe();return()=>{try{Ct.removeChannel(ie)}catch{}}}catch{return}},[n.applicationId,n.id,t==null?void 0:t.applicationId,t==null?void 0:t.id]);const Ce=Yt.useMemo(()=>{const Y=[],ie=(le,Ue)=>{try{return Ue.split(".").reduce((Ie,He)=>Ie&&Ie[He]!==void 0?Ie[He]:void 0,le)}catch{return}},je=(le,Ue)=>{for(const Ie of Ue){const He=ie(le,Ie);if(He!=null&&He!==""){const Me=typeof He=="number"?He:Xn(String(He));if(!Number.isNaN(Me)&&Number.isFinite(Me))return Me}}return null};(M||[]).forEach(le=>{let Ue=String((le==null?void 0:le.month)||"").trim();if(!Ue){const xt=le!=null&&le.statement_date?String(le.statement_date).slice(0,7):"";/\d{4}-\d{2}/.test(xt)&&(Ue=xt)}if(!Ue){const xt=le==null?void 0:le.extracted_json;if(xt){const X=je(xt,["month","summary.month","mca_summary.month"]);typeof X=="string"&&/\d{4}-\d{2}/.test(X)&&(Ue=X)}}if(!Ue)return;const Ie=le==null?void 0:le.total_deposits;let He=typeof Ie=="number"?Ie:Ie!=null?Xn(String(Ie)):null;if(He===null){const xt=le==null?void 0:le.extracted_json;xt&&(He=je(xt,["total_deposits","summary.total_deposits","mca_summary.total_deposits","totals.total_deposits"]))}(He===null||!Number.isFinite(He))&&(He=0);const Me=le==null?void 0:le.negative_days;let st=typeof Me=="number"?Me:Me!=null?Xn(String(Me)):null;if(st===null){const xt=le==null?void 0:le.extracted_json;xt&&(st=je(xt,["negative_days","summary.negative_days","mca_summary.negative_days","totals.negative_days"]))}(st===null||!Number.isFinite(st))&&(st=0);const ut=le==null?void 0:le.monthly_revenue;let wt=typeof ut=="number"?ut:ut!=null?Xn(String(ut)):null;if(wt===null){const xt=le==null?void 0:le.extracted_json;xt&&(wt=je(xt,["monthly_revenue","summary.monthly_revenue","mca_summary.monthly_revenue","totals.monthly_revenue"]))}(wt===null||!Number.isFinite(wt))&&(wt=0),Y.push({month:Ue,total_deposits:He||0,negative_days:st||0,monthly_revenue:wt||0,file_name:(le==null?void 0:le.file_name)||void 0})});const se=Y.filter(le=>{const Ue=Number(le.total_deposits)||0,Ie=Number(le.negative_days)||0,He=Number(le.monthly_revenue)||0;return Ue!==0||Ie!==0||He!==0});return se.sort((le,Ue)=>Date.parse(le.month+"-01")-Date.parse(Ue.month+"-01")),se},[M]),dt=Yt.useMemo(()=>{const Y=[];return(M||[]).forEach(ie=>{try{const je=ie==null?void 0:ie.extracted_json;let se=(ie==null?void 0:ie.mca_summary)??(je&&je.mca_summary)??null;if(se&&typeof se=="string")try{se=JSON.parse(se)}catch{se=null}if(!se||typeof se!="object")return;const le=se,Ue=Array.isArray(le)?le:[],Ie=!Array.isArray(le)&&le&&typeof le=="object"?Object.values(le).flat().filter(Boolean):[],He=(Ue.length?Ue:Ie).filter(Me=>Me&&typeof Me=="object");for(const Me of He){const st=String(((Me==null?void 0:Me.month)??(Me==null?void 0:Me.period)??"")||""),ut=String((Me==null?void 0:Me.funder)??""),wt=String((Me==null?void 0:Me.dailyweekly)??(Me==null?void 0:Me.debit_frequency)??""),xt=Me==null?void 0:Me.amount,X=typeof xt=="number"?xt:Xn(String(xt??"")),Ke=/weekly/i.test(wt),Oe=Ke?Number(X)/5:Number(X),Xe=String((Me==null?void 0:Me.notes)??"");Y.push({period:st,funder:ut,freq:wt,amountVal:xt,amountNum:Number(X),isWeekly:Ke,displayAmount:Number(Oe),notes:Xe})}}catch{}}),Y},[M]),O=Yt.useMemo(()=>{try{const Y=[];return(M||[]).forEach(ie=>{const je=ie==null?void 0:ie.extracted_json;let se=(ie==null?void 0:ie.mca_summary)??(je&&je.mca_summary)??null;if(se&&typeof se=="string")try{se=JSON.parse(se)}catch{}if(!se||typeof se!="object"){try{console.log("[MCA] No mca_summary object for document",ie==null?void 0:ie.id,"type=",typeof se,"value=",se)}catch{}return}try{console.log("[MCA] mca_summary detected for document",ie==null?void 0:ie.id,{isArray:Array.isArray(se),topLevelKeys:!Array.isArray(se)&&typeof se=="object"?Object.keys(se):void 0,items:Array.isArray(se)?se.length:void 0})}catch{}let le=String((ie==null?void 0:ie.month)||"").trim();if(!le){const Ie=ie!=null&&ie.statement_date?String(ie.statement_date).slice(0,7):"";/\d{4}-\d{2}/.test(Ie)&&(le=Ie)}const Ue={id:ie==null?void 0:ie.id,...se,month:le,average_daily_balances:se.average_daily_balances??se.average_daily_balance,ending_balances:se.ending_balances??se.ending_balance,monthly_revenue:(ie==null?void 0:ie.monthly_revenue)??se.monthly_revenue,negative_days:(ie==null?void 0:ie.negative_days)??se.negative_days,total_deposits:(ie==null?void 0:ie.total_deposits)??se.total_deposits,__mca_raw:se};Y.push(Ue)}),Y}catch{return[]}},[M]),_e=async Y=>{if(!Y)return;if(Y.type!=="application/pdf"){alert("Please upload PDF files only");return}if(Y.size>10*1024*1024){alert("File size must be under 10MB");return}const ie=h5();await at(Y,ie)},at=async(Y,ie)=>{try{W.current.add(Z(Y.name))}catch{}D(se=>new Map(se.set(ie,{file:Y,status:"uploading"}))),p(se=>new Map(se.set(ie,0)));const je=setInterval(()=>{p(se=>{const le=se.get(ie)||0;if(le>=90)return se;const Ue=new Map(se);return Ue.set(ie,le+Math.random()*15),Ue})},200);try{const se=Y;let le,Ue;try{const Ie=n.applicationId||(t==null?void 0:t.applicationId)||n.id||(t==null?void 0:t.id)||"";let He;try{const X=`${se.name}`,{error:Ke}=await Ct.storage.from("application_documents").upload(X,se,{upsert:!0});if(Ke)console.warn("[storage] upload failed; proceeding without file_url:",Ke.message);else{const{data:Oe}=Ct.storage.from("application_documents").getPublicUrl(X);He=Oe==null?void 0:Oe.publicUrl}}catch(X){console.warn("[storage] unexpected error during upload; proceeding without file_url:",X)}const Me={application_id:Ie,file_name:se.name,file_size:se.size,file_type:se.type||"application/pdf",statement_date:ie,...He?{file_url:He}:{}},st=`${Me.application_id}|${Me.file_name}|${Me.file_size}`;R.current.has(st)?console.log("[document-file] Skipping duplicate call for",st):R.current.add(st);const ut=await By(E$,{method:"POST",headers:{"Content-Type":"application/json","Idempotency-Key":st},body:JSON.stringify(Me),timeoutMs:3e4}),wt=ut.headers.get("content-type")||"";let xt;if(wt.includes("application/json"))xt=await ut.json().catch(()=>{});else{const X=await ut.text();try{xt=JSON.parse(X)}catch{xt=void 0}}if(xt&&typeof xt=="object"){const X=xt.id||xt.document_id||xt.documentId;typeof X=="string"&&X&&(le=X);const Ke=xt.file_url;typeof Ke=="string"&&Ke&&(Ue=Ke)}}catch(Ie){console.warn("[document-file] failed to persist document before new-deal:",Ie)}try{const Ie=n.applicationId||(t==null?void 0:t.applicationId)||n.id||(t==null?void 0:t.id)||"",He=(t==null?void 0:t.business_name)||"",Me=(t==null?void 0:t.owner_name)||"";let st;if(Ue){const ut={application_id:Ie,document_id:le,statementDate:ie,file_url:Ue,file_name:se.name,file_type:se.type||"application/pdf"};He&&(ut.business_name=He),Me&&(ut.owner_name=Me),console.log("[newDeal webhook] Starting JSON request with file_url",{url:$y,fileUrl:Ue,dateKey:ie,documentId:le}),st=await By($y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ut),timeoutMs:45e3})}else{const ut=new FormData;ut.append("file",se,se.name),ut.append("statementDate",ie),Ie&&ut.append("application_id",Ie),le&&ut.append("document_id",le),He&&ut.append("business_name",He),Me&&ut.append("owner_name",Me),console.log("[newDeal webhook] Starting multipart request",{url:$y,fileName:se.name,dateKey:ie,documentId:le}),st=await By($y,{method:"POST",body:ut,timeoutMs:45e3})}if(st.status===202)console.log("[newDeal webhook] 202 Accepted: processing in background. Skipping response parsing.");else if(st.ok){const ut=st.headers.get("content-type")||"";console.log("[newDeal webhook] Response received",{status:st.status,contentType:ut});try{let wt;if(ut.includes("application/json"))wt=await st.json();else{const xt=await st.text();try{wt=JSON.parse(xt)}catch{wt=void 0}}if(wt){const xt=Array.isArray(wt);console.log("[newDeal webhook - daily] Parsed response summary:",{dateKey:ie,isArray:xt,arrayLength:xt?wt.length:void 0,topLevelKeys:!xt&&typeof wt=="object"?Object.keys(wt):void 0})}}catch(wt){console.warn("Unable to read daily webhook response:",wt)}}else console.warn(`newDeal webhook responded ${st.status} ${st.statusText}; continuing upload flow`)}catch(Ie){Ie instanceof DOMException&&Ie.name==="AbortError"?console.warn("[newDeal webhook] Request aborted due to timeout (45s). Continuing upload flow.",{fileName:se.name,dateKey:ie}):console.warn("newDeal webhook failed; continuing upload flow:",Ie)}clearInterval(je),p(Ie=>{const He=new Map(Ie);return He.set(ie,100),He}),setTimeout(()=>{D(Ie=>new Map(Ie.set(ie,{file:se,status:"completed",fileUrl:Ue}))),p(Ie=>{const He=new Map(Ie);return He.delete(ie),He})},500)}catch(se){console.error("Daily upload failed:",se),clearInterval(je),D(le=>new Map(le.set(ie,{file:Y,status:"error"}))),p(le=>{const Ue=new Map(le);return Ue.delete(ie),Ue});try{W.current.delete(Z(Y.name))}catch{}}},St=async Y=>{var je;const ie=(je=Y.target.files)==null?void 0:je[0];if(ie){const se=n.id||(t==null?void 0:t.id)||n.applicationId||(t==null?void 0:t.applicationId)||"",le=(ue==null?void 0:ue.dateKey)||h5();if(await at(ie,le),(ue==null?void 0:ue.source)==="db"&&ue.docId){try{await p1(ue.docId)}catch(Ue){console.warn("Failed to delete old DB document during replace:",Ue)}se&&await o(se)}}Y.target.value="",ce(null)},Tt=async Y=>{const ie=H.get(Y);ie&&await _e(ie.file)},Pt=Y=>{Y.preventDefault(),Y.stopPropagation(),m(!0)},kt=Y=>{Y.preventDefault(),Y.stopPropagation(),m(!1)},jt=Y=>{Y.preventDefault(),Y.stopPropagation(),m(!1),B(Y.dataTransfer.files)},Rt=Y=>{if(!Y)return"";const ie=new Date(Y);return Number.isNaN(ie.getTime())?"":ie.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})},Ot=()=>{const Y=new Date,ie=Y.getFullYear(),je=Y.getMonth(),se=Y.getDate(),le=Array.from(H.entries()).map(([Me,st])=>{const ut=Me.slice(0,10),[wt,xt,X]=ut.split("-").map(Number),Ke=!Number.isNaN(wt)&&!Number.isNaN(xt)&&!Number.isNaN(X)?new Date(wt,xt-1,X):new Date,Oe=!Number.isNaN(wt)&&wt===ie&&xt-1===je,Xe=!Number.isNaN(wt)&&!Number.isNaN(xt)&&!Number.isNaN(X)?new Date(wt,xt-1,Oe?se:X):new Date;return{key:`local:${Me}`,dateKey:Me,dateDisplay:Xe.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),status:st.status,file:{name:st.file.name,size:st.file.size},fileUrl:st.fileUrl,sortDate:Ke,source:"local"}}),Ue=(M||[]).map(Me=>{const st=Me.statement_date?new Date(Me.statement_date):new Date(Me.created_at),ut=Rt(Me.statement_date||Me.created_at)||"",wt=(Me.statement_date||Me.created_at||"").slice(0,10)||Me.id;return{key:`db:${Me.id}`,dateKey:wt,dateDisplay:ut,status:"completed",file:{name:Me.file_name,size:typeof Me.file_size=="number"?Me.file_size:0},fileUrl:Me.file_url,sortDate:st,source:"db",docId:Me.id}}),Ie=Me=>String(Me||"").toLowerCase().trim().replace(/\s*\(\d+\)(?=\.[a-z0-9]+$)/i,""),He=new Map;return Ue.forEach(Me=>{var wt;const st=Ie((wt=Me.file)==null?void 0:wt.name),ut=He.get(st);(!ut||Me.sortDate>ut.sortDate)&&He.set(st,Me)}),le.forEach(Me=>{var ut;const st=Ie((ut=Me.file)==null?void 0:ut.name);He.has(st)||He.set(st,Me)}),Array.from(He.values()).sort((Me,st)=>st.sortDate.getTime()-Me.sortDate.getTime())},Ps=Y=>{D(ie=>{const je=new Map(ie);return je.delete(Y),je})},Fs=async Y=>{var je;const ie=n.id||(t==null?void 0:t.id)||n.applicationId||(t==null?void 0:t.applicationId)||"";if(Y.source==="db"&&Y.docId){try{await p1(Y.docId),console.log("Successfully deleted document from database:",Y.docId)}catch(se){console.error("Failed to delete DB document:",se),alert("Failed to delete document. Please try again.");return}ie&&await o(ie);return}try{ie&&Y.dateKey&&(await IE(ie,Y.dateKey,(je=Y.file)==null?void 0:je.name),ie&&await o(ie))}catch(se){console.warn("Failed to delete matching DB document for local item:",se)}Ps(Y.dateKey)},Os=Y=>{var ie;Y.source==="db"?ce({source:"db",dateKey:Y.dateKey,docId:Y.docId}):ce({source:"local",dateKey:Y.dateKey}),(ie=At.current)==null||ie.click()},be=async Y=>{var ie;try{$e((ie=Y==null?void 0:Y.file)==null?void 0:ie.name)}catch{}if(Se({item:Y}),De(null),Be(new Set),oe(""),Y.source==="db"&&Y.docId){Je(!0);try{const{data:je,error:se}=await Ct.from("application_documents").select("*").eq("id",Y.docId).maybeSingle();se?console.error("Failed to fetch document details:",se):De(je)}catch(je){console.error("Error fetching document details:",je)}finally{Je(!1)}}},ve=()=>{Se(null),De(null)},Ve=async Y=>{try{const ie=Ee==null?void 0:Ee.id;if(!ie){console.error("No document ID found for saving monthly revenue"),lt({show:!0,type:"error",title:"Error",message:"No document ID found for saving monthly revenue"});return}await RE(ie,Y.difference),console.log("Successfully saved Net Difference to monthly_revenue:",Y.difference);const je=Y.difference>=0?`+$${Math.abs(Y.difference).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`-$${Math.abs(Y.difference).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`;lt({show:!0,type:"success",title:"Successfully saved!",message:"Data has been saved.",amount:je})}catch(ie){console.error("Error saving Net Difference to monthly_revenue:",ie),lt({show:!0,type:"error",title:"Error saving to database",message:ie instanceof Error?ie.message:"Unknown error occurred"})}},ct=async Y=>{if(!d){u(!0);try{const ie={id:n.id||(t==null?void 0:t.id)||"",applicationId:n.applicationId||(t==null?void 0:t.applicationId)||n.id||(t==null?void 0:t.id)||""},je=le=>typeof le=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(le);(!ie.applicationId||!je(ie.applicationId))&&console.warn("[updatingApplications] Skipping webhook: missing or invalid applicationId",{id:ie.id,applicationId:ie.applicationId});const se={id:ie.id,applicationId:ie.applicationId,hasBankruptcies:!!(n.hasBankruptcies??!1),hasOpenJudgments:!!(n.hasOpenJudgments??!1),financial_overview:{total_documents:Array.isArray(Ce)?Ce.length:0,average_deposits:(()=>{const le=Array.isArray(Ce)?Ce.length:1,Ue=Ce.reduce((Ie,He)=>Ie+(Number(He.total_deposits)||0),0);return Number((Ue/Math.max(1,le)).toFixed(2))})(),average_revenue:(()=>{const le=Array.isArray(Ce)?Ce.length:1,Ue=Ce.reduce((Ie,He)=>Ie+(Number(He.monthly_revenue)||0),0);return Number((Ue/Math.max(1,le)).toFixed(2))})(),total_negative_days:Ce.reduce((le,Ue)=>le+(Number(Ue.negative_days)||0),0)},mca_summary:(()=>{try{const le=(O||[]).reduce((xt,X)=>{const Ke=X&&X.__mca_raw,Oe=Array.isArray(Ke)?Ke:!Array.isArray(Ke)&&Ke&&typeof Ke=="object"?Object.values(Ke).flat().filter(Boolean):[],Xe=(Array.isArray(Oe)?Oe:[]).filter(Et=>Et&&typeof Et=="object");let nt=0;for(const Et of Xe){const ot=String((Et==null?void 0:Et.dailyweekly)??(Et==null?void 0:Et.debit_frequency)??""),gt=Et==null?void 0:Et.amount,Fe=typeof gt=="number"?gt:Xn(String(gt??"")),Gt=/weekly/i.test(ot)?Number(Fe)/5:Number(Fe);nt+=Number.isFinite(Gt)?Number(Gt):0}return xt+nt},0),Ue=20,Ie=le*Ue,He=Array.isArray(Ce)?Ce.length:1,st=(Ce||[]).reduce((xt,X)=>xt+(Number(X.monthly_revenue)||0),0)/Math.max(1,He),ut=st>0?Ie/st:0,wt=(()=>{const X=ut*100,Ke=Math.pow(10,1),Oe=X*Ke,Xe=Math.floor(Oe),nt=Oe-Xe,Et=Math.abs(nt-.5)<1e-10;let ot;return Et?ot=Xe%2===0?Xe:Xe+1:ot=Math.round(Oe),ot/Ke})();return{total_funders:Number(le.toFixed(2)),multiplier:Ue,subtotal:Number(Ie.toFixed(2)),ratio:Number(ut.toFixed(2)),holdback_percentage:wt}}catch(le){return console.error("[updatingApplications] Error calculating MCA summary:",le),{total_funders:0,multiplier:20,subtotal:0,ratio:0,holdback_percentage:0}}})()};if(!L$&&ie.applicationId&&je(ie.applicationId)){try{console.log("[updatingApplications] payload preview (minimal)",se)}catch{}const le=await By(C$,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(se),timeoutMs:8e3});if(!le.ok){let Ue="";try{Ue=await le.text()}catch{}console.error("[updatingApplications] Non-OK response (flat payload)",{status:le.status,statusText:le.statusText,body:(Ue||"").slice(0,2048)})}}}catch(ie){console.error("[updatingApplications] Error sending webhook:",ie)}finally{const ie=(()=>{const se=Array.isArray(Ce)?Ce.length:1,le=Ce.reduce((Ue,Ie)=>Ue+(Number(Ie.monthly_revenue)||0),0);return Number((le/Math.max(1,se)).toFixed(2))})(),je={...n,monthlyRevenue:String(ie),creditScore:n.creditScore||"",requestedAmount:n.requestedAmount||""};console.log("[SubmissionIntermediate] Passing to parent:",{monthlyRevenue:je.monthlyRevenue,creditScore:je.creditScore,requestedAmount:je.requestedAmount}),s(je),u(!1)}}};return a.jsxs("div",{className:"mx-auto px-4 sm:px-6 lg:px-8 py-6",style:{maxWidth:"1440px"},children:[a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"px-10 py-8 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Merchant Cash Advance Application"}),a.jsx("p",{className:"text-gray-600 mt-2 text-lg",children:"Please fill out all required information to get matched with qualified lenders"}),a.jsxs("div",{className:"mt-8",children:[a.jsxs("div",{role:"tablist","aria-label":"Form view tabs",className:"inline-flex items-center p-1 rounded-2xl bg-gradient-to-r from-slate-100 via-white to-slate-100 border border-slate-200/60 shadow-lg backdrop-blur-sm",children:[a.jsx("button",{type:"button",role:"tab","aria-selected":A==="monthly",onClick:()=>L("monthly"),className:`relative px-6 sm:px-8 py-3 text-sm font-bold rounded-xl transition-all duration-300 ease-out ${A==="monthly"?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/25 transform scale-[1.02]":"bg-transparent text-slate-600 hover:text-slate-800 hover:bg-white/60 hover:shadow-sm"}`,children:a.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Monthly"]})}),a.jsx("button",{type:"button",role:"tab","aria-selected":A==="mtd",onClick:()=>L("mtd"),className:`relative px-6 sm:px-8 py-3 text-sm font-bold rounded-xl transition-all duration-300 ease-out ${A==="mtd"?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/25 transform scale-[1.02]":"bg-transparent text-slate-600 hover:text-slate-800 hover:bg-white/60 hover:shadow-sm"}`,children:a.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"MTD"]})})]}),a.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),a.jsxs("span",{className:"text-sm font-medium text-slate-600",children:["Viewing: ",a.jsx("span",{className:"font-bold text-slate-800 uppercase tracking-wide",children:A})," Analysis"]})]})]})]}),a.jsx("div",{className:"p-10",children:r||d?a.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[a.jsx("div",{className:"w-16 h-16 rounded-xl bg-gradient-to-b from-blue-50 to-blue-100/70 border border-blue-100 flex items-center justify-center shadow-sm mb-5",children:a.jsx("svg",{className:"w-7 h-7 text-blue-600 animate-spin",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:a.jsxs("g",{stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:[a.jsx("line",{x1:"12",y1:"3.5",x2:"12",y2:"6.5",opacity:"1"}),a.jsx("line",{x1:"12",y1:"17.5",x2:"12",y2:"20.5",opacity:"0.25"}),a.jsx("line",{x1:"3.5",y1:"12",x2:"6.5",y2:"12",opacity:"0.6"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"20.5",y2:"12",opacity:"0.25"}),a.jsx("line",{x1:"6.1",y1:"6.1",x2:"8.2",y2:"8.2",opacity:"0.85"}),a.jsx("line",{x1:"15.8",y1:"15.8",x2:"17.9",y2:"17.9",opacity:"0.2"}),a.jsx("line",{x1:"6.1",y1:"17.9",x2:"8.2",y2:"15.8",opacity:"0.45"}),a.jsx("line",{x1:"15.8",y1:"8.2",x2:"17.9",y2:"6.1",opacity:"0.25"})]})})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Finding Your Lender Matches"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"We’re reviewing your application and matching it with lenders best suited to your needs."}),a.jsx("div",{className:"w-full max-w-md mt-6",children:a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500 ease-out",style:{width:`${T}%`}})})}),a.jsx("p",{className:"text-gray-500 text-xs mt-3",children:"This usually takes 30–60 seconds"})]}):a.jsxs(a.Fragment,{children:[A==="mtd"&&a.jsx(k$,{applicationId:String((n==null?void 0:n.applicationId)||(t==null?void 0:t.applicationId)||(n==null?void 0:n.id)||(t==null?void 0:t.id)||""),businessName:String((n==null?void 0:n.businessName)||(t==null?void 0:t.businessName)||""),ownerName:String((n==null?void 0:n.ownerName)||(t==null?void 0:t.ownerName)||"")}),a.jsxs("div",{className:`mb-8 ${A==="mtd"?"hidden":""}`,children:[a.jsxs("div",{className:"mb-8 bg-white rounded-2xl p-6 border border-slate-200 shadow-sm",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-lg",children:a.jsx(u1,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-slate-800",children:"Bank Statement Documents"}),a.jsx("p",{className:"text-slate-600",children:"Secure document processing for financial analysis"})]})]}),a.jsxs("span",{className:"hidden md:inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200",children:[a.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500"}),"System Ready"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/50 rounded-lg border border-slate-200",children:[a.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg -> p-2 rounded-lg bg-emerald-100 text-emerald-700",children:a.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Secure Upload"}),a.jsx("p",{className:"text-xs text-slate-600",children:"Bank-grade encryption"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl border border-slate-200 bg-slate-50",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg -> p-2 rounded-lg bg-indigo-100 text-indigo-700",children:a.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Fast Processing"}),a.jsx("p",{className:"text-xs text-slate-600",children:"AI-powered analysis"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/50 rounded-lg border border-slate-200",children:[a.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg -> p-2 rounded-lg bg-fuchsia-100 text-fuchsia-700",children:a.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-800",children:"Smart Extraction"}),a.jsx("p",{className:"text-xs text-slate-600",children:"Financial data analysis"})]})]})]})]}),Ot().length>0&&a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6 p-4 bg-gradient-to-r from-white to-slate-50 rounded-xl border border-slate-200 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg shadow-sm",children:a.jsx(Is,{className:"w-4 h-4 text-white"})}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-bold text-slate-800",children:[Ot().length," ",Ot().length===1?"Document":"Documents"," Uploaded"]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Ready for processing and analysis"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[q&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 rounded-lg border border-blue-200",children:[a.jsx("div",{className:"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Syncing…"})]}),a.jsx("div",{className:"px-3 py-2 bg-emerald-50 rounded-lg border border-emerald-200",children:a.jsx("span",{className:"text-sm font-semibold text-emerald-700",children:"All Systems Active"})})]})]}),a.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gradient-to-r from-slate-50 to-blue-50/30 border-b border-slate-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Document"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Size"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:Ot().map(Y=>{var He;const ie=Y.status==="uploading",je=Y.status==="completed",se=Y.status==="error",le=new Set(Array.from(H.values()).map(Me=>{var st;return Z((st=Me==null?void 0:Me.file)==null?void 0:st.name)})),Ue=Z((He=Y==null?void 0:Y.file)==null?void 0:He.name),Ie=Ue&&le.has(Ue)&&!Ae.has(Ue);return a.jsxs("tr",{className:"group hover:bg-slate-50/50 transition-all duration-200",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-xl shadow-sm border ${je?"bg-gradient-to-br from-emerald-100 to-green-100 border-emerald-200":ie?"bg-gradient-to-br from-blue-100 to-indigo-100 border-blue-200":se?"bg-gradient-to-br from-red-100 to-rose-100 border-red-200":"bg-gradient-to-br from-slate-100 to-gray-100 border-slate-200"}`,children:a.jsx(Is,{className:`w-6 h-6 ${je?"text-emerald-700":ie?"text-blue-700":se?"text-red-700":"text-slate-600"}`})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h5",{className:"text-base font-semibold text-slate-900 truncate",title:Y.file.name,children:Y.file.name}),a.jsx("p",{className:"text-sm text-slate-500",children:"PDF Document"}),Ie&&a.jsxs("span",{className:"mt-1 inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-semibold bg-blue-50 text-blue-700 border border-blue-200",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"New upload"]}),je&&Y.fileUrl&&a.jsxs("a",{href:Y.fileUrl,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-600 hover:text-blue-700 font-medium mt-1",onClick:Me=>{var st;Me.stopPropagation();try{$e((st=Y==null?void 0:Y.file)==null?void 0:st.name)}catch{}},children:[a.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View Document"]})]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:`inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-bold border ${je?"bg-gradient-to-r from-emerald-50 to-green-50 text-emerald-800 border-emerald-200":ie?"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 border-blue-200":se?"bg-gradient-to-r from-red-50 to-rose-50 text-red-800 border-red-200":"bg-gradient-to-r from-slate-50 to-gray-50 text-slate-800 border-slate-200"}`,children:[je&&a.jsx(_s,{className:"w-3 h-3 mr-1"}),ie&&a.jsx("div",{className:"w-3 h-3 mr-1 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),se&&a.jsx("span",{className:"w-3 h-3 mr-1",children:"⚠"}),je?"Completed":ie?"Processing":se?"Error":"Uploaded"]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-slate-100 rounded-md text-xs font-semibold text-slate-700",children:[a.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(Y.file.size/1024/1024).toFixed(1)," MB"]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{type:"button",className:"p-2 rounded-lg text-slate-400 hover:text-slate-700 hover:bg-slate-50 border border-transparent hover:border-slate-200 transition-all duration-200",onClick:Me=>{Me.stopPropagation(),be(Y)},title:"View details",children:a.jsx(Is,{className:"w-4 h-4"})}),a.jsx("button",{type:"button",className:"p-2 rounded-lg text-slate-400 hover:text-blue-600 hover:bg-blue-50 border border-transparent hover:border-blue-200 transition-all duration-200",onClick:Me=>{Me.stopPropagation(),Os(Y)},title:"Replace file",children:a.jsx(MC,{className:"w-4 h-4"})}),Y.source==="local"&&se&&a.jsx("button",{type:"button",className:"p-2 rounded-lg text-slate-400 hover:text-orange-600 hover:bg-orange-50 border border-transparent hover:border-orange-200 transition-all duration-200",onClick:Me=>{Me.stopPropagation(),Tt(Y.dateKey)},title:"Retry upload",children:a.jsx(BM,{className:"w-4 h-4"})}),a.jsx("button",{type:"button",className:"p-2 rounded-lg text-slate-400 hover:text-red-600 hover:bg-red-50 border border-transparent hover:border-red-200 transition-all duration-200",onClick:Me=>{Me.stopPropagation(),Fs(Y)},title:"Remove file",children:a.jsx(vp,{className:"w-4 h-4"})})]})})]},Y.key)})})]})})}),ye&&a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:ve}),a.jsxs("div",{className:"relative z-10 w-full max-w-6xl mx-auto bg-white rounded-2xl border border-slate-300 shadow-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"px-8 py-6 bg-gradient-to-r from-slate-50 to-blue-50 border-b border-slate-200 flex items-center justify-between flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-blue-600 rounded-xl shadow-lg",children:a.jsx(Is,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"Bank Statement Analysis"}),a.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Transaction Categories & Details"})]})]}),a.jsx("button",{onClick:ve,className:"p-2 rounded-xl text-slate-400 hover:text-slate-600 hover:bg-white/80 transition-all duration-200",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsx("div",{className:"p-8 space-y-6 overflow-y-auto flex-1 bg-slate-50/30",children:(()=>{const Y=ye.item;return a.jsxs("div",{className:"space-y-4",children:[We&&a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsxs("div",{className:"flex items-center gap-2 text-blue-700",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-sm",children:"Loading document details..."})]})}),!Ee&&!We&&a.jsxs("div",{className:"mt-3 p-4 rounded-lg border border-amber-200 bg-amber-50 text-amber-800 text-sm flex items-start gap-3",children:[a.jsx(Is,{className:"w-4 h-4 mt-0.5 text-amber-700"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:"Preparing Bank Statement Analysis"}),a.jsxs("p",{className:"mt-0.5",children:["Your document is being processed. The ",a.jsx("span",{className:"font-semibold",children:"Transaction Categories & Details"})," will appear here shortly. Please wait for the analysis to complete."]})]})]}),Ee&&a.jsx("div",{children:(()=>{try{const ie=Ee.categories?typeof Ee.categories=="string"?JSON.parse(Ee.categories):Ee.categories:void 0,je=Ee.business_owner?typeof Ee.business_owner=="string"?JSON.parse(Ee.business_owner):Ee.business_owner:void 0,se=Ee.funder_list?typeof Ee.funder_list=="string"?JSON.parse(Ee.funder_list):Ee.funder_list:void 0,le={};(Oe=>{Oe&&(Array.isArray(Oe)?Oe.forEach(Xe=>{if(Xe&&typeof Xe=="object"){const nt=Xe.month||Xe.date||"Unknown";le[nt]||(le[nt]={}),Object.entries(Xe).forEach(([Et,ot])=>{Et==="month"||Et==="date"||(le[nt][Et]||(le[nt][Et]=[]),Array.isArray(ot)?le[nt][Et].push(...ot):le[nt][Et].push(ot))})}}):Oe&&typeof Oe=="object"&&Object.entries(Oe).forEach(([Xe,nt])=>{!nt||typeof nt!="object"||(le[Xe]||(le[Xe]={}),Object.entries(nt).forEach(([Et,ot])=>{le[Xe][Et]||(le[Xe][Et]=[]),Array.isArray(ot)?le[Xe][Et].push(...ot):le[Xe][Et].push(ot)}))}))})(ie);const Ie="Business Name & Owner",He=Oe=>{try{if(!Oe)return[];if(Array.isArray(Oe))return Oe.flat().filter(Boolean).map(nt=>nt).filter(Boolean);if(typeof Oe=="object")return Object.values(Oe).flatMap(Xe=>{if(!Xe)return[];if(Array.isArray(Xe))return Xe;if(typeof Xe=="object"){const nt=Xe.transactions;return Array.isArray(nt)?nt:[Xe]}return[]}).filter(Boolean)}catch{}return[]};if(je){const Oe=He(je);le[Ie]||(le[Ie]={}),le[Ie][Ie]||(le[Ie][Ie]=[]),le[Ie][Ie].push(...Oe)}if(se){const Oe="Funder List",Xe=He(se);le[Oe]||(le[Oe]={}),le[Oe][Oe]||(le[Oe][Oe]=[]),le[Oe][Oe].push(...Xe)}const Me=Object.keys(le).sort(),st=Me.length===0,ut={},wt=Oe=>Oe?Array.isArray(Oe)?Oe.flat().filter(Boolean):typeof Oe=="object"?Object.values(Oe).reduce((nt,Et)=>(Array.isArray(Et)?nt.push(...Et):Et&&typeof Et=="object"&&Array.isArray(Et.transactions)&&nt.push(...Et.transactions),nt),[]).filter(Boolean):[]:[];for(const[Oe,Xe]of Object.entries(le)){const nt=[];Array.isArray(Xe)?Xe.length>0&&nt.push(Oe):Xe&&typeof Xe=="object"&&Object.entries(Xe).forEach(([Et,ot])=>{wt(ot).length>0&&nt.push(Et)}),ut[Oe]={subWithData:nt}}const xt={},X=Te.trim().toLowerCase();Object.entries(le).forEach(([Oe,Xe])=>{const nt=ot=>String(ot||"").toLowerCase().includes(X),Et=ot=>{try{return(Array.isArray(ot)?ot.flat().filter(Boolean):Object.values(ot||{}).flatMap(Fe=>Array.isArray(Fe)?Fe:Fe&&typeof Fe=="object"&&Array.isArray(Fe.transactions)?Fe.transactions:[]).filter(Boolean)).some(Fe=>{const ns=String((Fe==null?void 0:Fe.date)||(Fe==null?void 0:Fe.Date)||(Fe==null?void 0:Fe.transaction_date)||""),Gt=String((Fe==null?void 0:Fe.description)||(Fe==null?void 0:Fe.Description)||(Fe==null?void 0:Fe.desc)||(Fe==null?void 0:Fe.memo)||""),mt=String((Fe==null?void 0:Fe.amount)||(Fe==null?void 0:Fe.Amount)||(Fe==null?void 0:Fe.value)||(Fe==null?void 0:Fe.amt)||"");return(ns+" "+Gt+" "+mt).toLowerCase().includes(X)})}catch{return!1}};if(it.size===0){if(!X)xt[Oe]=Xe;else if(Array.isArray(Xe))(nt(Oe)||Et(Xe))&&(xt[Oe]=Xe);else if(Xe&&typeof Xe=="object"){const ot={};Object.entries(Xe).forEach(([gt,Fe])=>{(nt(gt)||Et(Fe))&&(ot[gt]=Fe)}),Object.keys(ot).length>0&&(xt[Oe]=ot)}}else it.has(Oe)&&(xt[Oe]=Xe)});const Ke=(()=>{if(!X)return!0;let Oe=!1;for(const[Xe,nt]of Object.entries(xt))if(Array.isArray(nt)){if(String(Xe).toLowerCase().includes(X)){Oe=!0;break}for(const ot of nt){const gt=String((ot==null?void 0:ot.date)||(ot==null?void 0:ot.Date)||(ot==null?void 0:ot.transaction_date)||""),Fe=String((ot==null?void 0:ot.description)||(ot==null?void 0:ot.Description)||(ot==null?void 0:ot.desc)||(ot==null?void 0:ot.memo)||""),ns=String((ot==null?void 0:ot.amount)||(ot==null?void 0:ot.Amount)||(ot==null?void 0:ot.value)||(ot==null?void 0:ot.amt)||"");if((gt+" "+Fe+" "+ns).toLowerCase().includes(X)){Oe=!0;break}}if(Oe)break}else if(nt&&typeof nt=="object"){for(const[Et,ot]of Object.entries(nt)){if(String(Et).toLowerCase().includes(X)){Oe=!0;break}const gt=Array.isArray(ot)?ot:Object.values(ot||{}).flat();for(const Fe of gt){const ns=String((Fe==null?void 0:Fe.date)||(Fe==null?void 0:Fe.Date)||(Fe==null?void 0:Fe.transaction_date)||""),Gt=String((Fe==null?void 0:Fe.description)||(Fe==null?void 0:Fe.Description)||(Fe==null?void 0:Fe.desc)||(Fe==null?void 0:Fe.memo)||""),mt=String((Fe==null?void 0:Fe.amount)||(Fe==null?void 0:Fe.Amount)||(Fe==null?void 0:Fe.value)||(Fe==null?void 0:Fe.amt)||"");if((ns+" "+Gt+" "+mt).toLowerCase().includes(X)){Oe=!0;break}}if(Oe)break}if(Oe)break}return Oe})();return st?a.jsxs("div",{className:"mt-3 p-4 rounded-lg border border-amber-200 bg-amber-50 text-amber-800 text-sm flex items-start gap-3",children:[a.jsx(Is,{className:"w-4 h-4 mt-0.5 text-amber-700"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:"Preparing Bank Statement Analysis"}),a.jsxs("p",{className:"mt-0.5",children:["Your document is being processed. The ",a.jsx("span",{className:"font-semibold",children:"Transaction Categories & Details"})," will appear here shortly. Please wait for the analysis to complete."]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(w$,{categoryDropdownOpen:et,onToggleDropdown:()=>pe(!et),selectedCategories:it,allCategories:Me,mainCategorySummaries:ut,onClearAll:()=>{Be(new Set),pe(!1)},onSelectAll:()=>{Be(new Set(Me)),pe(!1)},onToggleCategory:(Oe,Xe)=>{const nt=new Set(it);Xe?nt.add(Oe):nt.delete(Oe),Be(nt)},categorySearch:Te,onCategorySearchChange:oe,onCategorySearchEnter:()=>{Te.trim().toLowerCase()},onApplyCategories:()=>{setTimeout(()=>{var Oe;(Oe=xe.current)==null||Oe.scrollIntoView({behavior:"smooth",block:"start"})},50)}}),Ee&&Ee.total_deposits!==void 0&&Ee.total_deposits!==null&&a.jsx(_$,{documentDetails:Ee,monthlyData:le,onSave:Ve}),!Ke&&a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No transactions found"}),a.jsx("p",{className:"text-slate-500",children:"Try adjusting your search criteria or category filter."})]}),a.jsx("div",{ref:xe}),Ke&&Object.entries(xt).map(([Oe,Xe])=>a.jsxs("div",{className:"mb-8",children:[!Array.isArray(Xe)&&(()=>{const Et=(gt=>{try{let Fe=0;return Object.entries(gt).forEach(([,ns])=>{(Jt=>Jt?Array.isArray(Jt)?Jt.flat().filter(Boolean):typeof Jt=="object"?Object.values(Jt).reduce((ts,It)=>(Array.isArray(It)?ts.push(...It):It&&typeof It=="object"&&Array.isArray(It.transactions)&&ts.push(...It.transactions),ts),[]).filter(Boolean):[]:[])(ns).forEach(Jt=>{Fe+=Xn((Jt==null?void 0:Jt.amount)??(Jt==null?void 0:Jt.Amount)??(Jt==null?void 0:Jt.value)??(Jt==null?void 0:Jt.amt))})}),Fe}catch{return 0}})(Xe),ot=Object.keys(Xe||{}).length||0;return a.jsxs("div",{className:"flex items-center justify-between px-6 py-4 mb-4 rounded-xl shadow-md border border-slate-200 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-white",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-400 shadow"}),a.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-extrabold tracking-wider uppercase",children:Oe||"Transaction Categories"}),ot>0&&a.jsxs("span",{className:"ml-2 px-2 py-0.5 text-[10px] sm:text-xs font-semibold rounded-full bg-white/10 border border-white/20",children:[ot," subcategories"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] sm:text-xs text-white/80 font-semibold uppercase tracking-wider",children:"Total"}),a.jsx("span",{className:"text-sm sm:text-base md:text-lg font-black",children:ps(Et)})]})]})})(),a.jsx("div",{className:"space-y-6",children:Array.isArray(Xe)?(()=>{const nt=Te.trim().toLowerCase(),Et=Xe,ot=String(Oe||"").toLowerCase(),gt=!nt||ot.includes(nt)?Et:Et.filter(Fe=>{const ns=String((Fe==null?void 0:Fe.date)||(Fe==null?void 0:Fe.Date)||(Fe==null?void 0:Fe.transaction_date)||""),Gt=String((Fe==null?void 0:Fe.description)||(Fe==null?void 0:Fe.Description)||(Fe==null?void 0:Fe.desc)||(Fe==null?void 0:Fe.memo)||""),mt=String((Fe==null?void 0:Fe.amount)||(Fe==null?void 0:Fe.Amount)||(Fe==null?void 0:Fe.value)||(Fe==null?void 0:Fe.amt)||"");return(ns+" "+Gt+" "+mt).toLowerCase().includes(nt)});return nt&&gt.length===0&&!ot.includes(nt)?null:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200/60 overflow-hidden mb-8",children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-8 py-5 relative",children:[a.jsx("div",{className:"absolute inset-0 bg-black/5"}),a.jsxs("div",{className:"relative flex items-center gap-3",children:[a.jsx("div",{className:"w-2 h-2 bg-white rounded-full opacity-80"}),a.jsx("h4",{className:"text-base font-bold uppercase tracking-wider",children:Oe})]})]}),a.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50 px-8 py-4 border-b border-slate-200/60",children:a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-3",children:a.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Date"})}),a.jsx("div",{className:"col-span-6",children:a.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Description"})}),a.jsx("div",{className:"col-span-3 text-right",children:a.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Amount"})})]})}),a.jsxs("div",{className:"bg-white",children:[gt.length?gt.map((Fe,ns)=>a.jsx("div",{className:"px-8 py-5 border-b border-slate-100/70 hover:bg-gradient-to-r hover:from-blue-50/30 hover:to-transparent transition-all duration-300 group",children:a.jsxs("div",{className:"grid grid-cols-12 gap-6 items-center",children:[a.jsx("div",{className:"col-span-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-1 h-8 bg-blue-400 rounded-full opacity-60 group-hover:opacity-100 transition-opacity duration-300"}),a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:j1((Fe==null?void 0:Fe.date)||(Fe==null?void 0:Fe.Date)||(Fe==null?void 0:Fe.transaction_date)||"")})]})}),a.jsx("div",{className:"col-span-6",children:a.jsx("span",{className:"text-sm text-slate-700 leading-relaxed font-medium",children:(Fe==null?void 0:Fe.description)||(Fe==null?void 0:Fe.Description)||(Fe==null?void 0:Fe.desc)||(Fe==null?void 0:Fe.memo)||String(Fe)})}),a.jsx("div",{className:"col-span-3 text-right",children:a.jsx("div",{className:"inline-flex items-center px-3 py-1.5 bg-slate-50 rounded-lg border border-slate-200/60",children:a.jsxs("span",{className:"text-sm font-bold text-slate-900",children:["$",Number((Fe==null?void 0:Fe.amount)||(Fe==null?void 0:Fe.Amount)||(Fe==null?void 0:Fe.value)||(Fe==null?void 0:Fe.amt)||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})})]})},ns)):a.jsxs("div",{className:"px-8 py-16 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsx("p",{className:"text-slate-500 font-medium",children:nt?"No matching transactions found":"No transaction data available"})]}),gt.length>0&&a.jsx("div",{className:"bg-gradient-to-r from-slate-100 to-slate-50 px-8 py-6 border-t-2 border-slate-200",children:a.jsxs("div",{className:"grid grid-cols-12 gap-6 items-center",children:[a.jsx("div",{className:"col-span-9",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-2 h-2 bg-slate-600 rounded-full"}),a.jsx("span",{className:"text-base font-bold text-slate-700 uppercase tracking-wider",children:"Total"})]})}),a.jsx("div",{className:"col-span-3 text-right",children:a.jsx("div",{className:"inline-flex items-center px-4 py-2 bg-white rounded-lg border-2 border-slate-300 shadow-sm",children:a.jsx("span",{className:"text-base font-extrabold text-slate-900",children:ps(gt.reduce((Fe,ns)=>Fe+Xn((ns==null?void 0:ns.amount)??(ns==null?void 0:ns.Amount)??(ns==null?void 0:ns.value)??(ns==null?void 0:ns.amt)),0))})})})]})})]})]},Oe)})():Object.entries(Xe).map(([nt,Et])=>(()=>{const gt=(mt=>mt?Array.isArray(mt)?mt.flat().filter(Boolean):typeof mt=="object"?Object.values(mt).reduce((ts,It)=>{if(Array.isArray(It))ts.push(...It);else if(It&&typeof It=="object"){const fs=It.transactions;Array.isArray(fs)&&ts.push(...fs)}return ts},[]).filter(Boolean):[]:[])(Et),Fe=Te.trim().toLowerCase(),ns=String(nt||"").toLowerCase(),Gt=!Fe||ns.includes(Fe)?gt:gt.filter(mt=>{const Jt=String((mt==null?void 0:mt.date)||(mt==null?void 0:mt.Date)||(mt==null?void 0:mt.transaction_date)||""),ds=String((mt==null?void 0:mt.description)||(mt==null?void 0:mt.Description)||(mt==null?void 0:mt.desc)||(mt==null?void 0:mt.memo)||""),ts=String((mt==null?void 0:mt.amount)||(mt==null?void 0:mt.Amount)||(mt==null?void 0:mt.value)||(mt==null?void 0:mt.amt)||"");return(Jt+" "+ds+" "+ts).toLowerCase().includes(Fe)});return Fe&&!Gt.length&&!ns.includes(Fe)?null:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200/60 overflow-hidden mb-8",children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-8 py-5 relative",children:[a.jsx("div",{className:"absolute inset-0 bg-black/5"}),a.jsxs("div",{className:"relative flex items-center gap-3",children:[a.jsx("div",{className:"w-2 h-2 bg-white rounded-full opacity-80"}),a.jsx("h4",{className:"text-base font-bold uppercase tracking-wider",children:nt})]})]}),a.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50 px-8 py-4 border-b border-slate-200/60",children:a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsx("div",{className:"col-span-3",children:a.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Date"})}),a.jsx("div",{className:"col-span-6",children:a.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Description"})}),a.jsx("div",{className:"col-span-3 text-right",children:a.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Amount"})})]})}),a.jsxs("div",{className:"bg-white",children:[Gt.length?Gt.map((mt,Jt)=>a.jsx("div",{className:"px-8 py-5 border-b border-slate-100/70 hover:bg-gradient-to-r hover:from-blue-50/30 hover:to-transparent transition-all duration-300 group",children:a.jsxs("div",{className:"grid grid-cols-12 gap-6 items-center",children:[a.jsx("div",{className:"col-span-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-1 h-8 bg-blue-400 rounded-full opacity-60 group-hover:opacity-100 transition-opacity duration-300"}),a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:j1((mt==null?void 0:mt.date)||(mt==null?void 0:mt.Date)||(mt==null?void 0:mt.transaction_date)||"")})]})}),a.jsx("div",{className:"col-span-6",children:a.jsx("span",{className:"text-sm text-slate-700 leading-relaxed font-medium",children:(mt==null?void 0:mt.description)||(mt==null?void 0:mt.Description)||(mt==null?void 0:mt.desc)||(mt==null?void 0:mt.memo)||String(mt)})}),a.jsx("div",{className:"col-span-3 text-right",children:a.jsx("div",{className:"inline-flex items-center px-3 py-1.5 bg-slate-50 rounded-lg border border-slate-200/60",children:a.jsxs("span",{className:"text-sm font-bold text-slate-900",children:["$",Number((mt==null?void 0:mt.amount)||(mt==null?void 0:mt.Amount)||(mt==null?void 0:mt.value)||(mt==null?void 0:mt.amt)||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})})]})},Jt)):a.jsxs("div",{className:"px-8 py-16 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsx("p",{className:"text-slate-500 font-medium",children:Fe?"No matching transactions found":"No transaction data available"})]}),Gt.length>0&&a.jsx("div",{className:"bg-gradient-to-r from-slate-100 to-slate-50 px-8 py-6 border-t-2 border-slate-200",children:a.jsxs("div",{className:"grid grid-cols-12 gap-6 items-center",children:[a.jsx("div",{className:"col-span-9",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-2 h-2 bg-slate-600 rounded-full"}),a.jsx("span",{className:"text-base font-bold text-slate-700 uppercase tracking-wider",children:"Total"})]})}),a.jsx("div",{className:"col-span-3 text-right",children:a.jsx("div",{className:"inline-flex items-center px-4 py-2 bg-white rounded-lg border-2 border-slate-300 shadow-sm",children:a.jsx("span",{className:"text-base font-extrabold text-slate-900",children:ps(Gt.reduce((mt,Jt)=>mt+Xn((Jt==null?void 0:Jt.amount)??(Jt==null?void 0:Jt.Amount)??(Jt==null?void 0:Jt.value)??(Jt==null?void 0:Jt.amt)),0))})})})]})})]})]},nt)})())})]},Oe||"CATEGORIES"))]})}catch(ie){return console.error("Error parsing categories data:",ie),a.jsx("div",{className:"px-4 py-8 text-center text-slate-500 italic",children:"Unable to parse categories data"})}})()}),!Ee&&!We&&a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-700 font-semibold mb-3",children:"Document Information"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-500",children:"File name"}),a.jsx("div",{className:"font-medium text-slate-900",children:Y.file.name})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-500",children:"Size"}),a.jsxs("div",{className:"font-medium text-slate-900",children:[(Y.file.size/1024/1024).toFixed(2)," MB"]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-500",children:"Status"}),a.jsx("div",{className:"font-medium text-slate-900",children:Y.status})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-500",children:"Date Key"}),a.jsx("div",{className:"font-medium text-slate-900",children:Y.dateKey})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-500",children:"Source"}),a.jsx("div",{className:"font-medium text-slate-900",children:Y.source})]}),Y.docId&&a.jsxs("div",{children:[a.jsx("div",{className:"text-slate-500",children:"Document ID"}),a.jsx("div",{className:"font-mono text-xs text-slate-900",children:Y.docId})]})]}),Y.fileUrl&&a.jsx("div",{className:"mt-3",children:a.jsx("a",{href:Y.fileUrl,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open file"})})]})]})})()}),a.jsxs("div",{className:"px-8 py-6 bg-slate-50 border-t border-slate-200 flex justify-between items-center flex-shrink-0",children:[a.jsxs("div",{className:"text-sm text-slate-500",children:["Bank Statement Analysis • ",ye.item.file.name]}),a.jsx("button",{onClick:ve,className:"px-6 py-2.5 bg-slate-600 hover:bg-slate-700 text-white text-sm font-semibold rounded-lg transition-colors duration-200 shadow-sm",children:"Close Analysis"})]})]})]})]}),a.jsxs("div",{ref:C,id:"pdf-export-root",children:[Array.isArray(M)&&M.length>0||Array.isArray(Ce)&&Ce.length>0?a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"bg-white border border-slate-200/60 rounded-xl shadow-lg overflow-hidden backdrop-blur-sm",children:[a.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-slate-900 to-slate-800 border-b border-slate-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 rounded-lg bg-blue-500/20 border border-blue-400/30",children:a.jsx(Pg,{className:"w-5 h-5 text-blue-300"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold text-white",children:"Financial Overview"}),a.jsx("p",{className:"text-xs text-slate-300",children:"Monthly analysis • Deposits, Revenue & Risk"})]})]}),q&&a.jsxs("div",{className:"flex items-center gap-2 text-blue-300 bg-blue-500/10 border border-blue-400/20 px-3 py-1.5 rounded-lg",children:[a.jsx("div",{className:"w-3 h-3 border-2 border-blue-400 border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-xs font-medium",children:"Updating"})]})]})}),Array.isArray(Ce)&&Ce.length>0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-slate-100/50 border-b border-slate-200",children:[a.jsx("th",{className:"px-6 py-3 text-left font-semibold text-slate-700 uppercase tracking-wider text-xs",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-slate-400"}),"Period"]})}),a.jsx("th",{className:"px-6 py-3 text-right font-semibold text-slate-700 uppercase tracking-wider text-xs",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),"Deposits"]})}),a.jsx("th",{className:"px-6 py-3 text-right font-semibold text-slate-700 uppercase tracking-wider text-xs",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Revenue"]})}),a.jsx("th",{className:"px-6 py-3 text-right font-semibold text-slate-700 uppercase tracking-wider text-xs",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),"Negative Days"]})})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-slate-100",children:[...Ce].sort((Y,ie)=>{const je=typeof Y.month=="string"&&/\d{4}-\d{2}/.test(Y.month)?Date.parse(Y.month+"-01"):Number.POSITIVE_INFINITY,se=typeof ie.month=="string"&&/\d{4}-\d{2}/.test(ie.month)?Date.parse(ie.month+"-01"):Number.POSITIVE_INFINITY;return je-se}).map((Y,ie)=>{const je=typeof Y.month=="string"&&/\d{4}-\d{2}/.test(Y.month)?new Date(Y.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"}):Y.month||`Period ${ie+1}`,se=Number(Y.negative_days)||0,le=Number(Y.total_deposits)||0,Ue=Number(Y.monthly_revenue)||0,Ie=Array.isArray(Ce)?Math.max(1,Ce.filter(st=>st&&st.month===Y.month).length):1,He=le/Ie,Me=Ue/Ie;return a.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors duration-150 group",children:[a.jsx("td",{className:"px-6 py-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500 group-hover:bg-blue-600 transition-colors"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium text-slate-900",children:je}),Y.file_name&&a.jsx("div",{className:"text-xs text-slate-500 truncate max-w-[260px]",children:Y.file_name})]})]})}),a.jsx("td",{className:"px-6 py-3 text-right",children:a.jsxs("div",{className:"inline-flex items-center",children:[a.jsx("span",{className:"font-bold text-slate-900 tabular-nums",children:ps(He)}),le>0&&a.jsx("div",{className:"ml-2 w-1.5 h-1.5 rounded-full bg-green-500"})]})}),a.jsx("td",{className:"px-6 py-3 text-right",children:a.jsxs("div",{className:"inline-flex items-center",children:[a.jsx("span",{className:"font-bold text-slate-900 tabular-nums",children:ps(Me)}),Ue>0&&a.jsx("div",{className:"ml-2 w-1.5 h-1.5 rounded-full bg-blue-500"})]})}),a.jsx("td",{className:"px-6 py-3 text-right",children:a.jsxs("div",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:`font-bold tabular-nums ${se===0?"text-emerald-600":se<=2?"text-amber-600":"text-red-600"}`,children:se}),a.jsx("div",{className:`w-2 h-2 rounded-full ${se===0?"bg-emerald-500":se<=2?"bg-amber-500":"bg-red-500"}`})]})})]},Y.id||ie)})}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-800 to-slate-900 border-t-2 border-slate-300",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-white/60"}),a.jsx("span",{className:"font-bold text-white uppercase tracking-wide text-sm",children:"Total"})]})}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsx("span",{className:"font-black text-white text-lg tabular-nums",children:(()=>{const Y=Array.isArray(Ce)?Ce.length:1,ie=Ce.reduce((je,se)=>je+(Number(se.total_deposits)||0),0);return ps(ie/Math.max(1,Y))})()})}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsx("span",{className:"font-black text-white text-lg tabular-nums",children:(()=>{const Y=Array.isArray(Ce)?Ce.length:1,ie=Ce.reduce((je,se)=>je+(Number(se.monthly_revenue)||0),0);return ps(ie/Math.max(1,Y))})()})}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsxs("div",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"font-black text-white text-lg tabular-nums",children:Ce.reduce((Y,ie)=>Y+(Number(ie.negative_days)||0),0)}),a.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"})]})})]})})]})}),!yt&&!v&&(os?a.jsxs("div",{className:"mt-3 px-4 py-3 bg-amber-50 border border-amber-200 rounded-lg text-amber-800 text-sm flex items-center gap-3",children:[a.jsx("div",{className:"w-4 h-4 rounded-full bg-amber-500/90"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Updating Financial Overview"}),a.jsx("span",{className:"ml-1",children:"A newly uploaded document is being processed. Totals will refresh shortly."})]})]}):me&&a.jsxs("div",{className:"mt-3 px-4 py-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-800 text-sm flex items-center gap-3",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-blue-300 border-t-blue-600 rounded-full"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold",children:"Action Needed"}),a.jsx("span",{className:"ml-1",children:"Deposits are not available yet for a newly uploaded document. Please manage the revenue you want to use for each new document."})]})]}))]}):a.jsxs("div",{className:"p-4 rounded-lg border border-amber-200 bg-amber-50 text-amber-800 text-sm flex items-start gap-3",children:[a.jsx(Is,{className:"w-4 h-4 mt-0.5 text-amber-700"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold",children:"Preparing Financial Overview"}),a.jsxs("p",{className:"mt-0.5",children:["Your document is being processed. The ",a.jsx("span",{className:"font-semibold",children:"Financial Overview"})," (Monthly Total Deposits) will appear here shortly. Please wait for the analysis to complete."]})]})]})]})}):null,Array.isArray(de)&&de.some(Y=>{const ie=Y,je=typeof(ie==null?void 0:ie.total_mtd)=="number"&&!Number.isNaN(ie.total_mtd),se=Array.isArray(ie==null?void 0:ie.mtd_selected)&&ie.mtd_selected.length>0;return je||se})?a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"bg-white border border-slate-200/60 rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"px-4 py-3 bg-slate-800 text-white flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Pg,{className:"w-5 h-5 text-violet-300"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold",children:"Funder MTD Totals"}),a.jsx("p",{className:"text-xs text-slate-300",children:"Saved totals from analysis (application_mtd.total_mtd)"})]})]})}),a.jsx("div",{className:"divide-y divide-slate-200",children:(de||[]).filter(Y=>{const ie=Y;return typeof(ie==null?void 0:ie.total_mtd)=="number"&&!Number.isNaN(ie.total_mtd)||typeof(ie==null?void 0:ie.total_amount)=="number"&&!Number.isNaN(ie.total_amount)||Array.isArray(ie==null?void 0:ie.mtd_selected)&&ie.mtd_selected.length>0}).map((Y,ie)=>{const je=Y,se=Array.isArray(je==null?void 0:je.mtd_selected)?je.mtd_selected:[];return a.jsxs("div",{className:"px-6 py-3",children:[a.jsx("div",{className:"grid grid-cols-12 gap-4 items-center",children:a.jsx("div",{className:"col-span-12 truncate text-slate-700 text-sm",children:Y.file_name||"MTD Document"})}),a.jsx("div",{className:"mt-2 grid grid-cols-12 gap-3",children:typeof(je==null?void 0:je.total_amount)=="number"&&!Number.isNaN(je.total_amount)&&a.jsxs("div",{className:"col-span-12 flex items-center justify-between py-1",children:[a.jsx("div",{className:"text-[11px] font-semibold text-slate-600 uppercase tracking-wider",children:"Transactions Total Deposits for MTD"}),a.jsx("div",{className:"text-right font-mono text-sm font-bold text-slate-900",children:ps(Number(je.total_amount||0))})]})}),se.length>0&&a.jsxs("div",{className:"mt-4 rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-sm overflow-hidden",children:[a.jsx("div",{className:"px-4 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-white/90"}),a.jsx("span",{className:"text-sm font-bold uppercase tracking-wide",children:"Selected Rows (Application MTD Selected)"})]})}),a.jsxs("div",{className:"bg-white border-b border-blue-200",children:[a.jsxs("div",{className:"px-4 py-2 grid grid-cols-12 gap-3 text-[10px] font-semibold text-slate-600 uppercase tracking-wider bg-slate-50 border-b border-slate-200",children:[a.jsx("div",{className:"col-span-2",children:"Date"}),a.jsx("div",{className:"col-span-4",children:"Description"}),a.jsx("div",{className:"col-span-2",children:"Funder"}),a.jsx("div",{className:"col-span-2",children:"Type"}),a.jsx("div",{className:"col-span-2 text-right",children:"Amount"})]}),a.jsx("div",{className:"divide-y divide-slate-100",children:se.map((le,Ue)=>a.jsxs("div",{className:"px-4 py-3 grid grid-cols-12 gap-3 text-xs hover:bg-blue-50/30 transition-colors",children:[a.jsx("div",{className:"col-span-2 whitespace-nowrap font-semibold text-slate-700",children:String((le==null?void 0:le.date)||"")}),a.jsx("div",{className:"col-span-4 truncate text-slate-700",title:String((le==null?void 0:le.description)||""),children:String((le==null?void 0:le.description)||"")}),a.jsx("div",{className:"col-span-2 truncate",children:a.jsx("span",{className:"inline-flex items-center px-2 py-1 text-[10px] font-semibold bg-emerald-100 text-emerald-800 border border-emerald-200 rounded",children:String((le==null?void 0:le.FUNDER)||(le==null?void 0:le.funder)||"")})}),a.jsx("div",{className:"col-span-2",children:a.jsx("span",{className:"inline-flex items-center px-2 py-1 text-[10px] font-semibold bg-amber-100 text-amber-800 border border-amber-200 rounded uppercase",children:String((le==null?void 0:le.type)||"")})}),a.jsx("div",{className:"col-span-2 text-right",children:a.jsx("span",{className:"inline-flex items-center px-2 py-1 text-xs font-bold bg-indigo-100 text-indigo-900 border border-indigo-200 rounded font-mono",children:ps(Number((le==null?void 0:le.amount)||0))})})]},`mtdsel-${Ue}`))})]}),a.jsx("div",{className:"px-4 py-2 bg-slate-50 border-t border-slate-200",children:a.jsxs("div",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:[se.length," Selected Row",se.length!==1?"s":""]})})]})]},Y.id||ie)})}),a.jsxs("div",{className:"px-6 py-3 bg-slate-50 border-t border-slate-200 grid grid-cols-12 items-center",children:[a.jsx("div",{className:"col-span-8 text-slate-600 uppercase text-xs font-semibold",children:"Total"}),a.jsx("div",{className:"col-span-4 text-right font-black text-slate-900",children:ps((de||[]).reduce((Y,ie)=>Y+(Number(ie.total_mtd)||0),0))})]})]})}):null,Array.isArray(Ce)&&Ce.length>0&&(!Array.isArray(O)||O.length===0)&&a.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-3",children:[a.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-amber-800",children:"Preparing Bank Statement Analysis"}),a.jsx("p",{className:"text-sm text-amber-700",children:"Complete the Bank Statement Analysis to view your Financial Performance Review & Assessment. This data will help match you with qualified lenders."})]})]}),Array.isArray(O)&&O.length>0&&a.jsxs("div",{className:"mb-6",children:[(()=>{const Y=Array.isArray(O)?O.length:0,ie=Array.isArray(M)?M.length:0,je=Math.max(0,ie-Y);return Y>0&&ie>Y?a.jsxs("div",{className:"mb-3 p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 w-5 h-5 mt-0.5 rounded-full bg-amber-400"}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold text-amber-800",children:[Y," of ",ie," Files Processed"]}),a.jsxs("p",{className:"text-sm text-amber-700",children:["Waiting for ",je," remaining file",je===1?"":"s"," to finish analysis. You can review processed results below while the others complete."]})]})]}):null})(),a.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-lg overflow-hidden",children:[a.jsx("div",{className:"px-5 py-4 bg-gradient-to-r from-slate-50 via-blue-50 to-indigo-50 border-b border-slate-200",children:a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center shadow-md",children:a.jsx(Is,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xl font-bold text-slate-800 tracking-tight",children:"Bank Statement Analysis"}),a.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"Financial Performance Review & Assessment"})]})]}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5 bg-emerald-50 border border-emerald-200 rounded",children:[a.jsx("span",{className:"w-1 h-1 rounded-full bg-emerald-500"}),a.jsxs("span",{className:"text-xs font-medium text-emerald-700",children:[O.length," Files Processed"]})]})})]})}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800",children:[a.jsx("th",{className:"text-center py-3 px-2 font-bold text-white text-sm uppercase tracking-wider border-r border-slate-600 last:border-r-0 w-12",children:a.jsxs("div",{className:"flex flex-col items-center justify-center gap-1",children:[a.jsx("input",{type:"checkbox",checked:dt.length>0&&he.size===dt.length,onChange:()=>{he.size===dt.length?we(new Set):we(new Set(dt.map((Y,ie)=>ie)))},className:"w-5 h-5 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer"}),a.jsx("span",{className:"text-xs mt-1",children:"All"})]})}),a.jsx("th",{className:"text-left py-3 px-4 font-bold text-white text-sm uppercase tracking-wider border-r border-slate-600 last:border-r-0 min-w-[180px]",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1 h-4 bg-blue-400 rounded-full"}),"Date"]})}),a.jsx("th",{className:"text-left py-3 px-4 font-bold text-white text-sm uppercase tracking-wider border-r border-slate-600 last:border-r-0",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1 h-4 bg-emerald-400 rounded-full"}),"Funder"]})}),a.jsx("th",{className:"text-left py-3 px-4 font-bold text-white text-sm uppercase tracking-wider border-r border-slate-600 last:border-r-0",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1 h-4 bg-amber-400 rounded-full"}),"Frequency"]})}),a.jsx("th",{className:"text-right py-3 px-4 font-bold text-white text-sm uppercase tracking-wider border-r border-slate-600 last:border-r-0",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("span",{className:"w-1 h-4 bg-indigo-400 rounded-full"}),"Amount"]})}),a.jsx("th",{className:"text-left py-3 px-4 font-bold text-white text-sm uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1 h-4 bg-purple-400 rounded-full"}),"Notes"]})})]})}),(()=>{const Y=dt;return a.jsx("tbody",{className:"divide-y divide-slate-100",children:Y.map((ie,je)=>{const se=String((ie==null?void 0:ie.period)||""),le=String((ie==null?void 0:ie.funder)||""),Ue=String((ie==null?void 0:ie.freq)||""),Ie=Number(ie==null?void 0:ie.amountNum),He=!!(ie!=null&&ie.isWeekly),Me=Number(ie==null?void 0:ie.displayAmount),st=String((ie==null?void 0:ie.notes)||"");return a.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-blue-50/30 hover:to-indigo-50/30 transition-all duration-200 group",children:[a.jsx("td",{className:"py-3 px-2 border-r border-slate-100 last:border-r-0 text-center",children:a.jsx("div",{className:"flex items-center justify-center",children:a.jsx("input",{type:"checkbox",checked:he.has(je),onChange:()=>{we(ut=>{const wt=new Set(ut);return wt.has(je)?wt.delete(je):wt.add(je),wt})},className:"w-5 h-5 rounded border-slate-300 text-blue-600 focus:ring-blue-500 cursor-pointer"})})}),a.jsx("td",{className:"py-3 px-4 border-r border-slate-100 last:border-r-0 min-w-[180px]",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"w-2 h-2 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 group-hover:scale-110 transition-transform"}),a.jsx("span",{className:"font-semibold text-slate-800 text-sm",children:b$(se)})]})}),a.jsx("td",{className:"py-3 px-4 border-r border-slate-100 last:border-r-0",children:a.jsx("span",{className:"inline-flex items-center px-3 py-1.5 text-sm font-semibold bg-gradient-to-r from-emerald-50 to-green-50 text-emerald-800 border border-emerald-200 rounded-lg shadow-sm",children:le||"—"})}),a.jsx("td",{className:"py-3 px-4 border-r border-slate-100 last:border-r-0",children:He?a.jsx("span",{className:"inline-flex items-center px-3 py-1.5 text-sm font-semibold bg-gradient-to-r from-amber-50 to-yellow-50 text-amber-800 border border-amber-200 rounded-lg shadow-sm uppercase tracking-wide",children:"WEEKLY = DAILY"}):a.jsx("span",{className:"inline-flex items-center px-3 py-1.5 text-sm font-semibold bg-gradient-to-r from-amber-50 to-yellow-50 text-amber-800 border border-amber-200 rounded-lg shadow-sm uppercase tracking-wide",children:Ue||"—"})}),a.jsx("td",{className:"py-3 px-4 text-right border-r border-slate-100 last:border-r-0",children:He?a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("span",{className:"inline-flex items-center px-2 py-1 text-[11px] font-semibold bg-slate-100 text-slate-700 border border-slate-200 rounded font-mono",title:"Original weekly amount",children:Number.isFinite(Number(Ie))?ps(Number(Ie)):isNaN(Ie)?"—":String(Ie)}),a.jsx("span",{className:"text-slate-500 font-semibold",children:"="}),a.jsx("span",{className:"inline-flex items-center px-3 py-1.5 text-sm font-bold bg-gradient-to-r from-indigo-50 to-blue-50 text-indigo-900 border border-indigo-200 rounded-lg shadow-sm font-mono",title:"Computed daily amount (weekly / 5)",children:Number.isFinite(Me)?ps(Me):isNaN(Me)?"—":String(Me)})]}):a.jsx("span",{className:"inline-flex items-center px-3 py-1.5 text-sm font-bold bg-gradient-to-r from-indigo-50 to-blue-50 text-indigo-900 border border-indigo-200 rounded-lg shadow-sm font-mono",children:Number.isFinite(Me)?ps(Me):isNaN(Me)?"—":String(Me)})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("div",{className:"max-w-lg",children:a.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",title:st,children:st||"—"})})})]},`mca-sel-${je}`)})})})()]}),a.jsx("div",{className:"border-t border-slate-300",children:(()=>{try{const Y=dt.reduce((ut,wt,xt)=>{if(!he.has(xt))return ut;const X=Number(wt==null?void 0:wt.displayAmount);return ut+(Number.isFinite(X)?X:0)},0),ie=(de||[]).filter(ut=>typeof(ut==null?void 0:ut.total_mtd)=="number").length,je=(de||[]).reduce((ut,wt)=>ut+(Number(wt==null?void 0:wt.total_mtd)||0),0),le=(Y+je)*20,Ue=Array.isArray(Ce)?Ce.length:1,He=(Ce||[]).reduce((ut,wt)=>ut+(Number(wt.monthly_revenue)||0),0)/Math.max(1,Ue),Me=He>0?le/He:0,st=(()=>{const wt=Me*100,xt=Math.pow(10,1),X=wt*xt,Ke=Math.floor(X),Oe=X-Ke,Xe=Math.abs(Oe-.5)<1e-10;let nt;return Xe?nt=Ke%2===0?Ke:Ke+1:nt=Math.round(X),nt/xt})();return a.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-white to-slate-50 px-6 py-6",children:[a.jsx("div",{className:"text-center mb-6",children:a.jsxs("div",{className:"inline-block bg-white border-2 border-slate-800 px-8 py-4 shadow-sm",children:[a.jsxs("div",{className:"border-b-2 border-slate-800 pb-3 mb-3",children:[a.jsx("h2",{className:"text-2xl font-black text-slate-900 uppercase tracking-widest",children:"BANK STATEMENT"}),a.jsx("h3",{className:"text-lg font-bold text-slate-700 uppercase tracking-wider mt-1",children:"TRANSACTION SUMMARY"})]}),a.jsx("div",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"FINANCIAL ANALYSIS REPORT"})]})}),a.jsxs("div",{className:"max-w-2xl mx-auto bg-white border-2 border-slate-800 shadow-lg overflow-hidden",children:[a.jsx("div",{className:"bg-slate-800 text-white px-8 py-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider opacity-80",children:"Document No."}),a.jsxs("div",{className:"font-mono text-sm font-bold",children:["BSA-",new Date().getFullYear(),"-",String(Date.now()).slice(-6)]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider opacity-80",children:"Date Processed"}),a.jsx("div",{className:"font-mono text-sm font-bold",children:new Date().toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})})]})]})}),a.jsxs("div",{className:"px-6 py-6 space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-slate-200",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900 uppercase tracking-wide",children:"TOTAL AMOUNT OF FUNDERS"}),a.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[a.jsxs("span",{className:"font-medium text-blue-600",children:[he.size," of ",dt.length]})," items selected"]})]}),a.jsx("div",{className:"text-right min-w-[120px]",children:a.jsx("div",{className:"font-mono text-lg font-black text-slate-900 tabular-nums",children:ps(Y)})})]}),ie>0&&a.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-slate-200",children:[a.jsx("div",{className:"flex-1",children:a.jsx("div",{className:"text-sm font-bold text-slate-900 uppercase tracking-wide",children:"FUNDER MTD TOTALS"})}),a.jsx("div",{className:"text-right min-w-[120px]",children:a.jsx("div",{className:"font-mono text-lg font-black text-slate-900 tabular-nums",children:ps(je)})})]}),a.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-slate-200",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-bold text-slate-900 uppercase tracking-wide",children:"CALCULATION MULTIPLIER"}),a.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Standard industry factor"})]}),a.jsx("div",{className:"text-right min-w-[120px]",children:a.jsx("div",{className:"font-mono text-lg font-black text-slate-900",children:"× 20"})})]}),a.jsx("div",{className:"bg-slate-100 -mx-6 px-6 py-4 border-y-2 border-slate-300",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-lg font-black text-slate-900 uppercase tracking-wider",children:"SUBTOTAL"}),a.jsx("div",{className:"text-sm text-slate-600 mt-1",children:"Amount × Multiplier"})]}),a.jsx("div",{className:"text-right",children:a.jsx("div",{className:"font-mono text-2xl font-black text-slate-900 tabular-nums",children:ps(le)})})]})}),He>0&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"pt-4 pb-2",children:a.jsx("div",{className:"text-sm font-bold text-slate-700 uppercase tracking-wider border-b border-slate-300 pb-2",children:"REVENUE ANALYSIS"})}),a.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-slate-200",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Total Revenue (Average)"}),a.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"From financial overview"})]}),a.jsx("div",{className:"text-right min-w-[120px]",children:a.jsx("div",{className:"font-mono text-base font-bold text-slate-900 tabular-nums",children:ps(He)})})]}),a.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-slate-200",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Ratio (Total ÷ Revenue)"}),a.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Calculation factor"})]}),a.jsx("div",{className:"text-right min-w-[120px]",children:a.jsx("div",{className:"font-mono text-base font-bold text-slate-900 tabular-nums",children:Me.toFixed(2)})})]}),a.jsx("div",{className:"bg-slate-800 text-white -mx-6 px-6 py-4 mt-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-lg font-black uppercase tracking-wider",children:"HOLDBACK PERCENTAGE"}),a.jsx("div",{className:"text-sm opacity-80 mt-1",children:"Final calculation result"})]}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:"font-mono text-3xl font-black tabular-nums",children:[st.toFixed(1),"%"]})})]})})]})]}),a.jsxs("div",{className:"bg-slate-100 border-t-2 border-slate-300 px-6 py-4",children:[a.jsxs("div",{className:"flex justify-between items-center text-xs",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-slate-700 uppercase tracking-wider",children:"Generated"}),a.jsx("div",{className:"font-mono text-slate-600 mt-1",children:new Date().toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"font-bold text-slate-700 uppercase tracking-wider",children:"Status"}),a.jsx("div",{className:"text-slate-600 mt-1",children:"AUTO-CALCULATED"})]})]}),a.jsx("div",{className:"mt-3 pt-3 border-t border-slate-300 text-center",children:a.jsx("div",{className:"text-xs font-semibold text-slate-600 uppercase tracking-widest",children:"BANK STATEMENT ANALYSIS • CONFIDENTIAL"})})]})]})]})}catch{return null}})()})]})]})]})]}),A!=="mtd"&&a.jsxs(a.Fragment,{children:[a.jsx(v$,{isDragOver:h,batchProcessing:v,disabled:d||v||me||Nt||Dt||(Array.isArray(M)?M.length:0)>(Array.isArray(O)?O.length:0),onDragOver:Pt,onDragLeave:kt,onDrop:jt,onChooseFiles:B}),a.jsx(S$,{files:x,bucketSubmitting:S,batchProcessing:v,onSubmitAll:P,onRemoveAt:U})]})]}),A!=="mtd"&&a.jsx(j$,{hasBankruptcies:!!n.hasBankruptcies,hasOpenJudgments:!!n.hasOpenJudgments,onToggleBankruptcies:Y=>c("hasBankruptcies",Y),onToggleOpenJudgments:Y=>c("hasOpenJudgments",Y)}),A!=="mtd"&&a.jsxs("div",{className:"flex items-center justify-between pt-8 mt-8 border-t border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[e&&a.jsx("button",{type:"button",onClick:e,className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl border-2 border-gray-200 text-gray-700 font-semibold hover:border-gray-300 hover:bg-gray-50 hover:shadow-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500/20",children:"Back"}),a.jsx("button",{type:"button",onClick:l,disabled:d||v||me||Dt||Nt||((Ce==null?void 0:Ce.length)||0)===0||(Array.isArray(M)?M.length:0)>(Array.isArray(O)?O.length:0),className:`inline-flex items-center gap-2 px-6 py-3 rounded-xl font-semibold border-2 transition-all duration-200 focus:outline-none focus:ring-4 ${d||v||me||Dt||Nt||((Ce==null?void 0:Ce.length)||0)===0||(Array.isArray(M)?M.length:0)>(Array.isArray(O)?O.length:0)?"bg-gradient-to-r from-gray-200 to-gray-300 text-gray-600 border-gray-200 cursor-not-allowed":"bg-white text-slate-800 border-slate-200 hover:border-blue-300 hover:text-blue-700 hover:shadow-md focus:ring-blue-500/20"}`,"aria-label":"Download PDF","aria-busy":d||v||me,children:j?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Generating PDF…"]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 16v-8m0 8l-3-3m3 3l3-3M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2"})}),"Download PDF"]})})]}),a.jsx("div",{className:"flex items-center",children:a.jsx("button",{type:"button",onClick:()=>ct(),disabled:d||v||me||Dt||Nt||((Ce==null?void 0:Ce.length)||0)===0||(Array.isArray(M)?M.length:0)>(Array.isArray(O)?O.length:0),className:`inline-flex items-center gap-3 px-6 py-3 rounded-xl font-bold text-base shadow-md transition-all duration-200 focus:outline-none focus:ring-4 ${d||v||me||Dt||Nt||((Ce==null?void 0:Ce.length)||0)===0||(Array.isArray(M)?M.length:0)>(Array.isArray(O)?O.length:0)?"bg-gradient-to-r from-gray-300 to-gray-400 text-white cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 hover:shadow-lg hover:scale-[1.02] focus:ring-blue-500/40"}`,"aria-label":"Continue to Additional Documents","aria-busy":d||v||me,children:d||v?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing…"]}):a.jsxs(a.Fragment,{children:["Continue to Additional Documents",a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})})]}),a.jsx("input",{ref:At,type:"file",className:"sr-only",accept:".pdf",onChange:St})]})})]}),Qe.show&&a.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:a.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl border border-slate-200/50 w-full max-w-md overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",children:[a.jsx("div",{className:`px-8 py-6 ${Qe.type==="success"?"bg-gradient-to-r from-emerald-500 to-green-600":"bg-gradient-to-r from-red-500 to-rose-600"}`,children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center",children:Qe.type==="success"?a.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):a.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-white leading-tight",children:Qe.title}),a.jsx("p",{className:"text-white/90 text-sm mt-1",children:Qe.message})]})]})}),a.jsxs("div",{className:"px-8 py-6",children:[Qe.amount&&a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"text-sm font-semibold text-slate-600 uppercase tracking-wider mb-2",children:"Net Difference"}),a.jsx("div",{className:`text-3xl font-black font-mono ${Qe.type==="success"?"text-emerald-600":"text-red-600"}`,children:Qe.amount})]}),a.jsx("div",{className:"flex items-center justify-end",children:a.jsx("button",{type:"button",onClick:()=>lt(Y=>({...Y,show:!1})),className:`px-6 py-3 rounded-xl text-sm font-bold text-white shadow-lg hover:shadow-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 ${Qe.type==="success"?"bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-700 hover:to-green-700 focus:ring-emerald-500":"bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700 focus:ring-red-500"}`,children:"OK"})})]})]})})]})},T$=({onContinue:s,onBack:e,loading:t,applicationId:r})=>{const[n,i]=ne.useState([]),[o,l]=ne.useState(!1),[c,d]=ne.useState(!1),u=ne.useRef(null),[h,m]=ne.useState([]),[p,x]=ne.useState(!1);Yt.useEffect(()=>{(async()=>{if(r){x(!0);try{const B=await Fh(r);m(B||[])}catch(B){console.warn("Failed to load saved additional documents:",B)}finally{x(!1)}}})()},[r]);const w=C=>{if(!C||C.length===0)return;const B=[];Array.from(C).forEach((U,P)=>{if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","image/jpeg","image/png","image/jpg"].includes(U.type)){alert(`File "${U.name}" is not a supported format. Please upload PDF, Word, or image files.`);return}if(U.size>10*1024*1024){alert(`File "${U.name}" is too large. Maximum size is 10MB.`);return}n.find(H=>H.file.name===U.name&&H.file.size===U.size)||B.push({id:`doc-${Date.now()}-${P}`,file:U,status:"completed",uploadProgress:100})}),B.length>0&&i(U=>[...U,...B])},S=C=>{i(B=>B.filter(U=>U.id!==C))},b=C=>{C.preventDefault(),l(!0)},v=C=>{C.preventDefault(),l(!1)},N=C=>{C.preventDefault(),l(!1),w(C.dataTransfer.files)},j=C=>{w(C.target.files),C.target&&(C.target.value="")},E=async()=>{if(!c){if(!r){alert("Missing application ID. Please go back and try again.");return}d(!0);try{for(const C of n){const{publicUrl:B}=await aE(r,C.file);await oE({application_id:r,file_name:C.file.name,file_size:C.file.size,file_type:C.file.type,file_url:B??void 0})}i([]);try{const C=await Fh(r);m(C||[])}catch(C){console.warn("Failed to refresh saved additional documents:",C)}s()}catch(C){console.error("Error processing additional documents:",C),alert("Failed to process documents. Please try again.")}finally{d(!1)}}},A=C=>{if(C===0)return"0 Bytes";const B=1024,U=["Bytes","KB","MB","GB"],P=Math.floor(Math.log(C)/Math.log(B));return parseFloat((C/Math.pow(B,P)).toFixed(2))+" "+U[P]},L=C=>C.includes("pdf")?a.jsx(Is,{className:"w-8 h-8 text-red-500"}):C.includes("word")||C.includes("document")?a.jsx(Is,{className:"w-8 h-8 text-blue-500"}):C.includes("image")?a.jsx(rc,{className:"w-8 h-8 text-green-500"}):a.jsx(Is,{className:"w-8 h-8 text-gray-500"});return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:a.jsxs("div",{className:"mx-auto px-4 sm:px-6 lg:px-8 py-8",style:{maxWidth:"1200px"},children:[a.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-800 rounded-2xl shadow-2xl overflow-hidden mb-8",children:[a.jsx("div",{className:"absolute inset-0 bg-black/10"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/90 to-indigo-800/90"}),a.jsxs("div",{className:"relative px-8 py-12 sm:px-12",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center",children:a.jsx(Q0,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-bold text-white leading-tight",children:"Additional Documents"}),a.jsx("p",{className:"text-blue-100 text-lg mt-2",children:"Strengthen your application with supporting materials"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(c1,{className:"w-6 h-6 text-yellow-300"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-semibold",children:"Optional Step"}),a.jsx("p",{className:"text-blue-100 text-sm",children:"Enhance your profile"})]})]})}),a.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Is,{className:"w-6 h-6 text-green-300"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-semibold",children:"Secure Upload"}),a.jsx("p",{className:"text-blue-100 text-sm",children:"Bank-grade security"})]})]})}),a.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(_s,{className:"w-6 h-6 text-emerald-300"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white font-semibold",children:"Saved Documents"}),a.jsxs("p",{className:"text-blue-100 text-sm",children:[h.length," files stored"]})]})]})})]})]})]}),a.jsx("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:a.jsxs("div",{className:"p-8 sm:p-10",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Upload Supporting Documents"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"You may upload letters of recommendation, business licenses, contracts, or any other documents that support your application. Accepted formats: PDF, Word documents, and images."}),a.jsx("div",{className:"relative",children:a.jsxs("div",{className:`relative border-2 border-dashed rounded-2xl p-12 text-center transition-all duration-300 ${o?"border-blue-500 bg-gradient-to-br from-blue-50 to-indigo-50 scale-[1.02]":"border-gray-300 hover:border-blue-400 hover:bg-gradient-to-br hover:from-gray-50 hover:to-blue-50"}`,onDragOver:b,onDragLeave:v,onDrop:N,children:[a.jsx("div",{className:`w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center transition-transform duration-300 ${o?"scale-110":""}`,children:a.jsx(u1,{className:`w-10 h-10 transition-colors duration-300 ${o?"text-blue-600":"text-blue-500"}`})}),a.jsx("h4",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Drop files here or click to browse"}),a.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto leading-relaxed",children:"Upload PDF documents, Word files, or images up to 10MB each. Your files are encrypted and securely stored."}),a.jsxs("button",{type:"button",onClick:()=>{var C;return(C=u.current)==null?void 0:C.click()},className:"inline-flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl font-semibold text-lg shadow-lg hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl hover:scale-105 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-500/30",children:[a.jsx(nv,{className:"w-5 h-5"}),"Choose Files"]}),a.jsxs("div",{className:"mt-6 flex items-center justify-center gap-6 text-sm text-gray-500",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-4 h-4 text-red-500"}),a.jsx("span",{children:"PDF"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Is,{className:"w-4 h-4 text-blue-500"}),a.jsx("span",{children:"Word"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(rc,{className:"w-4 h-4 text-green-500"}),a.jsx("span",{children:"Images"})]})]}),a.jsx("input",{ref:u,type:"file",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:j,className:"sr-only"})]})})]}),n.length>0&&a.jsxs("div",{className:"mb-8",children:[a.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:["Uploaded Documents (",n.length,")"]}),a.jsx("div",{className:"space-y-3",children:n.map(C=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[L(C.file.type),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:C.file.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[A(C.file.size)," • ",C.file.type.split("/")[1].toUpperCase()]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[C.status==="completed"&&a.jsx(_s,{className:"w-5 h-5 text-green-500"}),a.jsx("button",{type:"button",onClick:()=>S(C.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"Remove document",children:a.jsx(vp,{className:"w-4 h-4"})})]})]},C.id))})]}),a.jsxs("div",{className:"mb-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Saved Documents"}),a.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-emerald-50 to-green-50 rounded-full border border-emerald-200",children:[a.jsx(_s,{className:"w-5 h-5 text-emerald-600"}),a.jsx("span",{className:"text-emerald-700 font-semibold",children:p?"Loading...":`${h.length} files stored`})]})]}),h.length===0&&!p?a.jsxs("div",{className:"relative p-12 border-2 border-dashed border-gray-200 rounded-2xl bg-gradient-to-br from-gray-50 to-slate-50 text-center",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 flex items-center justify-center",children:a.jsx(Is,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No documents saved yet"}),a.jsx("p",{className:"text-gray-500 max-w-sm mx-auto",children:"Upload supporting documents above to strengthen your application and they'll appear here."})]}):a.jsx("div",{className:"grid gap-4",children:h.map((C,B)=>{var U;return a.jsxs("div",{className:"group relative bg-gradient-to-r from-white to-gray-50 rounded-xl border border-gray-200 p-6 hover:shadow-lg hover:border-blue-300 transition-all duration-200",children:[a.jsx("div",{className:"absolute -top-2 -left-2 w-8 h-8 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-full flex items-center justify-center text-sm font-bold shadow-lg",children:B+1}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center",children:L(String(C.file_type||"application/pdf"))}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-gray-900 text-lg",children:C.file_name}),a.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[C.file_size&&a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-md font-medium",children:A(Number(C.file_size))}),C.file_type&&a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-md font-medium",children:(U=String(C.file_type).split("/").pop())==null?void 0:U.toUpperCase()}),a.jsxs("span",{className:"text-gray-500 text-sm",children:["Uploaded ",C.created_at?new Date(C.created_at).toLocaleDateString():"recently"]})]})]})]}),a.jsx("div",{className:"flex items-center gap-3",children:C.file_url?a.jsxs("a",{href:C.file_url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg font-semibold hover:from-blue-700 hover:to-indigo-700 hover:shadow-lg transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-500/30",children:[a.jsx(IM,{className:"w-4 h-4"}),"Open"]}):a.jsx("div",{className:"px-4 py-2 bg-gray-100 text-gray-500 rounded-lg",children:"No preview"})})]})]},C.id||`${C.file_name}-${C.created_at}`)})})]}),a.jsxs("div",{className:"relative bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border border-blue-200 rounded-2xl p-8 mb-10 overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 opacity-5",children:[a.jsx("div",{className:"absolute top-4 right-4 w-32 h-32 bg-blue-600 rounded-full"}),a.jsx("div",{className:"absolute bottom-4 left-4 w-24 h-24 bg-indigo-600 rounded-full"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center",children:a.jsx(c1,{className:"w-6 h-6 text-white"})}),a.jsx("h4",{className:"text-xl font-bold text-blue-900",children:"Strengthen Your Application"})]}),a.jsx("p",{className:"text-blue-800 mb-6 leading-relaxed",children:"This step is optional but recommended. Adding supporting documents can significantly improve your approval chances and potentially secure better terms."}),a.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold text-blue-900 mb-3",children:"Recommended Documents:"}),a.jsxs("ul",{className:"space-y-2 text-blue-800",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(_s,{className:"w-4 h-4 text-emerald-600 flex-shrink-0"}),"Business licenses and permits"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(_s,{className:"w-4 h-4 text-emerald-600 flex-shrink-0"}),"Letters of recommendation"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(_s,{className:"w-4 h-4 text-emerald-600 flex-shrink-0"}),"Contracts or purchase orders"]})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold text-blue-900 mb-3",children:"Additional Options:"}),a.jsxs("ul",{className:"space-y-2 text-blue-800",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(_s,{className:"w-4 h-4 text-emerald-600 flex-shrink-0"}),"Financial statements"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(_s,{className:"w-4 h-4 text-emerald-600 flex-shrink-0"}),"Tax returns"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx(_s,{className:"w-4 h-4 text-emerald-600 flex-shrink-0"}),"Other business documents"]})]})]})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-8 border-t border-gray-200",children:[a.jsxs("button",{type:"button",onClick:e,disabled:c,className:"inline-flex items-center gap-3 px-6 py-3 text-gray-700 bg-white border-2 border-gray-300 rounded-xl font-semibold hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4 focus:ring-gray-500/20",children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 17l-5-5m0 0l5-5m-5 5h12"})}),"Back to Bank Statement"]}),a.jsx("button",{type:"button",onClick:E,disabled:c||t,className:`inline-flex items-center gap-3 px-8 py-4 rounded-xl font-bold text-lg shadow-lg transition-all duration-200 focus:outline-none focus:ring-4 ${c||t?"bg-gradient-to-r from-gray-300 to-gray-400 text-white cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700 hover:shadow-xl hover:scale-105 focus:ring-blue-500/30"}`,children:c?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing Documents…"]}):a.jsxs(a.Fragment,{children:["Continue to Lender Matches",a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})]})]})})]})})};function I$(s){const e=u=>{try{return JSON.parse(u)}catch{const h=u.match(/(?:\{|\[)[\s\S]*(?:\}|\])/);if(h)try{return JSON.parse(h[0])}catch{}return null}},t=u=>u&&typeof u=="object"&&!Array.isArray(u)?u:null;let r=s;typeof r=="string"&&(r=e(r)??{});const n=t(r)??{};let i=n;const o=n.output;if(typeof o=="string"){const u=e(o);u&&(i=u)}else o&&typeof o=="object"&&(i=o);const l=[i,i==null?void 0:i.data,i==null?void 0:i.result,i==null?void 0:i.payload,n,n.data,n.result,n.payload,n.matches].filter(u=>u!==void 0);let c=l.find(u=>Array.isArray(u));if(Array.isArray(c)&&c.length===1&&typeof c[0]=="object"&&c[0]!==null){const u=c[0].ranked_matches;Array.isArray(u)&&(c=u)}if(!c)for(const u of l){const h=t(u);if(h&&Array.isArray(h.matches)){c=h.matches;break}if(h&&Array.isArray(h.ranked_matches)){c=h.ranked_matches;break}}return Array.isArray(c)?c.map(u=>{const h=(u==null?void 0:u.lender_id)||(u==null?void 0:u.id)||(u==null?void 0:u.lenderId)||(u==null?void 0:u.lenderID)||null,m=(u==null?void 0:u.match_score)||(u==null?void 0:u.score)||(u==null?void 0:u.matchScore)||(u==null?void 0:u.qualification_score),p=typeof m=="number"?m:Number(m);return typeof h=="string"&&Number.isFinite(p)?{lender_id:h,match_score:p}:null}).filter(u=>u!==null):[]}const f5=s=>{var e,t,r,n,i,o,l,c,d,u,h,m,p,x,w,S,b,v,N,j,E,A,L,C,B;return{id:s.id??"",businessName:s.businessName??"",monthlyRevenue:((e=s.financialInfo)==null?void 0:e.averageMonthlyRevenue)??0,timeInBusiness:((t=s.businessInfo)==null?void 0:t.yearsInBusiness)??0,creditScore:s.creditScore??0,industry:s.industry??"",requestedAmount:s.requestedAmount??0,status:"draft",ownerName:((r=s.contactInfo)==null?void 0:r.ownerName)??"",email:((n=s.contactInfo)==null?void 0:n.email)??"",phone:((i=s.contactInfo)==null?void 0:i.phone)??"",address:((o=s.contactInfo)==null?void 0:o.address)??"",ein:((l=s.businessInfo)==null?void 0:l.ein)??"",businessType:((c=s.businessInfo)==null?void 0:c.businessType)??"",yearsInBusiness:((d=s.businessInfo)==null?void 0:d.yearsInBusiness)??0,numberOfEmployees:((u=s.businessInfo)==null?void 0:u.numberOfEmployees)??0,annualRevenue:((h=s.financialInfo)==null?void 0:h.annualRevenue)??0,monthlyDeposits:((m=s.financialInfo)==null?void 0:m.averageMonthlyDeposits)??0,existingDebt:((p=s.financialInfo)==null?void 0:p.existingDebt)??0,documents:s.documents??[],contactInfo:{ownerName:((x=s.contactInfo)==null?void 0:x.ownerName)??"",email:((w=s.contactInfo)==null?void 0:w.email)??"",phone:((S=s.contactInfo)==null?void 0:S.phone)??"",address:((b=s.contactInfo)==null?void 0:b.address)??""},businessInfo:{ein:((v=s.businessInfo)==null?void 0:v.ein)??"",businessType:((N=s.businessInfo)==null?void 0:N.businessType)??"",yearsInBusiness:((j=s.businessInfo)==null?void 0:j.yearsInBusiness)??0,numberOfEmployees:((E=s.businessInfo)==null?void 0:E.numberOfEmployees)??0},financialInfo:{annualRevenue:((A=s.financialInfo)==null?void 0:A.annualRevenue)??0,averageMonthlyRevenue:((L=s.financialInfo)==null?void 0:L.averageMonthlyRevenue)??0,averageMonthlyDeposits:((C=s.financialInfo)==null?void 0:C.averageMonthlyDeposits)??0,existingDebt:((B=s.financialInfo)==null?void 0:B.existingDebt)??0}}},R$=({initialStep:s,initialApplicationId:e,lockedLenderIds:t=[]})=>{const{user:r}=Wd(),[n,i]=ne.useState("application"),[o,l]=ne.useState(null),[c,d]=ne.useState(null),[u,h]=ne.useState(null),[m,p]=ne.useState(null),[x,w]=ne.useState([]),[S,b]=ne.useState(!1),[v,N]=ne.useState(null),[j,E]=ne.useState(null);ne.useEffect(()=>{(async()=>{if(s==="matches"&&e)try{const D=await vu(e);if(D){let M=Array.isArray(D.documents)?D.documents:[];if(!M||M.length===0)try{M=(await Jo(e)||[]).map(K=>K.file_name).filter(Boolean)}catch(q){console.warn("Failed to load application_documents for edit prefill:",q),M=[]}const $={id:D.id,businessName:D.business_name,monthlyRevenue:D.monthly_revenue,timeInBusiness:D.years_in_business,creditScore:D.credit_score,industry:D.industry,requestedAmount:D.requested_amount,status:D.status,ownerName:D.owner_name,email:D.email,phone:D.phone,address:D.address,ein:D.ein,businessType:D.business_type,yearsInBusiness:D.years_in_business,numberOfEmployees:D.number_of_employees,annualRevenue:D.annual_revenue,monthlyDeposits:D.monthly_deposits,existingDebt:D.existing_debt,documents:D.documents??[],contactInfo:{ownerName:D.owner_name,email:D.email,phone:D.phone,address:D.address},businessInfo:{ein:D.ein,businessType:D.business_type,yearsInBusiness:D.years_in_business,numberOfEmployees:D.number_of_employees},financialInfo:{annualRevenue:D.annual_revenue,averageMonthlyRevenue:D.monthly_revenue,averageMonthlyDeposits:D.monthly_deposits,existingDebt:D.existing_debt}};d($),i("matches")}}catch(D){console.warn("Failed to preload application for matches:",D)}})()},[s,e]),ne.useEffect(()=>{(async()=>{if(s==="application"&&e)try{const D=await vu(e);if(D){let M=Array.isArray(D.documents)?D.documents:[];if(!M||M.length===0)try{M=(await Jo(e)||[]).map(R=>R.file_name).filter(Boolean)}catch(Ne){console.warn("Failed to load application_documents for edit prefill:",Ne),M=[]}const $=D.date_of_birth??D.dateBirth??"",q=(()=>{if(!$)return"";const Ne=new Date($);return isNaN(Ne.getTime())?$:Ne.toLocaleDateString("en-US")})(),K={id:D.id,businessName:D.business_name,industry:D.industry,requestedAmount:D.requested_amount,creditScore:D.credit_score,documents:M,contactInfo:{ownerName:D.owner_name,email:D.email,phone:D.phone??"",address:D.address??"",dateOfBirth:q},businessInfo:{ein:D.ein??"",businessType:D.business_type??"",yearsInBusiness:D.years_in_business??0,numberOfEmployees:D.number_of_employees??0},financialInfo:{annualRevenue:D.annual_revenue??0,averageMonthlyRevenue:D.monthly_revenue??0,averageMonthlyDeposits:D.monthly_deposits??0,existingDebt:D.existing_debt??0}};p(K);const de=f5(K);d(de),i("application")}}catch(D){console.warn("Failed to preload application for editing:",D)}})()},[s,e]),ne.useEffect(()=>{(async()=>{if(s==="intermediate"&&e)try{const D=await vu(e);if(D){let M=Array.isArray(D.documents)?D.documents:[];if(!M||M.length===0)try{M=(await Jo(e)||[]).map(K=>K.file_name).filter(Boolean)}catch{M=[]}const $={id:D.id,businessName:D.business_name,monthlyRevenue:D.monthly_revenue,timeInBusiness:D.years_in_business,creditScore:D.credit_score,industry:D.industry,requestedAmount:D.requested_amount,status:D.status,ownerName:D.owner_name,email:D.email,phone:D.phone,address:D.address,ein:D.ein,businessType:D.business_type,yearsInBusiness:D.years_in_business,numberOfEmployees:D.number_of_employees,annualRevenue:D.annual_revenue,monthlyDeposits:D.monthly_deposits,existingDebt:D.existing_debt,documents:D.documents??[],contactInfo:{ownerName:D.owner_name,email:D.email,phone:D.phone,address:D.address},businessInfo:{ein:D.ein,businessType:D.business_type,yearsInBusiness:D.years_in_business,numberOfEmployees:D.number_of_employees},financialInfo:{annualRevenue:D.annual_revenue,averageMonthlyRevenue:D.monthly_revenue,averageMonthlyDeposits:D.monthly_deposits,existingDebt:D.existing_debt}};d($),i("intermediate")}}catch{}})()},[s,e]);const A=D=>D?{id:D.id,businessName:D.businessName,creditScore:D.creditScore,industry:D.industry,requestedAmount:D.requestedAmount,documents:D.documents??[],contactInfo:{ownerName:D.ownerName,email:D.email,phone:D.phone,address:D.address},businessInfo:{ein:D.ein,businessType:D.businessType,yearsInBusiness:D.yearsInBusiness??D.timeInBusiness,numberOfEmployees:D.numberOfEmployees},financialInfo:{annualRevenue:D.annualRevenue,averageMonthlyRevenue:D.monthlyRevenue}}:null,L=D=>({id:D.id,businessName:D.businessName,creditScore:D.creditScore,industry:D.industry,requestedAmount:D.requestedAmount,documents:D.documents,contactInfo:D.contactInfo,businessInfo:D.businessInfo,financialInfo:D.financialInfo}),C=D=>{l(n),i(D)},B=()=>{if(o){const D=o;l(n),i(D)}},U=async(D,M)=>{const $={id:D.id,businessName:D.businessName,monthlyRevenue:D.monthlyRevenue,timeInBusiness:D.timeInBusiness,creditScore:D.creditScore,industry:D.industry,requestedAmount:D.requestedAmount,status:D.status,ownerName:D.contactInfo.ownerName,email:D.contactInfo.email,phone:D.contactInfo.phone,address:D.contactInfo.address,ein:D.businessInfo.ein,businessType:D.businessInfo.businessType,yearsInBusiness:D.businessInfo.yearsInBusiness,numberOfEmployees:D.businessInfo.numberOfEmployees,annualRevenue:D.financialInfo.annualRevenue,monthlyDeposits:D.financialInfo.averageMonthlyDeposits,existingDebt:D.financialInfo.existingDebt,documents:D.documents,contactInfo:D.contactInfo,businessInfo:D.businessInfo,financialInfo:D.financialInfo};if(!!(m&&$.id)){try{const K={business_name:$.businessName,owner_name:$.ownerName,email:$.email,phone:$.phone||"",address:$.address||"",ein:$.ein||"",business_type:$.businessType||"",industry:$.industry,years_in_business:$.yearsInBusiness??$.timeInBusiness??0,number_of_employees:$.numberOfEmployees??0,annual_revenue:$.annualRevenue??0,monthly_revenue:$.monthlyRevenue??0,monthly_deposits:$.monthlyDeposits??0,existing_debt:$.existingDebt??0,credit_score:$.creditScore??0,requested_amount:$.requestedAmount??0,status:$.status||"submitted",documents:Array.isArray($.documents)?$.documents:[]};await Cp($.id,K)}catch(K){console.warn("[SubmissionsPortal] Failed to update application on edit submit:",K)}d($),N(null),b(!1),C("intermediate");return}d($),b(!0),N(null),C("bank"),(async()=>{var K;try{if(M!=null&&M.pdfFile&&!v){console.log("[newDeal] starting POST to /.netlify/functions/new-deal with file:",{name:M.pdfFile.name,size:M.pdfFile.size,type:M.pdfFile.type});const de="/.netlify/functions/new-deal",Ne=new FormData;Ne.append("file",M.pdfFile,M.pdfFile.name),D.id&&Ne.append("application_id",D.id),D.businessName&&Ne.append("business_name",D.businessName),(K=D.contactInfo)!=null&&K.ownerName&&Ne.append("owner_name",D.contactInfo.ownerName);const R=await fetch(de,{method:"POST",body:Ne});console.log("[newDeal] response status:",R.status,R.statusText),console.log("[newDeal] response content-type:",R.headers?R.headers.get("content-type"):"(no headers)");let W={},Z={};try{const oe=await R.text();if(console.log("[newDeal] raw body:",oe),oe)try{Z=JSON.parse(oe)}catch{const et=oe.match(/\[[\s\S]*?\]/),pe=oe.match(/\{[\s\S]*\}/);if(et)try{Z=JSON.parse(et[0])}catch{Z={}}else if(pe)try{Z=JSON.parse(pe[0])}catch{Z={}}else Z={}}}catch{Z={}}Array.isArray(Z)&&console.log("[newDeal] parsed array length:",Z.length),Array.isArray(Z)&&Z.length>0&&typeof Z[0]=="object"&&Z[0]!==null?W=Z[0]:Z&&typeof Z=="object"&&!Array.isArray(Z)?W=Z:W={},console.log("[newDeal] parsed normalized root object:",W);const ue={"Entity Type":W["Entity Type"]??null,State:W.State??null,"Gross Annual Revenue":W["Gross Annual Revenue"]??null,"Avg Daily Balance":W["Avg Daily Balance"]??null,"Avg Monthly Deposit Count":W["Avg Monthly Deposit Count"]??null,"NSF Count":W["NSF Count"]??null,"Negative Days":W["Negative Days"]??null,"Current Position Count":W["Current Position Count"]??null,Holdback:W.Holdback??null};console.log("[newDeal] expected-key preview:",ue);const ce={},ye=(oe,et="")=>{if(oe&&typeof oe=="object")for(const[pe,xe]of Object.entries(oe)){const he=et?`${et}.${pe}`:pe;xe&&typeof xe=="object"&&!Array.isArray(xe)?ye(xe,he):ce[he]=xe}};ye(W);const Se=oe=>oe.toLowerCase().replace(/[^a-z0-9]/g,""),Ee={};for(const[oe,et]of Object.entries({...W,...ce}))Ee[Se(oe)]=et;const De=oe=>{for(const et of oe){const pe=Se(et),xe=Ee[pe];if(xe!=null){if(typeof xe=="string"){if(xe.trim()!=="")return xe}else if(typeof xe=="number"||typeof xe=="boolean")return String(xe)}}return""},We=oe=>oe?oe.replace(/[^0-9.-]/g,""):"",Je={},it=oe=>typeof W[oe]=="string"||typeof W[oe]=="number"||typeof W[oe]=="boolean"?String(W[oe]):"";Je.entityType=it("Entity Type"),Je.state=it("State"),Je.grossAnnualRevenue=We(it("Gross Annual Revenue")),Je.avgDailyBalance=We(it("Avg Daily Balance")),Je.avgMonthlyDepositCount=We(it("Avg Monthly Deposit Count")),Je.nsfCount=We(it("NSF Count")),Je.negativeDays=We(it("Negative Days")),Je.currentPositionCount=We(it("Current Position Count")),Je.holdback=We(it("Holdback")),Je.entityType=Je.entityType||De(["Entity Type","Business Type","Entity","Business Entity"]),Je.state=Je.state||De(["State","Business State","Company State"]),Je.grossAnnualRevenue=Je.grossAnnualRevenue||We(De(["Gross Annual Revenue","Annual Revenue","Yearly Revenue","Gross Annual Sales"])),Je.avgDailyBalance=Je.avgDailyBalance||We(De(["Avg Daily Balance","Average Daily Balance"])),Je.avgMonthlyDepositCount=Je.avgMonthlyDepositCount||We(De(["Avg Monthly Deposit Count","Average Monthly Deposit Count"])),Je.nsfCount=Je.nsfCount||We(De(["NSF Count","NSF","NSFCount"])),Je.negativeDays=Je.negativeDays||We(De(["Negative Days","Days Negative"])),Je.currentPositionCount=Je.currentPositionCount||We(De(["Current Position Count","Positions","Current Positions"])),Je.holdback=Je.holdback||We(De(["Holdback","Hold Back","Hold-back"])),Je.creditScore=We(De(["Credit Score","FICO","FICO Score"]));const Be=De(["Time in Biz","Time In Business","Months In Business","Years In Business"]);if(Be){const oe=Number(We(Be));isNaN(oe)?Je.timeInBiz=Be:Je.timeInBiz=String(oe<=10?Math.round(oe*12):Math.round(oe))}Je.avgMonthlyRevenue=We(De(["Avg Monthly Revenue","Average Monthly Revenue","Monthly Revenue"]));const Te=(oe,et)=>oe&&String(oe).trim()!==""?oe:et==null?"":String(et);if(Je.entityType=Te(Je.entityType,$.businessType),!Je.state||String(Je.state).trim()===""){const et=($.address||"").match(/\b([A-Z]{2})\b(?:\s+\d{5}(?:-\d{4})?)?$/);et&&(Je.state=et[1])}Je.grossAnnualRevenue=Te(Je.grossAnnualRevenue,$.annualRevenue),Je.avgMonthlyDepositCount=Te(Je.avgMonthlyDepositCount,$.monthlyDeposits),Je.creditScore=Te(Je.creditScore,$.creditScore),Je.timeInBiz=Te(Je.timeInBiz,$.timeInBusiness),Je.avgMonthlyRevenue=Te(Je.avgMonthlyRevenue,$.monthlyRevenue),console.log("[newDeal] final normalized prefill:",Je),N(Je)}}catch(de){console.warn("PDF webhook failed:",de),N(null)}finally{b(!1)}})()},P=D=>{if(!c){C("matches");return}console.log("[SubmissionsPortal] Details from SubmissionIntermediate:",D),console.log("[SubmissionsPortal] Current application values:",{monthlyRevenue:c.monthlyRevenue,creditScore:c.creditScore,requestedAmount:c.requestedAmount});const M={...c,monthlyRevenue:D.monthlyRevenue?Number(D.monthlyRevenue):c.monthlyRevenue,creditScore:D.creditScore?Number(D.creditScore):c.creditScore,requestedAmount:D.requestedAmount?Number(D.requestedAmount):c.requestedAmount};console.log("[SubmissionsPortal] Updated application values:",{monthlyRevenue:M.monthlyRevenue,creditScore:M.creditScore,requestedAmount:M.requestedAmount}),d(M),(async()=>{try{b(!0);const $=R=>typeof R=="string"&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(R);let q=M;if(!$(q.id)){const R=D.applicationId||c.id;if($(R))q={...q,id:R},d(W=>W?{...W,id:R}:q);else{console.warn("No valid application id available; skipping lenders webhook to avoid creating a new row."),b(!1);return}}let K=null;try{K=await vu(q.id)}catch(R){console.warn("Failed to fetch latest application row; falling back to in-memory state:",R)}const de=K??{id:q.id,business_name:q.businessName,owner_name:q.ownerName,email:q.email,phone:q.phone||"",address:q.address||"",ein:q.ein||"",business_type:q.businessType||"",industry:q.industry,years_in_business:q.yearsInBusiness??q.timeInBusiness??0,number_of_employees:q.numberOfEmployees??0,annual_revenue:q.annualRevenue??0,monthly_revenue:q.monthlyRevenue??0,monthly_deposits:q.monthlyDeposits??0,existing_debt:q.existingDebt??0,credit_score:q.creditScore??0,requested_amount:q.requestedAmount??0,status:q.status||"submitted",documents:Array.isArray(q.documents)?q.documents:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()},Ne=await fetch("/.netlify/functions/applications-lenders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(de)});try{if(!Ne.ok)console.warn("applications/lenders webhook non-OK status:",Ne.status,Ne.statusText),E(null);else{const R=await Ne.text();if(!R||R.trim().length===0)E(null);else try{const W=JSON.parse(R),Z=I$(W);E(Z)}catch(W){console.warn("Failed to parse cleaned matches from webhook response:",W),E(null)}}}catch(R){console.warn("Failed handling applications/lenders webhook response:",R),E(null)}}catch($){console.warn("applications/lenders webhook failed:",$),E(null)}finally{b(!1),C("additional-documents")}})()},T=D=>{w(D),C("recap")},z=()=>{C("matches")},H=()=>{console.log("Final submission completed")};return a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Submissions Portal"}),a.jsx("p",{className:"text-gray-600",children:"Submit your merchant cash advance application and get matched with qualified lenders"})]}),a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:`flex items-center ${n==="application"?"text-blue-600":c?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${c?"bg-green-100 text-green-600":n==="application"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:c?a.jsx(_s,{className:"w-5 h-5"}):"1"}),a.jsx("span",{className:"ml-2 text-sm font-medium",children:"Document Upload & Application"})]}),a.jsx("div",{className:`flex-1 h-1 mx-4 ${c?"bg-green-200":"bg-gray-200"}`}),a.jsxs("div",{className:`flex items-center ${n==="bank"?"text-blue-600":n!=="application"?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${n==="bank"?"bg-blue-100 text-blue-600":n!=="application"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"}`,children:n!=="application"?a.jsx(_s,{className:"w-5 h-5"}):"2"}),a.jsx("span",{className:"ml-2 text-sm font-medium",children:"Bank Statement"})]}),a.jsx("div",{className:`flex-1 h-1 mx-4 ${n!=="application"&&n!=="bank"?"bg-green-200":"bg-gray-200"}`}),a.jsxs("div",{className:`flex items-center ${n==="additional-documents"?"text-blue-600":n==="matches"||n==="recap"?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${n==="matches"||n==="recap"?"bg-green-100 text-green-600":n==="additional-documents"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:n==="matches"||n==="recap"?a.jsx(_s,{className:"w-5 h-5"}):"3"}),a.jsx("span",{className:"ml-2 text-sm font-medium",children:"Additional Documents"})]}),a.jsx("div",{className:`flex-1 h-1 mx-4 ${n==="matches"||n==="recap"?"bg-green-200":"bg-gray-200"}`}),a.jsxs("div",{className:`flex items-center ${n==="matches"?"text-blue-600":x.length>0?"text-green-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${x.length>0?"bg-green-100 text-green-600":n==="matches"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:x.length>0?a.jsx(_s,{className:"w-5 h-5"}):"4"}),a.jsx("span",{className:"ml-2 text-sm font-medium",children:"Lender Matches"})]}),a.jsx("div",{className:`flex-1 h-1 mx-4 ${x.length>0?"bg-green-200":"bg-gray-200"}`}),a.jsxs("div",{className:`flex items-center ${n==="recap"?"text-blue-600":"text-gray-400"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${n==="recap"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:"5"}),a.jsx("span",{className:"ml-2 text-sm font-medium",children:"Submission Recap"})]})]})}),n==="application"?s==="application"&&e&&!m?a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-10 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-4 border-blue-200 border-t-blue-600 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600 text-sm",children:"Loading application..."})]})}):a.jsx(IP,{initialStep:m?"form":"upload",reviewMode:!!m,reviewInitial:m,reviewDocName:m!=null&&m.documents&&m.documents.length>0?m.documents[0]:null,onSubmit:U,onReviewSubmit:D=>{var $,q,K,de,Ne,R,W,Z,ue,ce,ye,Se,Ee,De,We;const M={id:D.id,businessName:D.businessName,monthlyRevenue:(($=D.financialInfo)==null?void 0:$.averageMonthlyRevenue)??D.monthlyRevenue??0,timeInBusiness:((q=D.businessInfo)==null?void 0:q.yearsInBusiness)??D.timeInBusiness??0,creditScore:D.creditScore??0,industry:D.industry??"",requestedAmount:D.requestedAmount??0,status:D.status||"submitted",contactInfo:{ownerName:((K=D.contactInfo)==null?void 0:K.ownerName)??"",email:((de=D.contactInfo)==null?void 0:de.email)??"",phone:((Ne=D.contactInfo)==null?void 0:Ne.phone)??"",dateOfBirth:((R=D.contactInfo)==null?void 0:R.dateOfBirth)??"",address:((W=D.contactInfo)==null?void 0:W.address)??""},businessInfo:{ein:((Z=D.businessInfo)==null?void 0:Z.ein)??"",businessType:((ue=D.businessInfo)==null?void 0:ue.businessType)??"",yearsInBusiness:((ce=D.businessInfo)==null?void 0:ce.yearsInBusiness)??0,numberOfEmployees:((ye=D.businessInfo)==null?void 0:ye.numberOfEmployees)??0},financialInfo:{annualRevenue:((Se=D.financialInfo)==null?void 0:Se.annualRevenue)??0,averageMonthlyRevenue:((Ee=D.financialInfo)==null?void 0:Ee.averageMonthlyRevenue)??D.monthlyRevenue??0,averageMonthlyDeposits:((De=D.financialInfo)==null?void 0:De.averageMonthlyDeposits)??0,existingDebt:((We=D.financialInfo)==null?void 0:We.existingDebt)??0},documents:Array.isArray(D.documents)?D.documents:[]};U(M,null)},onReadyForForm:D=>{console.log("[SubmissionsPortal] onReadyForForm prefill:",D),h(D);try{if(D){const M=f5(D);d(M)}}catch(M){console.warn("Failed to map prefill to AppData:",M)}m||setTimeout(()=>{C("bank")},0)}},m?`edit-${e}`:"new"):n==="bank"?a.jsx(h9,{onContinue:async D=>{var M,$,q,K,de,Ne,R,W,Z,ue,ce,ye,Se,Ee,De,We,Je,it,Be,Te,oe,et,pe,xe;if(D){b(!0);const he={...c||f5(D),id:D.id||(c==null?void 0:c.id)||"",businessName:D.businessName||(c==null?void 0:c.businessName)||"",creditScore:Number(D.creditScore??(c==null?void 0:c.creditScore)??0),industry:D.industry||(c==null?void 0:c.industry)||"",requestedAmount:Number(D.requestedAmount??(c==null?void 0:c.requestedAmount)??0),ownerName:((M=D.contactInfo)==null?void 0:M.ownerName)||(c==null?void 0:c.ownerName)||"",email:(($=D.contactInfo)==null?void 0:$.email)||(c==null?void 0:c.email)||"",phone:((q=D.contactInfo)==null?void 0:q.phone)||(c==null?void 0:c.phone),address:((K=D.contactInfo)==null?void 0:K.address)||(c==null?void 0:c.address),ein:((de=D.businessInfo)==null?void 0:de.ein)||(c==null?void 0:c.ein),businessType:((Ne=D.businessInfo)==null?void 0:Ne.businessType)||(c==null?void 0:c.businessType),yearsInBusiness:Number(((R=D.businessInfo)==null?void 0:R.yearsInBusiness)??(c==null?void 0:c.yearsInBusiness)??(c==null?void 0:c.timeInBusiness)??0),numberOfEmployees:Number(((W=D.businessInfo)==null?void 0:W.numberOfEmployees)??(c==null?void 0:c.numberOfEmployees)??0),annualRevenue:Number(((Z=D.financialInfo)==null?void 0:Z.annualRevenue)??(c==null?void 0:c.annualRevenue)??0),monthlyRevenue:Number(((ue=D.financialInfo)==null?void 0:ue.averageMonthlyRevenue)??(c==null?void 0:c.monthlyRevenue)??0),monthlyDeposits:Number(((ce=D.financialInfo)==null?void 0:ce.averageMonthlyDeposits)??(c==null?void 0:c.monthlyDeposits)??0),existingDebt:Number(((ye=D.financialInfo)==null?void 0:ye.existingDebt)??(c==null?void 0:c.existingDebt)??0),documents:Array.isArray(D.documents)?D.documents:(c==null?void 0:c.documents)??[],status:D.status||(c==null?void 0:c.status),contactInfo:{ownerName:((Se=D.contactInfo)==null?void 0:Se.ownerName)||(c==null?void 0:c.contactInfo.ownerName)||"",email:((Ee=D.contactInfo)==null?void 0:Ee.email)||(c==null?void 0:c.contactInfo.email)||"",phone:((De=D.contactInfo)==null?void 0:De.phone)||(c==null?void 0:c.contactInfo.phone)||"",address:((We=D.contactInfo)==null?void 0:We.address)||(c==null?void 0:c.contactInfo.address)||""},businessInfo:{ein:((Je=D.businessInfo)==null?void 0:Je.ein)||(c==null?void 0:c.businessInfo.ein)||"",businessType:((it=D.businessInfo)==null?void 0:it.businessType)||(c==null?void 0:c.businessInfo.businessType)||"",yearsInBusiness:Number(((Be=D.businessInfo)==null?void 0:Be.yearsInBusiness)??(c==null?void 0:c.businessInfo.yearsInBusiness)??0),numberOfEmployees:Number(((Te=D.businessInfo)==null?void 0:Te.numberOfEmployees)??(c==null?void 0:c.businessInfo.numberOfEmployees)??0)},financialInfo:{annualRevenue:Number(((oe=D.financialInfo)==null?void 0:oe.annualRevenue)??(c==null?void 0:c.financialInfo.annualRevenue)??0),averageMonthlyRevenue:Number(((et=D.financialInfo)==null?void 0:et.averageMonthlyRevenue)??(c==null?void 0:c.financialInfo.averageMonthlyRevenue)??0),averageMonthlyDeposits:Number(((pe=D.financialInfo)==null?void 0:pe.averageMonthlyDeposits)??(c==null?void 0:c.financialInfo.averageMonthlyDeposits)??0),existingDebt:Number(((xe=D.financialInfo)==null?void 0:xe.existingDebt)??(c==null?void 0:c.financialInfo.existingDebt)??0)}};if(!he.id||String(he.id).trim()==="")try{const we={business_name:he.businessName,owner_name:he.ownerName,email:he.email,phone:he.phone||"",address:he.address||"",ein:he.ein||"",business_type:he.businessType||"",industry:he.industry,years_in_business:he.yearsInBusiness??he.timeInBusiness??0,number_of_employees:he.numberOfEmployees??0,annual_revenue:he.annualRevenue??0,monthly_revenue:he.monthlyRevenue??0,monthly_deposits:he.monthlyDeposits??0,existing_debt:he.existingDebt??0,credit_score:he.creditScore??0,requested_amount:he.requestedAmount??0,status:he.status||"submitted",documents:Array.isArray(he.documents)?he.documents:[],user_id:r==null?void 0:r.id};console.log("[SubmissionsPortal] No application ID; creating draft in Supabase with:",we),console.log("[SubmissionsPortal] User ID being added:",r==null?void 0:r.id);const Ae=await g2(we);console.log("[SubmissionsPortal] Draft created. New ID:",Ae.id);const Ze={...he,id:Ae.id};d(Ze),C("intermediate")}catch(we){console.warn("Failed to create draft application before intermediate step:",we),d(he),C("intermediate")}else d(he),C("intermediate");h(D),b(!1)}else C("intermediate")},onReplaceDocument:()=>C("application"),application:u?L(u):A(c)}):n==="intermediate"?a.jsx(P$,{initial:{id:(c==null?void 0:c.id)??"",applicationId:(c==null?void 0:c.id)??"",business_name:(c==null?void 0:c.businessName)??"",owner_name:(c==null?void 0:c.ownerName)??"",dealName:(v==null?void 0:v.dealName)??(c==null?void 0:c.businessName)??"",industry:(v==null?void 0:v.industry)??(c==null?void 0:c.industry)??"",entityType:(v==null?void 0:v.entityType)??(c==null?void 0:c.businessType)??"",state:(v==null?void 0:v.state)??"",creditScore:String((c==null?void 0:c.creditScore)!==void 0&&(c==null?void 0:c.creditScore)!==null?c.creditScore:(v==null?void 0:v.creditScore)??""),timeInBiz:(v==null?void 0:v.timeInBiz)??String((c==null?void 0:c.timeInBusiness)??""),avgMonthlyRevenue:(v==null?void 0:v.avgMonthlyRevenue)??String((c==null?void 0:c.monthlyRevenue)??""),requestedAmount:(v==null?void 0:v.requestedAmount)??String((c==null?void 0:c.requestedAmount)??""),grossAnnualRevenue:(v==null?void 0:v.grossAnnualRevenue)??String((c==null?void 0:c.annualRevenue)??""),avgDailyBalance:(v==null?void 0:v.avgDailyBalance)??"",nsfCount:(v==null?void 0:v.nsfCount)??"",negativeDays:(v==null?void 0:v.negativeDays)??"",currentPositionCount:(v==null?void 0:v.currentPositionCount)??"",holdback:(v==null?void 0:v.holdback)??"",hasBankruptcies:!!(v!=null&&v.hasBankruptcies)||!1,hasOpenJudgments:!!(v!=null&&v.hasOpenJudgments)||!1},loading:S,onBack:B,onContinue:P}):n==="additional-documents"?a.jsx(T$,{applicationId:c==null?void 0:c.id,onBack:B,onContinue:()=>C("matches")}):n==="matches"?a.jsx(m9,{application:c,matches:j??void 0,onBack:B,onLenderSelect:T,lockedLenderIds:t}):a.jsx(p9,{application:c?{...c,status:["draft","submitted","under-review","matched"].includes(String(c.status))?c.status:"submitted"}:null,selectedLenderIds:x,onBack:z,onSubmit:H})]})},D$=()=>{const[s,e]=ne.useState("applications"),[t,r]=ne.useState(!1),[n,i]=ne.useState(null),[o,l]=ne.useState(!1),[c,d]=ne.useState(!1),[u,h]=ne.useState(()=>localStorage.getItem("mcaPortalEmailTemplate")||`Subject: Merchant Cash Advance Application - {{businessName}}

Dear {{lenderName}} Team,

I hope this email finds you well. I am writing to submit a merchant cash advance application for your review and consideration.

BUSINESS INFORMATION:
• Business Name: {{businessName}}
• Owner: {{ownerName}}
• Industry: {{industry}}
• Years in Business: {{yearsInBusiness}}
• Business Type: {{businessType}}
• EIN: {{ein}}

FINANCIAL DETAILS:
• Requested Amount: \${{requestedAmount}}
• Monthly Revenue: \${{monthlyRevenue}}
• Annual Revenue: \${{annualRevenue}}
• Credit Score: {{creditScore}}
• Existing Debt: \${{existingDebt}}

CONTACT INFORMATION:
• Email: {{email}}
• Phone: {{phone}}
• Address: {{address}}

I have attached the following documents for your review:
• Business bank statements (last 6 months)
• Tax returns
• Completed application form
• Voided business check

Based on your underwriting guidelines, I believe this application aligns well with your lending criteria:
• Amount Range: \${{lenderMinAmount}} - \${{lenderMaxAmount}}
• Factor Rate: {{lenderFactorRate}}
• Payback Term: {{lenderPaybackTerm}}
• Approval Time: {{lenderApprovalTime}}

I would appreciate the opportunity to discuss this application further and answer any questions you may have. Please let me know if you need any additional information or documentation.

Thank you for your time and consideration. I look forward to hearing from you soon.

Best regards,
{{ownerName}}
{{businessName}}
{{email}}
{{phone}}

---
This application was submitted through MCAPortal Pro
Application ID: {{applicationId}}`),[m,p]=ne.useState(null),[x,w]=ne.useState([]),[S,b]=ne.useState([]),[v,N]=ne.useState(!0),[j,E]=ne.useState(null),[A,L]=ne.useState(!1),[C,B]=ne.useState([]),[U,P]=ne.useState(!1),[T,z]=ne.useState({}),[H,D]=ne.useState(!1),[M,$]=ne.useState(""),[q,K]=ne.useState("error"),[de,Ne]=ne.useState([]),[R,W]=ne.useState(!1),[Z,ue]=ne.useState(null),[ce,ye]=ne.useState(!1),[Se,Ee]=ne.useState(""),[De,We]=ne.useState({name:"",contactEmail:"",ccEmails:[],phone:"",status:"active",rating:4,minAmount:1e4,maxAmount:5e5,minCreditScore:550,maxCreditScore:850,minTimeInBusiness:1,minMonthlyRevenue:15e3,industries:[],factorRate:"1.1 - 1.4",paybackTerm:"3-18 months",approvalTime:"24 hours",features:[]}),[Je,it]=ne.useState(""),Be=["All Industries","Retail","Restaurant","Healthcare","Professional Services","Technology","Construction","Transportation","Manufacturing","Real Estate","Automotive","Education","Entertainment","Agriculture","Finance"],Te=["No collateral required","Same day funding","Flexible payments","Competitive rates","Larger amounts","Industry expertise","Instant approval","Bad credit OK","Fast funding","Best rates","Large amounts","Premium service","Merchant-focused","Flexible terms"];Yt.useEffect(()=>{(async()=>{try{N(!0);const[_e,at]=await Promise.all([Ig(),xE()]);w(_e),b(at.map(St=>({...St,matchedLenders:0}))),N(!1);try{const St=at.map(Tt=>Tt.id);if(St.length>0){const{data:Tt,error:Pt}=await Ct.from("lender_submissions").select("application_id").in("application_id",St);if(!Pt&&Tt){const kt={};Tt.forEach(jt=>{kt[jt.application_id]=(kt[jt.application_id]||0)+1}),b(jt=>jt.map(Rt=>({...Rt,matchedLenders:kt[Rt.id]||0})))}}}catch(St){console.warn("Background submissions count fetch failed",St)}}catch(_e){console.error("Error loading data:",_e),N(!1)}})()},[]),Yt.useEffect(()=>{(async()=>{if(s==="deal-users")try{W(!0);const[_e,at,St]=await Promise.all([im("member"),im("admin").catch(()=>[]),im("Admin").catch(()=>[])]),Tt={};[..._e,...at,...St].forEach(Pt=>{Tt[Pt.id]=Pt}),Ne(Object.values(Tt))}catch(_e){console.error("Error loading deal users:",_e)}finally{W(!1)}})()},[s]);const oe=async O=>{try{const at=(await fj(O)).map(St=>({...St,status:os(St.status)??St.status}));B(at)}catch(_e){console.error("Error loading submissions:",_e)}},et=O=>{p(O),l(!0),oe(O.id)},pe=O=>{E(O),L(!0),oe(O.id)},xe=async O=>{if(O.preventDefault(),!!j)try{const _e={};let at=!1;if(C.forEach(Pt=>{const kt=me((Pt.status||"").toString()),jt=kt==="rejected",Rt=kt==="approved",Ot=kt==="responded",Ps=kt==="pending",Fs=!Pt.response||typeof Pt.response=="string"&&Pt.response.trim()==="",Os=Pt.offered_amount==null||typeof Pt.offered_amount=="number"&&Number.isNaN(Pt.offered_amount),be=!Pt.factor_rate||typeof Pt.factor_rate=="string"&&Pt.factor_rate.trim()==="",ve=!Pt.terms||typeof Pt.terms=="string"&&Pt.terms.trim()==="";(jt||Ps)&&Fs&&(_e[Pt.id]={..._e[Pt.id]||{},responseRequired:!0},at=!0),(Rt||Ot)&&(Os||be||ve)&&(_e[Pt.id]={..._e[Pt.id]||{},...Os?{offeredRequired:!0}:{},...be?{factorRequired:!0}:{},...ve?{termsRequired:!0}:{}},at=!0)}),z(_e),at){const Pt=Object.values(_e).some(jt=>jt.responseRequired),kt=Object.values(_e).some(jt=>jt.offeredRequired||jt.factorRequired||jt.termsRequired);Pt?C.some(Rt=>me((Rt.status||"").toString())==="pending"&&(!Rt.response||typeof Rt.response=="string"&&Rt.response.trim()===""))?($("Please provide a Response for submissions marked Pending."),K("warning")):($("Please provide a Response explaining why a submission is Declined."),K("error")):kt&&($("Please fill in Offered Amount, Factor Rate, and Terms for Approved or Counter Offer submissions."),K("success")),D(!0),setTimeout(()=>D(!1),4e3);return}const St={business_name:j.business_name,owner_name:j.owner_name,email:j.email,phone:j.phone,address:j.address,ein:j.ein,business_type:j.business_type,industry:j.industry,years_in_business:j.years_in_business,number_of_employees:j.number_of_employees,annual_revenue:j.annual_revenue,monthly_revenue:j.monthly_revenue,monthly_deposits:j.monthly_deposits,existing_debt:j.existing_debt,credit_score:j.credit_score,requested_amount:j.requested_amount,status:j.status,documents:j.documents,user_id:j.user_id},Tt=await Cp(j.id,St);b(Pt=>Pt.map(kt=>kt.id===j.id?{...Tt,matchedLenders:j.matchedLenders||kt.matchedLenders}:kt)),L(!1),E(null)}catch(_e){console.error("Error updating application:",_e),alert("Error updating application")}};if(v)return a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading admin data..."})]})});const he=O=>{switch(O){case"active":case"matched":case"funded":return"bg-green-100 text-green-800";case"inactive":case"declined":case"rejected":return"bg-red-100 text-red-800";case"pending":case"under-review":case"sent":return"bg-yellow-100 text-yellow-800";case"submitted":case"responded":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},we=O=>{(async()=>{try{await _E(O),w(at=>at.filter(St=>St.id!==O))}catch(at){console.error("Error deleting lender:",at),alert("Error deleting lender. Please try again.")}})()},Ae=O=>{We({name:O.name,contactEmail:O.contact_email,ccEmails:O.cc_emails||[],phone:O.phone||"",status:O.status,rating:O.rating,minAmount:O.min_amount,maxAmount:O.max_amount,minCreditScore:O.min_credit_score,maxCreditScore:O.max_credit_score,minTimeInBusiness:O.min_time_in_business,minMonthlyRevenue:O.min_monthly_revenue,industries:O.industries,factorRate:O.factor_rate,paybackTerm:O.payback_term,approvalTime:O.approval_time,features:O.features}),i(O),r(!0)},Ze=O=>{ue(O),Ee(""),ye(!0)},$e=()=>{We({name:"",contactEmail:"",ccEmails:[],phone:"",status:"active",rating:4,minAmount:1e4,maxAmount:5e5,minCreditScore:550,maxCreditScore:850,minTimeInBusiness:1,minMonthlyRevenue:15e3,industries:[],factorRate:"1.1 - 1.4",paybackTerm:"3-18 months",approvalTime:"24 hours",features:[]}),i(null),r(!0)},Qe=()=>{const O=Je.trim(),_e=/.+@.+\..+/.test(O);!O||!_e||(We(at=>({...at,ccEmails:Array.from(new Set([...at.ccEmails||[],O]))})),it(""))},lt=O=>{We(_e=>({..._e,ccEmails:(_e.ccEmails||[]).filter(at=>at!==O)}))},At=O=>{We(_e=>({..._e,industries:_e.industries.includes(O)?_e.industries.filter(at=>at!==O):[..._e.industries,O]}))},Nt=O=>{We(_e=>({..._e,features:_e.features.includes(O)?_e.features.filter(at=>at!==O):[..._e.features,O]}))},Lt=()=>{(async()=>{try{const _e=(De.ccEmails||[]).length?{cc_emails:De.ccEmails}:{},at={name:De.name,contact_email:De.contactEmail,..._e,phone:De.phone,status:De.status,rating:De.rating,total_applications:0,approval_rate:0,min_amount:De.minAmount,max_amount:De.maxAmount,min_credit_score:De.minCreditScore,max_credit_score:De.maxCreditScore,min_time_in_business:De.minTimeInBusiness,min_monthly_revenue:De.minMonthlyRevenue,industries:De.industries,factor_rate:De.factorRate,payback_term:De.paybackTerm,approval_time:De.approvalTime,features:De.features};if(n){const St=await NE(n.id,at);w(Tt=>Tt.map(Pt=>Pt.id===n.id?St:Pt))}else{const St=await wE(at);w(Tt=>[...Tt,St])}r(!1),i(null)}catch(_e){console.error("Error saving lender:",_e),alert("Error saving lender. Please try again.")}})()},Dt=O=>{confirm("Are you sure you want to delete this application? This action cannot be undone.")&&(async()=>{try{await vE(O),b(at=>at.filter(St=>St.id!==O))}catch(at){console.error("Error deleting application:",at),alert("Error deleting application. Please try again.")}})()},yt=(O,_e)=>{B(at=>at.map(St=>St.id===O?{...St,..._e}:St))},os=O=>{if(!O)return;const _e=O.trim().toLowerCase().replace(/_/g,"-");return _e==="decline"||_e==="declined"||_e==="rejected"?"rejected":_e==="fund"||_e==="funded"||_e==="approved"?"approved":_e==="counter-offer"||_e==="counter offer"||_e==="counteroffer"||_e==="responded"?"responded":_e==="sent"?"sent":_e==="pending"?"pending":O},me=O=>{if(!O)return;const _e=O.trim().toLowerCase().replace(/_/g,"-");return _e==="pending"?"pending":_e==="approved"?"approved":_e==="declined"||_e==="decline"||_e==="rejected"?"rejected":_e==="counter-offer"||_e==="counter offer"||_e==="counteroffer"||_e==="responded"?"responded":_e==="fund"||_e==="funded"?"approved":_e==="sent"?"sent":O||void 0},Ce=async(O,_e)=>{try{const at={..._e};if(["offered_amount","factor_rate","terms","response","notes"].forEach(kt=>{if(Object.prototype.hasOwnProperty.call(_e,kt)){const jt=_e[kt];(jt===void 0||jt==="")&&(at[kt]=null)}}),Object.prototype.hasOwnProperty.call(_e,"status")){const kt=me(_e.status);kt&&(at.status=kt)}const Tt=await CE(O,at),Pt=os(Tt.status);B(kt=>kt.map(jt=>jt.id===O?{...jt,...Tt,...Pt?{status:Pt}:{}}:jt))}catch(at){console.error("Error persisting submission change:",at);const St=(at==null?void 0:at.message)||(at==null?void 0:at.error_description)||JSON.stringify(at);alert(`Error updating submission: ${St}`)}},dt=async O=>{if(j)try{await hj(j.id,[O]),oe(j.id),P(!1)}catch(_e){console.error("Error adding lender submission:",_e),alert("Error adding lender submission")}};return a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Portal"}),a.jsx("p",{className:"text-gray-600",children:"Manage applications, lenders, and underwriting guidelines"})]}),a.jsx("div",{className:"border-b border-gray-200 mb-8",children:a.jsxs("nav",{className:"flex flex-wrap gap-4 overflow-x-auto no-scrollbar -mx-1 px-1",children:[a.jsxs("button",{onClick:()=>e("applications"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="applications"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(On,{className:"w-5 h-5 inline mr-2"}),"Applications"]}),a.jsxs("button",{onClick:()=>e("lenders"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="lenders"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(Br,{className:"w-5 h-5 inline mr-2"}),"Lenders"]}),a.jsxs("button",{onClick:()=>e("deal-users"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="deal-users"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(On,{className:"w-5 h-5 inline mr-2"}),"Deal Users"]}),a.jsxs("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center text-sm",children:[a.jsx(d1,{className:"w-4 h-4 mr-2"}),"Email Template"]}),a.jsxs("button",{onClick:()=>e("settings"),className:`py-2 px-1 border-b-2 font-medium text-sm ${s==="settings"?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(iv,{className:"w-5 h-5 inline mr-2"}),"Settings"]})]})}),s==="applications"&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Applications Management"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor and manage all merchant cash advance applications"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full"}),a.jsxs("span",{children:[S.length," Total Applications"]})]}),a.jsxs("select",{className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 text-sm bg-white",children:[a.jsx("option",{children:"All Statuses"}),a.jsx("option",{children:"Submitted"}),a.jsx("option",{children:"Under Review"}),a.jsx("option",{children:"Matched"}),a.jsx("option",{children:"Funded"}),a.jsx("option",{children:"Declined"})]})]})]}),a.jsx("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200/50 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-emerald-50 via-green-50 to-teal-50 border-b border-gray-200/60",children:[a.jsx("th",{className:"px-8 py-5 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Br,{className:"w-4 h-4 text-emerald-600"}),a.jsx("span",{children:"Business"})]})}),a.jsx("th",{className:"px-8 py-5 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-green-600",children:"$"}),a.jsx("span",{children:"Amount"})]})}),a.jsx("th",{className:"px-8 py-5 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Mc,{className:"w-4 h-4 text-yellow-600"}),a.jsx("span",{children:"Financial"})]})}),a.jsx("th",{className:"px-8 py-5 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(_s,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{children:"Status"})]})}),a.jsx("th",{className:"px-8 py-5 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(On,{className:"w-4 h-4 text-purple-600"}),a.jsx("span",{children:"Lenders"})]})}),a.jsx("th",{className:"px-8 py-5 text-center text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx(iv,{className:"w-4 h-4 text-orange-600"}),a.jsx("span",{children:"Actions"})]})})]})}),a.jsxs("tbody",{className:"bg-white divide-y divide-gray-100/80",children:[v&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-8 py-16 text-center",children:a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-emerald-600 mb-4"}),a.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Loading applications..."})]})})}),!v&&S.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-8 py-16 text-center",children:a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(Br,{className:"h-8 w-8 text-gray-400"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Applications Found"}),a.jsx("p",{className:"text-gray-500 max-w-sm",children:"Applications will appear here once submitted"})]})})}),!v&&S.map(O=>a.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-emerald-50/40 hover:to-green-50/40 transition-all duration-200",children:[a.jsx("td",{className:"px-8 py-6",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"relative",children:a.jsx("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-emerald-500 via-emerald-600 to-green-700 flex items-center justify-center shadow-lg",children:a.jsx("span",{className:"text-base font-bold text-white",children:O.business_name.charAt(0).toUpperCase()})})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-base font-semibold text-gray-900",children:O.business_name}),a.jsxs("div",{className:"text-sm text-gray-500 mt-0.5 font-mono",children:[O.owner_name," • ID: ",O.id.slice(0,8),"..."]})]})]})}),a.jsxs("td",{className:"px-8 py-6",children:[a.jsxs("div",{className:"text-xl font-bold text-gray-900",children:["$",O.requested_amount.toLocaleString()]}),a.jsx("div",{className:"text-sm text-gray-500",children:O.industry})]}),a.jsxs("td",{className:"px-8 py-6",children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",O.monthly_revenue.toLocaleString(),"/mo"]}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Credit: ",O.credit_score," • ",O.years_in_business,"y"]})]}),a.jsx("td",{className:"px-8 py-6",children:a.jsx("div",{className:"flex items-center",children:a.jsxs("span",{className:`inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold shadow-sm ${he(O.status)}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${O.status==="funded"?"bg-green-400":O.status==="approved"?"bg-blue-400":O.status==="submitted"?"bg-yellow-400":O.status==="declined"?"bg-red-400":"bg-gray-400"}`}),O.status.charAt(0).toUpperCase()+O.status.slice(1)]})})}),a.jsxs("td",{className:"px-8 py-6",children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[O.matchedLenders," lenders"]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Matched"})]}),a.jsx("td",{className:"px-8 py-6 text-center",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("button",{onClick:()=>et(O),className:"inline-flex items-center px-3 py-2 bg-gradient-to-r from-emerald-600 to-green-600 text-white text-xs font-semibold rounded-xl hover:from-emerald-700 hover:to-green-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",title:"View details",children:a.jsx(rc,{className:"w-3 h-3"})}),a.jsx("button",{onClick:()=>pe(O),className:"inline-flex items-center px-3 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-xs font-semibold rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",title:"Edit application",children:a.jsx(hN,{className:"w-3 h-3"})}),a.jsx("button",{onClick:()=>Dt(O.id),className:"inline-flex items-center px-3 py-2 bg-gradient-to-r from-red-600 to-red-700 text-white text-xs font-semibold rounded-xl hover:from-red-700 hover:to-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",title:"Delete application",children:a.jsx(vp,{className:"w-3 h-3"})})]})})]},O.id))]})]})})})]}),ce&&Z&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[85vh] overflow-hidden",children:[a.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-800 p-8",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/90 to-indigo-800/90"}),a.jsx("div",{className:"relative",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center",children:a.jsx(On,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-2xl font-bold text-white mb-1",children:["Applications by ",Z.full_name||"User"]}),a.jsxs("div",{className:"flex items-center space-x-3 text-blue-100",children:[a.jsx("span",{className:"text-sm",children:Z.email}),a.jsx("span",{className:"w-1 h-1 bg-blue-200 rounded-full"}),a.jsxs("span",{className:"text-xs font-mono",children:["ID: ",Z.id.slice(0,8),"..."]})]})]})]}),a.jsx("button",{onClick:()=>ye(!1),className:"w-10 h-10 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center text-white hover:text-blue-100 transition-all duration-200",children:a.jsx(ko,{className:"w-5 h-5"})})]})})]}),a.jsxs("div",{className:"p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Application Portfolio"}),a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),a.jsxs("span",{children:[S.filter(O=>O.user_id===Z.id&&(Se===""||O.business_name.toLowerCase().includes(Se.toLowerCase())||O.status.toLowerCase().includes(Se.toLowerCase())||O.requested_amount.toString().includes(Se))).length," Applications"]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:a.jsx(ij,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search applications by business name, status, or amount...",value:Se,onChange:O=>Ee(O.target.value),className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 text-sm placeholder-gray-500"}),Se&&a.jsx("button",{onClick:()=>Ee(""),className:"absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600",children:a.jsx(ko,{className:"h-4 w-4"})})]})]}),a.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-100 via-gray-50 to-gray-100",children:[a.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Br,{className:"w-4 h-4 text-gray-500"}),a.jsx("span",{children:"Business"})]})}),a.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-green-600",children:"$"}),a.jsx("span",{children:"Amount"})]})}),a.jsx("th",{className:"px-8 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),a.jsx("span",{children:"Status"})]})})]})}),a.jsxs("tbody",{className:"bg-white divide-y divide-gray-100",children:[S.filter(O=>O.user_id===Z.id&&(Se===""||O.business_name.toLowerCase().includes(Se.toLowerCase())||O.status.toLowerCase().includes(Se.toLowerCase())||O.requested_amount.toString().includes(Se))).map(O=>a.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/30 transition-all duration-200",children:[a.jsx("td",{className:"px-8 py-6",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-white font-bold text-sm",children:O.business_name.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900 text-base",children:O.business_name}),a.jsx("div",{className:"text-sm text-gray-500",children:O.industry})]})]})}),a.jsxs("td",{className:"px-8 py-6",children:[a.jsxs("div",{className:"text-xl font-bold text-gray-900",children:["$",O.requested_amount.toLocaleString()]}),a.jsx("div",{className:"text-sm text-gray-500",children:"Requested"})]}),a.jsx("td",{className:"px-8 py-6",children:a.jsxs("span",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold shadow-sm ${he(O.status)}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${O.status==="funded"?"bg-green-400":O.status==="approved"?"bg-blue-400":O.status==="submitted"?"bg-yellow-400":O.status==="declined"?"bg-red-400":"bg-gray-400"}`}),O.status.charAt(0).toUpperCase()+O.status.slice(1)]})})]},O.id)),S.filter(O=>O.user_id===Z.id&&(Se===""||O.business_name.toLowerCase().includes(Se.toLowerCase())||O.status.toLowerCase().includes(Se.toLowerCase())||O.requested_amount.toString().includes(Se))).length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:3,className:"px-8 py-16 text-center",children:a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(Br,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:Se?"No Matching Applications":"No Applications Found"}),a.jsx("p",{className:"text-gray-500 max-w-sm",children:Se?`No applications match "${Se}". Try a different search term.`:"This user hasn't submitted any applications yet."})]})})})]})]})})}),a.jsxs("div",{className:"mt-8 flex items-center justify-between pt-6 border-t border-gray-200",children:[a.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",S.filter(O=>O.user_id===Z.id&&(Se===""||O.business_name.toLowerCase().includes(Se.toLowerCase())||O.status.toLowerCase().includes(Se.toLowerCase())||O.requested_amount.toString().includes(Se))).length," of ",S.filter(O=>O.user_id===Z.id).length," applications"]}),a.jsx("button",{onClick:()=>ye(!1),className:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-xl hover:from-gray-700 hover:to-gray-800 transition-all duration-200 font-medium shadow-lg hover:shadow-xl",children:"Close"})]})]})]})}),s==="deal-users"&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Deal Users Management"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage member accounts and their access permissions"})]}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),a.jsxs("span",{children:[de.length," Active Users"]})]})})]}),a.jsx("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200/50 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 border-b border-gray-200/60",children:[a.jsx("th",{className:"px-8 py-5 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(On,{className:"w-4 h-4 text-blue-600"}),a.jsx("span",{children:"Member"})]})}),a.jsx("th",{className:"px-8 py-5 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(d1,{className:"w-4 h-4 text-green-600"}),a.jsx("span",{children:"Contact"})]})}),a.jsx("th",{className:"px-8 py-5 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(_s,{className:"w-4 h-4 text-emerald-600"}),a.jsx("span",{children:"Status"})]})}),a.jsx("th",{className:"px-8 py-5 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Mc,{className:"w-4 h-4 text-yellow-600"}),a.jsx("span",{children:"Joined"})]})}),a.jsx("th",{className:"px-8 py-5 text-center text-xs font-bold text-gray-700 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx(iv,{className:"w-4 h-4 text-purple-600"}),a.jsx("span",{children:"Actions"})]})})]})}),a.jsxs("tbody",{className:"bg-white divide-y divide-gray-100/80",children:[R&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-8 py-16 text-center",children:a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-4"}),a.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Loading user accounts..."})]})})}),!R&&de.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-8 py-16 text-center",children:a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(On,{className:"h-8 w-8 text-gray-400"})}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No User Accounts Found"}),a.jsx("p",{className:"text-gray-500 max-w-sm",children:"User accounts will appear here once created"})]})})}),!R&&de.map(O=>a.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-blue-50/40 hover:to-indigo-50/40 transition-all duration-200",children:[a.jsx("td",{className:"px-8 py-6",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"relative",children:a.jsx("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-700 flex items-center justify-center shadow-lg",children:a.jsx("span",{className:"text-base font-bold text-white",children:(O.full_name||O.email).charAt(0).toUpperCase()})})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-base font-semibold text-gray-900",children:O.full_name||"Unnamed User"}),a.jsxs("div",{className:"text-sm text-gray-500 mt-0.5 font-mono",children:["ID: ",O.id.slice(0,8),"..."]})]})]})}),a.jsxs("td",{className:"px-8 py-6",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:O.email}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center",children:[a.jsx("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full mr-2"}),"Primary contact"]})]}),a.jsx("td",{className:"px-8 py-6",children:a.jsx("div",{className:"flex items-center",children:a.jsxs("span",{className:`inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold shadow-sm ${O.roles==="admin"||O.roles==="Admin"?"bg-purple-100 text-purple-800 border border-purple-200":"bg-emerald-100 text-emerald-800 border border-emerald-200"}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${O.roles==="admin"||O.roles==="Admin"?"bg-purple-400":"bg-emerald-400"}`}),O.roles||"Member"]})})}),a.jsxs("td",{className:"px-8 py-6",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:new Date(O.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Math.floor((Date.now()-new Date(O.created_at).getTime())/(1e3*60*60*24))," days ago"]})]}),a.jsx("td",{className:"px-8 py-6 text-center",children:a.jsxs("button",{onClick:()=>Ze(O),className:"inline-flex items-center px-4 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-sm font-semibold rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",title:"View applications submitted by this user",children:[a.jsx(rc,{className:"w-4 h-4 mr-2"}),"View Applications"]})})]},O.id))]})]})})})]}),s==="lenders"&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Lender Management"}),a.jsxs("button",{onClick:()=>{$e()},className:"bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors flex items-center",children:[a.jsx(nv,{className:"w-4 h-4 mr-2"}),"Add Lender"]})]}),a.jsx("div",{className:"grid gap-6",children:x.map(O=>a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-lg flex items-center justify-center mr-4",children:a.jsx(Br,{className:"w-6 h-6 text-emerald-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:O.name}),a.jsxs("p",{className:"text-gray-600",children:[O.contact_email,Array.isArray(O.cc_emails)&&O.cc_emails.length>0&&a.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["• CC: ",O.cc_emails.join(", ")]})]}),a.jsx("p",{className:"text-gray-500 text-sm",children:O.phone})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${he(O.status)}`,children:O.status}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Mc,{className:"w-4 h-4 text-yellow-400 fill-current mr-1"}),a.jsx("span",{className:"text-sm font-medium",children:O.rating})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Total Applications"}),a.jsx("div",{className:"text-lg font-bold text-blue-900",children:O.total_applications})]}),a.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Approval Rate"}),a.jsxs("div",{className:"text-lg font-bold text-green-900",children:[O.approval_rate,"%"]})]}),a.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Amount Range"}),a.jsxs("div",{className:"text-sm font-bold text-purple-900",children:["$",O.min_amount.toLocaleString()," - $",O.max_amount.toLocaleString()]})]}),a.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-sm text-orange-600 font-medium",children:"Factor Rate"}),a.jsx("div",{className:"text-sm font-bold text-orange-900",children:O.factor_rate})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Underwriting Guidelines"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Min Credit Score:"}),a.jsx("span",{className:"ml-1 font-medium",children:O.min_credit_score})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Min Time in Business:"}),a.jsxs("span",{className:"ml-1 font-medium",children:[O.min_time_in_business," years"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Min Monthly Revenue:"}),a.jsxs("span",{className:"ml-1 font-medium",children:["$",O.min_monthly_revenue.toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Approval Time:"}),a.jsx("span",{className:"ml-1 font-medium",children:O.approval_time})]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Industries: "}),a.jsx("span",{className:"text-sm font-medium",children:O.industries.join(", ")})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsxs("button",{onClick:()=>Ae(O),className:"px-4 py-2 text-blue-600 border border-blue-300 rounded-lg hover:bg-blue-50 transition-colors flex items-center",children:[a.jsx(hN,{className:"w-4 h-4 mr-1"}),"Edit"]}),a.jsxs("button",{onClick:()=>we(O.id),className:"px-4 py-2 text-red-600 border border-red-300 rounded-lg hover:bg-red-50 transition-colors flex items-center",children:[a.jsx(vp,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]},O.id))})]}),s==="settings"&&a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"System Settings"}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"General Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Application Amount"}),a.jsx("input",{type:"number",defaultValue:"10000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Application Amount"}),a.jsx("input",{type:"number",defaultValue:"2000000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Notification Settings"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",defaultChecked:!0,className:"mr-3"}),a.jsx("label",{className:"text-sm text-gray-700",children:"Email notifications for new applications"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",defaultChecked:!0,className:"mr-3"}),a.jsx("label",{className:"text-sm text-gray-700",children:"Email notifications for lender matches"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",className:"mr-3"}),a.jsx("label",{className:"text-sm text-gray-700",children:"SMS notifications for urgent matters"})]})]})]})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:a.jsx("button",{className:"bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700 transition-colors",children:"Save Settings"})})]})]}),t&&a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n?"Edit Lender":"Add New Lender"})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lender Name *"}),a.jsx("input",{type:"text",value:De.name,onChange:O=>We(_e=>({..._e,name:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"Enter lender name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email *"}),a.jsx("input",{type:"email",value:De.contactEmail,onChange:O=>We(_e=>({..._e,contactEmail:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"contact@lender.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CC Emails"}),a.jsxs("div",{className:"w-full",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("input",{type:"email",value:Je,onChange:O=>it(O.target.value),onKeyDown:O=>{(O.key==="Enter"||O.key===",")&&(O.preventDefault(),Qe())},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"cc@example.com"}),a.jsx("button",{type:"button",onClick:Qe,className:"px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm",children:"Add"})]}),(De.ccEmails||[]).length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:De.ccEmails.map(O=>a.jsxs("span",{className:"inline-flex items-center gap-2 px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs",children:[O,a.jsx("button",{type:"button",onClick:()=>lt(O),className:"text-gray-500 hover:text-gray-800",children:"×"})]},O))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),a.jsx("input",{type:"tel",value:De.phone,onChange:O=>We(_e=>({..._e,phone:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"(555) 123-4567"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:De.status,onChange:O=>We(_e=>({..._e,status:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",children:[a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"}),a.jsx("option",{value:"pending",children:"Pending"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),a.jsx("input",{type:"number",min:"1",max:"5",step:"0.1",value:De.rating,onChange:O=>We(_e=>({..._e,rating:parseFloat(O.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Underwriting Guidelines"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Funding Range"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Amount ($)"}),a.jsx("input",{type:"number",value:De.minAmount,onChange:O=>We(_e=>({..._e,minAmount:parseInt(O.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Amount ($)"}),a.jsx("input",{type:"number",value:De.maxAmount,onChange:O=>We(_e=>({..._e,maxAmount:parseInt(O.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Credit Score Requirements"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Credit Score"}),a.jsx("input",{type:"number",min:"300",max:"850",value:De.minCreditScore,onChange:O=>We(_e=>({..._e,minCreditScore:parseInt(O.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Credit Score"}),a.jsx("input",{type:"number",min:"300",max:"850",value:De.maxCreditScore,onChange:O=>We(_e=>({..._e,maxCreditScore:parseInt(O.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Business Requirements"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Time in Business (years)"}),a.jsx("input",{type:"number",min:"0",step:"0.5",value:De.minTimeInBusiness,onChange:O=>We(_e=>({..._e,minTimeInBusiness:parseFloat(O.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Monthly Revenue ($)"}),a.jsx("input",{type:"number",value:De.minMonthlyRevenue,onChange:O=>We(_e=>({..._e,minMonthlyRevenue:parseInt(O.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500"})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Terms & Processing"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Factor Rate"}),a.jsx("input",{type:"text",value:De.factorRate,onChange:O=>We(_e=>({..._e,factorRate:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"1.1 - 1.4"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payback Term"}),a.jsx("input",{type:"text",value:De.paybackTerm,onChange:O=>We(_e=>({..._e,paybackTerm:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"3-18 months"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Approval Time"}),a.jsx("input",{type:"text",value:De.approvalTime,onChange:O=>We(_e=>({..._e,approvalTime:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",placeholder:"24 hours"})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Accepted Industries"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Be.map(O=>a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:De.industries.includes(O),onChange:()=>At(O),className:"mr-2 text-emerald-600 focus:ring-emerald-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:O})]},O))})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"font-medium text-gray-700 mb-3",children:"Key Features"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:Te.map(O=>a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:De.features.includes(O),onChange:()=>Nt(O),className:"mr-2 text-emerald-600 focus:ring-emerald-500"}),a.jsx("span",{className:"text-sm text-gray-700",children:O})]},O))})]})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:Lt,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700",children:n?"Update Lender":"Add Lender"})]})]})]})}),o&&m&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"relative bg-gradient-to-r from-emerald-600 via-green-700 to-teal-800 p-8",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-600/90 to-teal-800/90"}),a.jsx("div",{className:"relative",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center",children:a.jsx(Br,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-3xl font-bold text-white mb-2",children:m.business_name}),a.jsxs("div",{className:"flex items-center space-x-4 text-emerald-100",children:[a.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-semibold bg-white/20 backdrop-blur-sm border border-white/30",children:[a.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${m.status==="funded"?"bg-green-300":m.status==="approved"?"bg-blue-300":m.status==="submitted"?"bg-yellow-300":m.status==="declined"?"bg-red-300":"bg-gray-300"}`}),m.status.charAt(0).toUpperCase()+m.status.slice(1)]}),a.jsxs("span",{className:"text-sm font-mono",children:["ID: ",m.id.slice(0,8),"..."]}),a.jsx("span",{className:"text-sm",children:m.industry})]})]})]}),a.jsx("button",{onClick:()=>l(!1),className:"w-12 h-12 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center text-white hover:text-emerald-100 transition-all duration-200",children:a.jsx(ko,{className:"w-6 h-6"})})]})})]}),a.jsxs("div",{className:"overflow-y-auto max-h-[calc(90vh-200px)]",children:[a.jsxs("div",{className:"p-8",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[a.jsx("div",{className:"bg-gradient-to-br from-emerald-50 to-green-100 rounded-xl p-6 border border-emerald-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-emerald-700",children:"Requested Amount"}),a.jsxs("p",{className:"text-2xl font-bold text-emerald-900",children:["$",m.requested_amount.toLocaleString()]})]}),a.jsx("div",{className:"w-12 h-12 bg-emerald-500 rounded-xl flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold",children:"$"})})]})}),a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-xl p-6 border border-blue-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Monthly Revenue"}),a.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:["$",m.monthly_revenue.toLocaleString()]})]}),a.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center",children:a.jsx(Mc,{className:"w-6 h-6 text-white"})})]})}),a.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-violet-100 rounded-xl p-6 border border-purple-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-purple-700",children:"Credit Score"}),a.jsx("p",{className:"text-2xl font-bold text-purple-900",children:m.credit_score})]}),a.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center",children:a.jsx(_s,{className:"w-6 h-6 text-white"})})]})}),a.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-amber-100 rounded-xl p-6 border border-orange-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-orange-700",children:"Years in Business"}),a.jsx("p",{className:"text-2xl font-bold text-orange-900",children:m.years_in_business})]}),a.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center",children:a.jsx(Br,{className:"w-6 h-6 text-white"})})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-xl border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-xl flex items-center justify-center",children:a.jsx(Br,{className:"w-5 h-5 text-white"})}),a.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"Business Information"})]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Business Name"}),a.jsx("p",{className:"text-base text-gray-900 font-medium",children:m.business_name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Industry"}),a.jsx("p",{className:"text-base text-gray-900",children:m.industry})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Business Type"}),a.jsx("p",{className:"text-base text-gray-900",children:m.business_type||"N/A"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"EIN"}),a.jsx("p",{className:"text-base text-gray-900 font-mono",children:m.ein||"N/A"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Employees"}),a.jsx("p",{className:"text-base text-gray-900",children:m.number_of_employees})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Created"}),a.jsx("p",{className:"text-base text-gray-900",children:new Date(m.created_at).toLocaleDateString()})]})]})})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white rounded-xl border border-blue-200 p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-xl flex items-center justify-center",children:a.jsx(On,{className:"w-5 h-5 text-white"})}),a.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"Contact Information"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Owner Name"}),a.jsx("p",{className:"text-base text-gray-900 font-medium",children:m.owner_name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Email"}),a.jsx("p",{className:"text-base text-gray-900",children:m.email})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Phone"}),a.jsx("p",{className:"text-base text-gray-900",children:m.phone||"N/A"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-600 mb-1",children:"Address"}),a.jsx("p",{className:"text-base text-gray-900",children:m.address||"N/A"})]})]})]})]}),a.jsxs("div",{className:"mt-8 bg-gradient-to-br from-purple-50 to-white rounded-xl border border-purple-200 p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-xl flex items-center justify-center",children:a.jsx(Mc,{className:"w-5 h-5 text-white"})}),a.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"Financial Analysis"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[a.jsx("label",{className:"block text-sm font-semibold text-purple-600 mb-2",children:"Annual Revenue"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",m.annual_revenue.toLocaleString()]})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[a.jsx("label",{className:"block text-sm font-semibold text-purple-600 mb-2",children:"Monthly Deposits"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",m.monthly_deposits.toLocaleString()]})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-purple-100",children:[a.jsx("label",{className:"block text-sm font-semibold text-purple-600 mb-2",children:"Existing Debt"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",m.existing_debt.toLocaleString()]})]})]})]}),a.jsxs("div",{className:"mt-8 bg-gradient-to-br from-orange-50 to-white rounded-xl border border-orange-200 p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-xl flex items-center justify-center",children:a.jsx(_s,{className:"w-5 h-5 text-white"})}),a.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"Application Status"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-orange-100",children:[a.jsx("label",{className:"block text-sm font-semibold text-orange-600 mb-2",children:"Current Status"}),a.jsxs("span",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-semibold shadow-sm ${he(m.status)}`,children:[a.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${m.status==="funded"?"bg-green-400":m.status==="approved"?"bg-blue-400":m.status==="submitted"?"bg-yellow-400":m.status==="declined"?"bg-red-400":"bg-gray-400"}`}),m.status.charAt(0).toUpperCase()+m.status.slice(1)]})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border border-orange-100",children:[a.jsx("label",{className:"block text-sm font-semibold text-orange-600 mb-2",children:"Matched Lenders"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[m.matchedLenders," lenders"]})]})]})]}),m.documents&&m.documents.length>0&&a.jsxs("div",{className:"mt-8 bg-gradient-to-br from-green-50 to-white rounded-xl border border-green-200 p-6",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-xl flex items-center justify-center",children:a.jsx(_s,{className:"w-5 h-5 text-white"})}),a.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"Bank Statements & Documents"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.documents.map((O,_e)=>a.jsxs("div",{className:"flex items-center bg-white rounded-lg p-4 border border-green-100 hover:border-green-300 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-4",children:a.jsx(_s,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:O}),a.jsx("p",{className:"text-sm text-gray-500",children:"Bank Statement Document"})]})]},_e))})]})]}),a.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-8 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Application reviewed for financial analysis and bank statement verification"}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>l(!1),className:"px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-xl hover:from-gray-700 hover:to-gray-800 transition-all duration-200 font-medium shadow-lg hover:shadow-xl",children:"Close"}),a.jsx("button",{onClick:()=>Dt(m.id),className:"px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-200 font-medium shadow-lg hover:shadow-xl",children:"Delete Application"})]})]})})]})]})}),A&&j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-7xl w-full max-h-[95vh] overflow-hidden border border-gray-200",children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 px-8 py-6 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/90 to-indigo-700/90"}),a.jsxs("div",{className:"relative flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"bg-white/20 p-3 rounded-xl backdrop-blur-sm",children:a.jsx(Br,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:"Edit Application"}),a.jsxs("p",{className:"text-blue-100 text-sm font-medium",children:[j.business_name," • Bank Statement Processing"]})]})]}),a.jsx("button",{onClick:()=>{L(!1),E(null)},className:"bg-white/10 hover:bg-white/20 p-2 rounded-xl transition-all duration-200 backdrop-blur-sm",children:a.jsx(ko,{className:"w-6 h-6 text-white"})})]})]}),a.jsx("div",{className:"overflow-y-auto max-h-[calc(95vh-120px)]",children:a.jsx("div",{className:"p-8",children:a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-10",children:[a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-2xl border border-gray-200 shadow-sm",children:[a.jsx("div",{className:"bg-gradient-to-r from-gray-600 to-gray-700 px-6 py-4 rounded-t-2xl",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Is,{className:"w-5 h-5 text-white"}),a.jsx("h4",{className:"text-lg font-semibold text-white",children:"Application Details"})]})}),a.jsx("div",{className:"p-6",children:a.jsxs("form",{onSubmit:xe,className:"space-y-6",children:[a.jsxs("div",{className:"bg-blue-50/50 rounded-xl p-4 border border-blue-100",children:[a.jsxs("h5",{className:"text-sm font-semibold text-blue-800 mb-3 flex items-center",children:[a.jsx(CM,{className:"w-4 h-4 mr-2"}),"Business Information"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Business Name *"}),a.jsx("input",{type:"text",value:j.business_name,onChange:O=>E(_e=>_e?{..._e,business_name:O.target.value}:null),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm transition-all duration-200",placeholder:"Enter business name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Owner Name *"}),a.jsx("input",{type:"text",value:j.owner_name,onChange:O=>E(_e=>_e?{..._e,owner_name:O.target.value}:null),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white shadow-sm transition-all duration-200",placeholder:"Enter owner name"})]})]})]}),a.jsxs("div",{className:"bg-green-50/50 rounded-xl p-4 border border-green-100",children:[a.jsxs("h5",{className:"text-sm font-semibold text-green-800 mb-3 flex items-center",children:[a.jsx(OM,{className:"w-4 h-4 mr-2"}),"Contact Information"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address *"}),a.jsx("input",{type:"email",value:j.email,onChange:O=>E(_e=>_e?{..._e,email:O.target.value}:null),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white shadow-sm transition-all duration-200",placeholder:"business@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Phone Number"}),a.jsx("input",{type:"tel",value:j.phone||"",onChange:O=>E(_e=>_e?{..._e,phone:O.target.value}:null),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white shadow-sm transition-all duration-200",placeholder:"(555) 123-4567"})]})]})]}),a.jsxs("div",{className:"bg-purple-50/50 rounded-xl p-4 border border-purple-100",children:[a.jsxs("h5",{className:"text-sm font-semibold text-purple-800 mb-3 flex items-center",children:[a.jsx(kM,{className:"w-4 h-4 mr-2"}),"Business Classification"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Industry *"}),a.jsxs("select",{value:j.industry||"",onChange:O=>E(_e=>_e?{..._e,industry:O.target.value}:null),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white shadow-sm transition-all duration-200",children:[a.jsx("option",{value:"",children:"Select Industry"}),a.jsx("option",{value:"Retail",children:"Retail"}),a.jsx("option",{value:"Restaurant",children:"Restaurant"}),a.jsx("option",{value:"Healthcare",children:"Healthcare"}),a.jsx("option",{value:"Construction",children:"Construction"}),a.jsx("option",{value:"Professional Services",children:"Professional Services"}),a.jsx("option",{value:"Transportation",children:"Transportation"}),a.jsx("option",{value:"Manufacturing",children:"Manufacturing"}),a.jsx("option",{value:"Technology",children:"Technology"}),a.jsx("option",{value:"Real Estate",children:"Real Estate"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Application Status"}),a.jsxs("select",{value:j.status,onChange:O=>E(_e=>_e&&{..._e,status:O.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white shadow-sm transition-all duration-200",children:[a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"submitted",children:"Submitted"}),a.jsx("option",{value:"under-review",children:"Under Review"}),a.jsx("option",{value:"approved",children:"Approved"}),a.jsx("option",{value:"funded",children:"Funded"}),a.jsx("option",{value:"declined",children:"Declined"})]})]})]})]}),a.jsxs("div",{className:"bg-orange-50/50 rounded-xl p-4 border border-orange-100",children:[a.jsxs("h5",{className:"text-sm font-semibold text-orange-800 mb-3 flex items-center",children:[a.jsx(Lg,{className:"w-4 h-4 mr-2"}),"Financial Information"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Requested Amount *"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium",children:"$"}),a.jsx("input",{type:"number",value:j.requested_amount,onChange:O=>E(_e=>_e&&{..._e,requested_amount:Number(O.target.value)}),className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white shadow-sm transition-all duration-200",placeholder:"100,000"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Monthly Revenue"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium",children:"$"}),a.jsx("input",{type:"number",value:j.monthly_revenue,onChange:O=>E(_e=>_e&&{..._e,monthly_revenue:Number(O.target.value)}),className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white shadow-sm transition-all duration-200",placeholder:"25,000"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Credit Score"}),a.jsx("input",{type:"number",value:j.credit_score,onChange:O=>E(_e=>_e&&{..._e,credit_score:Number(O.target.value)}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white shadow-sm transition-all duration-200",min:"300",max:"850",placeholder:"650"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Years in Business"}),a.jsx("input",{type:"number",value:j.years_in_business,onChange:O=>E(_e=>_e&&{..._e,years_in_business:Number(O.target.value)}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 bg-white shadow-sm transition-all duration-200",min:"0",placeholder:"5"})]})]})]}),a.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:a.jsxs("button",{type:"submit",className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-8 py-3 rounded-xl font-semibold flex items-center shadow-lg hover:shadow-xl transition-all duration-200",children:[a.jsx(_s,{className:"w-5 h-5 mr-2"}),"Save Changes"]})})]})})]}),a.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-white rounded-2xl border border-indigo-200 shadow-sm",children:[a.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-700 px-6 py-4 rounded-t-2xl",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Br,{className:"w-5 h-5 text-white"}),a.jsx("h4",{className:"text-lg font-semibold text-white",children:"Lender Submissions"})]}),a.jsxs("button",{onClick:()=>P(!0),className:"bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-xl font-medium flex items-center text-sm transition-all duration-200 backdrop-blur-sm",children:[a.jsx(nv,{className:"w-4 h-4 mr-2"}),"Add Lender"]})]})}),a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[C.map(O=>{var _e,at,St,Tt,Pt;return a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900",children:O.lender.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(O.created_at).toLocaleDateString()]})]}),a.jsxs("select",{value:O.status,onChange:kt=>{const jt=kt.target.value,Rt=jt==="rejected"||jt==="declined"||jt==="decline",Ot=jt==="approved"||jt==="funded"||jt==="approve",Ps=jt==="responded"||jt==="counter-offer"||jt==="respond",Fs=jt==="pending";if(Rt)yt(O.id,{status:jt,offered_amount:void 0,factor_rate:void 0,terms:void 0}),(!O.response||typeof O.response=="string"&&O.response.trim()==="")&&z(be=>({...be,[O.id]:{responseRequired:!0}}));else if(Ot||Ps){yt(O.id,{status:jt});const Os=O.offered_amount==null||typeof O.offered_amount=="number"&&Number.isNaN(O.offered_amount),be=!O.factor_rate||typeof O.factor_rate=="string"&&O.factor_rate.trim()==="",ve=!O.terms||typeof O.terms=="string"&&O.terms.trim()==="";z(Os||be||ve?Ve=>({...Ve,[O.id]:{...Ve[O.id]||{},...Os?{offeredRequired:!0}:{},...be?{factorRequired:!0}:{},...ve?{termsRequired:!0}:{}}}):Ve=>({...Ve,[O.id]:{...Ve[O.id]||{},offeredRequired:!1,factorRequired:!1,termsRequired:!1}}))}else if(Fs){yt(O.id,{status:jt});const Os=!O.response||typeof O.response=="string"&&O.response.trim()==="";z(be=>({...be,[O.id]:{...be[O.id]||{},responseRequired:Os}}))}else yt(O.id,{status:jt}),z(Os=>{const be={...Os};return delete be[O.id],be})},onBlur:kt=>{const jt=kt.target.value;jt==="rejected"||jt==="declined"||jt==="decline"?Ce(O.id,{status:jt,offered_amount:void 0,factor_rate:void 0,terms:void 0}):Ce(O.id,{status:jt})},className:"px-3 py-1 rounded-full text-xs font-medium border border-gray-300 bg-white text-gray-700 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"sent",children:"Sent"}),a.jsx("option",{value:"responded",children:"Counter Offer"}),a.jsx("option",{value:"approved",children:"Approved"}),a.jsx("option",{value:"rejected",children:"Declined"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Offered Amount"}),a.jsx("input",{type:"number",value:O.offered_amount||"",onChange:kt=>{var jt;yt(O.id,{offered_amount:kt.target.value===""?void 0:Number(kt.target.value)}),kt.target.value.trim()!==""&&((jt=T[O.id])!=null&&jt.offeredRequired)&&z(Rt=>({...Rt,[O.id]:{...Rt[O.id]||{},offeredRequired:!1}}))},onBlur:kt=>Ce(O.id,{offered_amount:kt.target.value===""?void 0:Number(kt.target.value)}),className:`w-full px-3 py-2 text-sm border rounded-lg transition-all duration-200 ${me(O.status)==="rejected"?"border-red-400 bg-red-50 placeholder-red-400 focus:ring-2 focus:ring-red-200 focus:border-red-500":me(O.status)==="approved"?"border-green-400 bg-green-50 placeholder-green-400 focus:ring-2 focus:ring-green-200 focus:border-green-500":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-blue-500"}`,placeholder:"Amount"}),((_e=T[O.id])==null?void 0:_e.offeredRequired)&&a.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(_s,{className:"h-4 w-4 text-green-500"})}),a.jsxs("div",{className:"ml-2",children:[a.jsx("p",{className:"text-sm font-medium text-green-800",children:"Offered Amount Required"}),a.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Provide an offered amount for Approved or Counter Offer."})]})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Factor Rate"}),a.jsx("input",{type:"text",value:O.factor_rate||"",onChange:kt=>{var jt;yt(O.id,{factor_rate:kt.target.value===""?void 0:kt.target.value}),kt.target.value.trim()!==""&&((jt=T[O.id])!=null&&jt.factorRequired)&&z(Rt=>({...Rt,[O.id]:{...Rt[O.id]||{},factorRequired:!1}}))},onBlur:kt=>Ce(O.id,{factor_rate:kt.target.value===""?void 0:kt.target.value}),className:`w-full px-3 py-2 text-sm border rounded-lg transition-all duration-200 ${me(O.status)==="rejected"?"border-red-400 bg-red-50 placeholder-red-400 focus:ring-2 focus:ring-red-200 focus:border-red-500":me(O.status)==="approved"?"border-green-400 bg-green-50 placeholder-green-400 focus:ring-2 focus:ring-green-200 focus:border-green-500":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-blue-500"}`,placeholder:"1.2"}),((at=T[O.id])==null?void 0:at.factorRequired)&&a.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(_s,{className:"h-4 w-4 text-green-500"})}),a.jsxs("div",{className:"ml-2",children:[a.jsx("p",{className:"text-sm font-medium text-green-800",children:"Factor Rate Required"}),a.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Provide a factor rate for Approved or Counter Offer."})]})]})})]})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Terms"}),a.jsx("input",{type:"text",value:O.terms||"",onChange:kt=>{var jt;yt(O.id,{terms:kt.target.value===""?void 0:kt.target.value}),kt.target.value.trim()!==""&&((jt=T[O.id])!=null&&jt.termsRequired)&&z(Rt=>({...Rt,[O.id]:{...Rt[O.id]||{},termsRequired:!1}}))},onBlur:kt=>Ce(O.id,{terms:kt.target.value===""?void 0:kt.target.value}),className:`w-full px-3 py-2 text-sm border rounded-lg transition-all duration-200 ${me(O.status)==="rejected"?"border-red-400 bg-red-50 placeholder-red-400 focus:ring-2 focus:ring-red-200 focus:border-red-500":me(O.status)==="approved"?"border-green-400 bg-green-50 placeholder-green-400 focus:ring-2 focus:ring-green-200 focus:border-green-500":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-blue-500"}`,placeholder:"12 months"}),((St=T[O.id])==null?void 0:St.termsRequired)&&a.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(_s,{className:"h-4 w-4 text-green-500"})}),a.jsxs("div",{className:"ml-2",children:[a.jsx("p",{className:"text-sm font-medium text-green-800",children:"Terms Required"}),a.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Provide terms for Approved or Counter Offer."})]})]})})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Response"}),a.jsx("textarea",{value:O.response||"",onChange:kt=>{var jt;yt(O.id,{response:kt.target.value===""?void 0:kt.target.value}),kt.target.value.trim()!==""&&((jt=T[O.id])!=null&&jt.responseRequired)&&z(Rt=>{const Ot={...Rt};return delete Ot[O.id],Ot})},onBlur:kt=>Ce(O.id,{response:kt.target.value===""?void 0:kt.target.value}),className:`w-full px-3 py-2 text-sm border rounded-lg transition-all duration-200 resize-none ${(Tt=T[O.id])!=null&&Tt.responseRequired?me(O.status)==="rejected"?"border-red-400 bg-red-50 placeholder-red-400 focus:ring-2 focus:ring-red-200 focus:border-red-500":"border-amber-400 bg-amber-50 placeholder-amber-400 focus:ring-2 focus:ring-amber-200 focus:border-amber-500":"border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-blue-500"}`,rows:3,placeholder:"Explain the lender's response..."}),((Pt=T[O.id])==null?void 0:Pt.responseRequired)&&a.jsx("div",{className:`mt-2 p-3 rounded-lg border ${me(O.status)==="rejected"?"bg-red-50 border-red-200":"bg-amber-50 border-amber-200"}`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:me(O.status)==="rejected"?a.jsx(ko,{className:"h-4 w-4 text-red-400"}):a.jsx(SM,{className:"h-4 w-4 text-amber-500"})}),a.jsxs("div",{className:"ml-2",children:[a.jsx("p",{className:`text-sm font-medium ${me(O.status)==="rejected"?"text-red-800":"text-amber-800"}`,children:"Response Required"}),a.jsx("p",{className:`text-xs mt-1 ${me(O.status)==="rejected"?"text-red-600":"text-amber-700"}`,children:me(O.status)==="rejected"?"Please explain why this submission is declined.":"Please provide a response while status is Pending."})]})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:O.notes||"",onChange:kt=>yt(O.id,{notes:kt.target.value===""?void 0:kt.target.value}),onBlur:kt=>Ce(O.id,{notes:kt.target.value===""?void 0:kt.target.value}),className:"w-full px-3 py-2 text-sm border rounded-lg transition-all duration-200 resize-none border-gray-300 focus:ring-2 focus:ring-blue-200 focus:border-blue-500",rows:2,placeholder:"Internal notes..."})]})]},O.id)}),C.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(Br,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"No lender submissions yet"}),a.jsx("p",{className:"text-sm",children:'Click "Add Lender" to create submissions'})]})]})})]})]})})})]})}),U&&a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Lender Submission"}),a.jsx("button",{onClick:()=>P(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(ko,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:x.filter(O=>!C.some(_e=>_e.lender_id===O.id)).map(O=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>dt(O.id),children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:O.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["$",O.min_amount.toLocaleString()," - $",O.max_amount.toLocaleString()]})]}),a.jsx(nv,{className:"w-5 h-5 text-green-600"})]},O.id))}),x.filter(O=>!C.some(_e=>_e.lender_id===O.id)).length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"All available lenders have been added"})})]})]})}),c&&a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Email Template Settings"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Customize the email template sent to lenders"})]}),a.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:"×"})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Available Variables"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-sm",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"font-medium text-gray-700",children:"Business Info:"}),a.jsx("p",{className:"text-gray-600",children:"{{businessName}}"}),a.jsx("p",{className:"text-gray-600",children:"{{ownerName}}"}),a.jsx("p",{className:"text-gray-600",children:"{{industry}}"}),a.jsx("p",{className:"text-gray-600",children:"{{businessType}}"}),a.jsx("p",{className:"text-gray-600",children:"{{ein}}"}),a.jsx("p",{className:"text-gray-600",children:"{{yearsInBusiness}}"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"font-medium text-gray-700",children:"Financial Info:"}),a.jsx("p",{className:"text-gray-600",children:"{{requestedAmount}}"}),a.jsx("p",{className:"text-gray-600",children:"{{monthlyRevenue}}"}),a.jsx("p",{className:"text-gray-600",children:"{{annualRevenue}}"}),a.jsx("p",{className:"text-gray-600",children:"{{creditScore}}"}),a.jsx("p",{className:"text-gray-600",children:"{{existingDebt}}"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"font-medium text-gray-700",children:"Contact & Lender:"}),a.jsx("p",{className:"text-gray-600",children:"{{email}}"}),a.jsx("p",{className:"text-gray-600",children:"{{phone}}"}),a.jsx("p",{className:"text-gray-600",children:"{{address}}"}),a.jsx("p",{className:"text-gray-600",children:"{{lenderName}}"}),a.jsx("p",{className:"text-gray-600",children:"{{lenderMinAmount}}"}),a.jsx("p",{className:"text-gray-600",children:"{{lenderMaxAmount}}"}),a.jsx("p",{className:"text-gray-600",children:"{{lenderFactorRate}}"}),a.jsx("p",{className:"text-gray-600",children:"{{lenderPaybackTerm}}"}),a.jsx("p",{className:"text-gray-600",children:"{{lenderApprovalTime}}"}),a.jsx("p",{className:"text-gray-600",children:"{{applicationId}}"})]})]})})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Template"}),a.jsx("textarea",{value:u,onChange:O=>h(O.target.value),className:"w-full h-96 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm",placeholder:"Enter your email template..."}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Use the variables above to dynamically insert application and lender data"})]}),a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6",children:[a.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Preview"}),a.jsx("div",{className:"bg-white border rounded p-3 max-h-40 overflow-y-auto",children:a.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap",children:u.replace(/\{\{businessName\}\}/g,"Sample Business LLC").replace(/\{\{ownerName\}\}/g,"John Smith").replace(/\{\{industry\}\}/g,"Technology").replace(/\{\{businessType\}\}/g,"LLC").replace(/\{\{ein\}\}/g,"12-3456789").replace(/\{\{yearsInBusiness\}\}/g,"3").replace(/\{\{requestedAmount\}\}/g,"150,000").replace(/\{\{monthlyRevenue\}\}/g,"50,000").replace(/\{\{annualRevenue\}\}/g,"600,000").replace(/\{\{creditScore\}\}/g,"720").replace(/\{\{existingDebt\}\}/g,"25,000").replace(/\{\{email\}\}/g,"john@samplebusiness.com").replace(/\{\{phone\}\}/g,"(555) 123-4567").replace(/\{\{address\}\}/g,"123 Business St, City, ST 12345").replace(/\{\{lenderName\}\}/g,"Sample Lender").replace(/\{\{lenderMinAmount\}\}/g,"50,000").replace(/\{\{lenderMaxAmount\}\}/g,"500,000").replace(/\{\{lenderFactorRate\}\}/g,"1.2 - 1.4").replace(/\{\{lenderPaybackTerm\}\}/g,"6-18 months").replace(/\{\{lenderApprovalTime\}\}/g,"24 hours").replace(/\{\{applicationId\}\}/g,"APP-12345")})})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-between",children:[a.jsx("button",{onClick:()=>{h(`Subject: Merchant Cash Advance Application - {{businessName}}

Dear {{lenderName}} Team,

I hope this email finds you well. I am writing to submit a merchant cash advance application for your review and consideration.

BUSINESS INFORMATION:
• Business Name: {{businessName}}
• Owner: {{ownerName}}
• Industry: {{industry}}
• Years in Business: {{yearsInBusiness}}
• Business Type: {{businessType}}
• EIN: {{ein}}

FINANCIAL DETAILS:
• Requested Amount: \${{requestedAmount}}
• Monthly Revenue: \${{monthlyRevenue}}
• Annual Revenue: \${{annualRevenue}}
• Credit Score: {{creditScore}}
• Existing Debt: \${{existingDebt}}

CONTACT INFORMATION:
• Email: {{email}}
• Phone: {{phone}}
• Address: {{address}}

I have attached the following documents for your review:
• Business bank statements (last 6 months)
• Tax returns
• Completed application form
• Voided business check

Based on your underwriting guidelines, I believe this application aligns well with your lending criteria:
• Amount Range: \${{lenderMinAmount}} - \${{lenderMaxAmount}}
• Factor Rate: {{lenderFactorRate}}
• Payback Term: {{lenderPaybackTerm}}
• Approval Time: {{lenderApprovalTime}}

I would appreciate the opportunity to discuss this application further and answer any questions you may have. Please let me know if you need any additional information or documentation.

Thank you for your time and consideration. I look forward to hearing from you soon.

Best regards,
{{ownerName}}
{{businessName}}
{{email}}
{{phone}}

---
This application was submitted through MCAPortal Pro
Application ID: {{applicationId}}`)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Reset to Default"}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:()=>{localStorage.setItem("mcaPortalEmailTemplate",u),d(!1),alert("Email template saved successfully!")},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Save Template"})]})]})]})}),H&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:a.jsx("div",{className:`${q==="error"?"bg-red-600 border-red-700":"bg-green-600 border-green-700"} text-white px-6 py-4 rounded-xl shadow-2xl border max-w-md w-full`,children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0",children:q==="error"?a.jsx(ko,{className:"h-5 w-5 text-red-200"}):a.jsx(_s,{className:"h-5 w-5 text-green-200"})}),a.jsxs("div",{className:"ml-3 flex-1",children:[a.jsx("p",{className:"text-sm font-medium",children:q==="error"?"Validation Error":"Action Required"}),a.jsx("p",{className:`text-xs mt-1 ${q==="error"?"text-red-100":"text-green-100"}`,children:M})]}),a.jsx("div",{className:"ml-4 flex-shrink-0",children:a.jsx("button",{onClick:()=>D(!1),className:`${q==="error"?"text-red-200 hover:text-white":"text-green-200 hover:text-white"} inline-flex focus:outline-none transition-colors duration-200`,children:q==="error"?a.jsx(ko,{className:"h-4 w-4"}):a.jsx(_s,{className:"h-4 w-4"})})})]})})})]})},M$=({onEditDeal:s,onViewQualifiedLenders:e})=>{const{user:t}=Wd(),[r,n]=ne.useState(""),[i,o]=ne.useState("all"),[l,c]=ne.useState(null),[d,u]=ne.useState(!1),[h,m]=ne.useState(!1),[p,x]=ne.useState(!1),[w,S]=ne.useState([]),[b,v]=ne.useState([]),[N,j]=ne.useState(!1),[E,A]=ne.useState(!1),L=ne.useRef(null),[C,B]=ne.useState(!1),[U,P]=ne.useState(null),[T,z]=ne.useState([]),[H,D]=ne.useState([]),[M,$]=ne.useState(0),[q,K]=ne.useState(null),[de,Ne]=ne.useState(!1),[R,W]=ne.useState(!1),[Z,ue]=ne.useState([]),[ce,ye]=ne.useState({}),[Se,Ee]=ne.useState(null),[De,We]=ne.useState(""),[Je,it]=ne.useState(new Set),[Be,Te]=ne.useState(!1),[oe,et]=ne.useState(!1),[pe,xe]=ne.useState({business_name:"",industry:"",years_in_business:0,monthly_revenue:0,credit_score:0}),[he,we]=ne.useState(null),Ae=(X,Ke="success")=>{we({type:Ke,message:X}),window.setTimeout(()=>we(null),2500)},[Ze,$e]=ne.useState({owner_name:"",email:"",phone:"",address:""}),[Qe,lt]=ne.useState(!0),[At,Nt]=ne.useState(!0),[Lt,Dt]=ne.useState(!1),[yt,os]=ne.useState([]),[me,Ce]=ne.useState(""),[dt,O]=ne.useState(!1),[_e,at]=ne.useState(null),[St,Tt]=ne.useState(""),[Pt,kt]=ne.useState(null);Yt.useEffect(()=>{l&&(xe({business_name:l.business_name||"",industry:l.industry||"",years_in_business:Number(l.years_in_business)||0,monthly_revenue:Number(l.monthly_revenue)||0,credit_score:Number(l.credit_score)||0}),$e({owner_name:l.owner_name||"",email:l.email||"",phone:l.phone||"",address:l.address||""}))},[l]);const jt=()=>{Te(!0)},Rt=()=>{l&&(xe({business_name:l.business_name||"",industry:l.industry||"",years_in_business:Number(l.years_in_business)||0,monthly_revenue:Number(l.monthly_revenue)||0,credit_score:Number(l.credit_score)||0}),$e({owner_name:l.owner_name||"",email:l.email||"",phone:l.phone||"",address:l.address||""})),Te(!1)},Ot=async()=>{if(l){et(!0);try{const X={business_name:pe.business_name,industry:pe.industry,years_in_business:Number(pe.years_in_business)||0,monthly_revenue:Number(pe.monthly_revenue)||0,credit_score:Number(pe.credit_score)||0,owner_name:Ze.owner_name,email:Ze.email,phone:Ze.phone,address:Ze.address};if(console.log("Saving application details",{id:l.id,payload:X}),(X.business_name??"")===(l.business_name??"")&&(X.industry??"")===(l.industry??"")&&Number(X.years_in_business??0)===Number(l.years_in_business??0)&&Number(X.monthly_revenue??0)===Number(l.monthly_revenue??0)&&Number(X.credit_score??0)===Number(l.credit_score??0)&&(X.owner_name??"")===(l.owner_name??"")&&(X.email??"")===(l.email??"")&&(X.phone??"")===(l.phone??"")&&(X.address??"")===(l.address??"")){Ae("No changes to save","info"),Te(!1);return}const Oe=await Cp(l.id,X);c(Xe=>Xe&&{...Xe,...Oe}),z(Xe=>Xe.map(nt=>nt.id===l.id?{...nt,...Oe}:nt)),Te(!1),Ae("Saved changes successfully","success")}catch(X){console.error("Failed to save details",X),Ae("Failed to save details","error")}finally{et(!1)}}};Yt.useEffect(()=>{const X=Ke=>{if(!q)return;const Oe=Ke.target;Oe&&!Oe.closest('[data-dropdown="actions"]')&&K(null)};return document.addEventListener("mousedown",X),()=>document.removeEventListener("mousedown",X)},[q]);const Ps=ne.useCallback(async()=>{if(l){x(!0);try{const[X,Ke,Oe]=await Promise.all([Jo(l.id),co(l.id),Fh(l.id)]);S(X.map(Xe=>({id:Xe.id,file_name:Xe.file_name,file_size:Xe.file_size,file_type:Xe.file_type,upload_date:Xe.upload_date,file_url:Xe.file_url}))),v((Ke||[]).map(Xe=>({id:Xe.id,file_name:Xe.file_name,file_size:Xe.file_size,file_type:Xe.file_type,upload_date:Xe.upload_date,file_url:Xe.file_url,statement_date:Xe.statement_date}))),D((Oe||[]).map(Xe=>({id:String(Xe.id||crypto.randomUUID()),file_name:Xe.file_name,file_size:Xe.file_size||void 0,file_type:Xe.file_type||void 0,upload_date:Xe.created_at||void 0,file_url:Xe.file_url||void 0})))}catch(X){console.error("Failed to reload documents",X)}finally{x(!1)}}},[l]),Fs=async X=>{if(!(!X||!l)){j(!0);try{for(const Ke of Array.from(X)){const Oe=/mtd/i.test(Ke.name),Xe=Oe?`mtd/${l.id}/${Date.now()}-${Ke.name}`:`docs/${l.id}/${Date.now()}-${Ke.name}`,nt=await Ct.storage.from("application_documents").upload(Xe,Ke,{upsert:!0});if(nt.error)throw nt.error;const{data:Et}=Ct.storage.from("application_documents").getPublicUrl(Xe),ot=Et==null?void 0:Et.publicUrl;if(Oe)await mj({application_id:l.id,file_name:Ke.name,file_size:Ke.size,file_type:Ke.type,file_url:ot,upload_status:"completed"});else{const gt=await Ct.from("application_documents").insert([{application_id:l.id,file_name:Ke.name,file_size:Ke.size,file_type:Ke.type,upload_date:new Date().toISOString(),file_url:ot??null}]).select();if(gt.error)throw gt.error}}await Ps()}catch(Ke){console.error("Document upload failed",Ke),alert("Failed to upload document(s).")}finally{j(!1),L.current&&(L.current.value="")}}},Os=async X=>{await Fs(X.target.files)},be=async()=>{if(!U)return;const X=U;B(!1),P(null),X.kind==="doc"?await ve(X.data):await Ve(X.data)},ve=async X=>{if(!l)return;const Ke=w;S(Oe=>Oe.filter(Xe=>Xe.id!==X.id));try{if(X.file_url)try{const Oe="/object/public/",Xe=X.file_url.indexOf(Oe);if(Xe!==-1){const nt=X.file_url.substring(Xe+Oe.length),Et=nt.indexOf("/"),ot=nt.substring(0,Et),gt=nt.substring(Et+1);await Ct.storage.from(ot).remove([gt])}}catch{}await p1(X.id)}catch(Oe){console.error("Delete document failed",Oe),S(Ke),alert("Failed to delete document.")}},Ve=async X=>{if(!l)return;const Ke=b;v(Oe=>Oe.filter(Xe=>Xe.id!==X.id));try{if(X.file_url)try{const Oe="/object/public/",Xe=X.file_url.indexOf(Oe);if(Xe!==-1){const nt=X.file_url.substring(Xe+Oe.length),Et=nt.indexOf("/"),ot=nt.substring(0,Et),gt=nt.substring(Et+1);await Ct.storage.from(ot).remove([gt])}}catch{}await TE(l.id,X.file_name,X.file_size)}catch(Oe){console.error("Delete MTD failed",Oe),v(Ke),alert("Failed to delete MTD file.")}};Yt.useEffect(()=>{if(!h||!(l!=null&&l.id))return;const X=Ct.channel(`docs-mtd-${l.id}`).on("postgres_changes",{event:"*",schema:"public",table:"application_documents",filter:`application_id=eq.${l.id}`},()=>{Ps()}).on("postgres_changes",{event:"*",schema:"public",table:"application_mtd",filter:`application_id=eq.${l.id}`},()=>{Ps()}).on("postgres_changes",{event:"*",schema:"public",table:"application_additional",filter:`application_id=eq.${l.id}`},()=>{Ps()}).subscribe();return()=>{Ct.removeChannel(X)}},[h,l==null?void 0:l.id,Ps]);const ct=X=>{it(Ke=>{const Oe=new Set(Ke);return Oe.has(X)?Oe.delete(X):Oe.add(X),Oe})},Y=async()=>{if(!Se||Je.size===0)return;const X=Array.from(Je).filter(Oe=>!ce[Oe]);if(X.length===0)return;const Ke={...ce};ye(Oe=>{const Xe={...Oe};return X.forEach(nt=>{Xe[nt]=!0}),Xe}),it(new Set),We(""),Promise.all(X.map(Oe=>AN(Oe,Se.id,!0))).then(()=>{try{localStorage.setItem("mca-permissions-updated",String(Date.now())),window.dispatchEvent(new Event("mca-permissions-updated"))}catch{}}).catch(Oe=>{console.error("Bulk add failed",Oe),ye(Xe=>{const nt={...Xe};return X.forEach(Et=>{nt[Et]=Ke[Et]||!1}),nt}),alert("Failed to add selected users")})},ie=async X=>{if(!Se)return;const Ke=!!ce[X];ye(Oe=>({...Oe,[X]:!1}));try{await AN(X,Se.id,!1);try{localStorage.setItem("mca-permissions-updated",String(Date.now())),window.dispatchEvent(new Event("mca-permissions-updated"))}catch{}}catch(Oe){console.error("Revoke failed",Oe),ye(Xe=>({...Xe,[X]:Ke})),alert("Failed to revoke access")}},je=async X=>{if(t){Ee(X),Ne(!0),W(!0);try{const[Ke,Oe,Xe]=await Promise.all([im("admin"),im("member"),cE(X.id)]),nt=[...Ke,...Oe].filter(Et=>Et.id!==t.id);ue(nt),ye(Xe||{}),it(new Set),We("")}catch(Ke){console.error("Failed to load access data",Ke),ue([]),ye({})}finally{W(!1)}}};Yt.useEffect(()=>{(async()=>{if(!(t!=null&&t.id)){console.log("No user ID available, skipping application load");return}try{const Ke=t.role==="admin"||t.role==="Admin";let Oe;Ke?(console.log("Loading all applications for admin user:",t.id),Oe=await bE(),console.log("Found all applications:",Oe.length)):(console.log("Loading applications for member user ID:",t.id),Oe=await gE(t.id),console.log("Found applications visible to member (own + access):",Oe.length)),z(Oe.map(Xe=>({...Xe,matchedLenders:0,lenderSubmissions:[]})));try{const Xe=await Promise.allSettled(Oe.map(async Et=>{const ot=await fj(Et.id);return{appId:Et.id,rows:ot||[]}})),nt={};for(const Et of Xe)Et.status==="fulfilled"&&(nt[Et.value.appId]=Et.value.rows);z(Et=>Et.map(ot=>({...ot,lenderSubmissions:nt[ot.id]||[],matchedLenders:(nt[ot.id]||[]).length})))}catch(Xe){console.warn("Failed to enrich lender submissions:",Xe)}}catch(Ke){console.error("Error loading applications:",Ke)}finally{}})()},[t==null?void 0:t.id,t==null?void 0:t.role,M]),Yt.useEffect(()=>{const X=Ke=>{Ke.key==="mca-permissions-updated"&&$(Oe=>Oe+1)};return window.addEventListener("storage",X),()=>window.removeEventListener("storage",X)},[]);const se=X=>{switch(X){case"funded":return"bg-green-100 text-green-800";case"approved":return"bg-blue-100 text-blue-800";case"counter-offer":return"bg-yellow-100 text-yellow-800";case"pending":return"bg-gray-100 text-gray-800";case"declined":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},le=X=>{switch(X){case"funded":return"bg-blue-100 text-blue-800";case"approved":return"bg-green-100 text-green-800";case"submitted":return"bg-yellow-100 text-yellow-800";case"under-review":return"bg-purple-100 text-purple-800";case"declined":return"bg-red-100 text-red-800";case"draft":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Ue=X=>{switch(X){case"funded":return a.jsx(Mc,{className:"w-4 h-4"});case"approved":return a.jsx(_s,{className:"w-4 h-4"});case"submitted":return a.jsx(Dc,{className:"w-4 h-4"});case"under-review":return a.jsx(jM,{className:"w-4 h-4"});case"declined":return a.jsx(ko,{className:"w-4 h-4"});default:return a.jsx(Dc,{className:"w-4 h-4"})}},Ie=T.filter(X=>{var ot,gt;const Ke=(r||"").trim().toLowerCase(),Oe=i==="all"||X.status===i;if(!Ke)return Oe;const Xe=[X.business_name||"",X.industry||"",X.owner_name||"",X.email||"",X.phone||"",X.address||"",X.id||"",((ot=X.user)==null?void 0:ot.full_name)||"",((gt=X.user)==null?void 0:gt.email)||""].join(" ").toLowerCase();return Ke.split(/\s+/).filter(Boolean).every(Fe=>Xe.includes(Fe))&&Oe}),He={all:T.length,submitted:T.filter(X=>X.status==="submitted").length,approved:T.filter(X=>X.status==="approved").length,declined:T.filter(X=>X.status==="declined").length},Me=Yt.useMemo(()=>{const X=w.map(Xe=>({kind:"doc",...Xe})),Ke=b.map(Xe=>({kind:"mtd",...Xe})),Oe=H.map(Xe=>({kind:"additional",...Xe}));return[...X,...Ke,...Oe]},[w,b,H]),st=X=>{const Ke=Array.from(new Set((X.lenderSubmissions||[]).map(Oe=>Oe.lender_id).filter(Oe=>typeof Oe=="string"&&Oe.length>0)));s==null||s({applicationId:X.id,lockedLenderIds:Ke})},ut=X=>{const Ke=Array.from(new Set((X.lenderSubmissions||[]).map(Oe=>Oe.lender_id).filter(Oe=>typeof Oe=="string"&&Oe.length>0)));e==null||e({applicationId:X.id,lockedLenderIds:Ke})},wt=X=>{c(X),u(!0),(async()=>{try{Dt(!0);const Ke=await SE(X.id);os(Ke||[])}catch(Ke){console.warn("Failed to load lender notes:",Ke),os([])}finally{Dt(!1)}})()},xt=async X=>{c(X),m(!0),x(!0);try{const[Ke,Oe,Xe]=await Promise.all([Jo(X.id),co(X.id),Fh(X.id)]);S(Ke.map(nt=>({id:nt.id,file_name:nt.file_name,file_size:nt.file_size,file_type:nt.file_type,upload_date:nt.upload_date,file_url:nt.file_url}))),v((Oe||[]).map(nt=>({id:nt.id,file_name:nt.file_name,file_size:nt.file_size,file_type:nt.file_type,upload_date:nt.upload_date,file_url:nt.file_url,statement_date:nt.statement_date}))),D((Xe||[]).map(nt=>({id:nt.id,file_name:nt.file_name,file_size:nt.file_size,file_type:nt.file_type,upload_date:nt.created_at,file_url:nt.file_url})))}catch(Ke){console.error("Failed to load documents",Ke),S([]),v([]),D([])}finally{x(!1)}};return a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[h&&l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>m(!1),children:a.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-hidden border border-gray-100",onClick:X=>X.stopPropagation(),children:[a.jsxs("div",{className:"px-8 py-6 bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-700 text-white relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 to-transparent"}),a.jsx("div",{className:"relative z-10",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-lg",children:a.jsx(Is,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold tracking-tight",children:"Application Documents"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("span",{className:"text-blue-100 text-sm font-medium",children:l.business_name}),a.jsx("span",{className:"text-blue-200 text-sm",children:"•"}),a.jsx("span",{className:"text-blue-200 text-sm",children:"Document Management"})]})]})]})})})]}),a.jsxs("div",{className:"p-8 overflow-y-auto max-h-[calc(95vh-200px)]",children:[a.jsxs("div",{className:"text-gray-600 mb-6 text-center",children:[a.jsx("div",{className:"text-sm font-medium",children:"Manage application documents and bank statements"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Upload, view, and delete documents for this application"})]}),a.jsx("input",{ref:L,type:"file",multiple:!0,onChange:Os,className:"hidden"}),p?a.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[a.jsx("div",{className:"relative",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600"})}),a.jsx("p",{className:"text-gray-600 text-sm mt-4 font-medium",children:"Loading documents..."})]}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"rounded-2xl p-6 mb-8 transition-all duration-150 bg-gradient-to-br from-gray-50 to-gray-100/50 border border-gray-200/50",children:[a.jsx("div",{className:"flex items-center mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:a.jsx(Is,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Files (Documents + MTD)"}),a.jsxs("p",{className:"text-sm text-gray-600",children:[Me.length," file",Me.length!==1?"s":""," available"]})]})]})}),a.jsxs("div",{onDragOver:X=>{X.preventDefault(),X.stopPropagation(),A(!0)},onDragLeave:()=>A(!1),onDrop:async X=>{X.preventDefault(),X.stopPropagation(),A(!1);const Ke=X.dataTransfer.files;Ke&&Ke.length&&await Fs(Ke)},className:`mb-6 rounded-xl border-2 border-dashed ${E?"border-blue-400 bg-blue-50/40":"border-blue-200 bg-white/60"} p-5 flex items-center justify-between`,children:[a.jsxs("div",{className:"flex items-center gap-3 text-left",children:[a.jsx("div",{className:"w-9 h-9 rounded-lg bg-blue-100 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-gray-800",children:"Drag & drop files here"}),a.jsx("div",{className:"text-xs text-gray-500",children:"or click Browse to select files"})]})]}),a.jsx("button",{onClick:()=>{var X;return(X=L.current)==null?void 0:X.click()},disabled:N,className:`px-3 py-2 rounded-lg text-sm font-semibold ${N?"bg-blue-300 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:N?"Uploading…":"Browse"})]}),Me.length===0?a.jsx("div",{className:"text-center py-6 text-sm text-gray-500",children:"No files uploaded yet"}):a.jsx("div",{className:`space-y-3 rounded-lg ${E?"ring-2 ring-blue-300 ring-offset-0":""}`,children:Me.map(X=>{var Ke,Oe;return a.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl p-5 border border-white/60 shadow-sm hover:shadow-md transition-all duration-200 group",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[(()=>{var Et;const Xe=/\.pdf$/i.test(X.file_name)||(X.file_type||"").toLowerCase().includes("pdf"),nt=(((Et=X.file_type)==null?void 0:Et.split("/")[1])||X.file_name.split(".").pop()||"FILE").toUpperCase();return a.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden border border-gray-200 bg-white flex items-center justify-center shadow-sm",children:Xe&&X.file_url?a.jsx("iframe",{src:`${X.file_url}#view=FitH`,title:`Preview ${X.file_name}`,className:"w-full h-full",allow:"fullscreen",allowFullScreen:!0,loading:"lazy"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-50 to-gray-100 text-gray-600 text-xs font-semibold",children:nt})})})(),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h5",{className:"text-sm font-semibold text-gray-900 truncate",children:X.file_name}),X.kind==="mtd"?a.jsx("span",{className:"inline-flex px-2.5 py-1 text-xs font-semibold bg-purple-100 text-purple-800 rounded-full",children:"MTD"}):a.jsx("span",{className:"inline-flex px-2.5 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded-full",children:(Oe=((Ke=X.file_type)==null?void 0:Ke.split("/")[1])||X.file_name.split(".").pop()||"FILE")==null?void 0:Oe.toUpperCase()})]}),a.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Br,{className:"w-3 h-3"}),X.file_size?`${(X.file_size/1024).toFixed(1)} KB`:"Size unknown"]}),X.upload_date&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Dc,{className:"w-3 h-3"}),new Date(X.upload_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),X.kind==="mtd"&&X.statement_date&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Dc,{className:"w-3 h-3"}),new Date(X.statement_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]})]})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:X.file_url?a.jsxs(a.Fragment,{children:[a.jsxs("button",{className:"px-3 py-2 text-xs font-semibold text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-gray-300 transition-all duration-200",children:[a.jsx(TM,{className:"w-3 h-3 mr-1 inline"}),"Download"]}),a.jsxs("a",{href:X.file_url,target:"_blank",rel:"noreferrer",className:"px-3 py-2 text-xs font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 shadow-sm hover:shadow-md",children:[a.jsx(rc,{className:"w-3 h-3 mr-1 inline"}),"Open"]}),a.jsxs("button",{onClick:()=>{X.kind==="mtd"?P({kind:"mtd",data:{id:X.id,file_url:X.file_url,file_name:X.file_name,file_size:X.file_size}}):P({kind:"doc",data:{id:X.id,file_url:X.file_url,file_name:X.file_name}}),B(!0)},className:"px-3 py-2 text-xs font-semibold text-red-700 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 hover:border-red-300 transition-all duration-200",children:[a.jsx("svg",{className:"w-3 h-3 mr-1 inline",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]}):a.jsxs("span",{className:"px-3 py-2 text-xs text-gray-400 bg-gray-100 rounded-lg",children:[a.jsx(ko,{className:"w-3 h-3 mr-1 inline"}),"No URL"]})})]})},`${X.kind}-${X.id}`)})})]})})]}),C&&U&&a.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>{B(!1),P(null)}}),a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-md border border-gray-100 p-6",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-100 flex items-center justify-center text-red-600",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Confirm Delete"}),a.jsxs("div",{className:"text-sm text-gray-600",children:[U.kind==="doc"?"Delete document":"Delete MTD file",": ",a.jsx("span",{className:"font-medium",children:U.data.file_name}),"?"]})]})]}),a.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>{B(!1),P(null)},className:"px-4 py-2 rounded-xl border border-gray-200 text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:be,className:"px-4 py-2 rounded-xl text-white bg-red-600 hover:bg-red-700 shadow-sm",children:"Delete"})]})]})]}),a.jsxs("div",{className:"px-8 py-6 bg-gray-50/80 border-t border-gray-100 flex justify-between items-center",children:[a.jsxs("div",{className:"text-xs text-gray-500",children:["Application ID: ",l.id]}),a.jsx("button",{onClick:()=>m(!1),className:"px-6 py-3 rounded-xl border border-gray-200 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-300 font-semibold transition-all duration-200 shadow-sm hover:shadow-md",children:"Close"})]})]})}),a.jsx("div",{className:"mb-8",children:t&&(t.role==="admin"||t.role==="Admin")?a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"All Deals"}),a.jsx("p",{className:"text-gray-600",children:"View and manage all merchant cash advance submissions"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Admin view - showing all applications from all users"})]}):a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"My Deals"}),a.jsx("p",{className:"text-gray-600",children:"View and manage your merchant cash advance submissions"}),t&&a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Showing applications for: ",t.name," (",t.email,")"]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(Br,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:t&&(t.role==="admin"||t.role==="Admin")?"All Deals":"My Deals"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:T.length})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(_s,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Approved"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:He.approved})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:a.jsx(Dc,{className:"w-6 h-6 text-yellow-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Submitted"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:He.submitted})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:a.jsx(Lg,{className:"w-6 h-6 text-purple-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Volume"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",T.reduce((X,Ke)=>X+Ke.requested_amount,0).toLocaleString()]})]})]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:a.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ij,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search by business, contact, phone, email, ID...",value:r,onChange:X=>n(X.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),a.jsxs("select",{value:i,onChange:X=>o(X.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[a.jsxs("option",{value:"all",children:["All Status (",He.all,")"]}),a.jsxs("option",{value:"submitted",children:["Submitted (",He.submitted,")"]}),a.jsxs("option",{value:"approved",children:["Approved (",He.approved,")"]}),a.jsxs("option",{value:"declined",children:["Declined (",He.declined,")"]})]})]})})}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-visible",children:a.jsx("div",{className:"w-full overflow-x-auto md:overflow-visible",children:a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Business"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Financial"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activity"}),t&&(t.role==="admin"||t.role==="Admin")&&a.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted By"}),a.jsx("th",{className:"px-4 py-4"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ie.length===0?a.jsx("tr",{children:a.jsx("td",{className:"px-6 py-10 text-center text-gray-500 text-sm",colSpan:t&&(t.role==="admin"||t.role==="Admin")?7:6,children:"No application found"})}):Ie.map(X=>{var Ke,Oe,Xe;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:a.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:a.jsx("span",{className:"text-sm font-medium text-white",children:X.business_name.charAt(0).toUpperCase()})})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.business_name}),a.jsx("div",{className:"text-xs text-gray-400",children:X.industry})]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.owner_name}),a.jsx("div",{className:"text-sm text-gray-500",children:X.email}),a.jsx("div",{className:"text-sm text-gray-500",children:X.phone||"N/A"})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",X.requested_amount.toLocaleString()]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["$",X.monthly_revenue.toLocaleString(),"/mo"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Credit: ",X.credit_score," | ",X.years_in_business,"y"]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex flex-col space-y-2",children:[a.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${le(X.status)} max-w-fit`,children:[Ue(X.status),a.jsx("span",{className:"ml-1 capitalize",children:X.status.replace("-"," ")})]}),X.lenderSubmissions.length>0&&a.jsxs("span",{className:"text-xs text-gray-500",children:[X.lenderSubmissions.length," lender",X.lenderSubmissions.length>1?"s":""]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm text-gray-900",children:["Submitted: ",new Date(X.created_at).toLocaleDateString()]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Last: ",new Date(X.updated_at).toLocaleDateString()]})]})}),t&&(t.role==="admin"||t.role==="Admin")&&a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-8 w-8",children:a.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:a.jsx("span",{className:"text-xs font-medium text-white",children:(((Ke=X.user)==null?void 0:Ke.full_name)||X.owner_name||"U").charAt(0).toUpperCase()})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:((Oe=X.user)==null?void 0:Oe.full_name)||X.owner_name||"Unknown User"}),a.jsx("div",{className:"text-sm text-gray-500",children:((Xe=X.user)==null?void 0:Xe.email)||X.email||"No email"})]})]})}),a.jsx("td",{className:"px-4 py-4 relative text-right",children:a.jsxs("div",{"data-dropdown":"actions",children:[a.jsx("button",{onClick:()=>K(q===X.id?null:X.id),className:`inline-flex items-center justify-center h-8 w-8 rounded-lg transition-all duration-200 ${q===X.id?"bg-gray-100 text-gray-700 shadow-sm":"text-gray-400 hover:text-gray-600 hover:bg-gray-50"}`,title:"More actions",children:a.jsx(FM,{className:"w-4 h-4"})}),q===X.id&&a.jsxs("div",{className:"absolute right-10 top-1/2 -translate-y-1/2 bg-white border border-gray-200/60 rounded-xl shadow-2xl z-20 min-w-[240px] overflow-hidden backdrop-blur-sm",children:[a.jsx("div",{className:"px-6 py-3 bg-gradient-to-r from-slate-50 to-gray-50 border-b border-gray-200/80",children:a.jsxs("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-600 flex items-center",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mr-2"}),"Deal Actions"]})}),a.jsxs("div",{className:"py-2",children:[a.jsxs("button",{onClick:()=>{wt(X),K(null)},className:"flex items-center w-full text-left px-6 py-3 text-sm font-medium text-slate-700 hover:bg-blue-50/80 hover:text-blue-700 transition-all duration-200 group",children:[a.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-blue-100/50 group-hover:bg-blue-200/80 mr-3 transition-colors",children:a.jsx(rc,{className:"w-4 h-4 text-blue-600 group-hover:text-blue-700"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"View Details"}),a.jsx("div",{className:"text-xs text-slate-500 group-hover:text-blue-600",children:"Review application info"})]})]}),a.jsxs("button",{onClick:()=>{xt(X),K(null)},className:"flex items-center w-full text-left px-6 py-3 text-sm font-medium text-slate-700 hover:bg-emerald-50/80 hover:text-emerald-700 transition-all duration-200 group",children:[a.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-emerald-100/50 group-hover:bg-emerald-200/80 mr-3 transition-colors",children:a.jsx(Is,{className:"w-4 h-4 text-emerald-600 group-hover:text-emerald-700"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"View Documents"}),a.jsx("div",{className:"text-xs text-slate-500 group-hover:text-emerald-600",children:"Bank statements & files"})]})]}),a.jsxs("button",{onClick:()=>{ut(X),K(null)},className:"flex items-center w-full text-left px-6 py-3 text-sm font-medium text-slate-700 hover:bg-indigo-50/80 hover:text-indigo-700 transition-all duration-200 group",children:[a.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-indigo-100/50 group-hover:bg-indigo-200/80 mr-3 transition-colors",children:a.jsx(Mc,{className:"w-4 h-4 text-indigo-600 group-hover:text-indigo-700"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Qualified Lenders"}),a.jsx("div",{className:"text-xs text-slate-500 group-hover:text-indigo-600",children:"View lender matches"})]})]}),a.jsxs("button",{onClick:()=>{st(X),K(null)},className:"flex items-center w-full text-left px-6 py-3 text-sm font-medium text-slate-700 hover:bg-amber-50/80 hover:text-amber-700 transition-all duration-200 group",children:[a.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-amber-100/50 group-hover:bg-amber-200/80 mr-3 transition-colors",children:a.jsx("svg",{className:"w-4 h-4 text-amber-600 group-hover:text-amber-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Bank Statements"}),a.jsx("div",{className:"text-xs text-slate-500 group-hover:text-amber-600",children:"Modify Bank Documents"})]})]}),t&&(t.role==="admin"||t.role==="Admin")&&a.jsxs("button",{onClick:()=>{je(X),K(null)},className:"flex items-center w-full text-left px-6 py-3 text-sm font-medium text-slate-700 hover:bg-violet-50/80 hover:text-violet-700 transition-all duration-200 group",title:"Manage which users can access this deal",children:[a.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-violet-100/50 group-hover:bg-violet-200/80 mr-3 transition-colors",children:a.jsx(On,{className:"w-4 h-4 text-violet-600 group-hover:text-violet-700"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Manage Access"}),a.jsx("div",{className:"text-xs text-slate-500 group-hover:text-violet-600",children:"Control user permissions"})]})]})]})]})]})})]},X.id)})})]})})}),de&&Se&&a.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>Ne(!1)}),a.jsxs("div",{className:"relative z-50 w-full max-w-2xl bg-white rounded-3xl shadow-2xl border border-gray-100 overflow-hidden",children:[a.jsxs("div",{className:"px-8 py-6 bg-gradient-to-br from-emerald-600 via-emerald-700 to-teal-700 text-white relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 to-transparent"}),a.jsx("div",{className:"relative z-10",children:a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center",children:a.jsx(On,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xl font-bold tracking-tight",children:"Manage Access"}),a.jsx("div",{className:"text-emerald-100 text-sm font-medium",children:Se.business_name})]})]})})]}),a.jsxs("div",{className:"p-8",children:[a.jsxs("div",{className:"text-gray-600 mb-6 text-center",children:[a.jsx("div",{className:"text-sm font-medium",children:"Grant specific users access to this deal"}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Search and select users to manage permissions"})]}),R?a.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[a.jsx("div",{className:"relative",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-emerald-200 border-t-emerald-600"})}),a.jsx("p",{className:"text-gray-600 text-sm mt-4 font-medium",children:"Loading users..."})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[a.jsx("input",{type:"text",value:De,onChange:X=>We(X.target.value),placeholder:"Search users by name or email...",className:"flex-1 px-5 py-3.5 border border-gray-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all duration-200 text-sm font-medium placeholder-gray-400 shadow-sm"}),a.jsxs("button",{onClick:Y,disabled:Je.size===0,className:`px-6 py-3.5 rounded-xl text-white font-semibold transition-all duration-200 shadow-lg ${Je.size===0?"bg-gray-300 cursor-not-allowed text-gray-500":"bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 hover:shadow-xl transform hover:scale-105"}`,children:["Add Users ",Je.size>0&&`(${Je.size})`]})]}),a.jsx("div",{className:"mb-8",children:De.trim().length===0?a.jsxs("div",{className:"text-center py-12 bg-gray-50/50 rounded-2xl border-2 border-dashed border-gray-200",children:[a.jsx(On,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Start typing to search for users"}),a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Find users by name or email address"})]}):a.jsxs("div",{className:"space-y-3 max-h-64 overflow-auto pr-2",children:[Z.filter(X=>!ce[X.id]).filter(X=>{const Ke=De.trim().toLowerCase(),Oe=(X.full_name||"").toLowerCase(),Xe=(X.email||"").toLowerCase();return Oe.includes(Ke)||Xe.includes(Ke)}).map(X=>a.jsx("label",{className:"flex items-center justify-between rounded-xl border border-gray-200 px-5 py-4 hover:bg-emerald-50/50 hover:border-emerald-200 cursor-pointer transition-all duration-200 group",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("input",{type:"checkbox",checked:Je.has(X.id),onChange:()=>ct(X.id),className:"h-5 w-5 text-emerald-600 focus:ring-emerald-500 rounded-md border-2 border-gray-300 group-hover:border-emerald-400 transition-colors"}),a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-emerald-100 to-emerald-200 flex items-center justify-center",children:a.jsx("span",{className:"text-emerald-700 font-semibold text-sm",children:(X.full_name||X.email).charAt(0).toUpperCase()})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-gray-900",children:X.full_name||X.email}),a.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[a.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${(X.roles||"").toLowerCase()==="admin"?"bg-purple-400":"bg-blue-400"}`}),(X.roles||"").toLowerCase()==="admin"?"Admin":"Member"]})]})]})},X.id)),Z.filter(X=>!ce[X.id]).filter(X=>{const Ke=De.trim().toLowerCase(),Oe=(X.full_name||"").toLowerCase(),Xe=(X.email||"").toLowerCase();return Ke&&(Oe.includes(Ke)||Xe.includes(Ke))}).length===0&&a.jsxs("div",{className:"text-center py-12 bg-gray-50/50 rounded-2xl",children:[a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"No users match your search"}),a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Try a different search term"})]})]})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx("div",{className:"text-sm font-bold text-gray-700",children:"Granted Users"}),a.jsx("div",{className:"px-2 py-1 bg-emerald-100 text-emerald-700 rounded-full text-xs font-semibold",children:Z.filter(X=>ce[X.id]).length})]}),a.jsxs("div",{className:"space-y-3 max-h-64 overflow-auto pr-2",children:[Z.filter(X=>ce[X.id]).map(X=>a.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-emerald-200 px-5 py-4 bg-gradient-to-r from-emerald-50/80 to-emerald-50/40",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-emerald-500 to-emerald-600 flex items-center justify-center shadow-sm",children:a.jsx("span",{className:"text-white font-semibold text-sm",children:(X.full_name||X.email).charAt(0).toUpperCase()})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-gray-900",children:X.full_name||X.email}),a.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[a.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${(X.roles||"").toLowerCase()==="admin"?"bg-purple-400":"bg-blue-400"}`}),(X.roles||"").toLowerCase()==="admin"?"Admin":"Member",a.jsx("span",{className:"mx-1",children:"•"}),a.jsx("span",{className:"text-emerald-600 font-medium",children:"Access Granted"})]})]})]}),a.jsx("button",{onClick:()=>ie(X.id),className:"px-4 py-2 text-xs font-semibold rounded-lg border border-red-200 text-red-700 bg-red-50 hover:bg-red-100 hover:border-red-300 transition-all duration-200 hover:shadow-sm",children:"Revoke"})]},X.id)),Z.filter(X=>ce[X.id]).length===0&&a.jsxs("div",{className:"text-center py-12 bg-gray-50/50 rounded-2xl border-2 border-dashed border-gray-200",children:[a.jsx(On,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"No users have access yet"}),a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Search and add users to grant access"})]})]})]})]})]}),a.jsx("div",{className:"px-8 py-6 bg-gray-50/80 border-t border-gray-100 flex justify-end",children:a.jsx("button",{onClick:()=>Ne(!1),className:"px-6 py-3 rounded-xl border border-gray-200 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-300 font-semibold transition-all duration-200 shadow-sm hover:shadow-md",children:"Close"})})]})]}),d&&l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>u(!1),children:a.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-5xl w-full max-h-[95vh] overflow-hidden border border-gray-100",onClick:X=>X.stopPropagation(),children:[a.jsxs("div",{className:"px-8 py-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 border-b border-gray-200/80 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/40 to-transparent"}),a.jsx("div",{className:"relative z-10 flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg",children:a.jsx("span",{className:"text-white font-bold text-lg",children:l.business_name.charAt(0).toUpperCase()})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-900 tracking-tight",children:l.business_name}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold bg-blue-100 text-blue-800",children:l.industry}),a.jsx("span",{className:"text-gray-500 text-sm",children:"•"}),a.jsx("span",{className:"text-gray-600 text-sm font-medium",children:"Deal Details"})]})]})]})})]}),a.jsxs("div",{className:"p-8 overflow-y-auto max-h-[calc(95vh-140px)]",children:[a.jsxs("div",{className:"relative mb-4",children:[he&&a.jsx("div",{className:"pointer-events-none absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2",children:a.jsx("div",{className:`px-4 py-2 rounded-xl border text-sm font-semibold shadow-sm
                      ${he.type==="success"?"bg-emerald-50 border-emerald-200 text-emerald-800":""}
                      ${he.type==="error"?"bg-red-50 border-red-200 text-red-800":""}
                      ${he.type==="info"?"bg-blue-50 border-blue-200 text-blue-800":""}
                    `,children:he.message})}),a.jsx("div",{className:"flex items-center justify-end gap-2",children:Be?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{disabled:oe,onClick:Ot,className:`px-4 py-2 text-sm font-semibold text-white rounded-lg ${oe?"bg-indigo-300":"bg-indigo-600 hover:bg-indigo-700"}`,children:oe?"Saving...":"Save Changes"}),a.jsx("button",{onClick:Rt,className:"px-4 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50",children:"Cancel"})]}):a.jsx("button",{onClick:jt,className:"px-4 py-2 text-sm font-semibold text-indigo-700 bg-indigo-100 rounded-lg hover:bg-indigo-200",children:"Edit Details"})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100/50 rounded-2xl p-6 border border-gray-200/50",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),a.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Business Information"})]}),a.jsx("div",{className:"space-y-4",children:Be?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("label",{className:"flex items-center justify-between py-1",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Business Name"}),a.jsx("input",{value:pe.business_name,onChange:X=>xe(Ke=>({...Ke,business_name:X.target.value})),className:"ml-4 w-64 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("label",{className:"flex items-center justify-between py-1",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Industry"}),a.jsx("input",{value:pe.industry,onChange:X=>xe(Ke=>({...Ke,industry:X.target.value})),className:"ml-4 w-64 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("label",{className:"flex items-center justify-between py-1",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Time in Business (years)"}),a.jsx("input",{type:"number",value:pe.years_in_business,onChange:X=>xe(Ke=>({...Ke,years_in_business:Number(X.target.value)})),className:"no-spinner ml-4 w-32 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("label",{className:"flex items-center justify-between py-1",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Monthly Revenue"}),a.jsx("input",{type:"number",value:pe.monthly_revenue,onChange:X=>xe(Ke=>({...Ke,monthly_revenue:Number(X.target.value)})),className:"no-spinner ml-4 w-40 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("label",{className:"flex items-center justify-between py-1",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Credit Score"}),a.jsx("input",{type:"number",value:pe.credit_score,onChange:X=>xe(Ke=>({...Ke,credit_score:Number(X.target.value)})),className:"no-spinner ml-4 w-32 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]})]})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-200/60",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Business Name"}),a.jsx("span",{className:"font-semibold text-gray-900",children:l.business_name})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-200/60",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Industry"}),a.jsx("span",{className:"font-semibold text-gray-900",children:l.industry})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-200/60",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Time in Business"}),a.jsxs("span",{className:"font-semibold text-gray-900",children:[l.years_in_business," years"]})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-200/60",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Monthly Revenue"}),a.jsxs("span",{className:"font-bold text-emerald-600",children:["$",l.monthly_revenue.toLocaleString()]})]}),a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Credit Score"}),a.jsx("span",{className:`${l.credit_score>=700?"text-green-600":l.credit_score>=600?"text-yellow-600":"text-red-600"} font-bold`,children:l.credit_score})]})]})})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50/50 rounded-2xl p-6 border border-blue-200/50",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),a.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Contact Information"})]}),a.jsx("div",{className:"space-y-4",children:Be?a.jsx(a.Fragment,{children:a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("label",{className:"flex items-center justify-between py-1",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Owner"}),a.jsx("input",{value:Ze.owner_name,onChange:X=>$e(Ke=>({...Ke,owner_name:X.target.value})),className:"ml-4 w-64 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("label",{className:"flex items-center justify-between py-1",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Email"}),a.jsx("input",{type:"email",value:Ze.email,onChange:X=>$e(Ke=>({...Ke,email:X.target.value})),className:"ml-4 w-64 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("label",{className:"flex items-center justify-between py-1",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Phone"}),a.jsx("input",{value:Ze.phone,onChange:X=>$e(Ke=>({...Ke,phone:X.target.value})),className:"ml-4 w-48 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("label",{className:"flex items-center justify-between py-1",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Address"}),a.jsx("input",{value:Ze.address,onChange:X=>$e(Ke=>({...Ke,address:X.target.value})),className:"ml-4 w-72 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{className:"flex items-center justify-between py-1 opacity-60",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Source"}),a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-purple-100 text-purple-800",children:"website"})]})]})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-blue-200/60",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Owner"}),a.jsx("span",{className:"font-semibold text-gray-900",children:l.owner_name})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-blue-200/60",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Email"}),a.jsx("span",{className:"font-semibold text-blue-600",children:l.email})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-blue-200/60",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Phone"}),a.jsx("span",{className:"font-semibold text-gray-900",children:l.phone||"N/A"})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-blue-200/60",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Address"}),a.jsx("span",{className:"font-semibold text-gray-900 truncate max-w-[60%] text-right",children:l.address||"N/A"})]}),a.jsxs("div",{className:"flex items-center justify-between py-2",children:[a.jsx("span",{className:"text-gray-600 font-medium",children:"Source"}),a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-purple-100 text-purple-800",children:"website"})]})]})})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50/50 rounded-2xl p-6 border border-purple-200/50",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Lender Submissions"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Track all lender responses and offers"})]})]}),a.jsxs("div",{className:"flex flex-col items-end gap-1",children:[a.jsx("button",{onClick:()=>lt(X=>!X),className:"w-8 h-8 rounded-lg border border-purple-200 text-purple-700 hover:bg-purple-50 flex items-center justify-center text-lg leading-none","aria-label":"Toggle submissions",children:Qe?"−":"+"}),a.jsxs("div",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-semibold",children:[l.lenderSubmissions.length," Submissions"]})]})]}),Qe&&a.jsx("div",{className:"mt-4",children:l.lenderSubmissions.length===0?a.jsxs("div",{className:"text-center py-12 bg-white/60 rounded-xl border-2 border-dashed border-purple-200",children:[a.jsx("svg",{className:"w-12 h-12 text-purple-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"No lender submissions yet"}),a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Submissions will appear here once lenders respond"})]}):a.jsx("div",{className:"space-y-4",children:l.lenderSubmissions.map((X,Ke)=>a.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl p-5 border border-white/60 shadow-sm hover:shadow-md transition-all duration-200",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-sm",children:a.jsx("span",{className:"text-white font-bold text-sm",children:X.lender.name.charAt(0).toUpperCase()})}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-gray-900",children:X.lender.name}),a.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-2",children:[a.jsxs("span",{children:["Submitted: ",new Date(X.created_at).toLocaleDateString()]}),X.response_date&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full"}),a.jsxs("span",{children:["Responded: ",new Date(X.response_date).toLocaleDateString()]})]})]})]})]}),a.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-xs font-bold ${se(X.status)}`,children:X.status})]}),X.response&&a.jsx("div",{className:"mb-4 p-3 bg-blue-50/50 rounded-lg border border-blue-200/50",children:a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("span",{className:"font-semibold text-blue-700",children:"Response:"})," ",X.response]})}),(X.offered_amount||X.factor_rate||X.terms)&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[X.offered_amount&&a.jsxs("div",{className:"bg-emerald-50/50 rounded-lg p-3 border border-emerald-200/50",children:[a.jsx("span",{className:"text-xs font-semibold text-emerald-700 uppercase tracking-wide",children:"Offered Amount"}),a.jsxs("p",{className:"font-bold text-emerald-600 text-lg",children:["$",X.offered_amount.toLocaleString()]})]}),X.factor_rate&&a.jsxs("div",{className:"bg-orange-50/50 rounded-lg p-3 border border-orange-200/50",children:[a.jsx("span",{className:"text-xs font-semibold text-orange-700 uppercase tracking-wide",children:"Factor Rate"}),a.jsx("p",{className:"font-bold text-orange-600 text-lg",children:X.factor_rate})]}),X.terms&&a.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-3 border border-purple-200/50",children:[a.jsx("span",{className:"text-xs font-semibold text-purple-700 uppercase tracking-wide",children:"Terms"}),a.jsx("p",{className:"font-bold text-purple-600 text-sm",children:X.terms})]})]}),X.notes&&a.jsxs("div",{className:"bg-gray-50/50 rounded-lg p-3 border border-gray-200/50",children:[a.jsx("span",{className:"text-xs font-semibold text-gray-700 uppercase tracking-wide",children:"Notes"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:X.notes})]})]},Ke))})})]}),a.jsxs("div",{className:"mt-6 bg-gradient-to-b from-gray-50 to-white rounded-2xl border border-gray-200/80 shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h8M8 14h6"})})}),a.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Notes for Lenders"})]}),a.jsx("button",{onClick:()=>Nt(X=>!X),className:"w-8 h-8 rounded-lg border border-blue-200 text-blue-700 hover:bg-blue-50 flex items-center justify-center text-lg leading-none","aria-label":"Toggle notes section",children:At?"−":"+"})]}),At&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50/50 rounded-2xl border border-gray-200/80 shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),a.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Add New Note"})]}),a.jsx("textarea",{className:"w-full min-h-[120px] px-4 py-3 border border-gray-300 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none transition-all duration-200 bg-white/80 backdrop-blur-sm",placeholder:"Write a note for lenders... (e.g., follow-up required, special conditions, contact preferences)",value:me,onChange:X=>Ce(X.target.value)}),a.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[a.jsxs("div",{className:"text-xs text-gray-500",children:[me.length,"/500 characters"]}),a.jsx("button",{onClick:async()=>{if(!(!l||!me.trim()||dt)){O(!0);try{const X=await jE(l.id,me.trim());os(Ke=>[X,...Ke]),Ce(""),Ae("Note added","success")}catch(X){console.warn("Failed to add note:",X),Ae("Failed to add note","error")}finally{O(!1)}}},disabled:!me.trim()||dt,className:`px-6 py-2.5 rounded-xl text-sm font-semibold transition-all duration-200 ${!me.trim()||dt?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-blue-700 text-white hover:from-blue-700 hover:to-blue-800 shadow-lg hover:shadow-xl transform hover:scale-105"}`,children:dt?"Saving…":"Add Note"})]})]}),Lt?a.jsxs("div",{className:"text-center py-12 bg-gradient-to-br from-white to-gray-50/50 rounded-2xl border border-gray-200/80 shadow-sm",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-3 border-gray-200 border-t-blue-600 mx-auto mb-4"}),a.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Loading notes…"})]}):yt.length===0?a.jsxs("div",{className:"text-center py-16 bg-gradient-to-br from-white to-gray-50/50 rounded-2xl border-2 border-dashed border-gray-300",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gray-100 flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No notes yet"}),a.jsx("p",{className:"text-sm text-gray-500 max-w-sm mx-auto",children:"Start documenting important information about this application by adding your first note above."})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"text-lg font-bold text-gray-900",children:"Notes History"}),a.jsxs("div",{className:"px-2.5 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold",children:[yt.length," note",yt.length!==1?"s":""]})]}),yt.map(X=>a.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 p-4",children:[(()=>{const Ke=new Date(X.created_at),Oe=Ke.toLocaleString("en-US",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),Xe=Math.floor((Date.now()-Ke.getTime())/(1e3*60*60*24)),nt=`${Xe} day${Xe===1?"":"s"} ago`;return a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[a.jsx("span",{className:"font-medium",children:Oe}),a.jsx("span",{className:"text-gray-600",children:nt})]})})(),_e===X.id?a.jsxs("div",{children:[a.jsx("textarea",{className:"w-full min-h-[90px] px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",value:St,onChange:Ke=>Tt(Ke.target.value)}),a.jsxs("div",{className:"mt-2 flex items-center gap-2 justify-end",children:[a.jsx("button",{className:"px-4 py-2 text-sm font-semibold rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200",onClick:()=>{at(null),Tt("")},children:"Cancel"}),a.jsx("button",{className:"px-4 py-2 text-sm font-semibold rounded-lg bg-blue-600 text-white hover:bg-blue-700",onClick:async()=>{if(St.trim())try{await AE(X.id,{notes:St.trim()}),os(Ke=>Ke.map(Oe=>Oe.id===X.id?{...Oe,notes:St.trim()}:Oe)),at(null),Tt(""),Ae("Note updated","success")}catch(Ke){console.warn("Failed to update note:",Ke),Ae("Failed to update note","error")}},children:"Save"})]})]}):a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsx("div",{className:"text-sm text-gray-800 leading-relaxed whitespace-pre-wrap",children:X.notes}),a.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[a.jsx("button",{className:"px-3 py-1.5 text-xs font-semibold rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200",onClick:()=>{at(X.id),Tt(X.notes||"")},children:"Edit"}),a.jsx("button",{className:`px-3 py-1.5 text-xs font-semibold rounded-lg ${Pt===X.id?"bg-red-300 text-white":"bg-red-600 text-white hover:bg-red-700"}`,onClick:async()=>{if(!Pt)try{kt(X.id),await kE(X.id),os(Ke=>Ke.filter(Oe=>Oe.id!==X.id)),Ae("Note deleted","success")}catch(Ke){console.warn("Failed to delete note:",Ke),Ae("Failed to delete note","error")}finally{kt(null)}},children:Pt===X.id?"Deleting…":"Delete"})]})]})]},X.id))]})]})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200/80 flex justify-end gap-4",children:a.jsx("button",{onClick:()=>u(!1),className:"px-6 py-3 border border-gray-200 rounded-xl hover:bg-gray-50 hover:border-gray-300 font-semibold text-gray-700 transition-all duration-200 shadow-sm hover:shadow-md",children:"Close"})})]})]})})]})},F$=({onLogout:s})=>{const[e,t]=ne.useState([]),[r,n]=ne.useState(!0),[i,o]=ne.useState(""),[l,c]=ne.useState(""),[d,u]=ne.useState(null),[h,m]=ne.useState(!1),p=async()=>{try{n(!0);const{data:j,error:E}=await Ct.from("users").select("*").order("created_at",{ascending:!1});if(E)throw E;t(j||[])}catch(j){console.error("Error fetching users:",j)}finally{n(!1)}},x=async(j,E)=>{try{const{error:A}=await Ct.from("users").update({roles:E}).eq("id",j);if(A)throw A;p(),m(!1),u(null)}catch(A){console.error("Error updating user role:",A)}},w=async j=>{if(confirm("Are you sure you want to delete this user?"))try{const{error:E}=await Ct.from("users").delete().eq("id",j);if(E)throw E;p()}catch(E){console.error("Error deleting user:",E)}},S=e.filter(j=>{const E=j.full_name.toLowerCase().includes(i.toLowerCase())||j.email.toLowerCase().includes(i.toLowerCase())||j.roles&&j.roles.toLowerCase().includes(i.toLowerCase()),A=l===""||l==="no-role"&&!j.roles||j.roles===l;return E&&A}),b=j=>new Date(j).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),v=j=>{if(!j)return"bg-gray-100 text-gray-600";switch(j.toLowerCase()){case"admin":return"bg-red-100 text-red-800";case"member":return"bg-blue-100 text-blue-800";case"manager":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-600"}},N=()=>{localStorage.removeItem("adminLoggedIn"),s?s():window.location.reload()};return ne.useEffect(()=>{p()},[]),a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[a.jsx("div",{className:"bg-white/90 backdrop-blur-md shadow-lg border-b border-white/20 sticky top-0 z-40",children:a.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl shadow-lg",children:a.jsx(Q0,{className:"h-7 w-7 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",children:"Admin Dashboard"}),a.jsx("p",{className:"text-gray-600 text-sm",children:"MCAPortal Pro Management System"})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-lg shadow-md",children:a.jsxs("span",{className:"text-sm font-semibold",children:[e.length," Total Users"]})}),a.jsx("button",{onClick:p,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(On,{className:"h-4 w-4"}),a.jsx("span",{children:"Refresh"})]})}),a.jsx("button",{onClick:N,className:"px-4 py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",title:"Logout from Admin Panel",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(DC,{className:"h-4 w-4"}),a.jsx("span",{children:"Logout"})]})})]})]})})}),a.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[a.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-xl transition-all duration-300",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:e.length})]}),a.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl",children:a.jsx(On,{className:"h-6 w-6 text-white"})})]})}),a.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-xl transition-all duration-300",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Admin Users"}),a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:e.filter(j=>j.roles==="admin").length})]}),a.jsx("div",{className:"p-3 bg-gradient-to-br from-red-500 to-red-600 rounded-xl",children:a.jsx(Q0,{className:"h-6 w-6 text-white"})})]})}),a.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-xl transition-all duration-300",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Members"}),a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:e.filter(j=>j.roles==="member").length})]}),a.jsx("div",{className:"p-3 bg-gradient-to-br from-green-500 to-green-600 rounded-xl",children:a.jsx(kd,{className:"h-6 w-6 text-white"})})]})}),a.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 hover:shadow-xl transition-all duration-300",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Approval"}),a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:e.filter(j=>!j.roles).length})]}),a.jsx("div",{className:"p-3 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl",children:a.jsx(Dc,{className:"h-6 w-6 text-white"})})]})})]}),a.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 p-6 mb-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"User Directory"}),a.jsx("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:a.jsxs("span",{children:[S.length," of ",e.length," users"]})})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(ij,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search users by name, email, or role...",value:i,onChange:j=>o(j.target.value),className:"w-full pl-12 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:bg-white transition-all duration-200"})]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsxs("select",{value:l,onChange:j=>c(j.target.value),className:"px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[a.jsx("option",{value:"",children:"All Roles"}),a.jsx("option",{value:"no-role",children:"No Role"}),a.jsx("option",{value:"admin",children:"Admin"}),a.jsx("option",{value:"member",children:"Member"})]})})]})]}),a.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 overflow-hidden",children:r?a.jsxs("div",{className:"p-12 text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl mb-4",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-white border-t-transparent"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Loading Users"}),a.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch the user data..."})]}):a.jsxs("div",{className:"overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:[a.jsx("div",{className:"col-span-4",children:"User Information"}),a.jsx("div",{className:"col-span-3",children:"Contact"}),a.jsx("div",{className:"col-span-2",children:"Role & Status"}),a.jsx("div",{className:"col-span-2",children:"Created Date"}),a.jsx("div",{className:"col-span-1 text-center",children:"Actions"})]})}),a.jsx("div",{className:"divide-y divide-gray-100",children:S.map(j=>a.jsx("div",{className:"px-6 py-6 hover:bg-gray-50/50 transition-colors duration-200",children:a.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[a.jsx("div",{className:"col-span-4",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg",children:a.jsx(kd,{className:"h-6 w-6 text-white"})})}),a.jsx("div",{children:a.jsx("div",{className:"text-sm font-semibold text-gray-900",children:j.full_name})})]})}),a.jsx("div",{className:"col-span-3",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(d1,{className:"h-4 w-4 text-gray-400"}),a.jsx("span",{className:"text-sm text-gray-900 truncate",children:j.email})]})}),a.jsx("div",{className:"col-span-2",children:a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx("span",{className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${v(j.roles)}`,children:j.roles||"No Role"})})}),a.jsx("div",{className:"col-span-2",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(EM,{className:"h-4 w-4 text-gray-400"}),a.jsx("span",{className:"text-sm text-gray-600",children:b(j.created_at)})]})}),a.jsx("div",{className:"col-span-1 flex justify-center",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("button",{onClick:()=>{u(j),m(!0)},className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors duration-200",title:"Edit Role",children:a.jsx(hN,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>w(j.id),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"Delete User",children:a.jsx(vp,{className:"h-4 w-4"})})]})})]})},j.id))}),S.length===0&&!r&&a.jsxs("div",{className:"p-16 text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-3xl mb-6",children:a.jsx(On,{className:"h-10 w-10 text-gray-400"})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Users Found"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"No users match your current search criteria."}),a.jsx("button",{onClick:()=>o(""),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Clear Search"})]})]})}),h&&d&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-lg w-full overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-8 py-6",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"p-2 bg-white/20 rounded-xl",children:a.jsx(Q0,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:"Edit User Role"}),a.jsx("p",{className:"text-blue-100 text-sm",children:"Manage user permissions and access"})]})]})}),a.jsxs("div",{className:"p-8",children:[a.jsx("div",{className:"bg-gray-50 rounded-2xl p-6 mb-6",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center",children:a.jsx(kd,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:d.full_name}),a.jsx("p",{className:"text-gray-600",children:d.email})]})]})}),a.jsxs("div",{className:"mb-8",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-3",children:"Assign Role:"}),a.jsxs("select",{defaultValue:d.roles||"",onChange:j=>u({...d,roles:j.target.value||null}),className:"w-full p-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:bg-white transition-all duration-200 text-sm",children:[a.jsx("option",{value:"",children:"No Role (Pending Approval)"}),a.jsx("option",{value:"admin",children:"Admin (Full Access)"}),a.jsx("option",{value:"member",children:"Member (Standard Access)"})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>{m(!1),u(null)},className:"px-6 py-3 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-xl transition-all duration-200 font-medium",children:"Cancel"}),a.jsx("button",{onClick:()=>x(d.id,d.roles||""),className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 font-medium",children:"Update Role"})]})]})]})})]})]})},O$=({onRegistrationStart:s,onRegistrationEnd:e,showPendingApproval:t,onClosePendingApproval:r})=>{const[n,i]=ne.useState("login"),[o,l]=ne.useState(!1),[c,d]=ne.useState(null),[u,h]=ne.useState(!1),[m,p]=ne.useState(!1),[x,w]=ne.useState(!1),[S,b]=ne.useState(!1),[v,N]=ne.useState(!1);Yt.useEffect(()=>{localStorage.getItem("adminLoggedIn")==="true"&&N(!0)},[]);const j=async E=>{if(E.preventDefault(),!o){l(!0),d(null);try{const A=new FormData(E.currentTarget),L=A.get("email"),C=A.get("password"),B=A.get("fullName"),U=A.get("confirmPassword");if(n==="register"){if(C!==U)throw new Error("Passwords do not match");s==null||s(),await uE({email:L,password:C,fullName:B}),e==null||e(),setTimeout(()=>{w(!0)},100)}else{console.log("Checking admin login for:",L,C);const{data:P,error:T}=await Ct.from("admin").select("*").eq("email",L).single();if(console.log("Admin email check:",{adminCheck:P,adminCheckError:T}),!T&&P)if(P.password===C){console.log("Admin login successful"),localStorage.setItem("adminLoggedIn","true"),N(!0);return}else console.log("Admin password mismatch");const{data:z,error:H}=await Ct.from("users").select("*").eq("email",L).single();if(!H&&z){await hE({email:L,password:C});return}throw new Error("Invalid credentials")}}catch(A){d(A instanceof Error?A.message:"An error occurred"),n==="register"&&(e==null||e())}finally{l(!1)}}};return v?a.jsx(F$,{onLogout:()=>N(!1)}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[a.jsx("div",{className:"bg-white/80 backdrop-blur-sm shadow-sm border-b border-white/20",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center gap-3 py-6",children:[a.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl shadow-lg",children:a.jsx(Br,{className:"h-8 w-8 text-white"})}),a.jsx("div",{children:a.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",children:"MCAPortal Pro"})})]})})}),a.jsx("div",{className:"flex items-center justify-center px-4 sm:px-6 lg:px-8 py-12",children:a.jsxs("div",{className:"w-full max-w-lg",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:n==="login"?"Welcome Back":"Join MCAPortal Pro"}),a.jsx("p",{className:"text-gray-600",children:n==="login"?"Access your merchant cash advance dashboard":"Create your account to get started with professional banking solutions"})]}),a.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 overflow-hidden",children:[a.jsx("div",{className:"p-8 pb-6",children:a.jsxs("div",{className:"flex rounded-2xl bg-gray-50/80 p-1.5 border border-gray-200/50",children:[a.jsx("button",{onClick:()=>i("login"),className:`w-1/2 px-6 py-3 text-sm font-semibold rounded-xl transition-all duration-200 ${n==="login"?"bg-white text-blue-700 shadow-md border border-blue-100":"text-gray-600 hover:text-gray-800"}`,children:a.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[a.jsx(MM,{className:"h-4 w-4"}),"Sign In"]})}),a.jsx("button",{onClick:()=>i("register"),className:`w-1/2 px-6 py-3 text-sm font-semibold rounded-xl transition-all duration-200 ${n==="register"?"bg-white text-emerald-700 shadow-md border border-emerald-100":"text-gray-600 hover:text-gray-800"}`,children:a.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[a.jsx(UM,{className:"h-4 w-4"}),"Register"]})})]})}),a.jsxs("form",{onSubmit:j,className:"px-8 pb-8 space-y-6",children:[c&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:a.jsx("p",{className:"text-red-700 text-sm font-medium",children:c})}),n==="register"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Full Name"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{name:"fullName",type:"text",required:!0,className:"w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all bg-gray-50/50 text-gray-900 placeholder-gray-500",placeholder:"Enter your full name"}),a.jsx(On,{className:"h-5 w-5 text-gray-400 absolute left-4 top-1/2 -translate-y-1/2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{name:"email",type:"email",required:!0,className:"w-full pl-12 pr-4 py-4 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all bg-gray-50/50 text-gray-900 placeholder-gray-500",placeholder:"Enter your email address"}),a.jsx(d1,{className:"h-5 w-5 text-gray-400 absolute left-4 top-1/2 -translate-y-1/2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{name:"password",type:u?"text":"password",required:!0,className:"w-full pl-12 pr-12 py-4 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all bg-gray-50/50 text-gray-900 placeholder-gray-500",placeholder:"Enter your password"}),a.jsx(uN,{className:"h-5 w-5 text-gray-400 absolute left-4 top-1/2 -translate-y-1/2"}),a.jsx("button",{type:"button",onClick:()=>h(!u),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:u?a.jsx(dN,{className:"h-5 w-5"}):a.jsx(rc,{className:"h-5 w-5"})})]})]}),n==="register"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Confirm Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{name:"confirmPassword",type:m?"text":"password",required:!0,className:"w-full pl-12 pr-12 py-4 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all bg-gray-50/50 text-gray-900 placeholder-gray-500",placeholder:"Confirm your password"}),a.jsx(uN,{className:"h-5 w-5 text-gray-400 absolute left-4 top-1/2 -translate-y-1/2"}),a.jsx("button",{type:"button",onClick:()=>p(!m),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:m?a.jsx(dN,{className:"h-5 w-5"}):a.jsx(rc,{className:"h-5 w-5"})})]})]}),a.jsx("button",{type:"submit",disabled:o,className:`w-full py-4 rounded-xl text-white font-semibold transition-all duration-200 shadow-lg ${n==="login"?"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-blue-500/25":"bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 shadow-emerald-500/25"} ${o?"opacity-70 cursor-not-allowed":"hover:shadow-xl transform hover:-translate-y-0.5"}`,children:o?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Processing..."]}):n==="login"?"Sign In to Dashboard":"Create Your Account"}),n==="login"&&a.jsx("div",{className:"text-center",children:a.jsx("button",{type:"button",className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Forgot your password?"})})]}),a.jsx("div",{className:"px-8 pb-8",children:a.jsx("div",{className:"text-center text-sm text-gray-600 border-t border-gray-100 pt-6",children:n==="login"?a.jsxs(a.Fragment,{children:["New to MCAPortal Pro?"," ",a.jsx("button",{className:"text-emerald-600 hover:text-emerald-700 font-semibold",onClick:()=>i("register"),children:"Create an account"})]}):a.jsxs(a.Fragment,{children:["Already have an account?"," ",a.jsx("button",{className:"text-blue-600 hover:text-blue-700 font-semibold",onClick:()=>i("login"),children:"Sign in here"})]})})})]}),a.jsxs("div",{className:"mt-8 grid grid-cols-3 gap-4 text-center",children:[a.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-2xl p-4 border border-white/20",children:[a.jsx(Q0,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),a.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Bank-Level Security"})]}),a.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-2xl p-4 border border-white/20",children:[a.jsx(Pg,{className:"h-6 w-6 text-emerald-600 mx-auto mb-2"}),a.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Fast Approvals"})]}),a.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-2xl p-4 border border-white/20",children:[a.jsx(On,{className:"h-6 w-6 text-indigo-600 mx-auto mb-2"}),a.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Trusted by 1000+"})]})]})]})}),x&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full mx-4 overflow-hidden animate-in zoom-in-95 duration-200",children:a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-emerald-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:a.jsx(_s,{className:"h-8 w-8 text-white"})}),a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Registration Successful!"}),a.jsx("p",{className:"text-gray-600 mb-8 leading-relaxed",children:"Your account has been created successfully. You can now sign in with your new credentials to access MCAPortal Pro."}),a.jsx("button",{onClick:()=>{w(!1),i("login"),setTimeout(()=>{const E=document.querySelector("form");E&&E.reset()},100)},className:"w-full bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-700 hover:to-green-700 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Continue to Sign In"})]})})}),(S||t)&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full mx-4 overflow-hidden animate-in zoom-in-95 duration-200",children:a.jsxs("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-500 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:a.jsx(Dc,{className:"h-8 w-8 text-white"})}),a.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Account Pending Approval"}),a.jsx("p",{className:"text-gray-600 mb-8 leading-relaxed",children:"Your account has been created successfully, but you need to wait for admin approval to set your role before you can access the main portal. Please contact your administrator or wait for approval."}),a.jsx("button",{onClick:()=>{b(!1),r==null||r()},className:"w-full bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-700 hover:to-orange-700 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:"Understood"})]})})})]})};function B$({open:s,onClose:e,userId:t,onSaved:r}){const[n,i]=ne.useState(!1),[o,l]=ne.useState(!0),[c,d]=ne.useState(""),[u,h]=ne.useState(""),[m,p]=ne.useState(null),[x,w]=ne.useState(null),[S,b]=ne.useState(null),[v,N]=ne.useState(null);ne.useEffect(()=>{let E=!0;return(async()=>{if(s){l(!0),p(null);try{const L=await fE(t);if(!E)return;d(L.full_name||""),h(L.email||""),b(L.avatar_url??null)}catch(L){const C=L instanceof Error?L.message:"Failed to load profile";p(C)}finally{E&&l(!1)}}})(),()=>{E=!1}},[s,t]);const j=async()=>{i(!0),p(null),w(null);try{let E;v&&(E=await pE(t,v)),await mE(t,{full_name:c,...E?{avatar_url:E}:{}}),w("Saved"),r&&await r(),e()}catch(E){const A=E instanceof Error?E.message:"Failed to save";p(A)}finally{i(!1)}};return s?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:e}),a.jsxs("div",{className:"relative bg-white w-full max-w-md rounded-2xl shadow-2xl border-0 overflow-hidden",children:[a.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 px-6 py-8",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-purple-600/20"}),a.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors backdrop-blur-sm",children:a.jsx(qM,{className:"h-5 w-5 text-white"})}),a.jsxs("div",{className:"relative text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Profile Settings"}),a.jsx("p",{className:"text-blue-100 text-sm",children:"Manage your account information"})]})]}),a.jsx("div",{className:"px-6 py-6",children:o?a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Loading profile..."})]}):a.jsxs(a.Fragment,{children:[m&&a.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-50 border border-red-200",children:a.jsx("p",{className:"text-sm text-red-700",children:m})}),x&&a.jsx("div",{className:"mb-4 p-3 rounded-lg bg-emerald-50 border border-emerald-200",children:a.jsxs("p",{className:"text-sm text-emerald-700",children:["✓ ",x]})}),a.jsxs("div",{className:"flex flex-col items-center mb-8",children:[a.jsx("div",{className:"relative group",children:a.jsxs("div",{className:"relative",children:[S?a.jsx("img",{src:S,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-lg ring-4 ring-blue-100"}):a.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 border-4 border-white shadow-lg ring-4 ring-blue-100 flex items-center justify-center",children:a.jsx(kd,{className:"h-10 w-10 text-blue-600"})}),a.jsxs("label",{className:"absolute inset-0 flex items-center justify-center bg-black/40 rounded-full opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",children:[a.jsx(LM,{className:"h-6 w-6 text-white"}),a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:E=>{const A=E.target.files&&E.target.files[0];if(A){N(A);const L=URL.createObjectURL(A);b(L)}}})]})]})}),a.jsxs("p",{className:"text-xs text-gray-500 mt-3 text-center",children:["Click to change profile photo",a.jsx("br",{}),"PNG, JPG up to 2MB"]})]}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"email",value:u,readOnly:!0,className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 bg-gray-50 text-gray-600 font-medium focus:outline-none cursor-not-allowed"}),a.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4",children:a.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"})})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Full Name"}),a.jsx("input",{type:"text",value:c,onChange:E=>d(E.target.value),className:"w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-blue-500 focus:outline-none transition-colors font-medium",placeholder:"Enter your full name"})]})]})]})}),a.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 rounded-xl border-2 border-gray-300 text-gray-700 font-semibold hover:bg-gray-100 transition-colors",children:"Cancel"}),a.jsx("button",{onClick:j,disabled:n||o,className:"flex-1 px-4 py-3 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg hover:shadow-xl",children:n?a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):"Save Changes"})]})})]})]}):null}const sT=ne.createContext(null),Wd=()=>{const s=ne.useContext(sT);if(!s)throw new Error("useAuth must be used within AuthProvider");return s};function $$({children:s}){const[e,t]=ne.useState(null),[r,n]=ne.useState(!0),[i,o]=ne.useState(!1),[l,c]=ne.useState(!1);ne.useEffect(()=>{let h=!0;if(e&&!r){console.log("Auth already initialized, skipping...");return}const m=async()=>{try{const{data:{session:S},error:b}=await Ct.auth.getSession();if(b){console.error("Error getting session:",b),h&&n(!1);return}S!=null&&S.user&&h?await p(S.user.id):h&&(localStorage.getItem("mcapro_user")||(t(null),n(!1)))}catch(S){console.error("Error initializing auth:",S),h&&(t(null),n(!1))}},p=async S=>{console.log("handleUserSession called for userId:",S);try{console.log("Fetching user data from database...");const{data:b,error:v}=await Ct.from("users").select("full_name, email, roles, avatar_url").eq("id",S).single();if(console.log("User data response:",{userData:b,error:v}),!h){console.log("Component unmounted, returning early");return}if(!v&&b){if(!b.roles){console.log("User has no role assigned, showing pending approval"),await Ct.auth.signOut(),t(null),c(!0),n(!1);return}const N={id:S,name:b.full_name,email:b.email,role:b.roles,avatarUrl:b.avatar_url??null};console.log("Setting user info:",N),t(N),localStorage.setItem("mcapro_user",JSON.stringify(N)),console.log("User authentication successful")}else console.log("No user data found or error occurred"),t(null),localStorage.removeItem("mcapro_user")}catch(b){console.error("Error checking user role:",b),h&&(t(null),localStorage.removeItem("mcapro_user"))}finally{h&&(console.log("Setting loading to false"),n(!1))}},x=localStorage.getItem("mcapro_user");if(x&&!e)try{const S=JSON.parse(x);t(S),n(!1),console.log("Restored user from localStorage:",S)}catch(S){console.error("Error parsing stored user:",S),localStorage.removeItem("mcapro_user")}m();const{data:{subscription:w}}=Ct.auth.onAuthStateChange(async(S,b)=>{var v;if(h&&!i){if(console.log("Auth state change:",S,(v=b==null?void 0:b.user)==null?void 0:v.id),S==="SIGNED_OUT"||!(b!=null&&b.user)){console.log("User signed out, clearing state"),t(null),localStorage.removeItem("mcapro_user"),localStorage.removeItem("mcapro-auth-token"),n(!1);return}S==="SIGNED_IN"||S==="TOKEN_REFRESHED"?(console.log("Processing auth state change for user:",b.user.id),await p(b.user.id)):S==="INITIAL_SESSION"&&(b!=null&&b.user)&&(console.log("Processing initial session for user:",b.user.id),await p(b.user.id))}});return()=>{h=!1,w.unsubscribe()}},[i,r,e]);const u={user:e,loading:r,isRegistering:i,showPendingApproval:l,setIsRegistering:o,setShowPendingApproval:c,logout:async()=>{console.log("Logging out user..."),t(null),n(!1),localStorage.clear(),sessionStorage.clear(),console.log("User state and all storage cleared");try{await dE(),console.log("Supabase logout completed")}catch(h){console.error("Supabase logout error (but user is still logged out locally):",h)}console.log("Logout successful")},refreshUser:async()=>{if(!e)return;const{data:h}=await Ct.from("users").select("full_name, email, roles, avatar_url").eq("id",e.id).single();if(h){const m={id:e.id,name:h.full_name,email:h.email,role:h.roles,avatarUrl:h.avatar_url??null};t(m),localStorage.setItem("mcapro_user",JSON.stringify(m))}}};return a.jsx(sT.Provider,{value:u,children:s})}function z$({children:s}){const{user:e,loading:t}=Wd();return t?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e?a.jsx(a.Fragment,{children:s}):a.jsx(Eg,{to:"/login",replace:!0})}function U$({children:s}){const{user:e,loading:t}=Wd();return t?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e?a.jsx(Eg,{to:"/dashboard",replace:!0}):a.jsx(a.Fragment,{children:s})}function q$(){const{showPendingApproval:s,setIsRegistering:e,setShowPendingApproval:t}=Wd();return a.jsx(O$,{onRegistrationStart:()=>e(!0),onRegistrationEnd:()=>e(!1),showPendingApproval:s,onClosePendingApproval:()=>t(!1)})}function H$(){const{user:s,logout:e,refreshUser:t}=Wd(),r=ej(),[n,i]=ne.useState("submissions"),[o,l]=ne.useState(!1),[c,d]=ne.useState(null),[u,h]=ne.useState(!1);ne.useEffect(()=>{s&&n==="admin"&&(s.role==="admin"||s.role==="Admin"||i("submissions"))},[s,n]),ne.useEffect(()=>{const p=x=>{const w=x.target;o&&!w.closest(".user-dropdown")&&l(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[o]);const m=async()=>{try{await e(),l(!1),r("/login")}catch(p){console.error("Logout error:",p)}};return s?a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white shadow-lg border-b border-gray-100",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between py-4",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl shadow-lg",children:a.jsx(Br,{className:"h-7 w-7 text-white"})}),a.jsxs("div",{children:[a.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"MCAPortal Pro"}),a.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"Professional Dashboard"})]})]}),a.jsxs("div",{className:"flex items-center space-x-8",children:[a.jsxs("nav",{className:"flex items-center space-x-2 bg-gray-50 p-1 rounded-2xl border border-gray-200",children:[a.jsxs("button",{onClick:()=>{d(null),i("submissions")},className:`px-6 py-2.5 rounded-xl font-semibold text-sm transition-all duration-300 relative overflow-hidden ${n==="submissions"?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg transform scale-105":"text-gray-600 hover:text-blue-600 hover:bg-white hover:shadow-md"}`,children:[n==="submissions"&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/20 to-indigo-500/20 animate-pulse"}),a.jsx("span",{className:"relative",children:"Submissions Portal"})]}),a.jsxs("button",{onClick:()=>{d(null),i("deals")},className:`px-6 py-2.5 rounded-xl font-semibold text-sm transition-all duration-300 relative overflow-hidden ${n==="deals"?"bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg transform scale-105":"text-gray-600 hover:text-purple-600 hover:bg-white hover:shadow-md"}`,children:[n==="deals"&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-500/20 to-pink-500/20 animate-pulse"}),a.jsx("span",{className:"relative",children:"All Deals"})]}),s&&(s.role==="admin"||s.role==="Admin")&&a.jsxs("button",{onClick:()=>{d(null),i("admin")},className:`px-6 py-2.5 rounded-xl font-semibold text-sm transition-all duration-300 relative overflow-hidden ${n==="admin"?"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white shadow-lg transform scale-105":"text-gray-600 hover:text-emerald-600 hover:bg-white hover:shadow-md"}`,children:[n==="admin"&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-500/20 to-teal-500/20 animate-pulse"}),a.jsx("span",{className:"relative",children:"Admin Portal"})]})]}),a.jsx("div",{className:"relative",children:a.jsxs("div",{className:"relative user-dropdown",children:[a.jsxs("button",{onClick:()=>l(!o),className:"flex items-center space-x-3 px-4 py-2.5 bg-gradient-to-r from-gray-50 to-gray-100 hover:from-white hover:to-gray-50 rounded-2xl border border-gray-200 hover:border-blue-300 transition-all duration-300 shadow-sm hover:shadow-md group",children:[a.jsxs("div",{className:"relative",children:[s.avatarUrl?a.jsx("img",{src:s.avatarUrl,alt:"avatar",className:"w-10 h-10 rounded-full object-cover border-2 border-white shadow-md ring-2 ring-blue-100 group-hover:ring-blue-200 transition-all"}):a.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-full border-2 border-white shadow-md ring-2 ring-blue-100 group-hover:ring-blue-200 transition-all",children:a.jsx(kd,{className:"h-5 w-5 text-blue-600"})}),a.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-emerald-400 border-2 border-white rounded-full"})]}),a.jsxs("div",{className:"hidden sm:block text-left",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.name}),a.jsx("div",{className:"text-xs text-gray-500 capitalize",children:s.role})]}),a.jsx(PM,{className:`h-4 w-4 text-gray-400 group-hover:text-blue-500 transition-all duration-300 ${o?"rotate-180":""}`})]}),o&&a.jsxs("div",{className:"absolute right-0 top-full mt-3 w-64 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden z-50 animate-in slide-in-from-top-2 duration-200",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[s.avatarUrl?a.jsx("img",{src:s.avatarUrl,alt:"avatar",className:"w-12 h-12 rounded-full object-cover border-2 border-white shadow-md"}):a.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-full border-2 border-white shadow-md",children:a.jsx(kd,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-bold text-gray-900",children:s.name}),a.jsx("div",{className:"text-sm text-blue-600 font-medium capitalize",children:s.role})]})]})}),a.jsxs("div",{className:"py-2",children:[a.jsxs("button",{onClick:()=>{h(!0),l(!1)},className:"w-full text-left px-6 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors flex items-center gap-3 font-medium",children:[a.jsx(kd,{className:"h-4 w-4"}),"Account Settings"]}),a.jsxs("button",{onClick:m,className:"w-full text-left px-6 py-3 text-red-600 hover:bg-red-50 hover:text-red-700 flex items-center gap-3 transition-colors font-medium",children:[a.jsx(DC,{className:"h-4 w-4"}),"Sign Out"]})]})]})]})})]})]})})}),n==="submissions"&&a.jsx(R$,{initialStep:c==null?void 0:c.initialStep,initialApplicationId:c==null?void 0:c.initialApplicationId,lockedLenderIds:c==null?void 0:c.lockedLenderIds}),n==="deals"&&a.jsx(M$,{onEditDeal:({applicationId:p,lockedLenderIds:x})=>{d({initialStep:"intermediate",initialApplicationId:p,lockedLenderIds:x}),i("submissions")},onViewQualifiedLenders:({applicationId:p,lockedLenderIds:x})=>{d({initialStep:"matches",initialApplicationId:p,lockedLenderIds:x}),i("submissions")}}),n==="admin"&&s&&(s.role==="admin"||s.role==="Admin")&&a.jsx(D$,{}),s&&a.jsx(B$,{open:u,onClose:()=>h(!1),userId:s.id,onSaved:async()=>{await t()}})]}):a.jsx(Eg,{to:"/login",replace:!0})}const W$=cM([{path:"/login",element:a.jsx(U$,{children:a.jsx(q$,{})})},{path:"/dashboard",element:a.jsx(z$,{children:a.jsx(H$,{})})},{path:"/",element:a.jsx(Eg,{to:"/dashboard",replace:!0})},{path:"*",element:a.jsx(Eg,{to:"/dashboard",replace:!0})}]);function V$(){return a.jsx($$,{children:a.jsx(wM,{router:W$})})}cC(document.getElementById("root")).render(a.jsx(ne.StrictMode,{children:a.jsx(V$,{})}));export{Ws as _,si as c,Y3 as g};
